// Auto-generated from "make depends"; ALL CHANGES HERE WILL BE LOST!
!function(e,t){"function"==typeof define&&define.amd?define([],t.bind(e,this)):"object"==typeof module&&module.exports?module.exports=t.call(e,this):e.SocialCalc=t.call(e,this)}(this,function(e){var t;t||(t={}),t.Constants={cellDataType:{v:"value",n:"value",t:"text",f:"formula",c:"constant"},textdatadefaulttype:"t",s_BrowserNotSupported:"Browser not supported.",s_InternalError:"Internal SocialCalc error (probably an internal bug): ",s_pssUnknownColType:"Unknown col type item",s_pssUnknownRowType:"Unknown row type item",s_pssUnknownLineType:"Unknown line type",s_cfspUnknownCellType:"Unknown cell type item",doCanonicalizeSheet:!0,s_escUnknownSheetCmd:"Unknown sheet command: ",s_escUnknownSetCoordCmd:"Unknown set coord command: ",s_escUnknownCmd:"Unknown command: ",s_caccCircRef:"Circular reference to ",defaultRowNameWidth:"30",defaultAssumedRowHeight:15,defaultCellIDPrefix:"cell_",defaultCellLayout:"padding:2px 2px 1px 2px;vertical-align:top;",defaultCellFontStyle:"normal normal",defaultCellFontSize:"small",defaultCellFontFamily:"Verdana,Arial,Helvetica,sans-serif",defaultPaneDividerWidth:"3",defaultPaneDividerHeight:"3",defaultGridCSS:"1px solid #C0C0C0;",defaultCommentClass:"",defaultCommentStyle:"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-commentbg.gif);",defaultCommentNoGridClass:"",defaultCommentNoGridStyle:"",defaultReadonlyClass:"",defaultReadonlyStyle:"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-lockbg.gif);",defaultReadonlyNoGridClass:"",defaultReadonlyNoGridStyle:"",defaultReadonlyComment:"Locked cell",defaultColWidth:"80",defaultMinimumColWidth:10,defaultHighlightTypeCursorClass:"",defaultHighlightTypeCursorStyle:"color:#FFF;backgroundColor:#A6A6A6;",defaultHighlightTypeRangeClass:"",defaultHighlightTypeRangeStyle:"color:#000;backgroundColor:#E5E5E5;",defaultColnameClass:"",defaultColnameStyle:"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;",defaultSelectedColnameClass:"",defaultSelectedColnameStyle:"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;",defaultRownameClass:"",defaultRownameStyle:"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#808080;",defaultSelectedRownameClass:"",defaultSelectedRownameStyle:"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;",defaultUpperLeftClass:"",defaultUpperLeftStyle:"font-size:small;",defaultSkippedCellClass:"",defaultSkippedCellStyle:"font-size:small;background-color:#CCC",defaultPaneDividerClass:"",defaultPaneDividerStyle:"font-size:small;background-color:#C0C0C0;padding:0px;",defaultUnhideLeftClass:"",defaultUnhideLeftStyle:"float:right;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideleft.gif);padding:0;",defaultUnhideRightClass:"",defaultUnhideRightStyle:"float:left;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideright.gif);padding:0;",defaultUnhideTopClass:"",defaultUnhideTopStyle:"float:left;left:1px;position:absolute;bottom:-4px;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidetop.gif);padding:0;",defaultUnhideBottomClass:"",defaultUnhideBottomStyle:"float:left;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidebottom.gif);padding:0;",defaultColResizeBarClass:"col-resize-bar",defaultRowResizeBarClass:"row-resize-bar",s_rcMissingSheet:"Render Context must have a sheet object",defaultLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Link</span>',defaultPageLinkFormatString:'<span style="font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;">Page</span>',defaultFormatp:"#,##0.0%",defaultFormatc:"[$$]#,##0.00",defaultFormatdt:"d-mmm-yyyy h:mm:ss",defaultFormatd:"d-mmm-yyyy",defaultFormatt:"[h]:mm:ss",defaultDisplayTRUE:"TRUE",defaultDisplayFALSE:"FALSE",defaultImagePrefix:"images/sc_",defaultTableEditorIDPrefix:"te_",defaultPageUpDnAmount:15,AllowCtrlS:!0,defaultTableControlThickness:20,cteGriddivClass:"",s_statusline_executing:"Executing...",s_statusline_displaying:"Displaying...",s_statusline_ordering:"Ordering...",s_statusline_calculating:"Calculating...",s_statusline_calculatingls:"Calculating... Loading Sheet...",s_statusline_doingserverfunc:"doing server function ",s_statusline_incell:" in cell ",s_statusline_calcstart:"Calculation start...",s_statusline_sum:"SUM",s_statusline_recalcneeded:'<span style="color:#999;">(Recalc needed)</span>',s_statusline_circref:'<span style="color:red;">Circular reference: ',s_statusline_sendemail:"Sending Email ",s_inputboxdisplaymultilinetext:"[Multi-line text: Click icon on right to edit]",defaultInputEchoClass:"",defaultInputEchoStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;border:1px solid #884;fontSize:small;padding:2px 10px 1px 2px;cursor:default;",defaultInputEchoPromptClass:"",defaultInputEchoPromptStyle:"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;borderLeft:1px solid #884;borderRight:1px solid #884;borderBottom:1px solid #884;fontSize:small;fontStyle:italic;padding:2px 10px 1px 2px;cursor:default;",defaultInputEchoHintClass:"",defaultInputEchoHintStyle:"filter:alpha(opacity=80);opacity:.8;backgroundColor:#884;border:1px solid #884;fontSize:small;fontWeight:bold;padding:2px 2px 2px 2px;color:#FFF;position:absolute;top:-20px;cursor:default;",ietUnknownFunction:"Unknown function ",CH_radius1:29,CH_radius2:41,s_CHfillAllTooltip:"Fill Contents and Formats Down/Right",s_CHfillContentsTooltip:"Fill Contents Only Down/Right",s_CHmovePasteAllTooltip:"Move Contents and Formats",s_CHmovePasteContentsTooltip:"Move Contents Only",s_CHmoveInsertAllTooltip:"Slide Contents and Formats within Row/Col",s_CHmoveInsertContentsTooltip:"Slide Contents within Row/Col",s_CHindicatorOperationLookup:{Fill:"Fill",FillC:"Fill Contents",Move:"Move",MoveI:"Slide",MoveC:"Move Contents",MoveIC:"Slide Contents"},s_CHindicatorDirectionLookup:{Down:" Down",Right:" Right",Horizontal:" Horizontal",Vertical:" Vertical"},defaultTCSliderThickness:9,defaultTCButtonThickness:20,defaultTCThumbThickness:15,TCmainStyle:"backgroundColor:#EEE;",TCmainClass:"",TCendcapStyle:"backgroundColor:#FFF;",TCendcapClass:"",TCpanesliderClass:"tc-paneslider",s_panesliderTooltiph:"Drag to lock pane vertically",s_panesliderTooltipv:"Drag to lock pane horizontally",TClessbuttonStyle:"backgroundColor:#AAA;",TClessbuttonClass:"",TClessbuttonRepeatWait:300,TClessbuttonRepeatInterval:20,TCmorebuttonStyle:"backgroundColor:#AAA;",TCmorebuttonClass:"",TCmorebuttonRepeatWait:300,TCmorebuttonRepeatInterval:20,TCscrollareaStyle:"backgroundColor:#DDD;",TCscrollareaClass:"",TCscrollareaRepeatWait:500,TCscrollareaRepeatInterval:100,TCthumbClass:"",TCthumbStyle:"backgroundColor:#CCC;",TCPStrackinglineClass:"tracklingine",TCPStrackinglineStyle:"overflow:hidden;position:absolute;zIndex:100;",TCPStrackinglineThickness:"2px",TCTDFSthumbstatusvClass:"",TCTDFSthumbstatusvStyle:"height:20px;width:auto;border:3px solid #808080;overflow:hidden;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",TCTDFSthumbstatushClass:"",TCTDFSthumbstatushStyle:"height:20px;width:auto;border:1px solid black;padding:2px;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;",TCTDFSthumbstatusrownumClass:"",TCTDFSthumbstatusrownumStyle:"color:#FFF;background-color:#808080;font-size:small;white-space:nowrap;padding:3px;",TCTDFStopOffsetv:0,TCTDFSleftOffsetv:-80,s_TCTDFthumbstatusPrefixv:"Row ",TCTDFStopOffseth:-30,TCTDFSleftOffseth:0,s_TCTDFthumbstatusPrefixh:"Col ",TooltipOffsetX:2,TooltipOffsetY:10,TDpopupElementClass:"",TDpopupElementStyle:"border:1px solid black;padding:1px 2px 2px 2px;textAlign:center;backgroundColor:#FFF;fontSize:7pt;fontFamily:Verdana,Arial,Helvetica,sans-serif;position:absolute;width:auto;zIndex:110;",SCToolbarbackground:"background-color:#ffffff;",SCTabbackground:"background-color:#CCC;",SCTabselectedCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#404040;cursor:default;border-right:1px solid #CCC;",SCTabplainCSS:"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#808080;cursor:default;border-right:1px solid #CCC;",SCToolbartext:"font-size:x-small;font-weight:bold;color:#888",SCFormulabarheight:30,SCStatuslineheight:20,SCStatuslineCSS:"font-size:10px;padding:3px 0px;",SCFormatNumberFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|($1,234):$#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|[break]:|1\\c23:h:mm|1\\c23 PM:h:mm AM/PM|1\\c23\\c45:h:mm:ss|01\\c23\\c45:hh:mm:ss|26\\c23 (h\\cm):[hh]:mm|69\\c45 (m\\cs):[mm]:ss|69 (s):[ss]|[newcol]:|2006-01-04 01\\c23\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|",SCFormatTextFormats:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|",SCFormatPadsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",SCFormatFontsizes:"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|",SCFormatFontfamilies:"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|",SCFormatFontlook:"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|%loc!Bold Italic!:italic bold",SCFormatTextAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",SCFormatNumberAlignhoriz:"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|",SCFormatAlignVertical:"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|",SCFormatColwidth:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|",SCFormatRecalc:"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|",SCFormatUserMaxCol:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|",SCFormatUserMaxRow:"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|",ISCButtonNormalBackground:"transparent",ISCButtonBorderNormal:"none",ISCButtonBorderHover:"none",ISCButtonBorderDown:"none",ISCButtonDownBackground:"#888",s_PopupListCancel:"[Cancel]",s_PopupListCustom:"Custom",s_loc_align_center:"Align Center",s_loc_align_left:"Align Left",s_loc_align_right:"Align Right",s_loc_alignment:"Alignment",s_loc_audit:"Audit",s_loc_audit_trail_this_session:"Audit Trail This Session",s_loc_auto:"Auto",s_loc_auto_sum:"Auto Sum",s_loc_auto_wX_commas:"Auto w/ commas",s_loc_automatic:"Automatic",s_loc_background:"Background",s_loc_bold:"Bold",s_loc_bold_XampX_italics:"Bold &amp; Italics",s_loc_bold_italic:"Bold Italic",s_loc_borders:"Borders",s_loc_borders_off:"Borders Off",s_loc_borders_on:"Borders On",s_loc_bottom:"Bottom",s_loc_bottom_border:"Bottom Border",s_loc_cell_settings:"CELL SETTINGS",s_loc_csv_format:"CSV format",s_loc_cancel:"Cancel",s_loc_category:"Category",s_loc_center:"Center",s_loc_clear:"Clear",s_loc_clear_socialcalc_clipboard:"Clear SocialCalc Clipboard",s_loc_clipboard:"Clipboard",s_loc_color:"Color",s_loc_column_:"Column ",s_loc_comment:"Comment",s_loc_copy:"Copy",s_loc_custom:"Custom",s_loc_cut:"Cut",s_loc_default:"Default",s_loc_default_alignment:"Default Alignment",s_loc_default_column_width:"Default Column Width",s_loc_default_font:"Default Font",s_loc_default_format:"Default Format",s_loc_default_padding:"Default Padding",s_loc_delete:"Delete",s_loc_delete_column:"Delete Column",s_loc_delete_contents:"Delete Cell Contents",s_loc_delete_row:"Delete Row",s_loc_description:"Description",s_loc_display_clipboard_in:"Display Clipboard in",s_loc_down:"Down",s_loc_edit:"Edit",s_loc_existing_names:"Existing Names",s_loc_family:"Family",s_loc_fill_down:"Fill Down",s_loc_fill_right:"Fill Right",s_loc_font:"Font",s_loc_format:"Format",s_loc_formula:"Formula",s_loc_function_list:"Function List",s_loc_functions:"Functions",s_loc_grid:"Grid",s_loc_hidden:"Hidden",s_loc_hide_column:"Hide Column",s_loc_hide_row:"Hide Row",s_loc_horizontal:"Horizontal",s_loc_insert_column:"Insert Column Before",s_loc_insert_row:"Insert Row Before",s_loc_italic:"Italic",s_loc_last_sort:"Last Sort",s_loc_left:"Left",s_loc_left_border:"Left Border",s_loc_link:"Link",s_loc_link_input_box:"Link Input Box",s_loc_list:"List",s_loc_load_socialcalc_clipboard_with_this:"Load SocialCalc Clipboard With This",s_loc_lock_cell:"Lock Cell",s_loc_major_sort:"Major Sort",s_loc_manual:"Manual",s_loc_merge_cells:"Merge/Unmerge Cells",s_loc_middle:"Middle",s_loc_minor_sort:"Minor Sort",s_loc_move_insert:"Move Insert",s_loc_move_paste:"Move Paste",s_loc_multiXline_input_box:"Multi-line Input Box",s_loc_name:"Name",s_loc_names:"Names",s_loc_no_padding:"No padding",s_loc_normal:"Normal",s_loc_number:"Number",s_loc_number_horizontal:"Number Horizontal",s_loc_ok:"OK",s_loc_padding:"Padding",s_loc_page_name:"Page Name",s_loc_paste:"Paste",s_loc_paste_formats:"Paste Formats",s_loc_plain_text:"Plain Text",s_loc_recalc:"Recalc",s_loc_recalculation:"Recalculation",s_loc_redo:"Redo",s_loc_right:"Right",s_loc_right_border:"Right Border",s_loc_sheet_settings:"SHEET SETTINGS",s_loc_save:"Save",s_loc_save_to:"Save to",s_loc_set_cell_contents:"Set Cell Contents",s_loc_set_cells_to_sort:"Set Cells To Sort",s_loc_set_value_to:"Set Value To",s_loc_set_to_link_format:"Set to Link format",s_loc_setXclear_move_from:"Set/Clear Move From",s_loc_show_cell_settings:"Show Cell Settings",s_loc_show_sheet_settings:"Show Sheet Settings",s_loc_show_in_new_browser_window:"Show in new browser window",s_loc_size:"Size",s_loc_socialcalcXsave_format:"SocialCalc-save format",s_loc_sort:"Sort",s_loc_sort_:"Sort ",s_loc_sort_cells:"Sort Cells",s_loc_swap_colors:"Swap Colors",s_loc_tabXdelimited_format:"Tab-delimited format",s_loc_text:"Text",s_loc_text_horizontal:"Text Horizontal",s_loc_this_is_aXbrXsample:"This is a<br>sample",s_loc_top:"Top",s_loc_top_border:"Top Border",s_loc_undone_steps:"UNDONE STEPS",s_loc_url:"URL",s_loc_undo:"Undo",s_loc_unlock_cell:"Unlock Cell",s_loc_unmerge_cells:"Unmerge Cells",s_loc_up:"Up",s_loc_value:"Value",s_loc_vertical:"Vertical",s_loc_wikitext:"Wikitext",s_loc_workspace:"Workspace",s_loc_XnewX:"[New]",s_loc_XnoneX:"[None]",s_loc_Xselect_rangeX:"[select range]",SVStatuslineheight:20,SVStatuslineCSS:"font-size:10px;padding:3px 0px;",FormatNumber_separatorchar:",",FormatNumber_decimalchar:".",FormatNumber_defaultCurrency:"$",s_FormatNumber_daynames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s_FormatNumber_daynames3:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s_FormatNumber_monthnames:["January","February","March","April","May","June","July","August","September","October","November","December"],s_FormatNumber_monthnames3:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s_FormatNumber_am:"AM",s_FormatNumber_am1:"A",s_FormatNumber_pm:"PM",s_FormatNumber_pm1:"P",s_parseerrexponent:"Improperly formed number exponent",s_parseerrchar:"Unexpected character in formula",s_parseerrstring:"Improperly formed string",s_parseerrspecialvalue:"Improperly formed special value",s_parseerrtwoops:"Error in formula (two operators inappropriately in a row)",s_parseerrmissingopenparen:"Missing open parenthesis in list with comma(s). ",s_parseerrcloseparennoopen:"Closing parenthesis without open parenthesis. ",s_parseerrmissingcloseparen:"Missing close parenthesis. ",s_parseerrmissingoperand:"Missing operand. ",s_parseerrerrorinformula:"Error in formula.",s_calcerrerrorvalueinformula:"Error value in formula",s_parseerrerrorinformulabadval:"Error in formula resulting in bad value",s_formularangeresult:"Formula results in range value:",s_calcerrnumericnan:"Formula results in an bad numeric value",s_calcerrnumericoverflow:"Numeric overflow",s_sheetunavailable:"Sheet unavailable:",s_calcerrcellrefmissing:"Cell reference missing when expected.",s_calcerrsheetnamemissing:"Sheet name missing when expected.",s_circularnameref:"Circular name reference to name",s_calcerrunknownname:"Unknown name",s_calcerrincorrectargstofunction:"Incorrect arguments to function",s_sheetfuncunknownfunction:"Unknown function",s_sheetfunclnarg:"LN argument must be greater than 0",s_sheetfunclog10arg:"LOG10 argument must be greater than 0",s_sheetfunclogsecondarg:"LOG second argument must be numeric greater than 0",s_sheetfunclogfirstarg:"LOG first argument must be greater than 0",s_sheetfuncroundsecondarg:"ROUND second argument must be numeric",s_sheetfuncddblife:"DDB life must be greater than 1",s_sheetfuncslnlife:"SLN life must be greater than 1",s_fdef_ABS:"Absolute value function. ",s_fdef_ACOS:"Trigonometric arccosine function. ",s_fdef_AND:"True if all arguments are true. ",s_fdef_ASIN:"Trigonometric arcsine function. ",s_fdef_ATAN:"Trigonometric arctan function. ",s_fdef_ATAN2:"Trigonometric arc tangent function (result is in radians). ",s_fdef_AVERAGE:"Averages the values. ",s_fdef_CHOOSE:"Returns the value specified by the index. The values may be ranges of cells. ",s_fdef_COLUMNS:"Returns the number of columns in the range. ",s_fdef_COS:"Trigonometric cosine function (value is in radians). ",s_fdef_CONCAT:"Join Together Text & Values to Create a Single Combined Text String. ",s_fdef_CONCATENATE:"Join Together Text & Values to Create a Single Combined Text String. ",s_fdef_COUNT:"Counts the number of numeric values, not blank, text, or error. ",s_fdef_COUNTA:"Counts the number of non-blank values. ",s_fdef_COUNTBLANK:'Counts the number of blank values. (Note: "" is not blank.) ',s_fdef_COUNTIF:'Counts the number of number of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). ',s_fdef_DATE:'Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',s_fdef_DAVERAGE:"Averages the values in the specified field in records that meet the criteria. ",s_fdef_DAY:"Returns the day of month for a date value. ",s_fdef_DCOUNT:"Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. ",s_fdef_DCOUNTA:"Counts the number of non-blank values in the specified field in records that meet the criteria. ",s_fdef_DDB:"Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   ",s_fdef_DEGREES:"Converts value in radians into degrees. ",s_fdef_DGET:"Returns the value of the specified field in the single record that meets the criteria. ",s_fdef_DMAX:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DMIN:"Returns the maximum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DPRODUCT:"Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSTDEV:"Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSTDEVP:"Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DSUM:"Returns the sum of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVAR:"Returns the sample variance of the numeric values in the specified field in records that meet the criteria. ",s_fdef_DVARP:"Returns the variance of the numeric values in the specified field in records that meet the criteria. ",s_fdef_EVEN:"Rounds the value up in magnitude to the nearest even integer. ",s_fdef_EXACT:'Returns "true" if the values are exactly the same, including case, type, etc. ',s_fdef_EXP:"Returns e raised to the value power. ",s_fdef_FACT:"Returns factorial of the value. ",s_fdef_FALSE:'Returns the logical value "false". ',s_fdef_FIND:'Returns the starting position within string2 of the first occurrence of string1 at or after "start". If start is omitted, 1 is assumed. ',s_fdef_FV:"Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_HLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. ",s_fdef_HOUR:"Returns the hour portion of a time or date/time value. ",s_fdef_IF:"Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. ",s_fdef_INDEX:"Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). ",s_fdef_INT:"Returns the value rounded down to the nearest integer (towards -infinity). ",s_fdef_IRR:"Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",s_fdef_ISBLANK:'Returns "true" if the value is a reference to a blank cell. ',s_fdef_ISERR:'Returns "true" if the value is of type "Error" but not "NA". ',s_fdef_ISERROR:'Returns "true" if the value is of type "Error". ',s_fdef_ISLOGICAL:'Returns "true" if the value is of type "Logical" (true/false). ',s_fdef_ISNA:'Returns "true" if the value is the error type "NA". ',s_fdef_ISNONTEXT:'Returns "true" if the value is not of type "Text". ',s_fdef_ISNUMBER:'Returns "true" if the value is of type "Number" (including logical values). ',s_fdef_ISTEXT:'Returns "true" if the value is of type "Text". ',s_fdef_LEFT:"Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. ",s_fdef_LEN:"Returns the number of characters in the text value. ",s_fdef_LN:"Returns the natural logarithm of the value. ",s_fdef_LOG:"Returns the logarithm of the value using the specified base. ",s_fdef_LOG10:"Returns the base 10 logarithm of the value. ",s_fdef_LOWER:"Returns the text value with all uppercase characters converted to lowercase. ",s_fdef_MATCH:"Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. ",s_fdef_MAX:"Returns the maximum of the numeric values. ",s_fdef_MID:"Returns the specified number of characters from the text value starting from the specified position. ",s_fdef_MIN:"Returns the minimum of the numeric values. ",s_fdef_MINUTE:"Returns the minute portion of a time or date/time value. ",s_fdef_MOD:"Returns the remainder of the first value divided by the second. ",s_fdef_MONTH:"Returns the month part of a date value. ",s_fdef_N:"Returns the value if it is a numeric value otherwise an error. ",s_fdef_NA:"Returns the #N/A error value which propagates through most operations. ",s_fdef_NOT:"Returns FALSE if value is true, and TRUE if it is false. ",s_fdef_NOW:"Returns the current date/time. ",s_fdef_NPER:"Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. ",s_fdef_NPV:"Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. ",s_fdef_ODD:"Rounds the value up in magnitude to the nearest odd integer. ",s_fdef_OR:"True if any argument is true ",s_fdef_PI:"The value 3.1415926... ",s_fdef_PMT:"Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_POWER:"Returns the first value raised to the second value power. ",s_fdef_PRODUCT:"Returns the result of multiplying the numeric values. ",s_fdef_PROPER:"Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. ",s_fdef_PV:"Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ",s_fdef_RADIANS:"Converts value in degrees into radians. ",s_fdef_RATE:"Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ",s_fdef_REPLACE:"Returns text1 with the specified number of characters starting from the specified position replaced by text2. ",s_fdef_REPT:"Returns the text repeated the specified number of times. ",s_fdef_RIGHT:"Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. ",s_fdef_ROUND:"Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). ",s_fdef_ROWS:"Returns the number of rows in the range. ",s_fdef_SECOND:"Returns the second portion of a time or date/time value (truncated to an integer). ",s_fdef_SIN:"Trigonometric sine function (value is in radians) ",s_fdef_SLN:"Returns the amount of depreciation at each period of time using the straight-line method. ",s_fdef_SQRT:"Square root of the value ",s_fdef_STDEV:"Returns the sample standard deviation of the numeric values. ",s_fdef_STDEVP:"Returns the standard deviation of the numeric values. ",s_fdef_SUBSTITUTE:'Returns text1 with the all occurrences of oldtext replaced by newtext. If "occurrence" is present, then only that occurrence is replaced. ',s_fdef_SUM:"Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. ",s_fdef_SUMIF:'Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. ',s_fdef_SUMIFS:'Sums the numeric values of cells in the sum_range that meet the multiple criteria. The criteria may be a value ("x", 15, 1+3) or a test (>25).  ',s_fdef_SYD:"Depreciation by Sum of Year's Digits method. ",s_fdef_T:"Returns the text value or else a null string. ",s_fdef_TAN:"Trigonometric tangent function (value is in radians) ",s_fdef_TIME:"Returns the time value given the specified hour, minute, and second. ",s_fdef_TODAY:'Returns the current date (an integer). Note: In this program, day "1" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day "1" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',s_fdef_TRIM:"Returns the text value with leading, trailing, and repeated spaces removed. ",s_fdef_TRUE:'Returns the logical value "true". ',s_fdef_TRUNC:"Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. ",s_fdef_UPPER:"Returns the text value with all lowercase characters converted to uppercase. ",s_fdef_VALUE:"Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. ",s_fdef_VAR:"Returns the sample variance of the numeric values. ",s_fdef_VARP:"Returns the variance of the numeric values. ",s_fdef_VLOOKUP:"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. ",s_fdef_WEEKDAY:"Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. ",s_fdef_YEAR:"Returns the year part of a date value. ",s_fdef_SUMPRODUCT:"Sums the pairwise products of 2 or more ranges. The ranges must be of equal length.",s_fdef_CEILING:"Rounds the given number up to the nearest integer or multiple of significance. Significance is the value to whose multiple of ten the value is to be rounded up (.01, .1, 1, 10, etc.)",s_fdef_FLOOR:"Rounds the given number down to the nearest multiple of significance. Significance is the value to whose multiple of ten the number is to be rounded down (.01, .1, 1, 10, etc.)",s_farg_v:"value",s_farg_vn:"value1, value2, ...",s_farg_xy:"valueX, valueY",s_farg_choose:"index, value1, value2, ...",s_farg_range:"range",s_farg_rangec:"range, criteria",s_farg_date:"year, month, day",s_farg_dfunc:"databaserange, fieldname, criteriarange",s_farg_ddb:"cost, salvage, lifetime, period, [factor]",s_farg_find:"string1, string2, [start]",s_farg_fv:"rate, n, payment, [pv, [paytype]]",s_farg_hlookup:"value, range, row, [rangelookup]",s_farg_iffunc:"logical-expression, true-value, [false-value]",s_farg_index:"range, rownum, colnum",s_farg_irr:"range, [guess]",s_farg_tc:"text, count",s_farg_log:"value, base",s_farg_match:"value, range, [rangelookup]",s_farg_mid:"text, start, length",s_farg_nper:"rate, payment, pv, [fv, [paytype]]",s_farg_npv:"rate, value1, value2, ...",s_farg_pmt:"rate, n, pv, [fv, [paytype]]",s_farg_pv:"rate, n, payment, [fv, [paytype]]",s_farg_rate:"n, payment, pv, [fv, [paytype, [guess]]]",s_farg_replace:"text1, start, length, text2",s_farg_vp:"value, [precision]",s_farg_valpre:"value, precision",s_farg_csl:"cost, salvage, lifetime",s_farg_cslp:"cost, salvage, lifetime, period",s_farg_subs:"text1, oldtext, newtext, [occurrence]",s_farg_sumif:"range1, criteria, [range2]",s_farg_hms:"hour, minute, second",s_farg_txt:"text",s_farg_vlookup:"value, range, col, [rangelookup]",s_farg_weekday:"date, [type]",s_farg_dt:"date",s_farg_rangen:"range1, range2, ...",s_farg_vsig:"value, [significance]",function_classlist:["all","stat","lookup","datetime","financial","test","math","text","gui","action"],s_fclass_all:"All",s_fclass_stat:"Statistics",s_fclass_lookup:"Lookup",s_fclass_datetime:"Date & Time",s_fclass_financial:"Financial",s_fclass_test:"Test",s_fclass_math:"Math",s_fclass_text:"Text",s_fclass_action:"Email & Copy",s_fclass_gui:"Button & Input",lastone:null},t.ConstantsDefaultClasses={defaultComment:"",defaultCommentNoGrid:"",defaultHighlightTypeCursor:"",defaultHighlightTypeRange:"",defaultColname:"",defaultSelectedColname:"",defaultRowname:"",defaultSelectedRowname:"",defaultUpperLeft:"",defaultSkippedCell:"",defaultPaneDivider:"",cteGriddiv:"",defaultInputEcho:{classname:"",style:"filter:alpha(opacity=90);opacity:.9;"},TCmain:"",TCendcap:"",TCpaneslider:"",TClessbutton:"",TCmorebutton:"",TCscrollarea:"",TCthumb:"",TCPStrackingline:"",TCTDFSthumbstatus:"",TDpopupElement:""},t.ConstantsSetClasses=function(e){var o,i=t.ConstantsDefaultClasses,n=t.Constants;
e=e||"";for(o in i)"string"==typeof i[o]?(n[o+"Class"]=e+(i[o]||o),void 0!==n[o+"Style"]&&(n[o+"Style"]="")):"object"==typeof i[o]&&(n[o+"Class"]=e+(i[o].classname||o),n[o+"Style"]=i[o].style)},t.ConstantsSetImagePrefix=function(e){var o=t.Constants;for(var i in o)"string"==typeof o[i]&&(o[i]=o[i].replace(o.defaultImagePrefix,e));o.defaultImagePrefix=e};var t;t||(t={}),t.Callbacks={expand_wiki:null,expand_markup:function(e,o,i){return t.default_expand_markup(e,o,i)},MakePageLink:null,NormalizeSheetName:null},t.Cell=function(e){this.coord=e,this.datavalue="",this.datatype=null,this.formula="",this.valuetype="b",this.readonly=!1},t.CellProperties={coord:1,datavalue:1,datatype:1,formula:1,valuetype:1,errors:1,comment:1,readonly:1,bt:2,br:2,bb:2,bl:2,layout:2,font:2,color:2,bgcolor:2,cellformat:2,nontextvalueformat:2,textvalueformat:2,colspan:2,rowspan:2,cssc:2,csss:2,mod:2,displaystring:3,parseinfo:3,hcolspan:3,hrowspan:3},t.CellPropertiesTable={bt:"borderstyle",br:"borderstyle",bb:"borderstyle",bl:"borderstyle",layout:"layout",font:"font",color:"color",bgcolor:"color",cellformat:"cellformat",nontextvalueformat:"valueformat",textvalueformat:"valueformat"},t.Sheet=function(){t.ResetSheet(this),this.statuscallback=null,this.statuscallbackparams=null},t.ResetSheet=function(e){e.cells={},e.attribs={lastcol:1,lastrow:1,defaultlayout:0,usermaxcol:0,usermaxrow:0},e.rowattribs={hide:{},height:{}},e.colattribs={width:{},hide:{}},e.names={},e.layouts=[],e.layouthash={},e.fonts=[],e.fonthash={},e.colors=[],e.colorhash={},e.borderstyles=[],e.borderstylehash={},e.cellformats=[],e.cellformathash={},e.valueformats=[],e.valueformathash={},e.matched_cells=[],e.selected_search_cell=void 0,e.copiedfrom="",e.changes=new t.UndoStack,e.renderneeded=!1,e.changedrendervalues=!0,e.recalcchangedavalue=!1,e.hiddencolrow="",e.sci=new t.SheetCommandInfo(e),e.ioEventTree={},e.ioParameterList={}},t.Sheet.prototype.ResetSheet=function(){t.ResetSheet(this)},t.Sheet.prototype.AddCell=function(e){return this.cells[e.coord]=e},t.Sheet.prototype.LastCol=function(){var e=1;for(var o in this.cells){var i=t.coordToCr(o);i.col>e&&(e=i.col)}return e},t.Sheet.prototype.LastRow=function(){var e=1;for(var o in this.cells){var i=t.coordToCr(o);i.row>e&&(e=i.row)}return e},t.Sheet.prototype.GetAssuredCell=function(e){return this.cells[e]||this.AddCell(new t.Cell(e))},t.Sheet.prototype.ParseSheetSave=function(e){t.ParseSheetSave(e,this)},t.Sheet.prototype.CellFromStringParts=function(e,o,i){return t.CellFromStringParts(this,e,o,i)},t.Sheet.prototype.CreateSheetSave=function(e,o){return t.CreateSheetSave(this,e,o)},t.Sheet.prototype.CellToString=function(e){return t.CellToString(this,e)},t.Sheet.prototype.CanonicalizeSheet=function(e){return t.CanonicalizeSheet(this,e)},t.Sheet.prototype.EncodeCellAttributes=function(e){return t.EncodeCellAttributes(this,e)},t.Sheet.prototype.EncodeSheetAttributes=function(){return t.EncodeSheetAttributes(this)},t.Sheet.prototype.DecodeCellAttributes=function(e,o,i){return t.DecodeCellAttributes(this,e,o,i)},t.Sheet.prototype.DecodeSheetAttributes=function(e){return t.DecodeSheetAttributes(this,e)},t.Sheet.prototype.ScheduleSheetCommands=function(e,o){return t.ScheduleSheetCommands(this,e,o)},t.Sheet.prototype.SheetUndo=function(){return t.SheetUndo(this)},t.Sheet.prototype.SheetRedo=function(){return t.SheetRedo(this)},t.Sheet.prototype.CreateAuditString=function(){return t.CreateAuditString(this)},t.Sheet.prototype.GetStyleNum=function(e,o){return t.GetStyleNum(this,e,o)},t.Sheet.prototype.GetStyleString=function(e,o){return t.GetStyleString(this,e,o)},t.Sheet.prototype.RecalcSheet=function(){return t.RecalcSheet(this)},t.ParseSheetSave=function(e,o){var i,n,r,a,s,l,c,u,d,h=e.split(/\r\n|\n/),p=[],f=t.Constants;for(n=0;n<h.length;n++){switch(i=h[n],p=i.split(":"),p[0]){case"cell":c=o.GetAssuredCell(p[1]),r=2,o.CellFromStringParts(c,p,r);break;case"col":for(l=p[1],r=2;a=p[r++];)switch(a){case"w":o.colattribs.width[l]=p[r++];break;case"hide":o.colattribs.hide[l]=p[r++];break;default:throw f.s_pssUnknownColType+" '"+a+"'"}break;case"row":for(l=p[1]-0,r=2;a=p[r++];)switch(a){case"h":o.rowattribs.height[l]=p[r++]-0;break;case"hide":o.rowattribs.hide[l]=p[r++];break;default:throw f.s_pssUnknownRowType+" '"+a+"'"}break;case"sheet":for(u=o.attribs,r=1;a=p[r++];)switch(a){case"c":u.lastcol=p[r++]-0;break;case"r":u.lastrow=p[r++]-0;break;case"w":u.defaultcolwidth=p[r++]+"";break;case"h":u.defaultrowheight=p[r++]-0;break;case"tf":u.defaulttextformat=p[r++]-0;break;case"ntf":u.defaultnontextformat=p[r++]-0;break;case"layout":u.defaultlayout=p[r++]-0;break;case"font":u.defaultfont=p[r++]-0;break;case"tvf":u.defaulttextvalueformat=p[r++]-0;break;case"ntvf":u.defaultnontextvalueformat=p[r++]-0;break;case"color":u.defaultcolor=p[r++]-0;break;case"bgcolor":u.defaultbgcolor=p[r++]-0;break;case"circularreferencecell":u.circularreferencecell=p[r++];break;case"recalc":u.recalc=p[r++];break;case"needsrecalc":u.needsrecalc=p[r++];break;case"usermaxcol":u.usermaxcol=p[r++]-0;break;case"usermaxrow":u.usermaxrow=p[r++]-0;break;default:r+=1}break;case"name":d=t.decodeFromSave(p[1]).toUpperCase(),o.names[d]={desc:t.decodeFromSave(p[2])},o.names[d].definition=t.decodeFromSave(p[3]);break;case"layout":p=h[n].match(/^layout\:(\d+)\:(.+)$/),o.layouts[p[1]-0]=p[2],o.layouthash[p[2]]=p[1]-0;break;case"font":o.fonts[p[1]-0]=p[2],o.fonthash[p[2]]=p[1]-0;break;case"color":o.colors[p[1]-0]=p[2],o.colorhash[p[2]]=p[1]-0;break;case"border":o.borderstyles[p[1]-0]=p[2],o.borderstylehash[p[2]]=p[1]-0;break;case"cellformat":s=t.decodeFromSave(p[2]),o.cellformats[p[1]-0]=s,o.cellformathash[s]=p[1]-0;break;case"valueformat":s=t.decodeFromSave(p[2]),o.valueformats[p[1]-0]=s,o.valueformathash[s]=p[1]-0;break;case"version":break;case"copiedfrom":o.copiedfrom=p[1]+":"+p[2];break;case"clipboardrange":case"clipboard":break;case"":break;default:throw alert(f.s_pssUnknownLineType+" '"+p[0]+"'"),f.s_pssUnknownLineType+" '"+p[0]+"'"}p=null}},t.CellFromStringParts=function(e,o,i,n){for(var o,r,a;r=i[n++];)switch(r){case"v":o.datavalue=t.decodeFromSave(i[n++])-0,o.datatype="v",o.valuetype="n";break;case"t":o.datavalue=t.decodeFromSave(i[n++]),o.datatype="t",o.valuetype=t.Constants.textdatadefaulttype;break;case"vt":a=i[n++],o.valuetype=a,"n"==a.charAt(0)?(o.datatype="v",o.datavalue=t.decodeFromSave(i[n++])-0):(o.datatype="t",o.datavalue=t.decodeFromSave(i[n++]));break;case"vtf":a=i[n++],o.valuetype=a,o.datavalue="n"==a.charAt(0)?t.decodeFromSave(i[n++])-0:t.decodeFromSave(i[n++]),o.formula=t.decodeFromSave(i[n++]),o.datatype="f";break;case"vtc":a=i[n++],o.valuetype=a,o.datavalue="n"==a.charAt(0)?t.decodeFromSave(i[n++])-0:t.decodeFromSave(i[n++]),o.formula=t.decodeFromSave(i[n++]),o.datatype="c";break;case"ro":ro=t.decodeFromSave(i[n++]),o.readonly="yes"==ro.toLowerCase();break;case"e":o.errors=t.decodeFromSave(i[n++]);break;case"b":o.bt=i[n++]-0,o.br=i[n++]-0,o.bb=i[n++]-0,o.bl=i[n++]-0;break;case"l":o.layout=i[n++]-0;break;case"f":o.font=i[n++]-0;break;case"c":o.color=i[n++]-0;break;case"bg":o.bgcolor=i[n++]-0;break;case"cf":o.cellformat=i[n++]-0;break;case"ntvf":o.nontextvalueformat=i[n++]-0;break;case"tvf":o.textvalueformat=i[n++]-0;break;case"colspan":o.colspan=i[n++]-0;break;case"rowspan":o.rowspan=i[n++]-0;break;case"cssc":o.cssc=i[n++];break;case"csss":o.csss=t.decodeFromSave(i[n++]);break;case"mod":n+=1;break;case"comment":o.comment=t.decodeFromSave(i[n++]);break;default:throw t.Constants.s_cfspUnknownCellType+" '"+r+"'"}},t.sheetfields=["defaultrowheight","defaultcolwidth","circularreferencecell","recalc","needsrecalc","usermaxcol","usermaxrow"],t.sheetfieldsshort=["h","w","circularreferencecell","recalc","needsrecalc","usermaxcol","usermaxrow"],t.sheetfieldsxlat=["defaulttextformat","defaultnontextformat","defaulttextvalueformat","defaultnontextvalueformat","defaultcolor","defaultbgcolor","defaultfont","defaultlayout"],t.sheetfieldsxlatshort=["tf","ntf","tvf","ntvf","color","bgcolor","font","layout"],t.sheetfieldsxlatxlt=["cellformat","cellformat","valueformat","valueformat","color","color","font","layout"],t.CreateSheetSave=function(e,o,i){var n,r,a,s,l,c,u,d,h,p,f,m=[];e.CanonicalizeSheet(i||t.Constants.doCanonicalizeSheet);var g=e.xlt;for(f=o?t.ParseRange(o):{cr1:{row:1,col:1},cr2:{row:g.maxrow,col:g.maxcol}},r=f.cr1,a=f.cr2,m.push("version:1.5"),s=r.row;s<=a.row;s++)for(l=r.col;l<=a.col;l++)c=t.crToCoord(l,s),n=e.cells[c],n&&(u=e.CellToString(n),0!=u.length&&(u="cell:"+c+u,m.push(u)));for(l=1;l<=g.maxcol;l++)c=t.rcColname(l),e.colattribs.width[c]&&m.push("col:"+c+":w:"+e.colattribs.width[c]),e.colattribs.hide[c]&&m.push("col:"+c+":hide:"+e.colattribs.hide[c]);for(s=1;s<=g.maxrow;s++)e.rowattribs.height[s]&&m.push("row:"+s+":h:"+e.rowattribs.height[s]),e.rowattribs.hide[s]&&m.push("row:"+s+":hide:"+e.rowattribs.hide[s]);for(u="sheet:c:"+g.maxcol+":r:"+g.maxrow,h=0;h<t.sheetfields.length;h++)d=t.encodeForSave(e.attribs[t.sheetfields[h]]),d&&(u+=":"+t.sheetfieldsshort[h]+":"+d);for(h=0;h<t.sheetfieldsxlat.length;h++)d=e.attribs[t.sheetfieldsxlat[h]],d&&(u+=":"+t.sheetfieldsxlatshort[h]+":"+g[t.sheetfieldsxlatxlt[h]+"sxlat"][d]);for(m.push(u),h=1;h<g.newborderstyles.length;h++)m.push("border:"+h+":"+g.newborderstyles[h]);for(h=1;h<g.newcellformats.length;h++)m.push("cellformat:"+h+":"+t.encodeForSave(g.newcellformats[h]));for(h=1;h<g.newcolors.length;h++)m.push("color:"+h+":"+g.newcolors[h]);for(h=1;h<g.newfonts.length;h++)m.push("font:"+h+":"+g.newfonts[h]);for(h=1;h<g.newlayouts.length;h++)m.push("layout:"+h+":"+g.newlayouts[h]);for(h=1;h<g.newvalueformats.length;h++)m.push("valueformat:"+h+":"+t.encodeForSave(g.newvalueformats[h]));for(h=0;h<g.namesorder.length;h++)p=g.namesorder[h],m.push("name:"+t.encodeForSave(p).toUpperCase()+":"+t.encodeForSave(e.names[p].desc)+":"+t.encodeForSave(e.names[p].definition));return o&&m.push("copiedfrom:"+t.crToCoord(r.col,r.row)+":"+t.crToCoord(a.col,a.row)),m.push(""),delete e.xlt,m.join("\n")},t.CellToString=function(e,o){var o,i,n,r,a,s,l,c,u;return i="",o?(n=t.encodeForSave(o.datavalue),"v"==o.datatype?i+="n"==o.valuetype?":v:"+n:":vt:"+o.valuetype+":"+n:"t"==o.datatype?i+=o.valuetype==t.Constants.textdatadefaulttype?":t:"+n:":vt:"+o.valuetype+":"+n:(r=t.encodeForSave(o.formula),"f"==o.datatype?i+=":vtf:"+o.valuetype+":"+n+":"+r:"c"==o.datatype&&(i+=":vtc:"+o.valuetype+":"+n+":"+r)),o.readonly&&(i+=":ro:yes"),o.errors&&(i+=":e:"+t.encodeForSave(o.errors)),a=o.bt||"",s=o.br||"",l=o.bb||"",c=o.bl||"",e.xlt?(u=e.xlt,(a||s||l||c)&&(i+=":b:"+u.borderstylesxlat[a||0]+":"+u.borderstylesxlat[s||0]+":"+u.borderstylesxlat[l||0]+":"+u.borderstylesxlat[c||0]),o.layout&&(i+=":l:"+u.layoutsxlat[o.layout]),o.font&&(i+=":f:"+u.fontsxlat[o.font]),o.color&&(i+=":c:"+u.colorsxlat[o.color]),o.bgcolor&&(i+=":bg:"+u.colorsxlat[o.bgcolor]),o.cellformat&&(i+=":cf:"+u.cellformatsxlat[o.cellformat]),o.textvalueformat&&(i+=":tvf:"+u.valueformatsxlat[o.textvalueformat]),o.nontextvalueformat&&(i+=":ntvf:"+u.valueformatsxlat[o.nontextvalueformat])):((a||s||l||c)&&(i+=":b:"+a+":"+s+":"+l+":"+c),o.layout&&(i+=":l:"+o.layout),o.font&&(i+=":f:"+o.font),o.color&&(i+=":c:"+o.color),o.bgcolor&&(i+=":bg:"+o.bgcolor),o.cellformat&&(i+=":cf:"+o.cellformat),o.textvalueformat&&(i+=":tvf:"+o.textvalueformat),o.nontextvalueformat&&(i+=":ntvf:"+o.nontextvalueformat)),o.colspan&&(i+=":colspan:"+o.colspan),o.rowspan&&(i+=":rowspan:"+o.rowspan),o.cssc&&(i+=":cssc:"+o.cssc),o.csss&&(i+=":csss:"+t.encodeForSave(o.csss)),o.mod&&(i+=":mod:"+o.mod),o.comment&&(i+=":comment:"+t.encodeForSave(o.comment)),i):i},t.CanonicalizeSheet=function(e,o){var i,n,r,a,s,l,c,u,d,h,p,f,m,g=0,v=0,b=["borderstyle","cellformat","color","font","layout","valueformat"],y={};y.namesorder=[];for(c in e.names)y.namesorder.push(c);if(y.namesorder.sort(),!t.Constants.doCanonicalizeSheet||!o){for(l=0;l<b.length;l++){for(c=b[l],y["new"+c+"s"]=e[c+"s"],i=e[c+"s"].length,d=new Array(i),d[0]="",f=1;i>f;f++)d[f]=f;y[c+"sxlat"]=d}return y.maxrow=e.attribs.lastrow,y.maxcol=e.attribs.lastcol,void(e.xlt=y)}for(l=0;l<b.length;l++)c=b[l],y[c+"sUsed"]={};var C=y.colorsUsed,w=y.borderstylesUsed,x=y.fontsUsed,_=y.layoutsUsed,S=y.cellformatsUsed,k=y.valueformatsUsed;for(n in e.cells)r=t.coordToCr(n),a=e.cells[n],s=!1,a.valuetype&&"b"!=a.valuetype&&(s=!0),a.color&&(C[a.color]=1,s=!0),a.bgcolor&&(C[a.bgcolor]=1,s=!0),a.bt&&(w[a.bt]=1,s=!0),a.br&&(w[a.br]=1,s=!0),a.bb&&(w[a.bb]=1,s=!0),a.bl&&(w[a.bl]=1,s=!0),a.layout&&(_[a.layout]=1,s=!0),a.font&&(x[a.font]=1,s=!0),a.cellformat&&(S[a.cellformat]=1,s=!0),a.textvalueformat&&(k[a.textvalueformat]=1,s=!0),a.nontextvalueformat&&(k[a.nontextvalueformat]=1,s=!0),s&&(r.row>g&&(g=r.row),r.col>v&&(v=r.col));for(f=0;f<t.sheetfieldsxlat.length;f++)m=e.attribs[t.sheetfieldsxlat[f]],m&&(y[t.sheetfieldsxlatxlt[f]+"sUsed"][m]=1);c={height:1,hide:1};for(m in c)for(r in e.rowattribs[m])r>g&&(g=r);c={hide:1,width:1};for(m in c)for(n in e.colattribs[m])r=t.coordToCr(n+"1"),r.col>v&&(v=r.col);for(l=0;l<b.length;l++){c=b[l],u=[],h=y[c+"sUsed"];for(m in h)u.push(e[c+"s"][m]);for(u.sort(),u.unshift(""),d=[""],p=e[c+"hash"],f=1;f<u.length;f++)d[p[u[f]]]=f;y[c+"sxlat"]=d,y["new"+c+"s"]=u}y.maxrow=g||1,y.maxcol=v||1,e.xlt=y},t.EncodeCellAttributes=function(e,t){var o,i,n,r={},a=function(e){r[e]={def:!0,val:""}},s=function(e){for(var t=0;t<e.length;t++)a(e[t])},l=function(e,t){r[e].def=!1,r[e].val=t||""},c=function(e,t){"*"!=t&&(r[e].def=!1,r[e].val=t)},u=e.GetAssuredCell(t);for(a("alignhoriz"),u.cellformat&&l("alignhoriz",e.cellformats[u.cellformat]),s(["alignvert","padtop","padright","padbottom","padleft"]),u.layout&&(parts=e.layouts[u.layout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/),c("padtop",parts[1]),c("padright",parts[2]),c("padbottom",parts[3]),c("padleft",parts[4]),c("alignvert",parts[5])),s(["fontfamily","fontlook","fontsize"]),u.font&&(parts=e.fonts[u.font].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/),c("fontfamily",parts[3]),c("fontsize",parts[2]),c("fontlook",parts[1])),a("textcolor"),u.color&&l("textcolor",e.colors[u.color]),a("bgcolor"),u.bgcolor&&l("bgcolor",e.colors[u.bgcolor]),s(["numberformat","textformat"]),u.nontextvalueformat&&l("numberformat",e.valueformats[u.nontextvalueformat]),u.textvalueformat&&l("textformat",e.valueformats[u.textvalueformat]),s(["colspan","rowspan"]),l("colspan",u.colspan||1),l("rowspan",u.rowspan||1),o=0;4>o;o++)i="trbl".charAt(o),n="b"+i,a(n),l(n,u[n]?e.borderstyles[u[n]]:""),a(n+"thickness"),a(n+"style"),a(n+"color"),u[n]&&(parts=e.borderstyles[u[n]].match(/(\S+)\s+(\S+)\s+(\S.+)/),l(n+"thickness",parts[1]),l(n+"style",parts[2]),l(n+"color",parts[3]));return s(["cssc","csss","mod"]),l("cssc",u.cssc||""),l("csss",u.csss||""),l("mod",u.mod||"n"),r},t.EncodeSheetAttributes=function(e){var t,o=e.attribs,i={},n=function(e){i[e]={def:!0,val:""}},r=function(e){for(var t=0;t<e.length;t++)n(e[t])},a=function(e,o){i[e].def=!1,i[e].val=o||t},s=function(e,t){"*"!=t&&(i[e].def=!1,i[e].val=t)};return n("colwidth"),o.defaultcolwidth&&a("colwidth",o.defaultcolwidth),n("rowheight"),o.rowheight&&a("rowheight",o.defaultrowheight),n("textalignhoriz"),o.defaulttextformat&&a("textalignhoriz",e.cellformats[o.defaulttextformat]),n("numberalignhoriz"),o.defaultnontextformat&&a("numberalignhoriz",e.cellformats[o.defaultnontextformat]),r(["alignvert","padtop","padright","padbottom","padleft"]),o.defaultlayout&&(parts=e.layouts[o.defaultlayout].match(/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/),s("padtop",parts[1]),s("padright",parts[2]),s("padbottom",parts[3]),s("padleft",parts[4]),s("alignvert",parts[5])),r(["fontfamily","fontlook","fontsize"]),o.defaultfont&&(parts=e.fonts[o.defaultfont].match(/^(\*|\S+? \S+?) (\S+?) (\S.*)$/),s("fontfamily",parts[3]),s("fontsize",parts[2]),s("fontlook",parts[1])),n("textcolor"),o.defaultcolor&&a("textcolor",e.colors[o.defaultcolor]),n("bgcolor"),o.defaultbgcolor&&a("bgcolor",e.colors[o.defaultbgcolor]),r(["numberformat","textformat"]),o.defaultnontextvalueformat&&a("numberformat",e.valueformats[o.defaultnontextvalueformat]),o.defaulttextvalueformat&&a("textformat",e.valueformats[o.defaulttextvalueformat]),n("recalc"),o.recalc&&a("recalc",o.recalc),n("usermaxcol"),o.usermaxcol&&a("usermaxcol",o.usermaxcol),n("usermaxrow"),o.usermaxrow&&a("usermaxrow",o.usermaxrow),i},t.DecodeCellAttributes=function(e,t,o,n){var r,a,s,l=e.GetAssuredCell(t),c=!1,u=function(e,t,i){var n;o[e]&&(n=o[e].def?"":o[e].val,n!=(t||"")&&h(i+" "+n))},d="",h=function(e){d&&(d+="\n"),d+="set "+(n||t)+" "+e,c=!0};for(u("alignhoriz",e.cellformats[l.cellformat],"cellformat"),r=o.alignvert.def&&o.padtop.def&&o.padright.def&&o.padbottom.def&&o.padleft.def?"":"padding:"+(o.padtop.def?"* ":o.padtop.val+" ")+(o.padright.def?"* ":o.padright.val+" ")+(o.padbottom.def?"* ":o.padbottom.val+" ")+(o.padleft.def?"*":o.padleft.val)+";vertical-align:"+(o.alignvert.def?"*;":o.alignvert.val+";"),r!=(e.layouts[l.layout]||"")&&h("layout "+r),r=o.fontlook.def&&o.fontsize.def&&o.fontfamily.def?"":(o.fontlook.def?"* ":o.fontlook.val+" ")+(o.fontsize.def?"* ":o.fontsize.val+" ")+(o.fontfamily.def?"*":o.fontfamily.val),r!=(e.fonts[l.font]||"")&&h("font "+r),u("textcolor",e.colors[l.color],"color"),u("bgcolor",e.colors[l.bgcolor],"bgcolor"),u("numberformat",e.valueformats[l.nontextvalueformat],"nontextvalueformat"),u("textformat",e.valueformats[l.textvalueformat],"textvalueformat"),i=0;4>i;i++)a="trbl".charAt(i),s="b"+a,u(s,e.borderstyles[l[s]],s);return u("cssc",l.cssc,"cssc"),u("csss",l.csss,"csss"),o.mod&&(r=o.mod.def?"n":o.mod.val,r!=(l.mod||"n")&&("n"==r&&(r=""),h("mod "+r))),c?d:null},t.DecodeSheetAttributes=function(e,t){var o,i=e.attribs,n=!1,r=function(e,o,i){var n;t[e]&&(n=t[e].def?"":t[e].val,n!=(o||"")&&s(i+" "+n))},a="",s=function(e){a&&(a+="\n"),a+="set sheet "+e,n=!0};return r("colwidth",i.defaultcolwidth,"defaultcolwidth"),r("rowheight",i.defaultrowheight,"defaultrowheight"),r("textalignhoriz",e.cellformats[i.defaulttextformat],"defaulttextformat"),r("numberalignhoriz",e.cellformats[i.defaultnontextformat],"defaultnontextformat"),o=t.alignvert.def&&t.padtop.def&&t.padright.def&&t.padbottom.def&&t.padleft.def?"":"padding:"+(t.padtop.def?"* ":t.padtop.val+" ")+(t.padright.def?"* ":t.padright.val+" ")+(t.padbottom.def?"* ":t.padbottom.val+" ")+(t.padleft.def?"*":t.padleft.val)+";vertical-align:"+(t.alignvert.def?"*;":t.alignvert.val+";"),o!=(e.layouts[i.defaultlayout]||"")&&s("defaultlayout "+o),o=t.fontlook.def&&t.fontsize.def&&t.fontfamily.def?"":(t.fontlook.def?"* ":t.fontlook.val+" ")+(t.fontsize.def?"* ":t.fontsize.val+" ")+(t.fontfamily.def?"*":t.fontfamily.val),o!=(e.fonts[i.defaultfont]||"")&&s("defaultfont "+o),r("textcolor",e.colors[i.defaultcolor],"defaultcolor"),r("bgcolor",e.colors[i.defaultbgcolor],"defaultbgcolor"),r("numberformat",e.valueformats[i.defaultnontextvalueformat],"defaultnontextvalueformat"),r("textformat",e.valueformats[i.defaulttextvalueformat],"defaulttextvalueformat"),r("recalc",e.attribs.recalc,"recalc"),r("usermaxcol",e.attribs.usermaxcol,"usermaxcol"),r("usermaxrow",e.attribs.usermaxrow,"usermaxrow"),n?a:null},t.SheetCommandInfo=function(e){this.sheetobj=e,this.timerobj=null,this.firsttimerdelay=50,this.timerdelay=1,this.maxtimeslice=100,this.saveundo=!1,this.CmdExtensionCallbacks={}},t.ScheduleSheetCommands=function(o,i,n){var r=o.sci,a=new t.Parse(i);r.sheetobj.statuscallback&&o.statuscallback(r,"cmdstart","",r.sheetobj.statuscallbackparams),n&&r.sheetobj.changes.PushChange(""),r.timerobj=e.setTimeout(function(){t.SheetCommandsTimerRoutine(r,a,n)},r.firsttimerdelay)},t.SheetCommandsTimerRoutine=function(o,i,n){var r,a=new Date;for(o.timerobj=null;!i.EOF();){try{r=t.ExecuteSheetCommand(o.sheetobj,i,n)}catch(s){r=s.message}if(r&&("function"==typeof alert?alert(r):console.log(r)),i.NextLine(),new Date-a>=o.maxtimeslice)return void(o.timerobj=e.setTimeout(function(){t.SheetCommandsTimerRoutine(o,i,n)},o.timerdelay))}o.sheetobj.statuscallback&&o.sheetobj.statuscallback(o,"cmdend","",o.sheetobj.statuscallbackparams)},t.ExecuteSheetCommand=function(e,o,i){function n(o){function i(e){return"v"==e||"c"==e}var n=t.GetSpreadsheetControlObject().editor,r=n.range2,a=void 0;if(r.hasrange){var s,l;o&&r.bottom-r.top==1&&r.left==r.right?(s=e.GetAssuredCell(t.crToCoord(r.left,r.top)),l=e.GetAssuredCell(t.crToCoord(r.left,r.bottom)),i(s.datatype)&&i(l.datatype)&&(a=l.datavalue-s.datavalue)):o||r.left==r.right||(s=e.GetAssuredCell(t.crToCoord(r.left,r.top)),l=e.GetAssuredCell(t.crToCoord(r.right,r.top)),i(s.datatype)&&i(l.datatype)&&(a=l.datavalue-s.datavalue))}return n.Range2Remove(),a}var r,a,s,l,c,u,d,h,p,f,m,g,v,b,y,C,w,x,_,S,k,T,F,E,D,P,A,I,M,R,N,L,O,z,H,B,U,j,V,W,G,$,Y,K,q,X,J,Z,Q,et,tt,ot,it,nt,rt,at,st,lt,ct,ut,dt,b,y,ht,pt,ft,mt=e.attribs,gt=e.changes,vt=t.CellProperties,bt=t.Constants,yt=!1,Ct=function(){var e=t.ParseRange(l);g=e.cr1,v=e.cr2,v.col>mt.lastcol&&(mt.lastcol=v.col),v.row>mt.lastrow&&(mt.lastrow=v.row)};switch(p="",r=o.RestOfStringNoMove(),i&&e.changes.AddDo(r),a=o.NextToken()){case"set":if(l=o.NextToken(),c=o.NextToken(),s=o.RestOfString(),f="set "+l+" "+c,"sheet"==l)switch(e.renderneeded=!0,c){case"defaultcolwidth":i&&gt.AddUndo(f,mt[c]),mt[c]=s;break;case"defaultcolor":case"defaultbgcolor":i&&gt.AddUndo(f,e.GetStyleString("color",mt[c])),mt[c]=e.GetStyleNum("color",s);break;case"defaultlayout":i&&gt.AddUndo(f,e.GetStyleString("layout",mt[c])),mt[c]=e.GetStyleNum("layout",s);break;case"defaultfont":i&&gt.AddUndo(f,e.GetStyleString("font",mt[c])),"* * *"==s&&(s=""),mt[c]=e.GetStyleNum("font",s);break;case"defaulttextformat":case"defaultnontextformat":i&&gt.AddUndo(f,e.GetStyleString("cellformat",mt[c])),mt[c]=e.GetStyleNum("cellformat",s);break;case"defaulttextvalueformat":case"defaultnontextvalueformat":i&&gt.AddUndo(f,e.GetStyleString("valueformat",mt[c])),mt[c]=e.GetStyleNum("valueformat",s);for(C in e.cells)delete e.cells[C].displaystring;break;case"lastcol":case"lastrow":i&&gt.AddUndo(f,mt[c]-0),u=s-0,"number"==typeof u&&(mt[c]=u>0?u:1);break;case"recalc":i&&gt.AddUndo(f,mt[c]),"off"==s?mt.recalc=s:delete mt.recalc;break;case"usermaxcol":case"usermaxrow":i&&gt.AddUndo(f,mt[c]-0),u=s-0,"number"==typeof u&&(mt[c]=u>0?u:0);break;default:p=bt.s_escUnknownSheetCmd+r}else if(/^[a-z]{1,2}(:[a-z]{1,2})?$/i.test(l))for(e.renderneeded=!0,l=l.toUpperCase(),d=l.indexOf(":"),d>=0?(g=t.coordToCr(l.substring(0,d)+"1"),v=t.coordToCr(l.substring(d+1)+"1")):(g=t.coordToCr(l+"1"),v=g),b=g.col;b<=v.col;b++)"width"==c?(C=t.rcColname(b),i&&gt.AddUndo("set "+C+" width",e.colattribs.width[C]),s.length>0?e.colattribs.width[C]=s:delete e.colattribs.width[C]):"hide"==c&&(e.hiddencolrow="col",C=t.rcColname(b),i&&gt.AddUndo("set "+C+" hide",e.colattribs.hide[C]),s.length>0?e.colattribs.hide[C]=s:delete e.colattribs.hide[C]);else if(/^\d+(:\d+)?$/i.test(l))for(e.renderneeded=!0,l=l.toUpperCase(),d=l.indexOf(":"),d>=0?(g=t.coordToCr("A"+l.substring(0,d)),v=t.coordToCr("A"+l.substring(d+1))):(g=t.coordToCr("A"+l),v=g),y=g.row;y<=v.row;y++)"height"==c?(i&&gt.AddUndo("set "+y+" height",e.rowattribs.height[y]),s.length>0?e.rowattribs.height[y]=s:delete e.rowattribs.height[y]):"hide"==c&&(e.hiddencolrow="row",i&&gt.AddUndo("set "+y+" hide",e.rowattribs.hide[y]),s.length>0?e.rowattribs.hide[y]=s:delete e.rowattribs.hide[y]);else if(/^[a-z]{1,2}\d+(:[a-z]{1,2}\d+)?$/i.test(l))for(yt=!0,Ct(),g.row!=v.row||g.col!=v.col||e.celldisplayneeded||e.renderneeded?(e.renderneeded=!0,e.celldisplayneeded=""):e.celldisplayneeded=t.crToCoord(g.col,g.row),y=g.row;y<=v.row;y++)for(b=g.col;b<=v.col;b++)C=t.crToCoord(b,y),w=e.GetAssuredCell(C),w.readonly&&"readonly"!=c||(i&&gt.AddUndo("set "+C+" all",e.CellToString(w)),"value"==c?(d=s.indexOf(" "),w.datavalue=s.substring(d+1)-0,delete w.errors,w.datatype="v",w.valuetype=s.substring(0,d),delete w.displaystring,delete w.parseinfo,mt.needsrecalc="yes"):"text"==c?(d=s.indexOf(" "),w.datavalue=t.decodeFromSave(s.substring(d+1)),delete w.errors,w.datatype="t",w.valuetype=s.substring(0,d),delete w.displaystring,delete w.parseinfo,mt.needsrecalc="yes"):"formula"==c?(w.datavalue=0,delete w.errors,w.datatype="f",t._app&&"e#N/A"!=w.valuetype&&(w.prevvaluetype=w.valuetype),w.valuetype="e#N/A",w.formula=s,delete w.displaystring,delete w.parseinfo,mt.needsrecalc="yes"):"constant"==c?(d=s.indexOf(" "),h=s.substring(d+1).indexOf(" "),w.datavalue=s.substring(d+1,d+1+h)-0,w.valuetype=s.substring(0,d),"e"==w.valuetype.charAt(0)?w.errors=w.valuetype.substring(1):delete w.errors,w.datatype="c",w.formula=s.substring(d+h+2),delete w.displaystring,delete w.parseinfo,mt.needsrecalc="yes"):"empty"==c?(w.datavalue="",delete w.errors,w.datatype=null,w.formula="",w.valuetype="b",delete w.displaystring,delete w.parseinfo,mt.needsrecalc="yes"):"all"==c?(s.length>0?(w=new t.Cell(C),e.CellFromStringParts(w,s.split(":"),1),e.cells[C]=w):delete e.cells[C],mt.needsrecalc="yes"):/^b[trbl]$/.test(c)?(w[c]=e.GetStyleNum("borderstyle",s),e.renderneeded=!0):"color"==c||"bgcolor"==c?w[c]=e.GetStyleNum("color",s):"layout"==c||"cellformat"==c?w[c]=e.GetStyleNum(c,s):"font"==c?("* * *"==s&&(s=""),w[c]=e.GetStyleNum("font",s)):"textvalueformat"==c||"nontextvalueformat"==c?(w[c]=e.GetStyleNum("valueformat",s),delete w.displaystring):"cssc"==c?(s=s.replace(/[^a-zA-Z0-9\-]/g,""),w.cssc=s):"csss"==c?(s=s.replace(/\n/g,""),w.csss=s):"mod"==c?(s=s.replace(/[^yY]/g,"").toLowerCase(),w.mod=s):"comment"==c?w.comment=t.decodeFromSave(s):"readonly"==c?w.readonly="yes"==s.toLowerCase():p=bt.s_escUnknownSetCoordCmd+r);break;case"merge":if(e.renderneeded=!0,l=o.NextToken(),s=o.RestOfString(),Ct(),w=e.GetAssuredCell(g.coord),w.readonly)break;for(y=g.row;y<=v.row;y++)for(b=g.col;b<=v.col;b++)(y!=g.row||b!=g.col)&&(quashedCellCoord=t.crToCoord(b,y),quashedCell=e.GetAssuredCell(quashedCellCoord),i&&gt.AddUndo("set "+quashedCellCoord+" all",e.CellToString(quashedCell)),delete e.cells[quashedCellCoord]);i&&gt.AddUndo("unmerge "+g.coord),v.col>g.col?w.colspan=v.col-g.col+1:delete w.colspan,v.row>g.row?w.rowspan=v.row-g.row+1:delete w.rowspan,e.changedrendervalues=!0;break;case"unmerge":if(e.renderneeded=!0,l=o.NextToken(),s=o.RestOfString(),Ct(),w=e.GetAssuredCell(g.coord),w.readonly)break;i&&gt.AddUndo("merge "+g.coord+":"+t.crToCoord(g.col+(w.colspan||1)-1,g.row+(w.rowspan||1)-1)),delete w.colspan,delete w.rowspan,e.changedrendervalues=!0;break;case"erase":case"cut":for(e.renderneeded=!0,e.changedrendervalues=!0,l=o.NextToken(),s=o.RestOfString(),Ct(),i&&gt.AddUndo("changedrendervalues"),"cut"==a&&(i&&gt.AddUndo("loadclipboard",t.encodeForSave(t.Clipboard.clipboard)),t.Clipboard.clipboard=t.CreateSheetSave(e,l)),y=g.row;y<=v.row;y++)for(b=g.col;b<=v.col;b++)C=t.crToCoord(b,y),w=e.GetAssuredCell(C),w.readonly||(i&&gt.AddUndo("set "+C+" all",e.CellToString(w)),"all"==s?delete e.cells[C]:"formulas"==s?(w.datavalue="",w.datatype=null,w.formula="",w.valuetype="b",delete w.errors,delete w.displaystring,delete w.parseinfo,w.comment&&delete w.comment):"formats"==s&&(x=new t.Cell(C),x.datavalue=w.datavalue,x.datatype=w.datatype,x.formula=w.formula,x.valuetype=w.valuetype,w.comment&&(x.comment=w.comment),e.cells[C]=x));mt.needsrecalc="yes";break;case"fillright":case"filldown":e.renderneeded=!0,e.changedrendervalues=!0,i&&gt.AddUndo("changedrendervalues"),l=o.NextToken(),s=o.RestOfString(),Ct();var wt;for("fillright"==a?(_=!0,S=g.row,k=g.col+1,wt=n(!1)):(_=!1,S=g.row+1,k=g.col,wt=n(!0)),y=S;y<=v.row;y++)for(b=k;b<=v.col;b++)if(C=t.crToCoord(b,y),w=e.GetAssuredCell(C),!w.readonly){if(i&&gt.AddUndo("set "+C+" all",e.CellToString(w)),_?(T=t.crToCoord(g.col,y),E=b-k+1,F=0):(T=t.crToCoord(b,g.row),E=0,F=y-S+1),D=e.GetAssuredCell(T),"all"==s||"formats"==s)for(c in vt)1!=vt[c]&&(void 0===typeof D[c]||3==vt[c]?delete w[c]:w[c]=D[c]);("all"==s||"formulas"==s)&&(w.datavalue=void 0!==wt?D.datavalue+(_?E:F)*wt:D.datavalue,w.datatype=D.datatype,w.valuetype=D.valuetype,w.formula="f"==w.datatype?t.OffsetFormulaCoords(D.formula,E,F):D.formula,delete w.parseinfo,w.errors=D.errors),delete w.displaystring}mt.needsrecalc="yes";break;case"copy":l=o.NextToken(),s=o.RestOfString(),i&&gt.AddUndo("loadclipboard",t.encodeForSave(t.Clipboard.clipboard)),t.Clipboard.clipboard=t.CreateSheetSave(e,l);break;case"loadclipboard":s=o.RestOfString(),i&&gt.AddUndo("loadclipboard",t.encodeForSave(t.Clipboard.clipboard)),t.Clipboard.clipboard=t.decodeFromSave(s);break;case"clearclipboard":i&&gt.AddUndo("loadclipboard",t.encodeForSave(t.Clipboard.clipboard)),t.Clipboard.clipboard="";break;case"paste":if(e.renderneeded=!0,e.changedrendervalues=!0,i&&gt.AddUndo("changedrendervalues"),l=o.NextToken(),s=o.RestOfString(),Ct(),!t.Clipboard.clipboard)break;for(P=new t.Sheet,P.ParseSheetSave(t.Clipboard.clipboard),A=t.ParseRange(P.copiedfrom),I=Math.max(v.col-g.col+1,A.cr2.col-A.cr1.col+1),M=Math.max(v.row-g.row+1,A.cr2.row-A.cr1.row+1),g.col+I-1>mt.lastcol&&(mt.lastcol=g.col+I-1),g.row+M-1>mt.lastrow&&(mt.lastrow=g.row+M-1),y=g.row;y<g.row+M;y++)for(b=g.col;b<g.col+I;b++)if(C=t.crToCoord(b,y),w=e.GetAssuredCell(C),!w.readonly){i&&gt.AddUndo("set "+C+" all",e.CellToString(w));var xt=A.cr1.col+(b-g.col)%(A.cr2.col-A.cr1.col+1),_t=A.cr1.row+(y-g.row)%(A.cr2.row-A.cr1.row+1);if(T=t.crToCoord(xt,_t),D=P.GetAssuredCell(T),"all"==s||"formats"==s){y==g.row&&(sourceColname=t.rcColname(A.cr1.col+(b-g.col)%(A.cr2.col-A.cr1.col+1)),colWidth=P.colattribs.width[sourceColname],colHide=P.colattribs.hide[sourceColname],null!=colWidth&&(e.colattribs.width[t.rcColname(b)]=colWidth),null!=colHide&&(e.colattribs.hide[t.rcColname(b)]=colHide)),b==g.col&&(sourceRow=A.cr1.row+(y-g.row)%(A.cr2.row-A.cr1.row+1),rowHide=P.rowattribs.hide[sourceRow],null!=rowHide&&(e.rowattribs.hide[y]=rowHide));for(c in vt)1!=vt[c]&&(void 0===typeof D[c]||3==vt[c]?delete w[c]:(R=t.CellPropertiesTable[c],w[c]=R&&D[c]?e.GetStyleNum(R,P.GetStyleString(R,D[c])):D[c]))}("all"==s||"formulas"==s)&&(w.datavalue=D.datavalue,w.datatype=D.datatype,w.valuetype=D.valuetype,w.formula="f"==w.datatype?t.OffsetFormulaCoords(D.formula,b-xt,y-_t):D.formula,delete w.parseinfo,w.errors=D.errors,D.comment?w.comment=D.comment:w.comment&&delete w.comment),delete w.displaystring}mt.needsrecalc="yes";break;case"sort":for(e.renderneeded=!0,e.changedrendervalues=!0,i&&gt.AddUndo("changedrendervalues"),l=o.NextToken(),Ct(),X=[],J=[],Z=0,Q=0;3>=Q;Q++)X[Q]=o.NextToken(),J[Q]=o.NextToken(),X[Q]&&(Z=Q);for(tt={},et=[],ot=[],it=[],y=g.row;y<=v.row;y++){for(b=g.col;b<=v.col;b++)C=t.crToCoord(b,y),w=e.cells[C],w?(tt[C]=e.CellToString(w),i&&gt.AddUndo("set "+C+" all",tt[C])):i&&gt.AddUndo("set "+C+" all");for(et.push(et.length),ot.push([]),it.push([]),slast=it.length-1,Q=0;Z>=Q;Q++)C=X[Q]+y,w=e.GetAssuredCell(C),m=w.datavalue,rt=w.valuetype.charAt(0)||"b","t"==rt&&(m=m.toLowerCase()),ot[slast].push(m),it[slast].push(rt)}for(nt=function(e,t){var o,i,n,r,a;for(o=0;Z>=o;o++)if("up"==J[o]?(i=e,n=t):(i=t,n=e),r=it[i][o],tb=it[n][o],"t"==r?"t"==tb?(i=ot[i][o],n=ot[n][o],a=i>n?1:n>i?-1:0):"n"==tb?a=1:"b"==tb?a="up"==J[o]?-1:1:"e"==tb&&(a=-1):"n"==r?"t"==tb?a=-1:"n"==tb?(i=ot[i][o]-0,n=ot[n][o]-0,a=i>n?1:n>i?-1:0):"b"==tb?a="up"==J[o]?-1:1:"e"==tb&&(a=-1):"e"==r?"e"==tb?(i=ot[i][o],n=ot[n][o],a=i>n?1:n>i?-1:0):a="b"==tb&&"up"==J[o]?-1:1:"b"==r&&(a="b"==tb?0:"up"==J[o]?1:-1),a)return a;return a=e>t?1:t>e?-1:0},et.sort(nt),y=g.row;y<=v.row;y++)for(at=et[y-g.row],b=g.col;b<=v.col;b++)C=t.crToCoord(b,y),st=t.crToCoord(b,at+g.row),tt[st]?(w=new t.Cell(C),e.CellFromStringParts(w,tt[st].split(":"),1),"f"==w.datatype&&(w.formula=t.OffsetFormulaCoords(w.formula,0,y-g.row-at)),e.cells[C]=w):delete e.cells[C];mt.needsrecalc="yes";break;case"insertcol":case"insertrow":for(e.renderneeded=!0,e.changedrendervalues=!0,e.widgetsClean=!1,l=o.NextToken(),s=o.RestOfString(),Ct(),"insertcol"==a?(E=1,N=g.col,F=0,L=1,O=g.col,H=g.col,z=1,B=mt.lastrow,i&&gt.AddUndo("deletecol "+g.coord)):(E=0,N=1,F=1,L=g.row,O=1,H=mt.lastcol,z=g.row,B=g.row,i&&gt.AddUndo("deleterow "+g.coord)),y=mt.lastrow;y>=L;y--)for(b=mt.lastcol;b>=N;b--)T=t.crToCoord(b,y),C=t.crToCoord(b+E,y+F),e.cells[T]?e.cells[C]=e.cells[T]:delete e.cells[C];
for(y=z;B>=y;y++)for(b=O;H>=b;b++){C=t.crToCoord(b,y),w=new t.Cell(C),e.cells[C]=w,T=t.crToCoord(b-E,y-F),D=e.GetAssuredCell(T);for(c in vt)2==vt[c]&&(w[c]=D[c])}for(C in e.cells)w=e.cells[C],w&&"f"==w.datatype&&(w.formula=t.AdjustFormulaCoords(w.formula,g.col,E,g.row,F)),w&&delete w.parseinfo;for(lt in e.names)e.names[lt]&&(ct=e.names[lt].definition,ut="","="==ct.charAt(0)&&(ut="=",ct=ct.substring(1)),e.names[lt].definition=ut+t.AdjustFormulaCoords(ct,g.col,E,g.row,F));for(y=mt.lastrow;y>=L&&"insertrow"==a;y--){U=y+F;for(c in e.rowattribs)m=e.rowattribs[c][y],e.rowattribs[c][U]!=m&&(m?e.rowattribs[c][U]=m:delete e.rowattribs[c][U])}for(b=mt.lastcol;b>=N&&"insertcol"==a;b--){V=t.rcColname(b),j=t.rcColname(b+E);for(c in e.colattribs)m=e.colattribs[c][V],e.colattribs[c][j]!=m&&(m?e.colattribs[c][j]=m:delete e.colattribs[c][j])}var St=new t.RenderContext(e);St.CalculateCellSkipData();var kt={};for(var Tt in St.cellskip){var Ft=t.coordToCr(Tt),Et=St.cellskip[Tt];"insertcol"===a&&Ft.col===O&&(kt[Et]||(e.GetAssuredCell(Et).colspan+=E),kt[Et]=!0),"insertrow"===a&&Ft.row===z&&(kt[Et]||(e.GetAssuredCell(Et).rowspan+=F),kt[Et]=!0)}mt.lastcol+=E,mt.lastrow+=F,mt.needsrecalc="yes";break;case"deletecol":case"deleterow":for(e.renderneeded=!0,e.changedrendervalues=!0,e.widgetsClean=!1,l=o.NextToken(),s=o.RestOfString(),G=mt.lastcol,W=mt.lastrow,Ct(),"deletecol"==a?(E=g.col-v.col-1,F=0,k=v.col+1,S=1):(E=0,F=g.row-v.row-1,k=1,S=v.row+1),y=S;W-F>=y;y++)for(b=k;G-E>=b;b++)if(C=t.crToCoord(b+E,y+F),w=e.cells[C],w&&w.readonly)return p="Unable to remove "+("deletecol"==a?"column":"row")+", because cell "+w.coord+" is locked";for(y=S;W-F>=y;y++)for(b=k;G-E>=b;b++)C=t.crToCoord(b+E,y+F),i&&(S-F>y||k-E>b)&&(w=e.cells[C],w?gt.AddUndo("set "+C+" all",e.CellToString(w)):gt.AddUndo("erase "+C+" all")),T=t.crToCoord(b,y),w=e.cells[T],w?e.cells[C]=w:delete e.cells[C];for(C in e.cells)w=e.cells[C],w&&("f"==w.datatype?(K=w.formula,w.formula=t.AdjustFormulaCoords(K,g.col,E,g.row,F),w.formula!=K&&(delete w.parseinfo,i&&-1!=w.formula.indexOf("#REF!")&&(q=t.coordToCr(C),gt.AddUndo("set "+t.rcColname(q.col-E)+(q.row-F)+" formula "+K)))):delete w.parseinfo);for(lt in e.names)e.names[lt]&&(ct=e.names[lt].definition,ut="","="==ct.charAt(0)&&(ut="=",ct=ct.substring(1)),e.names[lt].definition=ut+t.AdjustFormulaCoords(ct,g.col,E,g.row,F));for(y=S;W-F>=y&&"deleterow"==a;y++){$=y+F;for(c in e.rowattribs)m=e.rowattribs[c][y],e.rowattribs[c][$]!=m&&(i&&gt.AddUndo("set "+$+" "+c,e.rowattribs[c][$]),m?e.rowattribs[c][$]=m:delete e.rowattribs[c][$])}for(b=k;G-E>=b&&"deletecol"==a;b++){V=t.rcColname(b),Y=t.rcColname(b+E);for(c in e.colattribs)m=e.colattribs[c][V],e.colattribs[c][Y]!=m&&(i&&gt.AddUndo("set "+Y+" "+c,e.colattribs[c][Y]),m?e.colattribs[c][Y]=m:delete e.colattribs[c][Y])}var St=new t.RenderContext(e);St.CalculateCellSkipData();var Dt={};for(var Tt in St.cellskip){var Ft=t.coordToCr(Tt),Et=St.cellskip[Tt],Pt=St.coordToCR[Et];"deletecol"===a&&Ft.col===k+E&&Pt.col<Ft.col&&(Dt[Et]||(e.GetAssuredCell(Et).colspan+=E),Dt[Et]=!0),"deleterow"===a&&Ft.row===S+F&&Pt.row<Ft.row&&(Dt[Et]||(e.GetAssuredCell(Et).rowspan+=F),Dt[Et]=!0)}if(i)if("deletecol"==a)for(b=g.col;b<=v.col;b++)gt.AddUndo("insertcol "+t.rcColname(g.col));else for(y=g.row;y<=v.row;y++)gt.AddUndo("insertrow "+g.row);"deletecol"==a?g.col<=G&&(v.col<=G?mt.lastcol+=E:mt.lastcol=g.col-1):g.row<=W&&(v.row<=W?mt.lastrow+=F:mt.lastrow=g.row-1),mt.needsrecalc="yes";break;case"movepaste":case"moveinsert":var At,It,Mt,Rt,Nt,Lt,Ot;for(e.renderneeded=!0,e.changedrendervalues=!0,i&&gt.AddUndo("changedrendervalues"),l=o.NextToken(),It=o.NextToken(),s=o.RestOfString(),""==s&&(s="all"),Ct(),Mt=t.coordToCr(It),E=Mt.col-g.col,F=Mt.row-g.row,I=v.col-g.col+1,M=v.row-g.row+1,At={},y=g.row;y<=v.row;y++)for(b=g.col;b<=v.col;b++)if(C=t.crToCoord(b,y),w=e.GetAssuredCell(C),!w.readonly&&(i&&gt.AddUndo("set "+C+" all",e.CellToString(w)),e.cells[C])){At[C]=new t.Cell(C);for(c in vt)void 0!==typeof w[c]&&(At[C][c]=w[c],"all"==s&&delete w[c],"formulas"==s&&(1==vt[c]||3==vt[c])&&delete w[c],"formats"==s&&2==vt[c]&&delete w[c]);"formulas"==s&&(w.datavalue="",w.datatype=null,w.formula="",w.valuetype="b"),"all"==s&&delete e.cells[C]}if("moveinsert"==a&&(Rt=!1,Nt=!1,0==F&&(Mt.col<g.col||Mt.col>v.col)?Mt.col<g.col?(Lt=g.col-Mt.col,Rt=-1):(Mt.col-=1,E=Mt.col-v.col,Lt=Mt.col-v.col,Rt=1):0==E&&(Mt.row<g.row||Mt.row>v.row)?Mt.row<g.row?(Lt=g.row-Mt.row,Nt=-1):(Mt.row-=1,F=Mt.row-v.row,Lt=Mt.row-v.row,Nt=1):a="movepaste"),Ot={},Nt)for(y=0;Lt>y;y++)for(b=g.col;b<=v.col;b++){if(0>Nt?(T=t.crToCoord(b,Mt.row+Lt-y-1),C=t.crToCoord(b,v.row-y)):(T=t.crToCoord(b,Mt.row-Lt+y+1),C=t.crToCoord(b,g.row+y)),D=e.GetAssuredCell(T),i&&gt.AddUndo("set "+T+" all",e.CellToString(D)),w=e.GetAssuredCell(C),"all"==s||"formats"==s)for(c in vt)1!=vt[c]&&(void 0===typeof D[c]||3==vt[c]?delete w[c]:w[c]=D[c]);("all"==s||"formulas"==s)&&(w.datavalue=D.datavalue,w.datatype=D.datatype,w.valuetype=D.valuetype,w.formula=D.formula,delete w.parseinfo,w.errors=D.errors),delete w.displaystring,Ot[T]=C}if(Rt)for(b=0;Lt>b;b++)for(y=g.row;y<=v.row;y++){if(0>Rt?(T=t.crToCoord(Mt.col+Lt-b-1,y),C=t.crToCoord(v.col-b,y)):(T=t.crToCoord(Mt.col-Lt+b+1,y),C=t.crToCoord(g.col+b,y)),D=e.GetAssuredCell(T),i&&gt.AddUndo("set "+T+" all",e.CellToString(D)),w=e.GetAssuredCell(C),"all"==s||"formats"==s)for(c in vt)1!=vt[c]&&(void 0===typeof D[c]||3==vt[c]?delete w[c]:w[c]=D[c]);("all"==s||"formulas"==s)&&(w.datavalue=D.datavalue,w.datatype=D.datatype,w.valuetype=D.valuetype,w.formula=D.formula,delete w.parseinfo,w.errors=D.errors),delete w.displaystring,Ot[T]=C}for(Mt.col+I-1>mt.lastcol&&(mt.lastcol=Mt.col+I-1),Mt.row+M-1>mt.lastrow&&(mt.lastrow=Mt.row+M-1),y=g.row;y<g.row+M;y++)for(b=g.col;b<g.col+I;b++)if(C=t.crToCoord(b+E,y+F),w=e.GetAssuredCell(C),!w.readonly)if(i&&gt.AddUndo("set "+C+" all",e.CellToString(w)),T=t.crToCoord(b,y),Ot[T]=C,"all"!=s||At[T]){if(D=At[T],D||(D=e.GetAssuredCell(T)),"all"==s||"formats"==s)for(c in vt)1!=vt[c]&&(void 0===typeof D[c]||3==vt[c]?delete w[c]:w[c]=D[c]);("all"==s||"formulas"==s)&&(w.datavalue=D.datavalue,w.datatype=D.datatype,w.valuetype=D.valuetype,w.formula=D.formula,delete w.parseinfo,w.errors=D.errors,D.comment?w.comment=D.comment:w.comment&&delete w.comment),delete w.displaystring}else delete e.cells[C];for(C in e.cells)w=e.cells[C],w&&("f"==w.datatype?(K=w.formula,w.formula=t.ReplaceFormulaCoords(K,Ot),w.formula!=K&&(delete w.parseinfo,i&&!Ot[C]&&gt.AddUndo("set "+C+" formula "+K))):delete w.parseinfo);for(lt in e.names)e.names[lt]&&(ct=e.names[lt].definition,K=ct,ut="","="==ct.charAt(0)&&(ut="=",ct=ct.substring(1)),e.names[lt].definition=ut+t.ReplaceFormulaCoords(ct,Ot),i&&e.names[lt].definition!=K&&gt.AddUndo("name define "+lt+" "+K));mt.needsrecalc="yes";break;case"name":if(l=o.NextToken(),lt=o.NextToken(),s=o.RestOfString(),lt=lt.toUpperCase().replace(/[^A-Z0-9_\.]/g,""),""==lt)break;if("define"==l){if(""==s)break;e.names[lt]?(i&&gt.AddUndo("name define "+lt+" "+e.names[lt].definition),e.names[lt].definition=s):(i&&gt.AddUndo("name delete "+lt),e.names[lt]={definition:s,desc:""})}else"desc"==l?e.names[lt]&&(i&&gt.AddUndo("name desc "+lt+" "+e.names[lt].desc),e.names[lt].desc=s):"delete"==l&&(i&&(e.names[lt].desc&&gt.AddUndo("name desc "+lt+" "+e.names[lt].desc),gt.AddUndo("name define "+lt+" "+e.names[lt].definition)),delete e.names[lt]);mt.needsrecalc="yes";break;case"recalc":mt.needsrecalc="yes",e.recalconce=!0;break;case"redisplay":e.renderneeded=!0;break;case"changedrendervalues":e.changedrendervalues=!0;break;case"pane":if(lt=o.NextToken().toUpperCase(),pt=1,ht=t.GetSpreadsheetControlObject().editor,"ROW"===lt.toUpperCase()){for(y=parseInt(o.NextToken(),10),"undefined"!=typeof ht.context.rowpanes[1]&&"number"==typeof ht.context.rowpanes[1].first&&(pt=ht.context.rowpanes[1].first),i&&gt.AddUndo("pane row "+pt);"yes"==ht.context.sheetobj.rowattribs.hide[y];)y++;(!y||y<=ht.context.rowpanes[0].first)&&ht.context.rowpanes.length>1?ht.context.rowpanes.length=1:ht.context.rowpanes.length-1&&!ht.timeout?(ht.context.SetRowPaneFirstLast(0,ht.context.rowpanes[0].first,y-1),ht.context.SetRowPaneFirstLast(1,y,y)):(ht.context.SetRowPaneFirstLast(0,ht.context.rowpanes[0].first,y-1),ht.context.SetRowPaneFirstLast(1,y,y)),ht.griddiv&&(ft=document.getElementById("trackingline-vertical"),ft&&(ht.griddiv.removeChild(ft),ht.FitToEditTable()))}else{for(b=parseInt(o.NextToken(),10),"undefined"!=typeof ht.context.colpanes[1]&&"number"==typeof ht.context.colpanes[1].first&&(pt=ht.context.colpanes[1].first),i&&gt.AddUndo("pane col "+pt);"yes"==ht.context.sheetobj.colattribs.hide[t.rcColname(b)];)b++;(!b||b<=ht.context.colpanes[0].first)&&ht.context.colpanes.length>1?ht.context.colpanes.length=1:ht.context.colpanes.length-1&&!ht.timeout?(ht.context.SetColPaneFirstLast(0,ht.context.colpanes[0].first,b-1),ht.context.SetColPaneFirstLast(1,b,b)):(ht.context.SetColPaneFirstLast(0,ht.context.colpanes[0].first,b-1),ht.context.SetColPaneFirstLast(1,b,b)),ht.griddiv&&(ft=document.getElementById("trackingline-horizon"),ft&&(ht.griddiv.removeChild(ft),ht.FitToEditTable()))}e.renderneeded=!0;break;case"startcmdextension":lt=o.NextToken(),dt=e.sci.CmdExtensionCallbacks[lt],dt&&dt.func(lt,dt.data,e,o,i);break;case"settimetrigger":case"sendemail":case"submitform":break;default:p=bt.s_escUnknownCmd+r}return t._app&&(yt?1==e.renderneeded&&"value"!=c&&"text"!=c&&"formula"!=c&&"constant"!=c&&"empty"!=c?e.widgetsClean=!1:"all"==c&&(e.widgetsClean=!1):1==e.renderneeded&&(e.widgetsClean=!1)),p},t.SheetUndo=function(e){var t,o=e.changes.TOS(),i=o?o.undo.length-1:-1,n="";for(t=i;t>=0;t--)n&&(n+="\n"),n+=o.undo[t];e.changes.Undo(),e.ScheduleSheetCommands(n,!1)},t.SheetRedo=function(e){var t,o,i=e.changes.Redo();if(!i)return void e.ScheduleSheetCommands("",!1);t=e.changes.TOS();var n="";for(o=0;t&&o<t.command.length;o++)n&&(n+="\n"),n+=t.command[o];e.ScheduleSheetCommands(n,!1)},t.CreateAuditString=function(e){var t,o,i="",n=e.changes.stack,r=e.changes.tos;for(t=0;r>=t;t++)for(o=0;o<n[t].command.length;o++)i+=n[t].command[o]+"\n";return i},t.GetStyleNum=function(e,t,o){var i;return 0==o.length?0:(i=e[t+"hash"][o],i||(e[t+"s"].length<1&&e[t+"s"].push(""),i=e[t+"s"].push(o)-1,e[t+"hash"][o]=i,e.changedrendervalues=!0),i)},t.GetStyleString=function(e,t,o){return o?e[t+"s"][o]:null},t.OffsetFormulaCoords=function(e,o,i){var n,r,a,s,l,c,u="",d=t.Formula;if(!d)return"Need SocialCalc.Formula";var h=d.TokenType,p=h.op,f=h.string,m=h.coord,g=d.TokenOpExpansion;for(n=d.ParseFormulaIntoTokens(e),s=0;s<n.length;s++)a=n[s].type,r=n[s].text,a==m?(c="",l=t.coordToCr(r),"$"!=r.charAt(0)?l.col+=o:c+="$",c+=t.rcColname(l.col),-1==r.indexOf("$",1)?l.row+=i:c+="$",c+=l.row,(l.row<1||l.col<1)&&(c="#REF!"),u+=c):u+=a==f?r.indexOf('"')>=0?'"'+r.replace(/"/,'""')+'"':'"'+r+'"':a==p?g[r]||r:r;return u},t.AdjustFormulaCoords=function(e,o,i,n,r){var a,s,l,c,u="",d=!1,h=t.Formula;if(!h)return"Need SocialCalc.Formula";var p=h.TokenType,f=p.op,m=p.string,g=p.coord,v=h.TokenOpExpansion;for(parseinfo=t.Formula.ParseFormulaIntoTokens(e),l=0;l<parseinfo.length;l++)a=parseinfo[l].type,s=parseinfo[l].text,a==f&&("!"==s?d=!0:":"!=s&&(d=!1),s=v[s]||s),a==g?(cr=t.coordToCr(s),(0>i&&cr.col>=o&&cr.col<o-i||0>r&&cr.row>=n&&cr.row<n-r)&&(d||(cr.col=0,cr.row=0)),d||(cr.col>=o&&(cr.col+=i),cr.row>=n&&(cr.row+=r)),c="$"==s.charAt(0)?"$"+t.rcColname(cr.col):t.rcColname(cr.col),c+=-1!=s.indexOf("$",1)?"$"+cr.row:cr.row,(cr.row<1||cr.col<1)&&(c="#REF!"),s=c):a==m&&(s=s.indexOf('"')>=0?'"'+s.replace(/"/,'""')+'"':'"'+s+'"'),u+=s;return u},t.ReplaceFormulaCoords=function(e,o){var i,n,r,a,s,l="",c=!1,u=t.Formula;if(!u)return"Need SocialCalc.Formula";var d=u.TokenType,h=d.op,p=d.string,f=d.coord,m=u.TokenOpExpansion;for(parseinfo=t.Formula.ParseFormulaIntoTokens(e),r=0;r<parseinfo.length;r++)i=parseinfo[r].type,n=parseinfo[r].text,i==h&&("!"==n?c=!0:":"!=n&&(c=!1),n=m[n]||n),i==f?(cr=t.coordToCr(n),s=t.crToCoord(cr.col,cr.row),o[s]&&!c&&(cr=t.coordToCr(o[s]),a="$"==n.charAt(0)?"$"+t.rcColname(cr.col):t.rcColname(cr.col),a+=-1!=n.indexOf("$",1)?"$"+cr.row:cr.row,n=a)):i==p&&(n=n.indexOf('"')>=0?'"'+n.replace(/"/,'""')+'"':'"'+n+'"'),l+=n;return l},t.RecalcInfo={sheet:null,currentState:0,state:{idle:0,start_calc:1,order:2,calc:3,start_wait:4,done_wait:5},recalctimer:null,maxtimeslice:100,timeslicedelay:1,starttime:0,queue:[],LoadSheet:function(){return!1}},t.RecalcData=function(){this.inrecalc=!0,this.celllist=[],this.celllistitem=0,this.calclist=null,this.calclistlength=0,this.firstcalc=null,this.lastcalc=null,this.nextcalc=null,this.count=0,this.checkinfo={}},t.RecalcCheckInfo=function(){this.oldcoord=null,this.parsepos=0,this.inrange=!1,this.inrangestart=!1,this.cr1=null,this.cr2=null,this.c1=null,this.c2=null,this.r1=null,this.r2=null,this.c=null,this.r=null},t.RecalcSheet=function(e){var o=t.RecalcInfo;return o.currentState!=o.state.idle?void o.queue.push(e):(delete e.attribs.circularreferencecell,t.Formula.FreshnessInfoReset(),t.RecalcClearTimeout(),o.sheet=e,o.currentState=o.state.start_calc,o.starttime=new Date,e.statuscallback&&e.statuscallback(o,"calcstart",null,e.statuscallbackparams),void t.RecalcSetTimeout())},t.RecalcSetTimeout=function(){var o=t.RecalcInfo;o.recalctimer=e.setTimeout(t.RecalcTimerRoutine,o.timeslicedelay)},t.RecalcClearTimeout=function(){var o=t.RecalcInfo;o.recalctimer&&(e.clearTimeout(o.recalctimer),o.recalctimer=null)},t.RecalcLoadedSheet=function(e,o,i,n){var r,a=t.RecalcInfo,s=t.Formula;r=t.Formula.AddSheetToCache(e||s.SheetCache.waitingForLoading,o,n),i&&r&&"off"!=r.attribs.recalc&&(r.previousrecalcsheet=a.sheet,a.sheet=r,a.currentState=a.state.start_calc),s.SheetCache.waitingForLoading=null,t.RecalcSetTimeout()},t.RecalcTimerRoutine=function(){var e,o,i,n,r,a=new Date,s=0,l=t.Formula;if(!l)return"Need SocialCalc.Formula";var c=t.RecalcInfo,u=c.sheet;if(u){var d=u.recalcdata||(u.recalcdata={}),h=function(e,t){u.statuscallback&&u.statuscallback(d,e,t,u.statuscallbackparams)};if(t.RecalcClearTimeout(),c.currentState==c.state.start_calc){d=new t.RecalcData,u.recalcdata=d;for(i in u.cells)i&&d.celllist.push(i);d.calclist={},c.currentState=c.state.order}if(c.currentState==c.state.order){for(;d.celllistitem<d.celllist.length;)if(i=d.celllist[d.celllistitem++],n=t.RecalcCheckCell(u,i),new Date-a>=c.maxtimeslice)return h("calcorder",{coord:i,total:d.celllist.length,count:d.celllistitem}),void t.RecalcSetTimeout();return h("calccheckdone",d.calclistlength),d.nextcalc=d.firstcalc,c.currentState=c.state.calc,void t.RecalcSetTimeout()}if(c.currentState==c.state.start_wait){if(c.currentState=c.state.done_wait,c.LoadSheet&&(r=c.LoadSheet(l.SheetCache.waitingForLoading)))return;return void t.RecalcLoadedSheet(null,"",!1)}if(c.currentState==c.state.done_wait)return c.currentState=c.state.calc,void t.RecalcSetTimeout();for(c.currentState!=c.state.calc&&alert("Recalc state error: "+c.currentState+". Error in SocialCalc code."),i=u.recalcdata.nextcalc;i;){if(o=u.cells[i],o.parseinfo||(o.parseinfo=l.ParseFormulaIntoTokens(o.formula)),o.parseinfo.coord=i,e=l.evaluate_parsed_formula(o.parseinfo,u,!1),l.SheetCache.waitingForLoading){if(1!=c.firstRenderScheduled){var p=t.GetSpreadsheetControlObject().editor;p.ScheduleRender(!1),c.firstRenderScheduled=!0}return d.nextcalc=i,d.count+=s,h("calcloading",{sheetname:l.SheetCache.waitingForLoading}),c.currentState=c.state.start_wait,void t.RecalcSetTimeout()}if(l.RemoteFunctionInfo.waitingForServer)return d.nextcalc=i,d.count+=s,h("calcserverfunc",{funcname:l.RemoteFunctionInfo.waitingForServer,coord:i,total:d.calclistlength,count:d.count}),void(c.currentState=c.state.done_wait);if((o.datavalue!=e.value||o.valuetype!=e.type)&&(o.datavalue=e.value,o.valuetype=e.type,delete o.displaystring,u.recalcchangedavalue=!0),e.error&&(o.errors=e.error),s++,i=u.recalcdata.calclist[i],new Date-a>=c.maxtimeslice)return d.nextcalc=i,d.count+=s,h("calcstep",{coord:i,total:d.calclistlength,count:d.count}),void t.RecalcSetTimeout()}if(d.inrecalc=!1,u.reRenderCellList=u.recalcdata.celllist,delete u.recalcdata,delete u.attribs.needsrecalc,c.sheet=u.previousrecalcsheet||null,c.sheet)return c.currentState=c.state.calc,void t.RecalcSetTimeout();l.FreshnessInfo.recalc_completed=!0,c.currentState=c.state.idle,h("calcfinished",new Date-c.starttime),c.queue.length>0&&(u=c.queue.shift(),u.RecalcSheet())}},t.RecalcCheckCell=function(e,o){var i,n,r,a,s,l,c,u,d,h,p=t.Formula;if(!p)return"Need SocialCalc.Formula";var f=p.TokenType,m=f.op,g=f.name,v=f.coord,b=e.recalcdata,y=b.checkinfo,C=!1,w=null,x=o;e:for(;x;)if(d=e.cells[x],h=y[x],!d||"f"!=d.datatype||h&&"object"!=typeof h)x=w,y[x]&&(w=y[x].oldcoord);else{for(h||(h=new t.RecalcCheckInfo,y[x]=h),d.errors&&delete d.errors,d.parseinfo||(d.parseinfo=p.ParseFormulaIntoTokens(d.formula)),i=d.parseinfo,a=h.parsepos;a<i.length;a++){if(h.inrange){if(h.inrangestart&&(h.cr1.col>h.cr2.col?(h.c1=h.cr2.col,h.c2=h.cr1.col):(h.c1=h.cr1.col,h.c2=h.cr2.col),h.c=h.c1-1,h.cr1.row>h.cr2.row?(h.r1=h.cr2.row,h.r2=h.cr1.row):(h.r1=h.cr1.row,h.r2=h.cr2.row),h.r=h.r1,h.inrangestart=!1),h.c+=1,h.c>h.c2){if(h.r+=1,h.r>h.r2){h.inrange=!1;continue}h.c=h.c1}if(s=t.crToCoord(h.c,h.r),h.parsepos=a,h.oldcoord=w,w=x,x=s,y[x]&&"object"==typeof y[x])return d.errors=t.Constants.s_caccCircRef+o,y[o]=!0,b.firstcalc?b.calclist[b.lastcalc]=o:b.firstcalc=o,b.lastcalc=o,b.calclistlength++,e.attribs.circularreferencecell=x+"|"+w,d.errors;continue e}if(r=i[a].type,n=i[a].text,r==m&&("!"==n?C=!0:":"!=n&&(C=!1)),r==g)if(l=p.LookupName(e,n),"range"==l.type){if(c=l.value.indexOf("|"),-1!=c){h.cr1=t.coordToCr(l.value.substring(0,c)),u=l.value.indexOf("|",c+1),h.cr2=t.coordToCr(l.value.substring(c+1,u)),h.inrange=!0,h.inrangestart=!0,a-=1;continue}}else"coord"==l.type&&(r=v,n=l.value);if(r==v){if(a>=2&&i[a-1].type==m&&":"==i[a-1].text&&i[a-2].type==v&&!C){h.cr1=t.coordToCr(i[a-2].text),h.cr2=t.coordToCr(n),h.inrange=!0,h.inrangestart=!0,a-=1;continue}if(!C){if(-1!=n.indexOf("$")&&(n=n.replace(/\$/g,"")),h.parsepos=a+1,h.oldcoord=w,w=x,x=n,y[x]&&"object"==typeof y[x])return d.errors=t.Constants.s_caccCircRef+o,y[o]=!0,b.firstcalc?b.calclist[b.lastcalc]=o:b.firstcalc=o,b.lastcalc=o,b.calclistlength++,e.attribs.circularreferencecell=x+"|"+w,d.errors;continue e}}}C=!1,y[x]=!0,b.firstcalc?b.calclist[b.lastcalc]=x:b.firstcalc=x,b.lastcalc=x,b.calclistlength++,x=w,w=y[x]?y[x].oldcoord:null}return""},t.Parse=function(e){this.str=e,this.pos=0,this.delimiter=" ",this.lineEnd=e.indexOf("\n"),this.lineEnd<0&&(this.lineEnd=e.length)},t.Parse.prototype.NextToken=function(){if(this.pos<0)return"";var e=this.str.indexOf(this.delimiter,this.pos),t=this.pos;return e>this.lineEnd&&(e=this.lineEnd),e>=0?(this.pos=e+1,this.str.substring(t,e)):(this.pos=this.lineEnd,this.str.substring(t,this.lineEnd))},t.Parse.prototype.RestOfString=function(){var e=this.pos;return this.pos<0||this.pos>=this.lineEnd?"":(this.pos=this.lineEnd,this.str.substring(e,this.lineEnd))},t.Parse.prototype.RestOfStringNoMove=function(){return this.pos<0||this.pos>=this.lineEnd?"":this.str.substring(this.pos,this.lineEnd)},t.Parse.prototype.NextLine=function(){this.pos=this.lineEnd+1,this.lineEnd=this.str.indexOf("\n",this.pos),this.lineEnd<0&&(this.lineEnd=this.str.length)},t.Parse.prototype.EOF=function(){return this.pos<0||this.pos>=this.str.length?!0:!1},t.UndoStack=function(){this.stack=[],this.tos=-1,this.maxRedo=0,this.maxUndo=50},t.UndoStack.prototype.PushChange=function(e){for(;this.stack.length>0&&this.stack.length-1>this.tos;)this.stack.pop();this.stack.push({command:[],type:e,undo:[]}),this.maxRedo&&this.stack.length>this.maxRedo&&this.stack.shift(),this.maxUndo&&this.stack.length>this.maxUndo&&(this.stack[this.stack.length-this.maxUndo-1].undo=[]),this.tos=this.stack.length-1},t.UndoStack.prototype.AddDo=function(){if(this.stack[this.stack.length-1]){for(var e=[],t=0;t<arguments.length;t++)null!=arguments[t]&&e.push(arguments[t]);var o=e.join(" ");this.stack[this.stack.length-1].command.push(o)}},t.UndoStack.prototype.AddUndo=function(){if(this.stack[this.stack.length-1]){for(var e=[],t=0;t<arguments.length;t++)null!=arguments[t]&&e.push(arguments[t]);var o=e.join(" ");this.stack[this.stack.length-1].undo.push(o)}},t.UndoStack.prototype.TOS=function(){return this.tos>=0?this.stack[this.tos]:null},t.UndoStack.prototype.Undo=function(){return this.tos>=0&&(!this.maxUndo||this.tos>this.stack.length-this.maxUndo-1)?(this.tos-=1,!0):!1},t.UndoStack.prototype.Redo=function(){return this.tos<this.stack.length-1?(this.tos+=1,!0):!1},t.Clipboard={clipboard:""},t.RenderContext=function(e){var o=e.attribs,i=t.Constants;if(this.sheetobj=e,this.hideRowsCols=!1,this.showGrid=!1,this.showRCHeaders=!1,this.rownamewidth=i.defaultRowNameWidth,this.pixelsPerRow=i.defaultAssumedRowHeight,this.cellskip={},this.coordToCR={},this.colwidth=[],this.rowheight=[],this.totalwidth=0,this.totalheight=0,this.rowpanes=[],this.colpanes=[],this.colunhideleft=[],this.colunhideright=[],this.rowunhidetop=[],this.rowunhidebottom=[],this.maxcol=0,this.maxrow=0,this.highlights={},this.cursorsuffix="",this.highlightTypes={cursor:{style:i.defaultHighlightTypeCursorStyle,className:i.defaultHighlightTypeCursorClass},range:{style:i.defaultHighlightTypeRangeStyle,className:i.defaultHighlightTypeRangeClass},cursorinsertup:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-x;backgroundPosition:top left;backgroundImage:url("+i.defaultImagePrefix+"cursorinsertup.gif);",className:i.defaultHighlightTypeCursorClass},cursorinsertleft:{style:"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-y;backgroundPosition:top left;backgroundImage:url("+i.defaultImagePrefix+"cursorinsertleft.gif);",className:i.defaultHighlightTypeCursorClass},range2:{style:"color:#000;backgroundColor:#FFF;backgroundImage:url("+i.defaultImagePrefix+"range2.gif);",className:""}},this.cellIDprefix=i.defaultCellIDPrefix,this.defaultlinkstyle=null,this.defaultHTMLlinkstyle={type:"html"},this.defaultfontstyle=i.defaultCellFontStyle,this.defaultfontsize=i.defaultCellFontSize,this.defaultfontfamily=i.defaultCellFontFamily,this.defaultlayout=i.defaultCellLayout,this.defaultpanedividerwidth=i.defaultPaneDividerWidth,this.defaultpanedividerheight=i.defaultPaneDividerHeight,this.gridCSS=i.defaultGridCSS,this.commentClassName=i.defaultCommentClass,this.commentCSS=i.defaultCommentStyle,this.commentNoGridClassName=i.defaultCommentNoGridClass,this.commentNoGridCSS=i.defaultCommentNoGridStyle,this.readonlyClassName=i.defaultReadonlyClass,this.readonlyCSS=i.defaultReadonlyStyle,this.readonlyNoGridClassName=i.defaultReadonlyNoGridClass,this.readonlyNoGridCSS=i.defaultReadonlyNoGridStyle,this.readonlyComment=i.defaultReadonlyComment,this.classnames={colname:i.defaultColnameClass,rowname:i.defaultRownameClass,selectedcolname:i.defaultSelectedColnameClass,selectedrowname:i.defaultSelectedRownameClass,upperleft:i.defaultUpperLeftClass,skippedcell:i.defaultSkippedCellClass,panedivider:i.defaultPaneDividerClass,unhideleft:i.defaultUnhideLeftClass,unhideright:i.defaultUnhideRightClass,unhidetop:i.defaultUnhideTopClass,unhidebottom:i.defaultUnhideBottomClass,colresizebar:i.defaultColResizeBarClass,rowresizebar:i.defaultRowResizeBarClass},this.explicitStyles={colname:i.defaultColnameStyle,rowname:i.defaultRownameStyle,selectedcolname:i.defaultSelectedColnameStyle,selectedrowname:i.defaultSelectedRownameStyle,upperleft:i.defaultUpperLeftStyle,skippedcell:i.defaultSkippedCellStyle,panedivider:i.defaultPaneDividerStyle,unhideleft:i.defaultUnhideLeftStyle,unhideright:i.defaultUnhideRightStyle,unhidetop:i.defaultUnhideTopStyle,unhidebottom:i.defaultUnhideBottomStyle},this.cellskip=null,this.needcellskip=!0,this.fonts=[],this.layouts=[],this.needprecompute=!0,!o)throw i.s_rcMissingSheet;this.rowpanes[0]={first:1,last:o.lastrow},this.colpanes[0]={first:1,last:o.lastcol},this.usermaxcol=o.usermaxcol,this.usermaxrow=o.usermaxrow},t.RenderContext.prototype.PrecomputeSheetFontsAndLayouts=function(){t.PrecomputeSheetFontsAndLayouts(this)},t.RenderContext.prototype.CalculateCellSkipData=function(){t.CalculateCellSkipData(this)},t.RenderContext.prototype.CalculateColWidthData=function(){t.CalculateColWidthData(this)},t.RenderContext.prototype.CalculateRowHeightData=function(){t.CalculateRowHeightData(this)},t.RenderContext.prototype.SetRowPaneFirstLast=function(e,t,o){this.rowpanes[e]={first:t,last:o}},t.RenderContext.prototype.SetColPaneFirstLast=function(e,t,o){this.colpanes[e]={first:t,last:o}},t.RenderContext.prototype.CoordInPane=function(e,o,i){return t.CoordInPane(this,e,o,i)},t.RenderContext.prototype.CellInPane=function(e,o,i,n){return t.CellInPane(this,e,o,i,n)},t.RenderContext.prototype.InitializeTable=function(e){t.InitializeTable(this,e)},t.RenderContext.prototype.RenderSheet=function(e,o){return t.RenderSheet(this,e,o)},t.RenderContext.prototype.RenderColGroup=function(){return t.RenderColGroup(this)},t.RenderContext.prototype.RenderColHeaders=function(){return t.RenderColHeaders(this)},t.RenderContext.prototype.RenderSizingRow=function(){return t.RenderSizingRow(this)},t.RenderContext.prototype.RenderRow=function(e,o,i){return t.RenderRow(this,e,o,i)},t.RenderContext.prototype.RenderSpacingRow=function(){return t.RenderSpacingRow(this)},t.RenderContext.prototype.RenderCell=function(e,o,i,n,r,a){return t.RenderCell(this,e,o,i,n,r,a)},t.PrecomputeSheetFontsAndLayouts=function(e){var o,i,n,r,a,s,l,c,u=e.sheetobj,d=u.attribs;for(d.defaultfont&&(o=u.fonts[d.defaultfont],o=o.replace(/^\*/,t.Constants.defaultCellFontStyle),o=o.replace(/(.+)\*(.+)/,"$1"+t.Constants.defaultCellFontSize+"$2"),o=o.replace(/\*$/,t.Constants.defaultCellFontFamily),i=o.match(/^(\S+? \S+?) (\S+?) (\S.*)$/),e.defaultfontstyle=i[1],e.defaultfontsize=i[2],e.defaultfontfamily=i[3]),s=1;s<u.fonts.length;s++)l=u.fonts[s],l=l.replace(/^\*/,e.defaultfontstyle),l=l.replace(/(.+)\*(.+)/,"$1"+e.defaultfontsize+"$2"),l=l.replace(/\*$/,e.defaultfontfamily),i=l.match(/^(\S+?) (\S+?) (\S+?) (\S.*)$/),i&&(e.fonts[s]={style:i[1],weight:i[2],size:i[3],family:i[4]});for(n=/^padding:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+);vertical-align:\s*(\S+);/,r=t.Constants.defaultCellLayout.match(n),a=d.defaultlayout?u.layouts[d.defaultlayout].match(n):["","*","*","*","*","*"],s=1;s<u.layouts.length;s++)if(l=u.layouts[s],i=l.match(n)){for(c=1;5>=c;c++)"*"==i[c]&&(i[c]="*"!=a[c]?a[c]:r[c]);e.layouts[s]="padding:"+i[1]+" "+i[2]+" "+i[3]+" "+i[4]+";vertical-align:"+i[5]+";"}e.needprecompute=!1},t.CalculateCellSkipData=function(e){{var o,i,n,r,a,s,l,c,u,d=e.sheetobj;d.rowattribs,d.colattribs}for(e.maxrow=0,e.maxcol=0,e.cellskip={},o=1;o<=d.attribs.lastrow;o++)for(i=1;i<=d.attribs.lastcol;i++)if(n=t.crToCoord(i,o),r=d.cells[n],void 0!==r&&!e.cellskip[n]&&(a=r.colspan||1,s=r.rowspan||1,a>1||s>1))for(l=o;o+s>l;l++)for(c=i;i+a>c;c++)u=t.crToCoord(c,l),u==n?e.coordToCR[n]={row:o,col:i}:e.cellskip[u]=n,l>e.maxrow&&(maxrow=l),c>e.maxcol&&(maxcol=c);e.needcellskip=!1},t.CalculateColWidthData=function(e){{var o,i,n,r,a=e.sheetobj;a.colattribs}for(r=e.showRCHeaders?e.rownamewidth-0:0,colpane=0;colpane<e.colpanes.length;colpane++)for(o=e.colpanes[colpane].first;o<=e.colpanes[colpane].last;o++)i=t.rcColname(o),"yes"==a.colattribs.hide[i]?e.colwidth[o]=0:(n=a.colattribs.width[i]||a.attribs.defaultcolwidth||t.Constants.defaultColWidth,("blank"==n||"auto"==n)&&(n=""),e.colwidth[o]=n+"",r+=n&&n-0>0?n-0:10);e.totalwidth=r},t.CalculateRowHeightData=function(e){var o,i,n,r=e.sheetobj;for(n=e.showRCHeaders?e.pixelsPerRow:0,rowpane=0;rowpane<e.rowpanes.length;rowpane++)for(o=e.rowpanes[rowpane].first;o<=e.rowpanes[rowpane].last;o++)"yes"===r.rowattribs.hide[o]?e.rowheight[o]=0:(i=r.rowattribs.height[o]||r.attribs.defaultrowheight||t.Constants.defaultAssumedRowHeight,("blank"===i||"auto"===i)&&(i=""),e.rowheight[o]=i+"",n+=i&&i-0>0?i-0:10);e.totalheight=n},t.InitializeTable=function(e,t){t.style.borderCollapse="collapse",t.cellSpacing="0",t.cellPadding="0",t.style.width=e.totalwidth+"px"},t.RenderSheet=function(e,t,o){var i,n,r,a,s,l;for(e.sheetobj.changedrendervalues&&(e.needcellskip=!0,e.needprecompute=!0,e.sheetobj.changedrendervalues=!1),e.needcellskip&&e.CalculateCellSkipData(),e.needprecompute&&e.PrecomputeSheetFontsAndLayouts(),e.CalculateColWidthData(),e.CalculateRowHeightData(),r=document.createElement("table"),e.InitializeTable(r),a=e.RenderColGroup(),r.appendChild(a),s=document.createElement("tbody"),s.appendChild(e.RenderSizingRow()),e.showRCHeaders&&(i=e.RenderColHeaders(),i&&s.appendChild(i)),n=0;n<e.rowpanes.length;n++){for(rownum=e.rowpanes[n].first;rownum<=e.rowpanes[n].last;rownum++)i=e.RenderRow(rownum,n,o),s.appendChild(i);n<e.rowpanes.length-1&&(i=e.RenderSpacingRow(),s.appendChild(i))}return r.appendChild(s),t&&(l=t.parentNode,l&&l.replaceChild(r,t)),r},t.RenderRow=function(e,o,i,n){var r,a,s,l,c=e.sheetobj,u=document.createElement("tr");if(e.showRCHeaders){if(a=document.createElement("td"),e.classnames&&(a.className=e.classnames.rowname),e.explicitStyles&&(a.style.cssText=e.explicitStyles.rowname),a.width=e.rownamewidth,a.height=e.rowheight[o],a.style.verticalAlign="top",a.innerHTML=o+"",o<e.rowpanes[e.rowpanes.length-1].last&&"yes"==c.rowattribs.hide[o+1]){var d=document.createElement("div");d.style.position="relative";var h=document.createElement("div");e.classnames&&(h.className=e.classnames.unhidetop),e.explicitStyles&&(h.style.cssText=e.explicitStyles.unhidetop);var p=e.rowheight[o]-0-t.Constants.defaultAssumedRowHeight;p=0===p?4:p,h.style.bottom="-"+p+"px",e.rowunhidetop[o]=h,d.appendChild(h),a.appendChild(d)}if(o>1&&"yes"==c.rowattribs.hide[o-1]){var h=document.createElement("div");e.classnames&&(h.className=e.classnames.unhidebottom),e.explicitStyles&&(h.style.cssText=e.explicitStyles.unhidebottom),e.rowunhidebottom[o]=h,a.appendChild(h)}var f=document.createElement("div");f.className=e.classnames.rowresizebar,a.appendChild(f),u.appendChild(a)}for(s=0;s<e.colpanes.length;s++){for(r=e.colpanes[s].first;r<=e.colpanes[s].last;r++)a=e.RenderCell(o,r,i,s,null,n),a&&u.appendChild(a);s<e.colpanes.length-1&&(a=document.createElement("td"),a.width=e.defaultpanedividerwidth,e.classnames.panedivider&&(a.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(a.style.cssText=e.explicitStyles.panedivider),l=document.createElement("div"),l.style.width=e.defaultpanedividerwidth+"px",l.style.overflow="hidden",a.appendChild(l),u.appendChild(a))}return"yes"==c.rowattribs.hide[o]&&(u.style.cssText+=";display:none"),u},t.RenderSpacingRow=function(e){var t,o,i,n,r=(e.sheetobj,document.createElement("tr"));for(e.showRCHeaders&&(o=document.createElement("td"),o.width=e.rownamewidth,o.height=e.defaultpanedividerheight,e.classnames.panedivider&&(o.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(o.style.cssText=e.explicitStyles.panedivider),r.appendChild(o)),i=0;i<e.colpanes.length;i++){for(t=e.colpanes[i].first;t<=e.colpanes[i].last;t++)o=document.createElement("td"),n=e.colwidth[t],n&&(o.width=n),o.height=e.defaultpanedividerheight,e.classnames.panedivider&&(o.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(o.style.cssText=e.explicitStyles.panedivider),o&&r.appendChild(o);i<e.colpanes.length-1&&(o=document.createElement("td"),o.width=e.defaultpanedividerwidth,o.height=e.defaultpanedividerheight,e.classnames.panedivider&&(o.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(o.style.cssText=e.explicitStyles.panedivider),r.appendChild(o))}return r},t.RenderColHeaders=function(e){var o,i,n=e.sheetobj,r=document.createElement("tr");if(!e.showRCHeaders)return null;for(i=document.createElement("td"),e.classnames&&(i.className=e.classnames.upperleft),e.explicitStyles&&(i.style.cssText=e.explicitStyles.upperleft),i.width=e.rownamewidth,r.appendChild(i),colpane=0;colpane<e.colpanes.length;colpane++){for(o=e.colpanes[colpane].first;o<=e.colpanes[colpane].last;o++){if(i=document.createElement("td"),e.classnames&&(i.className=e.classnames.colname),e.explicitStyles&&(i.style.cssText=e.explicitStyles.colname),"yes"==n.colattribs.hide[t.rcColname(o)]&&(i.style.cssText+=";display:none"),i.innerHTML=t.rcColname(o),o<e.colpanes[e.colpanes.length-1].last&&"yes"==n.colattribs.hide[t.rcColname(o+1)]){var a=document.createElement("div");
e.classnames&&(a.className=e.classnames.unhideleft),e.explicitStyles&&(a.style.cssText=e.explicitStyles.unhideleft),e.colunhideleft[o]=a,i.appendChild(a)}o>1&&"yes"==n.colattribs.hide[t.rcColname(o-1)]&&(a=document.createElement("div"),e.classnames&&(a.className=e.classnames.unhideright),e.explicitStyles&&(a.style.cssText=e.explicitStyles.unhideright),e.colunhideright[o]=a,i.appendChild(a));var s=document.createElement("span");s.style.height=t.Constants.defaultAssumedRowHeight+"px",s.className=e.classnames.colresizebar,i.appendChild(s),r.appendChild(i)}colpane<e.colpanes.length-1&&(i=document.createElement("td"),i.width=e.defaultpanedividerwidth,e.classnames.panedivider&&(i.className=e.classnames.panedivider),e.explicitStyles.panedivider&&(i.style.cssText=e.explicitStyles.panedivider),r.appendChild(i))}return r},t.RenderColGroup=function(e){var o,i,n,r,a=e.sheetobj,s=document.createElement("colgroup");for(e.showRCHeaders&&(n=document.createElement("col"),n.width=e.rownamewidth,s.appendChild(n)),o=0;o<e.colpanes.length;o++){for(i=e.colpanes[o].first;i<=e.colpanes[o].last;i++)n=document.createElement("col"),"yes"==a.colattribs.hide[t.rcColname(i)]?n.width="1":(r=e.colwidth[i],r&&(n.width=r),s.appendChild(n));o<e.colpanes.length-1&&(n=document.createElement("col"),n.width=e.defaultpanedividerwidth,s.appendChild(n))}return s},t.RenderSizingRow=function(e){var o,i,n,r,a=e.sheetobj,s=document.createElement("tr");for(e.showRCHeaders&&(n=document.createElement("td"),n.style.width=e.rownamewidth+"px",n.height="1",s.appendChild(n)),o=0;o<e.colpanes.length;o++){for(i=e.colpanes[o].first;i<=e.colpanes[o].last;i++)n=document.createElement("td"),"yes"==a.colattribs.hide[t.rcColname(i)]?n.width="1":(r=e.colwidth[i],r&&(n.width=r)),n.height="1",s.appendChild(n);o<e.colpanes.length-1&&(n=document.createElement("td"),n.width=e.defaultpanedividerwidth,n.height="1",s.appendChild(n))}return s},t.RenderCell=function(e,o,i,n,r,a,s){var l,c,u,d,h,p,f,m=e.sheetobj,g="";o-=0,i-=0;var v=t.crToCoord(i,o);if(e.cellskip[v])return e.CoordInPane(e.cellskip[v],n,r)?null:(u=a?t.CreatePseudoElement():document.createElement("td"),e.classnames.skippedcell&&(u.className=e.classnames.skippedcell),e.explicitStyles.skippedcell&&(u.style.cssText=e.explicitStyles.skippedcell),u.innerHTML="&nbsp;",u);if(u=a?t.CreatePseudoElement():document.createElement("td"),e.cellIDprefix&&(u.id=e.cellIDprefix+v),h=m.cells[v],h||(h=new t.Cell(v)),f=m.attribs,scc=t.Constants,h.colspan>1){for(d=1,l=1;l<h.colspan;l++)"yes"!=m.colattribs.hide[t.rcColname(i+l)]&&e.CellInPane(o,i+l,n,r)&&d++;u.colSpan=d}if(h.rowspan>1){for(d=1,l=1;l<h.rowspan;l++)"yes"!=m.rowattribs.hide[o+l+""]&&e.CellInPane(o+l,i,n,r)&&d++;u.rowSpan=d}return(void 0==h.displaystring||0==m.widgetsClean)&&(h.displaystring=t.FormatValueForDisplay(m,h.datavalue,v,s||e.defaultlinkstyle)),u.innerHTML=h.displaystring,l=h.layout||f.defaultlayout,g+=l&&"undefined"!=typeof e.layouts[l]?e.layouts[l]:scc.defaultCellLayout,l=h.font||f.defaultfont,l&&"undefined"!=typeof e.fonts[l]?(c=e.fonts[l],g+="font-style:"+c.style+";font-weight:"+c.weight+";font-size:"+c.size+";font-family:"+c.family+";"):(scc.defaultCellFontSize&&(g+="font-size:"+scc.defaultCellFontSize+";"),scc.defaultCellFontFamily&&(g+="font-family:"+scc.defaultCellFontFamily+";")),l=h.color||f.defaultcolor,l&&"undefined"!=typeof m.colors[l]&&(g+="color:"+m.colors[l]+";"),l=h.bgcolor||f.defaultbgcolor,l&&"undefined"!=typeof m.colors[l]&&(g+="background-color:"+m.colors[l]+";"),l=h.cellformat,l&&"undefined"!=typeof m.cellformats[l]?g+="text-align:"+m.cellformats[l]+";":(c=h.valuetype.charAt(0),"t"==c?(l=f.defaulttextformat,l&&"undefined"!=typeof m.cellformats[l]&&(g+="text-align:"+m.cellformats[l]+";")):"n"==c?(l=f.defaultnontextformat,g+=l&&"undefined"!=typeof m.cellformats[l]?"text-align:"+m.cellformats[l]+";":"text-align:right;"):g+="text-align:left;"),(h.colspan>1||h.rowspan>1)&&(p=m.cells[t.crToCoord(i+(h.colspan||1)-1,o+(h.rowspan||1)-1)]),l=h.bt,l&&"undefined"!=typeof m.borderstyles[l]&&(g+="border-top:"+m.borderstyles[l]+";"),l="undefined"!=typeof p?p.br:h.br,l&&"undefined"!=typeof m.borderstyles[l]?g+="border-right:"+m.borderstyles[l]+";":e.showGrid&&(c=e.CellInPane(o,i+(h.colspan||1),n,r)?t.crToCoord(i+(h.colspan||1),o):"nomatch",e.cellskip[c]&&(c=e.cellskip[c]),m.cells[c]&&m.cells[c].bl||(g+="border-right:"+e.gridCSS)),l="undefined"!=typeof p?p.bb:h.bb,l&&"undefined"!=typeof m.borderstyles[l]?g+="border-bottom:"+m.borderstyles[l]+";":e.showGrid&&(c=e.CellInPane(o+(h.rowspan||1),i,n,r)?t.crToCoord(i,o+(h.rowspan||1)):"nomatch",e.cellskip[c]&&(c=e.cellskip[c]),m.cells[c]&&m.cells[c].bt||(g+="border-bottom:"+e.gridCSS)),l=h.bl,l&&"undefined"!=typeof m.borderstyles[l]&&(g+="border-left:"+m.borderstyles[l]+";"),h.comment&&(u.title=h.comment,e.showGrid?(e.commentClassName&&(u.className=(u.className?u.className+" ":"")+e.commentClassName),g+=e.commentCSS):(e.commentNoGridClassName&&(u.className=(u.className?u.className+" ":"")+e.commentNoGridClassName),g+=e.commentNoGridCSS)),h.readonly&&(h.comment||(u.title=e.readonlyComment),e.showGrid?(e.readonlyClassName&&(u.className=(u.className?u.className+" ":"")+e.readonlyClassName),g+=e.readonlyCSS):(e.readonlyNoGridClassName&&(u.className=(u.className?u.className+" ":"")+e.readonlyNoGridClassName),g+=e.readonlyNoGridCSS)),u.style.cssText=g,void 0!==h.cssc&&(a?u.className=(u.className?u.className+" ":"")+h.cssc:u.classList.add(h.cssc)),c=e.highlights[v],c&&("cursor"==c&&(c+=e.cursorsuffix),e.highlightTypes[c].className&&(u.className=(u.className?u.className+" ":"")+e.highlightTypes[c].className),t.setStyles(u,e.highlightTypes[c].style)),"yes"==m.colattribs.hide[t.rcColname(i)]&&(u.style.cssText+=";display:none"),"yes"==m.rowattribs.hide[o]&&(u.style.cssText+=";display:none"),u},t.CoordInPane=function(e,t,o,i){var n=e.coordToCR[t];if(!n||!n.row||!n.col)throw"Bad coordToCR for "+t;return e.CellInPane(n.row,n.col,o,i)},t.CellInPane=function(e,t,o,i,n){var r=e.rowpanes[i],a=e.colpanes[n];if(!r||!a)throw"CellInPane called with unknown panes "+i+"/"+n;return t<r.first||t>r.last?!1:o<a.first||o>a.last?!1:!0},t.CreatePseudoElement=function(){return{style:{cssText:""},innerHTML:"",className:""}},t.rcColname=function(e){e>702&&(e=702),1>e&&(e=1);var t=(e-1)%26+65,o=Math.floor((e-1)/26);return o?String.fromCharCode(o+64)+String.fromCharCode(t):String.fromCharCode(t)},t.letters=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t.crToCoord=function(e,o){var i;1>e&&(e=1),e>702&&(e=702),1>o&&(o=1);var n=(e-1)%26,r=Math.floor((e-1)/26);return i=r?t.letters[r-1]+t.letters[n]+o:t.letters[n]+o},t.coordToCol={},t.coordToRow={},t.coordToCr=function(e){var o,i,n,r=t.coordToRow[e];if(r)return{row:r,col:t.coordToCol[e]};for(o=0,r=0,i=0;i<e.length;i++)n=e.charCodeAt(i),36==n||(57>=n?r=10*r+n-48:n>=97?o=26*o+n-96:n>=65&&(o=26*o+n-64));return t.coordToCol[e]=o,t.coordToRow[e]=r,{row:r,col:o}},t.ParseRange=function(e){var o,i,n,r;return e||(e="A1:A1"),e=e.toUpperCase(),o=e.indexOf(":"),o>=0?(i=e.substring(0,o),n=t.coordToCr(i),n.coord=i,i=e.substring(o+1),r=t.coordToCr(i),r.coord=i):(n=t.coordToCr(e),n.coord=e,r=t.coordToCr(e),r.coord=e),{cr1:n,cr2:r}},t.decodeFromSave=function(e){if("string"!=typeof e)return e;if(-1==e.indexOf("\\"))return e;var t=e.replace(/\\c/g,":");return t=t.replace(/\\n/g,"\n"),t.replace(/\\b/g,"\\")},t.decodeFromAjax=function(e){if("string"!=typeof e)return e;if(-1==e.indexOf("\\"))return e;var t=e.replace(/\\c/g,":");return t=t.replace(/\\n/g,"\n"),t=t.replace(/\\e/g,"]]"),t.replace(/\\b/g,"\\")},t.encodeForSave=function(e){return"string"!=typeof e?e:(-1!=e.indexOf("\\")&&(e=e.replace(/\\/g,"\\b")),-1!=e.indexOf(":")&&(e=e.replace(/:/g,"\\c")),-1!=e.indexOf("\n")&&(e=e.replace(/\n/g,"\\n")),e)},t.special_chars=function(e){return/[&<>"]/.test(e)&&(e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;")),e},t.Lookup=function(e,t){for(i=0;i<t.length;i++)if(t[i]>e)return i>0?i-1:null;return t.length-1},t.setStyles=function(e,t){var o,i,n,r,a;if(t)for(o=t.split(";"),i=0;i<o.length;i++)n=o[i].indexOf(":"),-1!=n&&(r=o[i].substring(0,n),a=o[i].substring(n+1),r&&a&&(e.style[r]=a))},t.GetViewportInfo=function(){var t={};return e.innerWidth?(t.width=e.innerWidth,t.height=e.innerHeight,t.horizontalScroll=e.pageXOffset,t.verticalScroll=e.pageYOffset):document.documentElement&&document.documentElement.clientWidth?(t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight,t.horizontalScroll=document.documentElement.scrollLeft,t.verticalScroll=document.documentElement.scrollTop):document.body.clientWidth&&(t.width=document.body.clientWidth,t.height=document.body.clientHeight,t.horizontalScroll=document.body.scrollLeft,t.verticalScroll=document.body.scrollTop),t},t.GetElementPosition=function(e){for(var o=0,i=0;e&&"relative"!=t.GetComputedStyle(e,"position");)o+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;return{left:o,top:i}},t.GetElementPositionWithScroll=function(e){var t=e.getBoundingClientRect();return{left:t.left,right:t.right,top:t.top,bottom:t.bottom,width:t.width?t.width:t.right-t.left,height:t.height?t.height:t.bottom-t.top}},t.GetElementFixedParent=function(e){for(;e&&"HTML"!=e.tagName;){if("fixed"==t.GetComputedStyle(e,"position"))return e;e=e.parentNode}return!1},t.GetComputedStyle=function(e,t){var o;return o="undefined"!=typeof e.currentStyle?e.currentStyle:document.defaultView.getComputedStyle(e,null),o[t]},t.LookupElement=function(e,t){var o;for(o=0;o<t.length;o++)if(t[o].element==e)return t[o];return null},t.AssignID=function(e,t,o){e.idPrefix&&(t.id=e.idPrefix+o)},t.GetCellContents=function(e,t){var o="",i=e.cells[t];if(i)switch(i.datatype){case"v":o=i.datavalue+"";break;case"t":o="'"+i.datavalue;break;case"f":o="="+i.formula;break;case"c":o=i.formula}return o},t.FormatValueForDisplay=function(e,o,i,n){var r,a,s,l,c=e.attribs,u=(t.Constants,e.cells[i]);u||(u=new t.Cell(i)),l=o,a=u.valuetype||"",s=a.substring(1),valueinputwidget=a.charAt(1);var d=a.substring(2),h=null,p=null;if(a=a.charAt(0),u.errors||"e"==a)return l=u.errors||s||"Error in cell";if("t"==a){if(r=e.valueformats[u.textvalueformat-0]||e.valueformats[c.defaulttextvalueformat-0]||"","formula"==r)return l="f"==u.datatype?t.special_chars("="+u.formula)||"&nbsp;":"c"==u.datatype?t.special_chars("'"+u.formula)||"&nbsp;":t.special_chars("'"+l)||"&nbsp;";var h=l;l=t.format_text_for_display(l,u.valuetype,r,e,n,u.nontextvalueformat);var p=l}else if("n"==a){if(r=u.nontextvalueformat,(null==r||""==r)&&(r=c.defaultnontextvalueformat),r=e.valueformats[r-0],(null==r||"none"==r)&&(r=""),"formula"==r)return l="f"==u.datatype?t.special_chars("="+u.formula)||"&nbsp;":"c"==u.datatype?t.special_chars("'"+u.formula)||"&nbsp;":t.special_chars("'"+l)||"&nbsp;";if("forcetext"==r)return l="f"==u.datatype?t.special_chars("="+u.formula)||"&nbsp;":"c"==u.datatype?t.special_chars(u.formula)||"&nbsp;":t.special_chars(l)||"&nbsp;";var h=l;l=t.format_number_for_display(l,u.valuetype,r);var p=l}else l="&nbsp;";if("i"==valueinputwidget&&null!=h&&null!=p){var f=e.ioParameterList[i],m=t.Formula.FunctionList[d];if(m){var g=m[5],v=0==h?"":"checked";g=g.replace(/<%=checked%>/g,v),g=g.replace(/<%=formated_value%>/g,p),g=g.replace(/<%=display_value%>/g,h);var b;if(f){for(var y=0;y<f.length;y++){b="coord"==f[y].type?e.GetAssuredCell(f[y].value).datavalue:f[y].value;var C=new RegExp("<%=parameter"+y+"_value%>","g");g=g.replace(C,b)}if(f.html)for(var w=0;w<f.html.length;w++){var C=new RegExp("<%=html"+w+"_value%>","g");g=g.replace(C,f.html[w])}f.css&&(g=g.replace(/^(<\w+)(\W)/,"$1 style='"+f.css+"'$2"))}return g.replace(/<%=cell_reference%>/g,i)}return"error:Widget HTML missing"}return l},t.format_text_for_display=function(e,o,i,n,r,a){var i,s,l,c,u,d;return s=o.substring(1),d=e,("none"==i||null==i)&&(i=""),/^(text-|custom|hidden)/.test(i)||(i=""),(""==i||"General"==i)&&("h"==s&&(i="text-html"),("w"==s||"r"==s)&&(i="text-wiki"),"l"==s&&(i="text-link"),s||(i="text-plain")),"text-html"==i||(t.Callbacks.expand_wiki&&/^text-wiki/.test(i)?d=t.Callbacks.expand_wiki(d,n,r,i):"text-wiki"==i?d=t.Callbacks.expand_markup&&t.Callbacks.expand_markup(d,n,r)||t.special_chars("wiki-text:"+d):"text-url"==i?(l=t.special_chars(d),c=encodeURI(d),d='<a href="'+c+'">'+l+"</a>"):"text-link"==i?d=t.expand_text_link(d,n,r,i):"text-image"==i?(c=encodeURI(d),d='<img src="'+c+'">'):"text-custom:"==i.substring(0,12)?(l=t.special_chars(d),l=l.replace(/  /g,"&nbsp; "),l=l.replace(/\n/g,"<br>"),c=encodeURI(d),u={},u.r=d,u.s=l,u.u=c,d=i.substring(12),d=d.replace(/@(r|s|u)/g,function(e,t){return u[t]})):"custom"==i.substring(0,6)?(d=t.special_chars(d),d=d.replace(/  /g,"&nbsp; "),d=d.replace(/\n/g,"<br>"),d+=" (custom format)"):"hidden"==i?d="&nbsp;":null!=a&&""!=a&&"none"!=n.valueformats[a-0]&&""!=n.valueformats[a-0]?(i=n.valueformats[a],d=t.format_number_for_display(e,o,i)):(d=t.special_chars(d),d=d.replace(/  /g,"&nbsp; "),d=d.replace(/\n/g,"<br>"))),d},t.format_number_for_display=function(e,o,i){var n,r,a=t.Constants;return n=e-0,r=o.substring(1),("Auto"==i||""==i)&&(i="%"==r?a.defaultFormatp:"$"==r?a.defaultFormatc:"dt"==r?a.defaultFormatdt:"d"==r?a.defaultFormatd:"t"==r?a.defaultFormatt:"l"==r?"logical":"General"),"logical"==i?n?a.defaultDisplayTRUE:a.defaultDisplayFALSE:"hidden"==i?"&nbsp;":t.FormatNumber.formatNumberWithFormat(e,i,"")},t.DetermineValueType=function(e){var o,i,n,r,a,s,l,c,u,d,h=e+"",p="t";return o=h.replace(/^\s+/,""),o=o.replace(/\s+$/,""),0==h.length?p="":h.match(/^\s+$/)||(o.match(/^[-+]?\d*(?:\.)?\d*(?:[eE][-+]?\d+)?$/)?(h=o-0,isNaN(h)?h=e+"":p="n"):o.match(/^[-+]?\d*(?:\.)?\d*\s*%$/)?(h=(o.slice(0,-1)-0)/100,p="n%"):o.match(/^[-+]?\$\s*\d*(?:\.)?\d*\s*$/)&&o.match(/\d/)?(h=o.replace(/\$/,"")-0,p="n$"):o.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*$/)?(h=o.replace(/,/g,"")-0,p="n"):o.match(/^[-+]?(\d*,\d*)+(?:\.)?\d*\s*%$/)?(h=(o.replace(/[%,]/g,"")-0)/100,p="n%"):o.match(/^[-+]?\$\s*(\d*,\d*)+(?:\.)?\d*$/)&&o.match(/\d/)?(h=o.replace(/[\$,]/g,"")-0,p="n$"):(i=h.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{1,4})\s*$/))?(n=i[3]-0,n=1e3>n?n+2e3:n,h=0===navigator.language.indexOf("fr")?t.FormatNumber.convert_date_gregorian_to_julian(n,i[2]-0,i[1]-0)-2415019:t.FormatNumber.convert_date_gregorian_to_julian(n,i[1]-0,i[2]-0)-2415019,p="nd"):(i=h.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})\s*$/))?(n=i[1]-0,n=1e3>n?n+2e3:n,h=t.FormatNumber.convert_date_gregorian_to_julian(n,i[2]-0,i[3]-0)-2415019,p="nd"):(i=h.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2}) (\d{1,2}):(\d{1,2})\s*$/))?(n=i[1]-0,n=1e3>n?n+2e3:n,r=i[4]-0,a=i[5]-0,h=t.FormatNumber.convert_date_gregorian_to_julian(n,i[2]-0,i[3]-0)-2415019,p="nd",24>r&&60>a&&(h+=r/24+a/1440,p="ndt")):(i=h.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})\s*$/))?(n=i[1]-0,n=1e3>n?n+2e3:n,r=i[4]-0,a=i[5]-0,s=i[6]-0,h=t.FormatNumber.convert_date_gregorian_to_julian(n,i[2]-0,i[3]-0)-2415019,p="nd",24>r&&60>a&&60>s&&(h+=r/24+a/1440+s/86400,p="ndt")):(i=h.match(/^(\d{1,2}):(\d{1,2})\s*$/))?(r=i[1]-0,a=i[2]-0,24>r&&60>a&&(h=r/24+a/1440,p="nt")):(i=h.match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})\s*$/))?(r=i[1]-0,a=i[2]-0,s=i[3]-0,24>r&&60>a&&60>s&&(h=r/24+a/1440+s/86400,p="nt")):(i=h.match(/^\s*([-+]?\d+) (\d+)\/(\d+)\s*$/))?(u=i[1]-0,c=i[2]-0,l=i[3]-0,l&&l>0&&(h=u+(0>u?-c/l:c/l),p="n")):(d=t.InputConstants[h.toUpperCase()])?(c=d.indexOf(","),h=d.substring(0,c)-0,p=d.substring(c+1)):o.length>7&&"http://"==o.substring(0,7).toLowerCase()?(h=o,p="tl"):o.match(/<([A-Z][A-Z0-9]*)\b[^>]*>[\s\S]*?<\/\1>/i)&&(h=o,p="th")),{value:h,type:p}},t.InputConstants={TRUE:"1,nl",FALSE:"0,nl","#N/A":"0,e#N/A","#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"},t.default_expand_markup=function(e){var o=e;return o=t.special_chars(o),o=o.replace(/  /g,"&nbsp; "),o=o.replace(/\n/g,"<br>")},t.expand_text_link=function(e,o,i,n){var r,a,s,l=t.Constants,c="",u=t.ParseCellLinkText(e+"");return r=u.desc?t.special_chars(u.desc):u.pagename?l.defaultPageLinkFormatString:l.defaultLinkFormatString,e.length>7&&"http://"==e.substring(0,7).toLowerCase()&&">"!=e.charAt(e.length-1)&&(r=r.substring(7)),a=u.newwin||!i?' target="_blank"':"",u.pagename?t.Callbacks.MakePageLink&&(c=t.Callbacks.MakePageLink(u.pagename,u.workspacename,i,n)):c=encodeURI(u.url),s='<a href="'+c+'"'+a+">"+r+"</a>"},t.ParseCellLinkText=function(e){var t={url:"",desc:"",newwin:!1,pagename:"",workspace:""},o=!1,i=e.length-1,n=0,r=e.lastIndexOf("<"),a=e.lastIndexOf("["),s=e.lastIndexOf("{"),l=-1;return">"==e.charAt(i)&&-1!=r||"]"==e.charAt(i)&&-1!=a||!("}"!=e.charAt(i)||"]"!=e.charAt(i-1)||-1==s||-1==a||s>a)?(">"==e.charAt(i)?(l=r-1,r>0&&"<"==e.charAt(l)&&">"==e.charAt(i-1)&&(l--,i--,t.newwin=!0)):"]"==e.charAt(i)?(l=a-1,o=!0,a>0&&"["==e.charAt(l)&&"]"==e.charAt(i-1)&&(l--,i--,t.newwin=!0)):"}"==e.charAt(i)&&(l=s-1,o=!0,wsend=a,i--,a>0&&"["==e.charAt(a-1)&&"]"==e.charAt(i-1)&&(wsend=a-1,i--,t.newwin=!0)," "==e.charAt(wsend-1)&&wsend--,t.workspace=e.substring(s+1,wsend)||"")," "==e.charAt(l)&&l--,'"'==e.charAt(n)&&'"'==e.charAt(l)&&(n++,l--)):(i++,l=i),o?t.pagename=e.substring(a+1,i)||"":t.url=e.substring(r+1,i)||"",l>=n&&(t.desc=e.substring(n,l+1)),t},t.ConvertSaveToOtherFormat=function(e,o,i){var n,r,a,s,l,c,u,d,h,p,f="";if("scsave"==o)return e;if(""==e)return"";if(n=new t.Sheet,n.ParseSheetSave(e),i)throw"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.";if(a=n.copiedfrom?t.ParseRange(n.copiedfrom):{cr1:{row:1,col:1},cr2:{row:n.attribs.lastrow,col:n.attribs.lastcol}},"html"==o)return r=new t.RenderContext(n),n.copiedfrom&&(r.rowpanes[0]={first:a.cr1.row,last:a.cr2.row},r.colpanes[0]={first:a.cr1.col,last:a.cr2.col}),s=document.createElement("div"),l=r.RenderSheet(null,r.defaultHTMLlinkstyle),s.appendChild(l),delete r,delete n,f=s.innerHTML,delete l,delete s,f;for(c=a.cr1.row;c<=a.cr2.row;c++){for(u=a.cr1.col;u<=a.cr2.col;u++)d=t.crToCoord(u,c),h=n.GetAssuredCell(d),p=h.errors?h.errors:h.datavalue+"","csv"==o?(-1!=p.indexOf('"')&&(p=p.replace(/"/g,'""')),/[, \n"]/.test(p)&&(p='"'+p+'"'),u>a.cr1.col&&(p=","+p)):"tab"==o&&(-1!=p.indexOf("\n")&&(-1!=p.indexOf('"')&&(p=p.replace(/"/g,'""')),p='"'+p+'"'),u>a.cr1.col&&(p="	"+p)),f+=p;f+="\n"}return f},t.ConvertOtherFormatToSave=function(e,o){var i,n,r,a,s,l,c,u,d,h,p,f,m="",g=function(){h++,h>f&&(f=h),p=t.crToCoord(h,d),t.SetConvertedCell(i,p,s),s=""};if("scsave"==o)return e;if(i=new t.Sheet,n=e.split(/\r\n|\n/),f=0,"csv"==o){for(d=0,l=!1,r=0;r<n.length&&(r!=n.length-1||""!=n[r]);r++)for(l?s+="\n":(s="",d++,h=0),a=n[r],c=0;c<a.length;c++)u=a.charAt(c),'"'!=u?(","!=u||l?s+=u:g(),c!=a.length-1||l||g()):l?c<a.length-1&&'"'==a.charAt(c+1)?(c++,s+='"'):(l=!1,c==a.length-1&&g()):l=!0;f>0&&(i.attribs.lastrow=d,i.attribs.lastcol=f,m=i.CreateSheetSave("A1:"+t.crToCoord(f,d)))}if("tab"==o){for(d=0,l=!1,r=0;r<n.length&&(r!=n.length-1||""!=n[r]);r++)for(l?s+="\n":(s="",d++,h=0),a=n[r],c=0;c<a.length;c++){if(u=a.charAt(c),'"'==u){if(l){c<a.length-1?'"'==a.charAt(c+1)?(c++,s+='"'):"	"==a.charAt(c+1)&&(c++,l=!1,g()):(l=!1,g());continue}if(""==s){l=!0;continue}}"	"!=u||l?s+=u:g(),c!=a.length-1||l||g()}f>0&&(i.attribs.lastrow=d,i.attribs.lastcol=f,m=i.CreateSheetSave("A1:"+t.crToCoord(f,d)))}return m},t.SetConvertedCell=function(e,o,i){var n,r;n=e.GetAssuredCell(o),r=t.DetermineValueType(i),"n"==r.type&&r.value==i?(n.datatype="v",n.valuetype="n",n.datavalue=r.value):"t"==r.type.charAt(0)?(n.datatype="t",n.valuetype=r.type,n.datavalue=r.value):(n.datatype="c",n.valuetype=r.type,n.datavalue=r.value,n.formula=i)};var t;t||(t={}),t.TableEditor=function(o){var i=t.Constants;this.context=o,this.toplevel=null,this.fullgrid=null,this.noEdit=!1,this.width=null,this.tablewidth=null,this.height=null,this.tableheight=null,this.inputBox=null,this.inputEcho=null,this.verticaltablecontrol=null,this.horizontaltablecontrol=null,this.logo=null,this.cellhandles=null,this.timeout=null,this.busy=!1,this.ensureecell=!1,this.deferredCommands=[],this.deferredEmailCommands=[],this.gridposition=null,this.headposition=null,this.firstscrollingrow=null,this.firstscrollingrowtop=null,this.lastnonscrollingrow=null,this.lastvisiblerow=null,this.firstscrollingcol=null,this.firstscrollingcolleft=null,this.lastnonscrollingcol=null,this.lastvisiblecol=null,this.rowpositions=[],this.colpositions=[],this.rowheight=[],this.colwidth=[],this.ecell=null,this.state="start",this.workingvalues={},this.imageprefix=i.defaultImagePrefix,this.idPrefix=i.defaultTableEditorIDPrefix,this.pageUpDnAmount=i.defaultPageUpDnAmount,this.recalcFunction=function(e){return e.context.sheetobj.RecalcSheet?void e.context.sheetobj.RecalcSheet(t.EditorSheetStatusCallback,e):null},this.ctrlkeyFunction=function(o,i){var n,r,a,s,l,c;switch(i){case"[ctrl-a]":return o.MoveECell("A1"),o.RangeAnchor("A1"),o.RangeExtend(t.crToCoord(o.context.sheetobj.attribs.lastcol,o.context.sheetobj.attribs.lastrow)),!1;case"[ctrl-c]":case"[ctrl-x]":return n=o.pasteTextarea,n.value="",r=t.GetEditorCellElement(o,o.ecell.row,o.ecell.col),r&&(a=t.GetElementPosition(r.element),n.style.left=a.left-1+"px",n.style.top=a.top-1+"px"),l=o.range.hasrange?t.crToCoord(o.range.left,o.range.top)+":"+t.crToCoord(o.range.right,o.range.bottom):o.ecell.coord,c=t.ConvertSaveToOtherFormat(t.CreateSheetSave(o.context.sheetobj,l),"tab"),s="[ctrl-c]"==i||o.noEdit||o.ECellReadonly()?"copy "+l+" formulas":"cut "+l+" formulas",o.EditorScheduleSheetCommands(s,!0,!1),n.style.display="block",n.value=c,n.focus(),n.select(),e.setTimeout(function(){var e=o.pasteTextarea;e.blur(),e.style.display="none",t.KeyboardFocus()},200),!0;case"[ctrl-v]":return o.noEdit||o.ECellReadonly()?!0:(n=o.pasteTextarea,n.value="",r=t.GetEditorCellElement(o,o.ecell.row,o.ecell.col),r&&(a=t.GetElementPosition(r.element),n.style.left=a.left-1+"px",n.style.top=a.top-1+"px"),n.style.display="block",n.value="",n.focus(),e.setTimeout(function(){var e=o.pasteTextarea,i=e.value;e.blur(),e.style.display="none";var n="";if(o.pastescclipboard)o.pastescclipboard=!1;else{var r=t.ConvertSaveToOtherFormat(t.Clipboard.clipboard,"tab");i=i.replace(/\r\n/g,"\n"),i==r||i.length-r.length==1&&i.substring(0,i.length-1)==r||(n="loadclipboard "+t.encodeForSave(t.ConvertOtherFormatToSave(i,"tab"))+"\n")}var a;if(o.range.hasrange){var s=new t.Sheet;s.ParseSheetSave(t.Clipboard.clipboard);var l=s.copiedfrom.match(/(.+):(.+)/);a=null!==l&&l[1]===l[2]?t.crToCoord(o.range.left,o.range.top)+":"+t.crToCoord(o.range.right,o.range.bottom):t.crToCoord(o.range.left,o.range.top)}else a=o.ecell.coord;n+="paste "+a+" formulas",o.EditorScheduleSheetCommands(n,!0,!1),t.KeyboardFocus()},200),!0);case"[ctrl-z]":return o.EditorScheduleSheetCommands("undo",!0,!1),!1;case"[ctrl-s]":if(!t.Constants.AllowCtrlS)break;return e.setTimeout(function(){var i=o.context.sheetobj,n=i.GetAssuredCell(o.ecell.coord),r=n.nontextvalueformat?i.valueformats[n.nontextvalueformat-0]||"":"",a=e.prompt("Advanced Feature:\n\nCustom Numeric Format or Command",r);if(null!=a){if(a.match(/^cmd:/))s=a.substring(4);else{if(a.match(/^edit:/))return s=a.substring(5),void(t.CtrlSEditor&&t.CtrlSEditor(s));l=o.range.hasrange?t.crToCoord(o.range.left,o.range.top)+":"+t.crToCoord(o.range.right,o.range.bottom):o.ecell.coord,s="set "+l+" nontextvalueformat "+a}o.EditorScheduleSheetCommands(s,!0,!1)}},200),!1}return!0},o.sheetobj.statuscallback=t.EditorSheetStatusCallback,o.sheetobj.statuscallbackparams=this,this.StatusCallback={},this.MoveECellCallback={},this.RangeChangeCallback={},this.SettingsCallbacks={},this.ecell={coord:"A1",row:1,col:1},o.highlights[this.ecell.coord]="cursor",this.range={hasrange:!1},this.range2={hasrange:!1}},t.TableEditor.prototype.CreateTableEditor=function(e,o){return t.CreateTableEditor(this,e,o)},t.TableEditor.prototype.ResizeTableEditor=function(e,o){return t.ResizeTableEditor(this,e,o)},t.TableEditor.prototype.SaveEditorSettings=function(){return t.SaveEditorSettings(this)},t.TableEditor.prototype.LoadEditorSettings=function(e,o){return t.LoadEditorSettings(this,e,o)},t.TableEditor.prototype.EditorRenderSheet=function(){t.EditorRenderSheet(this)},t.TableEditor.prototype.EditorScheduleSheetCommands=function(e,o,i){t.EditorScheduleSheetCommands(this,e,o,i)},t.TableEditor.prototype.ScheduleSheetCommands=function(e,t){this.context.sheetobj.ScheduleSheetCommands(e,t)},t.TableEditor.prototype.SheetUndo=function(){this.context.sheetobj.SheetUndo()},t.TableEditor.prototype.SheetRedo=function(){this.context.sheetobj.SheetRedo()},t.TableEditor.prototype.EditorStepSet=function(e,o){t.EditorStepSet(this,e,o)},t.TableEditor.prototype.GetStatuslineString=function(e,o,i){return t.EditorGetStatuslineString(this,e,o,i)},t.TableEditor.prototype.EditorMouseRegister=function(){return t.EditorMouseRegister(this)},t.TableEditor.prototype.EditorMouseUnregister=function(){return t.EditorMouseUnregister(this)},t.TableEditor.prototype.EditorMouseRange=function(e){return t.EditorMouseRange(this,e)},t.TableEditor.prototype.EditorProcessKey=function(e,o){return t.EditorProcessKey(this,e,o)},t.TableEditor.prototype.EditorAddToInput=function(e,o){return t.EditorAddToInput(this,e,o)},t.TableEditor.prototype.DisplayCellContents=function(){return t.EditorDisplayCellContents(this)},t.TableEditor.prototype.EditorSaveEdit=function(e){return t.EditorSaveEdit(this,e)},t.TableEditor.prototype.EditorApplySetCommandsToRange=function(e,o){return t.EditorApplySetCommandsToRange(this,e,o)},t.TableEditor.prototype.MoveECellWithKey=function(e){return t.MoveECellWithKey(this,e)},t.TableEditor.prototype.MoveECell=function(e){return t._app?"A1":t.MoveECell(this,e)},t.TableEditor.prototype.ReplaceCell=function(e,o,i){t.ReplaceCell(this,e,o,i)},t.TableEditor.prototype.UpdateCellCSS=function(e,o,i){t.UpdateCellCSS(this,e,o,i)},t.TableEditor.prototype.SetECellHeaders=function(e){t.SetECellHeaders(this,e)},t.TableEditor.prototype.EnsureECellVisible=function(){t.EnsureECellVisible(this)},t.TableEditor.prototype.ECellReadonly=function(e){return t.ECellReadonly(this,e)},t.TableEditor.prototype.RangeAnchor=function(e){t.RangeAnchor(this,e)},t.TableEditor.prototype.RangeExtend=function(e){t.RangeExtend(this,e)},t.TableEditor.prototype.RangeRemove=function(){t.RangeRemove(this)},t.TableEditor.prototype.Range2Remove=function(){t.Range2Remove(this)},t.TableEditor.prototype.FitToEditTable=function(){t.FitToEditTable(this)},t.TableEditor.prototype.CalculateEditorPositions=function(){t.CalculateEditorPositions(this)},t.TableEditor.prototype.ScheduleRender=function(){this.ScheduleRender(!0)},t.TableEditor.prototype.ScheduleRender=function(e){t._app&&1==e&&(this.context.sheetobj.widgetsClean=!1),t.ScheduleRender(this)},t.TableEditor.prototype.DoRenderStep=function(){t.DoRenderStep(this)},t.TableEditor.prototype.SchedulePositionCalculations=function(){t.SchedulePositionCalculations(this)},t.TableEditor.prototype.DoPositionCalculations=function(){t.DoPositionCalculations(this)},t.TableEditor.prototype.CalculateRowPositions=function(e,o,i){return t.CalculateRowPositions(this,e,o,i)},t.TableEditor.prototype.CalculateColPositions=function(e,o,i){return t.CalculateColPositions(this,e,o,i)},t.TableEditor.prototype.ScrollRelative=function(e,o){t.ScrollRelative(this,e,o)},t.TableEditor.prototype.ScrollRelativeBoth=function(e,o){t.ScrollRelativeBoth(this,e,o)},t.TableEditor.prototype.PageRelative=function(e,o){t.PageRelative(this,e,o)},t.TableEditor.prototype.LimitLastPanes=function(){t.LimitLastPanes(this)},t.TableEditor.prototype.ScrollTableUpOneRow=function(){return t.ScrollTableUpOneRow(this)},t.TableEditor.prototype.ScrollTableDownOneRow=function(){return t.ScrollTableDownOneRow(this)},t.TableEditor.prototype.ScrollTableLeftOneCol=function(){return t.ScrollTableLeftOneCol(this)},t.TableEditor.prototype.ScrollTableRightOneCol=function(){return t.ScrollTableRightOneCol(this)},t.TableEditor.prototype.StopPropagation=function(){return t.StopPropagation(this)},t.TableEditor.prototype.SetMouseMoveUp=function(){return t.SetMouseMoveUp(this)},t.TableEditor.prototype.RemoveMouseMoveUp=function(){return t.RemoveMouseMoveUp(this)},t.CreateTableEditor=function(o,i,n){var r=t.Constants,a=t.AssignID;o.toplevel=document.createElement("div"),o.toplevel.style.position="relative",a(o,o.toplevel,"toplevel"),o.width=i,o.height=n,o.griddiv=document.createElement("div"),o.tablewidth=Math.max(0,i-r.defaultTableControlThickness),o.tableheight=Math.max(0,n-r.defaultTableControlThickness),o.griddiv.style.width=o.tablewidth+"px",o.griddiv.style.height=o.tableheight+"px",o.griddiv.style.overflow="hidden",o.griddiv.style.cursor="default",r.cteGriddivClass&&(o.griddiv.className=r.cteGriddivClass),a(o,o.griddiv,"griddiv"),o.FitToEditTable(),o.EditorRenderSheet(),o.griddiv.appendChild(o.fullgrid),o.verticaltablecontrol=new t.TableControl(o,!0,o.tableheight),o.verticaltablecontrol.CreateTableControl(),a(o,o.verticaltablecontrol.main,"tablecontrolv"),o.horizontaltablecontrol=new t.TableControl(o,!1,o.tablewidth),o.horizontaltablecontrol.CreateTableControl(),a(o,o.horizontaltablecontrol.main,"tablecontrolh");var s,l,c,u,d;return s=document.createElement("table"),o.layouttable=s,s.cellSpacing=0,s.cellPadding=0,a(o,s,"layouttable"),l=document.createElement("tbody"),s.appendChild(l),c=document.createElement("tr"),l.appendChild(c),u=document.createElement("td"),u.appendChild(o.griddiv),c.appendChild(u),1!=t._app&&(u=document.createElement("td"),u.appendChild(o.verticaltablecontrol.main),c.appendChild(u)),c=document.createElement("tr"),l.appendChild(c),1!=t._app&&(u=document.createElement("td"),u.appendChild(o.horizontaltablecontrol.main),c.appendChild(u)),u=document.createElement("td"),u.style.background=t._app?"url("+o.imageprefix+"logo.gif) no-repeat right center":"url("+o.imageprefix+"logo.gif) no-repeat center center",u.innerHTML="<div style='cursor:pointer;font-size:1px;'><img src='"+o.imageprefix+"1x1.gif' border='0' width='18' height='18'></div>",c.appendChild(u),o.logo=u,a(o,o.logo,"logo"),u.firstChild.firstChild.title="SocialCalc",o.toplevel.appendChild(o.layouttable),o.noEdit||(o.inputEcho=new t.InputEcho(o),a(o,o.inputEcho.main,"inputecho")),o.cellhandles=new t.CellHandles(o),d=document.createElement("textarea"),t.setStyles(d,"display:none;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);"),d.value="",o.pasteTextarea=d,a(o,o.pasteTextarea,"pastetextarea"),navigator.userAgent.match(/Safari\//)&&!navigator.userAgent.match(/Chrome\//)&&(e.removeEventListener("beforepaste",t.SafariPasteFunction,!1),e.addEventListener("beforepaste",t.SafariPasteFunction,!1),e.removeEventListener("beforecopy",t.SafariPasteFunction,!1),e.addEventListener("beforecopy",t.SafariPasteFunction,!1),e.removeEventListener("beforecut",t.SafariPasteFunction,!1),e.addEventListener("beforecut",t.SafariPasteFunction,!1)),o.toplevel.appendChild(o.pasteTextarea),t.MouseWheelRegister(o.toplevel,{WheelMove:t.EditorProcessMouseWheel,editor:o}),t.KeyboardSetFocus(o),t.EditorSheetStatusCallback(null,"startup",null,o),o.toplevel},t.SafariPasteFunction=function(e){e.preventDefault()},t.ResizeTableEditor=function(e,o,i){var n=t.Constants;e.width=o,e.height=i,e.toplevel.style.width=o+"px",e.toplevel.style.height=i+"px",e.tablewidth=t._app?Math.max(0,o):Math.max(0,o-n.defaultTableControlThickness),e.tableheight=Math.max(0,i-n.defaultTableControlThickness),e.griddiv.style.width=e.tablewidth+"px",e.griddiv.style.height=e.tableheight+"px",e.verticaltablecontrol.main.style.height=e.tableheight+"px",e.horizontaltablecontrol.main.style.width=e.tablewidth+"px",e.FitToEditTable(),e.ScheduleRender()},t.SaveEditorSettings=function(e){var t,o,i=e.context,n=e.range,r="";for(r+="version:1.0\n",t=0;t<i.rowpanes.length;t++)r+="rowpane:"+t+":"+i.rowpanes[t].first+":"+i.rowpanes[t].last+"\n";for(t=0;t<i.colpanes.length;t++)r+="colpane:"+t+":"+i.colpanes[t].first+":"+i.colpanes[t].last+"\n";e.ecell&&(r+="ecell:"+e.ecell.coord+"\n"),n.hasrange&&(r+="range:"+n.anchorcoord+":"+n.top+":"+n.bottom+":"+n.left+":"+n.right+"\n");
for(o in e.SettingsCallbacks)r+=e.SettingsCallbacks[o].save(e,o);return r},t.LoadEditorSettings=function(e,o,i){var n,r,a,s,l,c,u,d,h,p=o.split(/\r\n|\n/),f=[],m=e.context;for(m.rowpanes=[{first:1,last:1}],m.colpanes=[{first:1,last:1}],e.ecell=null,e.range={hasrange:!1},e.range2={hasrange:!1},h=e.range,m.highlights={},d=m.highlights,r=0;r<p.length;r++)switch(n=p[r],f=n.split(":"),u=f[0]){case"version":break;case"rowpane":m.rowpanes[f[1]-0]={first:f[2]-0,last:f[3]-0};break;case"colpane":m.colpanes[f[1]-0]={first:f[2]-0,last:f[3]-0};break;case"ecell":e.ecell=t.coordToCr(f[1]),e.ecell.coord=f[1],d[f[1]]="cursor";break;case"range":for(h.hasrange=!0,h.anchorcoord=f[1],a=t.coordToCr(h.anchorcoord),h.anchorrow=a.row,h.anchorcol=a.col,h.top=f[2]-0,h.bottom=f[3]-0,h.left=f[4]-0,h.right=f[5]-0,s=h.top;s<=h.bottom;s++)for(l=h.left;l<=h.right;l++)c=t.crToCoord(l,s),"cursor"!=d[c]&&(d[c]="range");break;default:e.SettingsCallbacks[u]&&e.SettingsCallbacks[u].load(e,u,n,i)}},t.EditorRenderSheet=function(e){e.EditorMouseUnregister();var o=e.context.sheetobj;if(null!=o.reRenderCellList&&t._app&&o.widgetsClean===!0){for(var i in o.reRenderCellList){var n=o.reRenderCellList[i],r=o.cells[n].valuetype;("i"!=r.charAt(1)||r!=o.cells[n].prevvaluetype)&&(cr=t.coordToCr(n),cell=t.GetEditorCellElement(e,cr.row,cr.col),null!=cell&&e.ReplaceCell(cell,cr.row,cr.col))}o.reRenderCellList=[]}else e.fullgrid=e.context.RenderSheet(e.fullgrid),null!=o.reRenderCellList&&t._app&&(o.widgetsClean=!0,o.reRenderCellList=[]);e.ecell&&e.SetECellHeaders("selected"),t.AssignID(e,e.fullgrid,"fullgrid"),t._app||(e.fullgrid.className="te_download"),e.EditorMouseRegister()},t.EditorScheduleSheetCommands=function(e,o,i,n){if("start"==e.state||n){if(e.busy&&!n)return void e.deferredCommands.push({cmdstr:o,saveundo:i});var r=o.split(" ");switch(r[0]){case"recalc":case"redisplay":e.context.sheetobj.ScheduleSheetCommands(o,!1);break;case"undo":t._app&&(e.context.sheetobj.widgetsClean=!1),e.SheetUndo();break;case"redo":t._app&&(e.context.sheetobj.widgetsClean=!1),e.SheetRedo();break;case"setemailparameters":t.TriggerIoAction.Email(r[1],r[2]);break;default:e.context.sheetobj.ScheduleSheetCommands(o,i)}}},t.EditorSheetStatusCallback=function(e,o,i,n){var r,a,s,l=n.context.sheetobj,c=function(e){for(r in n.StatusCallback)n.StatusCallback[r].func&&n.StatusCallback[r].func(n,e,i,n.StatusCallback[r].params)};switch(o){case"startup":break;case"cmdstart":n.busy=!0,l.celldisplayneeded="";break;case"cmdextension":break;case"cmdend":if(c(o),l.changedrendervalues&&(n.context.PrecomputeSheetFontsAndLayouts(),n.context.CalculateCellSkipData(),l.changedrendervalues=!1),l.celldisplayneeded&&!l.renderneeded&&l.cells[l.celldisplayneeded]&&"e#N/A"!=l.cells[l.celldisplayneeded].valuetype&&(cr=t.coordToCr(l.celldisplayneeded),a=t.GetEditorCellElement(n,cr.row,cr.col),n.ReplaceCell(a,cr.row,cr.col)),n.deferredCommands.length)return s=n.deferredCommands.shift(),void n.EditorScheduleSheetCommands(s.cmdstr,s.saveundo,!0);if(l.attribs.needsrecalc&&("off"!=l.attribs.recalc||l.recalconce)&&n.recalcFunction?(n.FitToEditTable(),l.renderneeded=!1,l.recalconce&&delete l.recalconce,n.recalcFunction(n)):l.renderneeded?(n.FitToEditTable(),l.renderneeded=!1,n.ScheduleRender(!1)):n.SchedulePositionCalculations(),"col"==l.hiddencolrow&&null!==n.ecell){for(var u=n.ecell.col;"yes"==l.colattribs.hide[t.rcColname(u)];)u++;var d=t.crToCoord(u,n.ecell.row);n.MoveECell(d),l.hiddencolrow=""}if("row"==l.hiddencolrow&&null!==n.ecell){for(var h=n.ecell.row;"yes"==l.rowattribs.hide[h];)h++;var d=t.crToCoord(n.ecell.col,h);n.MoveECell(d),l.hiddencolrow=""}return;case"calcstart":n.busy=!0;break;case"calccheckdone":case"calcorder":case"calcstep":case"calcloading":case"calcserverfunc":break;case"calcfinished":return c(o),void n.ScheduleRender(!1);case"schedrender":n.busy=!0;break;case"renderdone":break;case"schedposcalc":n.busy=!0;break;case"doneposcalc":if(n.deferredEmailCommands.length){c(o);var p=n.deferredEmailCommands.shift();return void n.EditorScheduleSheetCommands(p.cmdstr,p.saveundo,!0)}return void(n.deferredCommands.length?(c(o),s=n.deferredCommands.shift(),n.EditorScheduleSheetCommands(s.cmdstr,s.saveundo,!0)):(n.busy=!1,c(o),"start"==n.state&&n.DisplayCellContents()));case"emailing":case"confirmemailsent":break;default:alert("Unknown status: "+o)}c(o)},t.EditorGetStatuslineString=function(e,o,i,n){var r,a,s,l,c,u,d,h,p=t.Constants;switch(a="",o){case"moveecell":case"rangechange":case"startup":break;case"cmdstart":n.command=!0,document.body.style.cursor="progress",e.griddiv.style.cursor="progress",a=p.s_statusline_executing;break;case"cmdextension":a="Command Extension: "+i;break;case"cmdend":n.command=!1;break;case"schedrender":a=p.s_statusline_displaying;break;case"renderdone":a=" ";break;case"schedposcalc":a=p.s_statusline_displaying;break;case"cmdendnorender":case"doneposcalc":document.body.style.cursor="default",e.griddiv.style.cursor="default","sent"==n.emailing&&(a=n.emailreponse,n.emailreponse="",n.emailing="done");break;case"calcorder":a=p.s_statusline_ordering+Math.floor(100*i.count/(i.total||1))+"%";break;case"calcstep":a=p.s_statusline_calculating+Math.floor(100*i.count/(i.total||1))+"%";break;case"calcloading":a=p.s_statusline_calculatingls+": "+i.sheetname;break;case"calcserverfunc":a=p.s_statusline_calculating+Math.floor(100*i.count/(i.total||1))+"%, "+p.s_statusline_doingserverfunc+i.funcname+p.s_statusline_incell+i.coord;break;case"calcstart":n.calculating=!0,document.body.style.cursor="progress",e.griddiv.style.cursor="progress",a=p.s_statusline_calcstart;break;case"calccheckdone":break;case"calcfinished":n.calculating=!1;break;case"emailing":n.emailing="sending",n.emailreponse="";break;case"confirmemailsent":n.emailing="sent","undefined"==typeof n.emailreponse&&(n.emailreponse=""),n.emailreponse+=i;break;default:a=o}if("sending"==n.emailing&&(a+=p.s_statusline_sendemail),"sent"==n.emailing&&(a+=n.emailreponse),!a&&n.calculating&&(a=p.s_statusline_calculating),!(n.calculating||n.command||a||!e.range.hasrange||e.range.left==e.range.right&&e.range.top==e.range.bottom)){for(h=0,c=e.range.top;c<=e.range.bottom;c++)for(u=e.range.left;u<=e.range.right;u++)d=e.context.sheetobj.cells[t.crToCoord(u,c)],d&&d.valuetype&&"n"==d.valuetype.charAt(0)&&(h+=d.datavalue-0);h=t.FormatNumber.formatNumberWithFormat(h,"[,]General",""),s=t.crToCoord(e.range.left,e.range.top)+":"+t.crToCoord(e.range.right,e.range.bottom),a=s+" ("+(e.range.right-e.range.left+1)+"x"+(e.range.bottom-e.range.top+1)+") "+p.s_statusline_sum+"="+h+" "+a}return r=(e.ecell||{}).coord+" &nbsp; "+a,n.calculating||"yes"!=e.context.sheetobj.attribs.needsrecalc||(r+=" &nbsp; "+p.s_statusline_recalcneeded),l=e.context.sheetobj.attribs.circularreferencecell,l&&(l=l.replace(/\|/," referenced by "),r+=" &nbsp; "+p.s_statusline_circref+l+"</span>"),r+=""},t.EditorMouseInfo={registeredElements:[],editor:null,element:null,ignore:!1,mousedowncoord:"",mouselastcoord:"",mouseresizecol:"",mouseresizeclientx:null,mouseresizedisplay:null},t.EditorMouseRegister=function(e){var o,i=t.EditorMouseInfo,n=e.fullgrid;for(o=0;o<i.registeredElements.length;o++)if(i.registeredElements[o].editor==e){if(i.registeredElements[o].element==n)return;break}if(o<i.registeredElements.length?i.registeredElements[o].element=n:i.registeredElements.push({element:n,editor:e}),n.addEventListener)n.addEventListener("mousedown",t.ProcessEditorMouseDown,!1),n.addEventListener("dblclick",t.ProcessEditorDblClick,!1);else{if(!n.attachEvent)throw"Browser not supported";n.attachEvent("onmousedown",t.ProcessEditorMouseDown),n.attachEvent("ondblclick",t.ProcessEditorDblClick)}i.ignore=!1},t.EditorMouseUnregister=function(e){{var o,i,n=t.EditorMouseInfo;e.fullgrid}for(o=0;o<n.registeredElements.length&&n.registeredElements[o].editor!=e;o++);o<n.registeredElements.length&&(i=n.registeredElements[o].element,i.removeEventListener?(i.removeEventListener("mousedown",t.ProcessEditorMouseDown,!1),i.removeEventListener("dblclick",t.ProcessEditorDblClick,!1)):i.detachEvent&&(i.detachEvent("onmousedown",t.ProcessEditorMouseDown),i.detachEvent("ondblclick",t.ProcessEditorDblClick)),n.registeredElements.splice(o,1))},t.StopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1},t.SetMouseMoveUp=function(e,o,i,n){document.addEventListener?(document.addEventListener("mousemove",e,!0),document.addEventListener("mouseup",o,!0)):i.attachEvent&&(i.setCapture(),i.attachEvent("onmousemove",e),i.attachEvent("onmouseup",o),i.attachEvent("onlosecapture",o)),t.StopPropagation(n)},t.RemoveMouseMoveUp=function(e,o,i,n){t.StopPropagation(n),document.removeEventListener?(document.removeEventListener("mousemove",e,!0),document.removeEventListener("mouseup",o,!0)):i.detachEvent&&(i.detachEvent("onlosecapture",o),i.detachEvent("onmouseup",o),i.detachEvent("onmousemove",e),i.releaseCapture())},t.ProcessEditorMouseDown=function(o){var i,n,r,a,s=o||e.event,l=t.EditorMouseInfo,c=s.target||s.srcElement,u=c;3==u.nodeType&&(u=u.parentNode);var d;if(!l.ignore){for(d=null;!d&&c;c=c.parentNode)d=t.LookupElement(c,l.registeredElements);if(!d)return void(l.editor=null);i=d.editor,l.element=c,a=i.range;var h=t.GetElementPositionWithScroll(i.toplevel),p=s.clientX-h.left,f=s.clientY-h.top;if(n=t.GridMousePosition(i,p,f)){if(l.editor=i,n.rowheader)return void(n.rowselect?t.ProcessEditorRowselectMouseDown(o,c,n):t.ProcessEditorRowsizeMouseDown(o,c,n));if(n.colheader)return void(n.colselect?t.ProcessEditorColselectMouseDown(o,c,n):t.ProcessEditorColsizeMouseDown(o,c,n));if(n.coord){if(a.hasrange||o.shiftKey&&i.RangeAnchor(),r=i.MoveECell(n.coord),1==t._app)return void t.CmdGotFocus(!0);var m=i.context.sheetobj.cells[r];if(m&&"i"==m.valuetype.charAt(1)){var g=m.valuetype.substring(2),v=g+"_"+r;if(u&&v==u.id){var b=document.getElementById(v);t.CmdGotFocus(b)}}else a.hasrange&&(o.shiftKey?i.RangeExtend():i.RangeRemove()),l.mousedowncoord=r,l.mouselastcoord=r,i.EditorMouseRange(r),t.KeyboardSetFocus(i),"start"!=i.state&&i.inputBox&&i.inputBox.element.focus(),t.SetMouseMoveUp(t.ProcessEditorMouseMove,t.ProcessEditorMouseUp,c,s)}}}},t.EditorMouseRange=function(e,o){var i,n,r=e.range;switch(e.state){case"input":i=e.inputBox.GetText(),n=e.workingvalues,("(+-*/,:!&<>=^".indexOf(i.slice(-1))>=0&&"="==i.slice(0,1)||"="==i)&&(n.partialexpr=i),n.partialexpr?o&&e.inputBox.SetText(r.hasrange?n.partialexpr+t.crToCoord(r.left,r.top)+":"+t.crToCoord(r.right,r.bottom):n.partialexpr+o):(e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),e.EditorSaveEdit(),e.inputBox.DisplayCellContents(null));break;case"inputboxdirect":e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),e.EditorSaveEdit(),e.inputBox.DisplayCellContents(null)}},t.ProcessEditorMouseMove=function(o){var i,n,r,a=o||e.event,s=t.EditorMouseInfo;if(i=s.editor,i&&!s.ignore){n=s.element;var l=t.GetElementPositionWithScroll(i.toplevel),c=a.clientX-l.left,u=a.clientY-l.top;if(r=t.GridMousePosition(i,c,u)){if(r&&!r.coord)return void t.SetDragAutoRepeat(i,r);t.SetDragAutoRepeat(i,null),r.coord&&(r.coord!=s.mouselastcoord&&(o.shiftKey||i.range.hasrange||i.RangeAnchor(s.mousedowncoord),i.MoveECell(r.coord),i.RangeExtend()),s.mouselastcoord=r.coord,i.EditorMouseRange(r.coord),t.StopPropagation(a))}}},t.ProcessEditorMouseUp=function(o){var i,n,r,a=o||e.event,s=t.EditorMouseInfo;if(i=s.editor,i&&!s.ignore){n=s.element;var l=t.GetElementPositionWithScroll(i.toplevel),c=a.clientX-l.left,u=a.clientY-l.top;if(r=t.GridMousePosition(i,c,u),t.SetDragAutoRepeat(i,null),r)return r.coord||(r.coord=i.ecell.coord),i.range.hasrange?(i.MoveECell(r.coord),i.RangeExtend()):r.coord&&r.coord!=s.mousedowncoord&&(i.RangeAnchor(s.mousedowncoord),i.MoveECell(r.coord),i.RangeExtend()),i.EditorMouseRange(r.coord),s.editor=null,t.RemoveMouseMoveUp(t.ProcessEditorMouseMove,t.ProcessEditorMouseUp,n,a),!1}},t.ProcessEditorColsizeMouseDown=function(o,i,n){var r=o||e.event,a=t.EditorMouseInfo,s=a.editor,l=t.GetElementPositionWithScroll(s.toplevel),c=r.clientX-l.left;if(a.mouseresizecolnum=n.coltoresize,a.mouseresizecol=t.rcColname(n.coltoresize),a.mousedownclientx=c,a.mousecoltounhide=n.coltounhide,n.coltoresize){var u=document.createElement("div");a.mouseresizedisplay=u,u.style.width="auto",u.style.position="absolute",u.style.zIndex=100,u.style.top=s.headposition.top+"px",u.style.left=s.colpositions[n.coltoresize]+"px",u.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="height:100px;border:1px dashed black;background-color:white;width:'+(s.context.colwidth[a.mouseresizecolnum]-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+s.context.colwidth[a.mouseresizecolnum]+"</div></td></tr></table>",t.setStyles(u.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.85;"),s.toplevel.appendChild(u)}t.SetMouseMoveUp(t.ProcessEditorColsizeMouseMove,t.ProcessEditorColsizeMouseUp,s.toplevel,r)},t.ProcessEditorColsizeMouseMove=function(o){var i=o||e.event,n=t.EditorMouseInfo,r=n.editor;if(r){if(n.mouseresizecolnum){var a=t.GetElementPositionWithScroll(r.toplevel),s=i.clientX-a.left,l=r.context.colwidth[n.mouseresizecolnum]-0+(s-n.mousedownclientx);l<t.Constants.defaultMinimumColWidth&&(l=t.Constants.defaultMinimumColWidth);var c=n.mouseresizedisplay;c.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="height:100px;border:1px dashed black;background-color:white;width:'+(l-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+l+"</div></td></tr></table>",t.setStyles(c.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.85;")}t.StopPropagation(i)}},t.ProcessEditorColsizeMouseUp=function(o){var i=o||e.event,n=t.EditorMouseInfo,r=n.editor;if(r){element=n.element;var a=t.GetElementPositionWithScroll(r.toplevel),s=i.clientX-a.left;if(t.RemoveMouseMoveUp(t.ProcessEditorColsizeMouseMove,t.ProcessEditorColsizeMouseUp,r.toplevel,i),n.mousecoltounhide)r.EditorScheduleSheetCommands("set "+t.rcColname(n.mousecoltounhide)+" hide",!0,!1);else if(n.mouseresizecolnum){var l=r.context.colwidth[n.mouseresizecolnum]-0+(s-n.mousedownclientx);l<t.Constants.defaultMinimumColWidth&&(l=t.Constants.defaultMinimumColWidth),r.EditorScheduleSheetCommands("set "+n.mouseresizecol+" width "+l,!0,!1),r.timeout&&e.clearTimeout(r.timeout),r.timeout=e.setTimeout(t.FinishColRowSize,1)}return!1}},t.FinishColRowSize=function(){var e=t.EditorMouseInfo,o=e.editor;o&&(o.toplevel.removeChild(e.mouseresizedisplay),e.mouseresizedisplay=null,e.editor=null)},t.ProcessEditorRowselectMouseDown=function(o,i,n){var r=o||e.event,a=t.EditorMouseInfo,s=a.editor,l=t.GetSpreadsheetControlObject().sheet;coord1=t.crToCoord(1,n.row),coord2=t.crToCoord(l.LastCol(),n.row),coord3=t.crToCoord(s.firstscrollingcol,n.row),s.RangeAnchor(coord1),s.RangeExtend(coord2),s.MoveECell(coord3),t.SetMouseMoveUp(t.ProcessEditorRowselectMouseMove,t.ProcessEditorRowselectMouseUp,s.toplevel,r)},t.ProcessEditorRowselectMouseMove=function(o){var i=o||e.event,n=t.EditorMouseInfo,r=n.editor,a=t.GetSpreadsheetControlObject().sheet;if(r){var s=t.GetElementPositionWithScroll(r.toplevel),l=i.clientX-s.left,c=i.clientY-s.top;result=t.GridMousePosition(r,l,c),coord2=t.crToCoord(a.LastCol(),result.row),coord3=t.crToCoord(r.firstscrollingcol,result.row),r.RangeExtend(coord2),r.MoveECell(coord3)}},t.ProcessEditorRowselectMouseUp=function(o){var i=(o||e.event,t.EditorMouseInfo),n=i.editor;n&&t.RemoveMouseMoveUp(t.ProcessEditorRowselectMouseMove,t.ProcessEditorRowselectMouseUp,n.toplevel,o)},t.ProcessEditorColselectMouseDown=function(o,i,n){var r=o||e.event,a=t.EditorMouseInfo,s=a.editor,l=t.GetSpreadsheetControlObject().sheet;coord1=t.crToCoord(n.col,1),coord2=t.crToCoord(n.col,l.LastRow()),coord3=t.crToCoord(n.col,s.firstscrollingrow),s.RangeAnchor(coord1),s.RangeExtend(coord2),s.MoveECell(coord3),t.SetMouseMoveUp(t.ProcessEditorColselectMouseMove,t.ProcessEditorColselectMouseUp,s.toplevel,r)},t.ProcessEditorColselectMouseMove=function(o){var i=o||e.event,n=t.EditorMouseInfo,r=n.editor,a=t.GetSpreadsheetControlObject().sheet;if(r){var s=t.GetElementPositionWithScroll(r.toplevel),l=i.clientX-s.left,c=i.clientY-s.top;result=t.GridMousePosition(r,l,c),coord2=t.crToCoord(result.col,a.LastRow()),coord3=t.crToCoord(result.col,r.firstscrollingrow),r.RangeExtend(coord2),r.MoveECell(coord3)}},t.ProcessEditorColselectMouseUp=function(o){var i=(o||e.event,t.EditorMouseInfo),n=i.editor;n&&t.RemoveMouseMoveUp(t.ProcessEditorColselectMouseMove,t.ProcessEditorColselectMouseUp,n.toplevel,o)},t.ProcessEditorRowsizeMouseDown=function(o,i,n){var r=o||e.event,a=t.EditorMouseInfo,s=a.editor,l=t.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight,c=r.clientY-l;if(a.mouseresizerownum=n.rowtoresize,a.mouseresizerow=n.rowtoresize,a.mousedownclienty=c,a.mouserowtounhide=n.rowtounhide,n.rowtoresize){var u=document.createElement("div");a.mouseresizedisplay=u,u.style.width=s.context.totalwidth+"px",u.style.height=s.rowpositions[n.rowtoresize]+"px",u.style.position="absolute",u.style.zIndex=100,u.style.top=s.rowpositions[n.rowtoresize]+"px",u.style.left=s.headposition.left+"px",u.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="width:100pxborder:1px dashed black;background-color:white;height:'+(s.context.rowheight[a.mouseresizerownum]-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+s.context.rowheight[a.mouseresizerownum]+"</div></td></tr></table>",t.setStyles(u.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.5;"),s.toplevel.appendChild(u)}t.SetMouseMoveUp(t.ProcessEditorRowsizeMouseMove,t.ProcessEditorRowsizeMouseUp,s.toplevel,r)},t.ProcessEditorRowsizeMouseMove=function(o){var i=o||e.event,n=t.EditorMouseInfo,r=n.editor;if(r){if(n.mouseresizerownum){var a=t.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight,s=i.clientY-a,l=r.context.rowheight[n.mouseresizerownum]-0+(s-n.mousedownclienty);l<t.Constants.defaultAssumedRowHeight&&(l=t.Constants.defaultAssumedRowHeight);var c=n.mouseresizedisplay;c.innerHTML='<table cellpadding="0" cellspacing="0"><tr><td style="width:100px;border:1px dashed black;background-color:white;height:'+(l-2)+'px;">&nbsp;</td><td><div style="font-size:small;color:white;background-color:gray;padding:4px;">'+l+"</div></td></tr></table>",t.setStyles(c.firstChild.lastChild.firstChild.childNodes[0],"filter:alpha(opacity=85);opacity:.5;")}t.StopPropagation(i)}},t.ProcessEditorRowsizeMouseUp=function(o){var i=o||e.event,n=t.EditorMouseInfo,r=n.editor;if(r){element=n.element;var a=t.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight,s=i.clientY-a;if(t.RemoveMouseMoveUp(t.ProcessEditorRowsizeMouseMove,t.ProcessEditorRowsizeMouseUp,r.toplevel,i),n.mouserowtounhide)r.EditorScheduleSheetCommands("set "+n.mouserowtounhide+" hide",!0,!1);else if(n.mouseresizerownum){var l=r.context.rowheight[n.mouseresizerownum]-0+(s-n.mousedownclienty);l<t.Constants.defaultAssumedRowHeight&&(l=t.Constants.defaultAssumedRowHeight),r.EditorScheduleSheetCommands("set "+n.mouseresizerownum+" height "+l,!0,!1),r.timeout&&e.clearTimeout(r.timeout),r.timeout=e.setTimeout(t.FinishColRowSize,1)}return!1}},t.AutoRepeatInfo={timer:null,mouseinfo:null,repeatinterval:1e3,editor:null,repeatcallback:null},t.SetDragAutoRepeat=function(o,i,n){var r,a,s=t.AutoRepeatInfo;if(s.repeatcallback=n,!i)return s.timer&&(e.clearTimeout(s.timer),s.timer=null),void(s.mouseinfo=null);if(s.editor=o,s.mouseinfo&&(i.rowheader||i.rowfooter?i.row!=s.mouseinfo.row&&(r=t.crToCoord(o.ecell.col,i.row),s.repeatcallback?(a=i.row<s.mouseinfo.row?"left":i.row>s.mouseinfo.row?"right":"",s.repeatcallback(r,a)):(o.MoveECell(r),o.MoveECell(r),o.RangeExtend(),o.EditorMouseRange(r))):(i.colheader||i.colfooter)&&i.col!=s.mouseinfo.col&&(r=t.crToCoord(i.col,o.ecell.row),s.repeatcallback?(a=i.row<s.mouseinfo.row?"left":i.row>s.mouseinfo.row?"right":"",s.repeatcallback(r,a)):(o.MoveECell(r),o.RangeExtend(),o.EditorMouseRange(r)))),s.mouseinfo=i,i.distance<5)s.repeatinterval=333;else if(i.distance<10)s.repeatinterval=250;else if(i.distance<25)s.repeatinterval=100;else{if(!(i.distance<35))return void(s.timer&&(e.clearTimeout(s.timer),s.timer=null));s.repeatinterval=75}s.timer||(s.timer=e.setTimeout(t.DragAutoRepeat,s.repeatinterval))},t.DragAutoRepeat=function(){var o,i,n,r=t.AutoRepeatInfo,a=r.mouseinfo;a.rowheader?o="left":a.rowfooter?o="right":a.colheader?o="up":a.colfooter&&(o="down"),r.repeatcallback?(n=t.coordToCr(r.editor.ecell.coord),"left"==o&&n.col>1?n.col--:"right"==o?n.col++:"up"==o&&n.row>1?n.row--:"down"==o&&n.row++,i=t.crToCoord(n.col,n.row),r.repeatcallback(i,o)):(i=r.editor.MoveECellWithKey("[a"+o+"]shifted"),i&&r.editor.EditorMouseRange(i)),r.timer=e.setTimeout(t.DragAutoRepeat,r.repeatinterval)},t.ProcessEditorDblClick=function(o){var i,n,r,a,s=o||e.event,l=t.EditorMouseInfo,c=s.target||s.srcElement;if(!l.ignore){for(a=null;!a&&c;c=c.parentNode)a=t.LookupElement(c,l.registeredElements);if(!a)return void(l.editor=null);i=a.editor;var u=t.GetElementPositionWithScroll(i.toplevel),d=s.clientX-u.left,h=s.clientY-u.top;if(n=t.GridMousePosition(i,d,h),n&&n.coord){switch(l.editor=i,l.element=c,r=i.range,sheetobj=i.context.sheetobj,i.state){case"start":t.EditorOpenCellEdit(i);break;case"input":}t.StopPropagation(s)}}},t.EditorOpenCellEdit=function(e){var t;return e.ecell&&e.inputBox?e.inputBox.element.disabled?!0:(e.inputBox.ShowInputBox(!0),e.inputBox.Focus(),e.inputBox.SetText(""),e.inputBox.DisplayCellContents(),e.inputBox.Select("end"),t=e.workingvalues,t.partialexpr="",t.ecoord=e.ecell.coord,t.erow=e.ecell.row,void(t.ecol=e.ecell.col)):!0},t.EditorProcessKey=function(e,o,i){var n,r,a,s,l=(e.context.sheetobj,e.workingvalues),c=e.range;switch("string"!=typeof o&&(o=""),e.state){case"start":if(i.shiftKey&&"[a"==o.substr(0,2)&&(o+="shifted"),"[enter]"==o&&(o="[adown]"),"[tab]"==o&&(o=i.shiftKey?"[aleft]":"[aright]"),"[a"==o.substr(0,2)||"[pg"==o.substr(0,3)||"[home]"==o)return n=e.MoveECellWithKey(o),!n;if("[del]"==o||"[backspace]"==o){e.noEdit||e.ECellReadonly()||e.EditorApplySetCommandsToRange("empty","");break}if("[esc]"==o){if(c.hasrange){e.RangeRemove(),e.MoveECell(c.anchorcoord);for(s in e.StatusCallback)e.StatusCallback[s].func(e,"specialkey",o,e.StatusCallback[s].params)}return!1}if("[f2]"==o)return e.noEdit||e.ECellReadonly()?!0:(t.EditorOpenCellEdit(e),e.state="inputboxdirect",!1);if(o.length>1&&"["==o.substr(0,1)||0==o.length)return e.ctrlkeyFunction&&o.length>0?e.ctrlkeyFunction(e,o):!0;if(!e.ecell)return!0;if(!e.inputBox)return!0;if(e.ECellReadonly())return!0;e.inputBox.element.disabled=!1,e.state="input",e.inputBox.ShowInputBox(!0),e.inputBox.Focus(),e.inputBox.SetText(o),e.inputBox.Select("end"),l.partialexpr="",l.ecoord=e.ecell.coord,l.erow=e.ecell.row,l.ecol=e.ecell.col,e.RangeRemove();break;case"input":if(a=e.inputBox.GetText(),e.inputBox.skipOne)return!1;if("[esc]"==o||"[enter]"==o||"[tab]"==o||o&&"[a"==o.substr(0,2)){if(("(+-*/,:!&<>=^".indexOf(a.slice(-1))>=0&&"="==a.slice(0,1)||"="==a)&&(l.partialexpr=a),l.partialexpr&&(i.shiftKey&&"[a"==o.substr(0,2)&&(o+="shifted"),r=e.MoveECellWithKey(o)))return e.inputBox.SetText(c.hasrange?l.partialexpr+t.crToCoord(c.left,c.top)+":"+t.crToCoord(c.right,c.bottom):l.partialexpr+r),!1;e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),"[esc]"!=o?(e.EditorSaveEdit(),e.ecell.coord!=l.ecoord&&e.MoveECell(l.ecoord),"[enter]"==o&&(o="[adown]"),"[tab]"==o&&(o=i.shiftKey?"[aleft]":"[aright]"),"[a"==o.substr(0,2)&&e.MoveECellWithKey(o)):(e.inputBox.DisplayCellContents(),e.RangeRemove(),e.MoveECell(l.ecoord));break}return l.partialexpr&&"[backspace]"==o?(e.inputBox.SetText(l.partialexpr),l.partialexpr="",e.RangeRemove(),e.MoveECell(l.ecoord),e.inputBox.ShowInputBox(!0),!1):"[f2]"==o?(e.state="inputboxdirect",!1):(c.hasrange&&e.RangeRemove(),e.MoveECell(l.ecoord),l.partialexpr&&(e.inputBox.ShowInputBox(!0),l.partialexpr=""),!0);case"inputboxdirect":if(a=e.inputBox.GetText(),"[esc]"==o||"[enter]"==o||"[tab]"==o){e.inputBox.Blur(),e.inputBox.ShowInputBox(!1),e.state="start",e.cellhandles.ShowCellHandles(!0),"[esc]"==o?e.inputBox.DisplayCellContents():(e.EditorSaveEdit(),e.ecell.coord!=l.ecoord&&e.MoveECell(l.ecoord),"[enter]"==o&&(o="[adown]"),"[tab]"==o&&(o=i.shiftKey?"[aleft]":"[aright]"),"[a"==o.substr(0,2)&&e.MoveECellWithKey(o));break}return"[f2]"==o?(e.state="input",!1):!0;case"skip-and-start":return e.state="start",e.cellhandles.ShowCellHandles(!0),!1;default:return!0}return!1},t.EditorAddToInput=function(e,t,o){var i=e.workingvalues;if(!e.noEdit&&!e.ECellReadonly())switch(e.state){case"start":e.state="input",e.inputBox.ShowInputBox(!0),e.inputBox.element.disabled=!1,e.inputBox.Focus(),e.inputBox.SetText((o||"")+t),e.inputBox.Select("end"),i.partialexpr="",i.ecoord=e.ecell.coord,i.erow=e.ecell.row,i.ecol=e.ecell.col,e.RangeRemove();break;case"input":case"inputboxdirect":e.inputBox.element.focus(),i.partialexpr&&(e.inputBox.SetText(i.partialexpr),i.partialexpr="",e.RangeRemove(),e.MoveECell(i.ecoord)),e.inputBox.SetText(e.inputBox.GetText()+t)}},t.EditorDisplayCellContents=function(e){e.inputBox&&e.inputBox.DisplayCellContents()},t.EditorSaveEdit=function(e,o){var i,n,r,a,s,l,c=e.context.sheetobj,u=e.workingvalues;r="text t",a="string"==typeof o?o:e.inputBox.GetText(),s=t.GetCellContents(c,u.ecoord)+"",a!=s&&(n=a.charAt(0),"="==n&&-1==a.indexOf("\n")?(r="formula",a=a.substring(1)):"'"==n?(r="text t",a=a.substring(1),i=t.DetermineValueType(a),"t"==i.type.charAt(0)&&(r="text "+i.type)):0==a.length?r="empty":(i=t.DetermineValueType(a),r="n"==i.type&&a==i.value+""?"value n":"t"==i.type.charAt(0)?"text "+i.type:""==i.type?"text t":"constant "+i.type+" "+i.value),"t"==r.charAt(0)&&(a=t.encodeForSave(a)),l="set "+u.ecoord+" "+r+" "+a,e.EditorScheduleSheetCommands(l,!0,!1),"undefined"!=typeof c.ioEventTree&&"undefined"!=typeof c.ioParameterList&&"undefined"!=typeof c.ioEventTree[u.ecoord]&&t.EditedTriggerCell(c.ioEventTree[u.ecoord],u.ecoord,e,c))},t.EditedTriggerCell=function(e,t,o,i){for(var n in e){var r=i.ioParameterList[n];if("undefined"!=typeof r)switch(r.function_name){case"EMAILONEDIT":case"EMAILONEDITIF":cmdline="setemailparameters "+n+" "+t,o.deferredEmailCommands.push({cmdstr:cmdline,saveundo:!1})}}},t.EditorApplySetCommandsToRange=function(e,o){var i,n,r=(e.context.sheetobj,e.ecell),a=e.range;a.hasrange?(coord=t.crToCoord(a.left,a.top)+":"+t.crToCoord(a.right,a.bottom),i="set "+coord+" "+o,n=e.EditorScheduleSheetCommands(i,!0,!1)):(i="set "+r.coord+" "+o,n=e.EditorScheduleSheetCommands(i,!0,!1)),e.DisplayCellContents()},t.EditorProcessMouseWheel=function(e,t,o,i){i.functionobj.editor.busy||(t>0&&i.functionobj.editor.ScrollRelative(!0,Math.floor(1.5*-t)),0>t&&i.functionobj.editor.ScrollRelative(!0,Math.ceil(1.5*-t)))},t.GridMousePosition=function(e,o,i){var n,r,a,s,l,c,u={};for(n=1;n<e.rowpositions.length&&!(e.rowheight[n]&&e.rowpositions[n]+e.rowheight[n]>i);n++);for(a=1;a<e.colpositions.length&&!(e.colwidth[a]&&e.colpositions[a]+e.colwidth[a]>o);a++);if(u.row=n,u.col=a,e.headposition&&1!=t._app){if(o<e.headposition.left&&o>=e.gridposition.left){for(u.rowheader=!0,u.distance=e.headposition.left-o,u.rowtoresize=!1,u.rowselect=!1,l=1;l<e.rowpositions.length;l++)if(e.rowheight[l]&&e.rowpositions[l]+e.rowheight[l]-3<=i&&e.rowpositions[l]+e.rowheight[l]+3>=i){u.rowtoresize=l;break}if((unhide=e.context.rowunhidetop[n])&&(pos=t.GetElementPosition(unhide),o>=pos.left&&o<pos.left+unhide.offsetWidth&&i>=e.rowpositions[n]+e.rowheight[n]-unhide.offsetHeight&&i<e.rowpositions[n]+e.rowheight[n]&&(u.rowtounhide=n+1)),(unhide=e.context.rowunhidebottom[n])&&(pos=t.GetElementPosition(unhide),o>=pos.left&&o<pos.left+unhide.offsetWidth&&i>=e.rowpositions[n]&&i<e.rowpositions[n]+unhide.offsetHeight&&(u.rowtounhide=n-1)),null==u.rowtounhide){for(r=0;r<e.context.rowpanes.length;r++)if(u.rowtoresize>=e.context.rowpanes[r].first&&u.rowtoresize<=e.context.rowpanes[r].last)return u;u.rowselect=!0}return delete u.rowtoresize,u}if(i<e.headposition.top&&i>e.gridposition.top){for(u.colheader=!0,u.distance=e.headposition.top-i,u.coltoresize=!1,u.colselect=!1,c=1;c<e.colpositions.length;c++)if(e.colwidth[c]&&e.colpositions[c]+e.colwidth[c]-3<=o&&e.colpositions[c]+e.colwidth[c]+3>=o){u.coltoresize=c;break}if((unhide=e.context.colunhideleft[a])&&(pos=t.GetElementPosition(unhide),o>=pos.left&&o<pos.left+unhide.offsetWidth&&i>=pos.top&&i<pos.top+unhide.offsetHeight&&(u.coltounhide=a+1)),(unhide=e.context.colunhideright[a])&&(pos=t.GetElementPosition(unhide),o>=pos.left&&o<pos.left+unhide.offsetWidth&&i>=pos.top&&i<pos.top+unhide.offsetHeight&&(u.coltounhide=a-1)),null==u.coltounhide){for(s=0;s<e.context.colpanes.length;s++)if(u.coltoresize>=e.context.colpanes[s].first&&u.coltoresize<=e.context.colpanes[s].last)return u;u.colselect=!0}return delete u.coltoresize,u}return o>=e.verticaltablecontrol.controlborder?(u.rowfooter=!0,u.distance=o-e.verticaltablecontrol.controlborder,u):i>=e.horizontaltablecontrol.controlborder?(u.colfooter=!0,u.distance=i-e.horizontaltablecontrol.controlborder,u):o<e.gridposition.left?(u.rowheader=!0,u.distance=e.headposition.left-o,u):i<=e.gridposition.top?(u.colheader=!0,u.distance=e.headposition.top-i,u):(u.coord=t.crToCoord(u.col,u.row),e.context.cellskip[u.coord]&&(u.coord=e.context.cellskip[u.coord]),u)}return null},t.GetEditorCellElement=function(e,o,i){var n=0,r=0;if(0==e.context.showRCHeaders)var n=-1,r=-1;var a,s,l,c,u=0,d=0;for(a=0;a<e.context.rowpanes.length;a++){if(o>=e.context.rowpanes[a].first&&o<=e.context.rowpanes[a].last)for(s=0;s<e.context.colpanes.length;s++){if(i>=e.context.colpanes[s].first&&i<=e.context.colpanes[s].last){for(u+=o-e.context.rowpanes[a].first+2,l=e.context.colpanes[s].first;i>=l;l++)c=e.context.cellskip[t.crToCoord(l,o)],c&&e.context.CoordInPane(c,a,s)||d++;return{element:e.griddiv.firstChild.lastChild.childNodes[u+r].childNodes[d+n],rowpane:a,colpane:s}}for(l=e.context.colpanes[s].first;l<=e.context.colpanes[s].last;l++)c=e.context.cellskip[t.crToCoord(l,o)],c&&e.context.CoordInPane(c,a,s)||d++;d+=1}u+=e.context.rowpanes[a].last-e.context.rowpanes[a].first+1+1}return null},t.MoveECellWithKey=function(e,o){var i,n,r,a,s=!1,l=1;if(!e.ecell)return null;switch("shifted"==o.slice(-7)&&(o=o.slice(0,-7),s=!0),n=e.ecell.row,r=e.ecell.col,a=e.context.sheetobj.cells[e.ecell.coord],o){case"[adown]":n+=a&&a.rowspan||1;break;case"[aup]":n--,l=-1;break;case"[pgdn]":n+=e.pageUpDnAmount-1+(a&&a.rowspan||1);break;case"[pgup]":n-=e.pageUpDnAmount,l=-1;break;case"[aright]":r+=a&&a.colspan||1;break;case"[aleft]":r--,l=-1;break;case"[home]":n=1,r=1;break;default:return null}for(e.context.sheetobj.attribs.usermaxcol&&(r=Math.min(e.context.sheetobj.attribs.usermaxcol,r)),e.context.sheetobj.attribs.usermaxrow&&(n=Math.min(e.context.sheetobj.attribs.usermaxrow,n));"yes"==e.context.sheetobj.colattribs.hide[t.rcColname(r)];)r+=l,1>r&&(l=-l,r=1);for(;"yes"==e.context.sheetobj.rowattribs.hide[n];)n+=l,1>n&&(l=-l,n=1);return e.range.hasrange||s&&e.RangeAnchor(),i=e.MoveECell(t.crToCoord(r,n)),e.range.hasrange&&(s?e.RangeExtend():e.RangeRemove()),i},t.MoveECell=function(e,o){var i,n,r=e.context.highlights,a=t.coordToCr(o);if(e.context.sheetobj.attribs.usermaxcol&&a.col>e.context.sheetobj.attribs.usermaxcol&&(a.col=e.context.sheetobj.attribs.usermaxcol),e.context.sheetobj.attribs.usermaxrow&&a.row>e.context.sheetobj.attribs.usermaxrow&&(a.row=e.context.sheetobj.attribs.usermaxrow),o=t.crToCoord(a.col,a.row),e.ecell){if(e.ecell.coord==o)return o;i=t.GetEditorCellElement(e,e.ecell.row,e.ecell.col),delete r[e.ecell.coord],e.range2.hasrange&&e.ecell.row>=e.range2.top&&e.ecell.row<=e.range2.bottom&&e.ecell.col>=e.range2.left&&e.ecell.col<=e.range2.right&&(r[e.ecell.coord]="range2"),e.UpdateCellCSS(i,e.ecell.row,e.ecell.col),e.SetECellHeaders(""),e.cellhandles&&e.cellhandles.ShowCellHandles(!1)
}o=e.context.cellskip[o]||o,e.ecell=t.coordToCr(o),e.ecell.coord=o,i=t.GetEditorCellElement(e,e.ecell.row,e.ecell.col),r[o]="cursor";for(n in e.MoveECellCallback)e.MoveECellCallback[n](e);e.UpdateCellCSS(i,e.ecell.row,e.ecell.col),e.SetECellHeaders("selected");for(n in e.StatusCallback)e.StatusCallback[n].func(e,"moveecell",o,e.StatusCallback[n].params);return e.busy?e.ensureecell=!0:(e.ensureecell=!1,e.EnsureECellVisible()),o},t.EnsureECellVisible=function(e){var t=0,o=0;e.ecell.row>e.lastnonscrollingrow&&(e.ecell.row<e.firstscrollingrow?t=e.ecell.row-e.firstscrollingrow-Math.floor((e.lastvisiblerow-e.firstscrollingrow)/2):e.ecell.row+1>e.lastvisiblerow&&(t=e.ecell.row-e.lastvisiblerow+Math.floor((e.lastvisiblerow-e.firstscrollingrow)/2))),e.ecell.col>e.lastnonscrollingcol&&(e.ecell.col<e.firstscrollingcol?o=e.ecell.col-e.firstscrollingcol-Math.floor((e.lastvisiblecol-e.firstscrollingcol)/2):e.ecell.col+1>e.lastvisiblecol&&(o=e.ecell.col-e.lastvisiblecol+Math.floor((e.lastvisiblecol-e.firstscrollingcol)/2))),0!=t||0!=o?e.ScrollRelativeBoth(t,o):e.cellhandles.ShowCellHandles(!0)},t.ReplaceCell=function(e,t,o,i){var n,r;if(t&&(n=e.context.RenderCell(o,i,t.rowpane,t.colpane,!0,null),n&&t.element)){t.element.innerHTML=n.innerHTML,t.element.style.cssText="",t.element.className=n.className;for(r in n.style)"cssText"!=n.style[r]&&(t.element.style[r]=n.style[r])}},t.UpdateCellCSS=function(e,t,o,i){var n,r;if(t&&(n=e.context.RenderCell(o,i,t.rowpane,t.colpane,!0,null))){t.element.style.cssText="",t.element.className=n.className;for(r in n.style)"cssText"!=n.style[r]&&(t.element.style[r]=n.style[r])}},t.SetECellHeaders=function(e,o){if(e.context.showRCHeaders!==!1){var i,n,r,a,s,l=e.ecell,c=e.context,u=0,d=0;if(l){for(;"yes"==c.sheetobj.colattribs.hide[t.rcColname(l.col)];)l.col++;for(;"yes"==c.sheetobj.rowattribs.hide[l.row];)l.row++;for(l.coord=t.crToCoord(l.col,l.row),i=0;i<c.rowpanes.length;i++){if(r=c.rowpanes[i].first,a=c.rowpanes[i].last,l.row>=r&&l.row<=a){var h=2+u+l.row-r;null!==e.fullgrid&&h>=0&&(s=e.fullgrid.childNodes[1].childNodes[h].childNodes[0],s&&(c.classnames&&(s.className=c.classnames[o+"rowname"]),c.explicitStyles&&(s.style.cssText=c.explicitStyles[o+"rowname"]),s.style.verticalAlign="top"))}u+=a-r+1+1}for(n=0;n<c.colpanes.length;n++){if(r=c.colpanes[n].first,a=c.colpanes[n].last,l.col>=r&&l.col<=a){var h=1+d+l.col-r;null!==e.fullgrid&&h>=0&&(s=e.fullgrid.childNodes[1].childNodes[1].childNodes[h],s&&(c.classnames&&(s.className=c.classnames[o+"colname"]),c.explicitStyles&&(s.style.cssText=c.explicitStyles[o+"colname"])))}d+=a-r+1+1}}}},t.ECellReadonly=function(e,t){if(!t&&e.ecell&&(t=e.ecell.coord),!t)return!1;var o=e.context.sheetobj.cells[t];return o&&o.readonly},t.RangeAnchor=function(e,t){e.range.hasrange&&e.RangeRemove(),e.RangeExtend(t)},t.RangeExtend=function(e,o){var i,n,r,a,s,l,c,u=e.context.highlights,d=e.range,h=e.range2;if(o?(c=t.coordToCr(o),c.coord=o):c=e.ecell,c){d.hasrange||(d.anchorcoord=c.coord,d.anchorrow=c.row,d.top=c.row,d.bottom=c.row,d.anchorcol=c.col,d.left=c.col,d.right=c.col,d.hasrange=!0),d.anchorrow<c.row?(d.top=d.anchorrow,d.bottom=c.row):(d.top=c.row,d.bottom=d.anchorrow),d.anchorcol<c.col?(d.left=d.anchorcol,d.right=c.col):(d.left=c.col,d.right=d.anchorcol);for(r in u)switch(u[r]){case"range":u[r]="unrange";break;case"range2":u[r]="unrange2"}for(a=d.top;a<=d.bottom;a++)for(s=d.left;s<=d.right;s++)switch(r=t.crToCoord(s,a),u[r]){case"unrange":u[r]="range";break;case"cursor":break;case"unrange2":default:u[r]="newrange"}for(a=h.top;h.hasrange&&a<=h.bottom;a++)for(s=h.left;s<=h.right;s++)switch(r=t.crToCoord(s,a),u[r]){case"unrange2":u[r]="range2";break;case"range":case"newrange":case"cursor":break;default:u[r]="newrange2"}for(r in u){switch(u[r]){case"unrange":delete u[r];break;case"newrange":u[r]="range";break;case"newrange2":u[r]="range2";break;case"range":case"range2":case"cursor":continue}n=t.coordToCr(r),i=t.GetEditorCellElement(e,n.row,n.col),e.UpdateCellCSS(i,n.row,n.col)}for(l in e.RangeChangeCallback)e.RangeChangeCallback[l](e);r=t.crToCoord(e.range.left,e.range.top),(e.range.left!=e.range.right||e.range.top!=e.range.bottom)&&(r+=":"+t.crToCoord(e.range.right,e.range.bottom));for(l in e.StatusCallback)e.StatusCallback[l].func(e,"rangechange",r,e.StatusCallback[l].params)}},t.RangeRemove=function(e){var o,i,n,r,a,s,l=e.context.highlights,c=e.range,u=e.range2;if(c.hasrange||u.hasrange){for(r=u.top;u.hasrange&&r<=u.bottom;r++)for(a=u.left;a<=u.right;a++)switch(n=t.crToCoord(a,r),l[n]){case"range":l[n]="newrange2";break;case"range2":case"cursor":break;default:l[n]="newrange2"}for(n in l){switch(l[n]){case"range":delete l[n];break;case"newrange2":l[n]="range2";break;case"cursor":continue}i=t.coordToCr(n),o=t.GetEditorCellElement(e,i.row,i.col),e.UpdateCellCSS(o,i.row,i.col)}c.hasrange=!1;for(s in e.RangeChangeCallback)e.RangeChangeCallback[s](e);for(s in e.StatusCallback)e.StatusCallback[s].func(e,"rangechange","",e.StatusCallback[s].params)}},t.Range2Remove=function(e){var o,i,n,r=e.context.highlights,a=e.range2;if(a.hasrange){for(n in r){switch(r[n]){case"range2":delete r[n];break;case"range":case"cursor":continue}i=t.coordToCr(n),o=t.GetEditorCellElement(e,i.row,i.col),e.UpdateCellCSS(o,i.row,i.col)}a.hasrange=!1}},t.FitToEditTable=function(e){{var o,i,n,r,a,s,l,c,u=e.context,d=u.sheetobj;d.colattribs}for(r=u.showRCHeaders?u.rownamewidth-0:0,colpane=0;colpane<u.colpanes.length-1;colpane++)for(o=u.colpanes[colpane].first;o<=u.colpanes[colpane].last;o++)i=t.rcColname(o),"yes"!=d.colattribs.hide[i]&&(n=d.colattribs.width[i]||d.attribs.defaultcolwidth||t.Constants.defaultColWidth,("blank"==n||"auto"==n)&&(n=""),r+=n&&n-0>0?n-0:10);for(o=u.colpanes[colpane].first;1e4>=o&&(i=t.rcColname(o),"yes"!=d.colattribs.hide[i]&&(n=d.colattribs.width[i]||d.attribs.defaultcolwidth||t.Constants.defaultColWidth,("blank"==n||"auto"==n)&&(n=""),r+=n&&n-0>0?n-0:10),!(r>e.tablewidth));o++);u.colpanes[colpane].last=u.sheetobj.attribs.usermaxcol||o;for(var h=u.rowpanes[0].first,p=u.sheetobj.attribs.lastrow;"yes"==d.rowattribs.hide[h]&&p>h;)h++;for(u.rowpanes[0].first=h,a=u.showRCHeaders?1:0,l=0;l<u.rowpanes.length-1;l++)for(a+=u.rowpanes[l].last-u.rowpanes[l].first+1,s=u.rowpanes[l].first;s<=u.rowpanes[l].last;s++)"yes"==d.rowattribs.hide[s]&&a--;c=e.tableheight-a*u.pixelsPerRow,u.rowpanes[l].last=u.sheetobj.attribs.usermaxrow||u.rowpanes[l].first+Math.floor(c/u.pixelsPerRow)+1},t.CalculateEditorPositions=function(e){var o,i,n;e.gridposition=t.GetElementPosition(e.griddiv);var r=e.griddiv.firstChild.lastChild.childNodes[1].childNodes[0];for(e.headposition=t.GetElementPosition(r),e.headposition.left+=r.offsetWidth,e.headposition.top+=r.offsetHeight,e.rowpositions=[],o=0;o<e.context.rowpanes.length;o++)e.CalculateRowPositions(o,e.rowpositions,e.rowheight);for(n=0;n<e.rowpositions.length&&!(e.rowpositions[n]>e.gridposition.top+e.tableheight);n++);for(e.lastvisiblerow=n-1,e.colpositions=[],i=0;i<e.context.colpanes.length;i++)e.CalculateColPositions(i,e.colpositions,e.colwidth);for(n=0;n<e.colpositions.length&&!(e.colpositions[n]>e.gridposition.left+e.tablewidth);n++);for(e.lastvisiblecol=n-1,e.firstscrollingrow=e.context.rowpanes[e.context.rowpanes.length-1].first;"yes"==e.context.sheetobj.rowattribs.hide[e.firstscrollingrow];)e.firstscrollingrow++;for(e.firstscrollingrowtop=e.rowpositions[e.firstscrollingrow]||e.headposition.top,e.lastnonscrollingrow=e.context.rowpanes.length-1>0?e.context.rowpanes[e.context.rowpanes.length-2].last:0,e.firstscrollingcol=e.context.colpanes[e.context.colpanes.length-1].first;"yes"==e.context.sheetobj.colattribs.hide[t.rcColname(e.firstscrollingcol)];)e.firstscrollingcol++;e.firstscrollingcolleft=e.colpositions[e.firstscrollingcol]||e.headposition.left,e.lastnonscrollingcol=e.context.colpanes.length-1>0?e.context.colpanes[e.context.colpanes.length-2].last:0,e.verticaltablecontrol.ComputeTableControlPositions(),e.horizontaltablecontrol.ComputeTableControlPositions()},t.ScheduleRender=function(o){1!=o.ignoreRender&&(o.timeout&&e.clearTimeout(o.timeout),t.EditorSheetStatusCallback(null,"schedrender",null,o),o.timeout=e.setTimeout(function(){t.DoRenderStep(o)},1))},t.DoRenderStep=function(o){o.timeout=null,o.EditorRenderSheet(),t.EditorSheetStatusCallback(null,"renderdone",null,o),t.EditorSheetStatusCallback(null,"schedposcalc",null,o),o.timeout=e.setTimeout(function(){t.DoPositionCalculations(o)},1)},t.SchedulePositionCalculations=function(o){t.EditorSheetStatusCallback(null,"schedposcalc",null,o),o.timeout=e.setTimeout(function(){t.DoPositionCalculations(o)},1)},t.DoPositionCalculations=function(e){e.timeout=null,e.CalculateEditorPositions(),e.verticaltablecontrol.PositionTableControlElements(),e.horizontaltablecontrol.PositionTableControlElements(),t.EditorSheetStatusCallback(null,"doneposcalc",null,e),e.ensureecell&&e.ecell&&!e.deferredCommands.length&&(e.ensureecell=!1,e.EnsureECellVisible()),e.cellhandles.ShowCellHandles(!0)},t.CalculateRowPositions=function(e,t,o,i){{var n,r,a,s,l,c,u=e.context;u.sheetobj}if(u.showRCHeaders){for(c=e.fullgrid.lastChild,n=2,r=0;t>r;r++)n+=u.rowpanes[r].last-u.rowpanes[r].first+2;for(s=0,a=u.rowpanes[r].first;a<=u.rowpanes[r].last;a++)l=c.childNodes[n+s],s++,l&&(o[a]||(o[a]=l.firstChild.offsetTop,i[a]=l.firstChild.offsetHeight))}},t.CalculateColPositions=function(e,o,i,n){{var r,a,s,l,c,u,d,h=e.context;h.sheetobj}if(h.showRCHeaders){for(d=e.fullgrid.lastChild,r=1,a=0;o>a;a++)r+=h.colpanes[a].last-h.colpanes[a].first+2;for(c=d.childNodes[1],l=0,s=h.colpanes[a].first;s<=h.colpanes[a].last;s++)u=t.GetElementPosition(c.childNodes[r+l]),i[s]||(i[s]=u.left,c.childNodes[r+l]&&(n[s]=c.childNodes[r+l].offsetWidth)),l++}},t.ScrollRelative=function(e,t,o){t?e.ScrollRelativeBoth(o,0):e.ScrollRelativeBoth(0,o)},t.ScrollRelativeBoth=function(e,o,i){var n=e.context,r=o>0?1:-1,a=i>0?1:-1,s=n.rowpanes.length,l=s>1?n.rowpanes[s-2].last+1:1;n.rowpanes[s-1].first+o<l&&(o=-n.rowpanes[s-1].first+l);var c=n.colpanes.length,u=c>1?n.colpanes[c-2].last+1:1;for(n.colpanes[c-1].first+i<u&&(i=-n.colpanes[c-1].first+u);"yes"==n.sheetobj.colattribs.hide[t.rcColname(n.colpanes[c-1].first+i)];)if(i+=a,1>i){i=0;break}for(;"yes"==n.sheetobj.rowattribs.hide[n.rowpanes[s-1].first+o];)if(o+=r,1>o){o=0;break}return 1!=o&&-1!=o||0!=i?void((0!=o||0!=i)&&(n.rowpanes[s-1].first+=o,n.rowpanes[s-1].last+=o,n.colpanes[c-1].first+=i,n.colpanes[c-1].last+=i,e.LimitLastPanes(),e.FitToEditTable(),e.ScheduleRender())):(1==o?e.ScrollTableUpOneRow():e.ScrollTableDownOneRow(),e.ecell&&e.SetECellHeaders("selected"),void e.SchedulePositionCalculations())},t.PageRelative=function(e,o,i){var n,r,a,s,l=e.context,c=o?"rowpanes":"colpanes",u=l[c][l[c].length-1],d=o?"lastvisiblerow":"lastvisiblecol",h=o?e.rowheight:e.colwidth,p=o?t.Constants.defaultAssumedRowHeight:t.Constants.defaultColWidth;if(i>0)r=e[d],r==u.first&&(r+=1);else{for(a=o?e.tableheight-(e.firstscrollingrowtop-e.gridposition.top):e.tablewidth-(e.firstscrollingcolleft-e.gridposition.left),a-=h[e[d]]>0?h[e[d]]:p,r=u.first-1;r>0&&(n=h[r]>0?h[r]:p,!(n>a));r--)a-=n;s=u.first,r>=s&&(r=s-1),1>r&&(r=1)}u.first=r,u.last=r+1,e.LimitLastPanes(),e.FitToEditTable(),e.ScheduleRender()},t.LimitLastPanes=function(e){var t,o=e.context;t=o.rowpanes.length,t>1&&o.rowpanes[t-1].first<=o.rowpanes[t-2].last&&(o.rowpanes[t-1].first=o.rowpanes[t-2].last+1),o.sheetobj.attribs.usermaxrow&&o.rowpanes[t-1].first>o.sheetobj.attribs.usermaxrow&&(o.rowpanes[t-1].first=o.sheetobj.attribs.usermaxrow),t=o.colpanes.length,t>1&&o.colpanes[t-1].first<=o.colpanes[t-2].last&&(o.colpanes[t-1].first=o.colpanes[t-2].last+1),o.sheetobj.attribs.usermaxcol&&o.colpanes[t-1].first>o.sheetobj.attribs.usermaxcol&&(o.colpanes[t-1].first=o.sheetobj.attribs.usermaxcol)},t.ScrollTableUpOneRow=function(e){var o,i,n,r,a,s,l,c,u,d,h,p,f={},m=e.context,g=m.sheetobj,v=e.fullgrid;for(p=v.lastChild,o=m.showRCHeaders?2:1,i=0;i<m.rowpanes.length-1;i++)o+=m.rowpanes[i].last-m.rowpanes[i].first+2;if(m.sheetobj.attribs.usermaxrow&&m.sheetobj.attribs.usermaxrow-m.rowpanes[i].first<1)return v;for(p.removeChild(p.childNodes[o]),m.rowpanes[i].first++,m.rowpanes[i].last++,e.FitToEditTable(),m.CalculateColWidthData(),m.sheetobj.attribs.usermaxrow&&m.rowpanes[i].last==m.sheetobj.attribs.usermaxrow||(c=m.RenderRow(m.rowpanes[i].last,i),p.appendChild(c)),maxrowspan=1,l=m.rowpanes[i].first-1,a=0;a<m.colpanes.length;a++)for(r=m.colpanes[a].first;r<=m.colpanes[a].last;r++)coord=t.crToCoord(r,l),m.cellskip[coord]||(s=g.cells[coord],s&&s.rowspan>maxrowspan&&(maxrowspan=s.rowspan));if(maxrowspan>1)for(n=1;maxrowspan>n&&!(n+l>=m.rowpanes[i].last);n++)u=m.RenderRow(n+l,i),d=p.childNodes[o+n-1],p.replaceChild(u,d);for(h=m.rowpanes[i].last,a=0;a<m.colpanes.length;a++)for(r=m.colpanes[a].first;r<=m.colpanes[a].last;r++)coord=m.cellskip[t.crToCoord(r,h)],coord&&(n=m.coordToCR[coord].row-0,n==m.rowpanes[i].last||n<m.rowpanes[i].first||(s=g.cells[coord],s&&s.rowspan>1&&(f[n]=!0)));for(n in f)u=m.RenderRow(n,i),d=p.childNodes[o+(n-m.rowpanes[i].first)],p.replaceChild(u,d);return v},t.ScrollTableDownOneRow=function(e){var o,i,n,r,a,s,l,c,u,d,h,p={},f=e.context,m=f.sheetobj,g=e.fullgrid;for(h=g.lastChild,o=f.showRCHeaders?2:1,i=0;i<f.rowpanes.length-1;i++)o+=f.rowpanes[i].last-f.rowpanes[i].first+2;for(f.sheetobj.attribs.usermaxrow||h.removeChild(h.childNodes[o+(f.rowpanes[i].last-f.rowpanes[i].first)]),f.rowpanes[i].first--,f.rowpanes[i].last--,e.FitToEditTable(),f.CalculateColWidthData(),c=f.RenderRow(f.rowpanes[i].first,i),h.insertBefore(c,h.childNodes[o]),maxrowspan=1,l=f.rowpanes[i].first,a=0;a<f.colpanes.length;a++)for(r=f.colpanes[a].first;r<=f.colpanes[a].last;r++)coord=t.crToCoord(r,l),f.cellskip[coord]||(s=m.cells[coord],s&&s.rowspan>maxrowspan&&(maxrowspan=s.rowspan));if(maxrowspan>1)for(n=1;maxrowspan>n&&!(n+l>f.rowpanes[i].last);n++)c=f.RenderRow(n+l,i),u=h.childNodes[o+n],h.replaceChild(c,u);for(d=f.rowpanes[i].last,a=0;a<f.colpanes.length;a++)for(r=f.colpanes[a].first;r<=f.colpanes[a].last;r++)coord=t.crToCoord(r,d),s=m.cells[coord],s&&s.rowspan>1?p[d]=!0:(coord=f.cellskip[t.crToCoord(r,d)],coord&&(n=f.coordToCR[coord].row-0,n==d||n<f.rowpanes[i].first||(s=m.cells[coord],s&&s.rowspan>1&&(p[n]=!0))));for(n in p)c=f.RenderRow(n,i),u=h.childNodes[o+(n-f.rowpanes[i].first)],h.replaceChild(c,u);return g},t.InputBox=function(e,o){e&&(this.element=e,this.editor=o,this.inputEcho=null,o.inputBox=this,e.onmousedown=t.InputBoxOnMouseDown,o.MoveECellCallback.formulabar=function(e){"start"==e.state&&o.inputBox.DisplayCellContents(e.ecell.coord)})},t.InputBox.prototype.DisplayCellContents=function(e){t.InputBoxDisplayCellContents(this,e)},t.InputBox.prototype.ShowInputBox=function(e){this.editor.inputEcho.ShowInputEcho(e)},t.InputBox.prototype.GetText=function(){return this.element.value},t.InputBox.prototype.SetText=function(e){this.element&&(this.element.value=e,this.editor.inputEcho.SetText(e+"_"))},t.InputBox.prototype.Focus=function(){t.InputBoxFocus(this)},t.InputBox.prototype.Blur=function(){return this.element.blur()},t.InputBox.prototype.Select=function(e){if(this.element)switch(e){case"end":if(document.selection&&document.selection.createRange)try{var t=document.selection.createRange().duplicate();t.moveToElementText(this.element),t.collapse(!1),t.select()}catch(o){void 0!=this.element.selectionStart&&(this.element.selectionStart=this.element.value.length,this.element.selectionEnd=this.element.value.length)}else void 0!=this.element.selectionStart&&(this.element.selectionStart=this.element.value.length,this.element.selectionEnd=this.element.value.length)}},t.InputBoxDisplayCellContents=function(e,o){var i=t.Constants;if(e){if(!o){if(!e.editor)return;if(!e.editor.ecell)return;o=e.editor.ecell.coord}var n=t.GetCellContents(e.editor.context.sheetobj,o);-1!=n.indexOf("\n")?(n=i.s_inputboxdisplaymultilinetext,e.element.disabled=!0):e.element.disabled=e.editor.ECellReadonly()?!0:!1,e.SetText(n)}},t.InputBoxFocus=function(e){if(e){e.element.focus();var t=e.editor;t.state="input";var o=t.workingvalues;o.partialexpr="",o.ecoord=t.ecell.coord,o.erow=t.ecell.row,o.ecol=t.ecell.col}},t.InputBoxOnMouseDown=function(){var e=t.Keyboard.focusTable;if(!e)return!0;var o=e.workingvalues;switch(e.state){case"start":e.state="inputboxdirect",o.partialexpr="",o.ecoord=e.ecell.coord,o.erow=e.ecell.row,o.ecol=e.ecell.col,e.inputEcho.ShowInputEcho(!0);break;case"input":o.partialexpr="",e.MoveECell(o.ecoord),e.state="inputboxdirect",t.KeyboardFocus();break;case"inputboxdirect":}},t.InputEcho=function(e){var o=t.Constants;this.editor=e,this.text="",this.interval=null,this.container=null,this.main=null,this.prompt=null,this.hint=null,this.functionbox=null,this.container=document.createElement("div"),t.setStyles(this.container,"display:none;position:absolute;zIndex:10;"),this.main=document.createElement("div"),o.defaultInputEchoClass&&(this.main.className=o.defaultInputEchoClass),o.defaultInputEchoStyle&&t.setStyles(this.main,o.defaultInputEchoStyle),this.main.innerHTML="&nbsp;",this.hint=document.createElement("div"),o.defaultInputEchoHintClass&&(this.hint.className=o.defaultInputEchoHintClass),o.defaultInputEchoHintStyle&&t.setStyles(this.hint,o.defaultInputEchoHintStyle),this.hint.innerHTML="",this.container.appendChild(this.hint),this.container.appendChild(this.main),this.prompt=document.createElement("div"),o.defaultInputEchoPromptClass&&(this.prompt.className=o.defaultInputEchoPromptClass),o.defaultInputEchoPromptStyle&&t.setStyles(this.prompt,o.defaultInputEchoPromptStyle),this.prompt.innerHTML="",this.container.appendChild(this.prompt),t.DragRegister(this.main,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:this.container},this.editor.toplevel),e.toplevel.appendChild(this.container)},t.InputEcho.prototype.ShowInputEcho=function(e){return t.ShowInputEcho(this,e)},t.InputEcho.prototype.SetText=function(e){return t.SetInputEchoText(this,e)},t.ShowInputEcho=function(o,i){var n,r,a=o.editor;a&&(i?(a.cellhandles.ShowCellHandles(!1),n=t.GetEditorCellElement(a,a.ecell.row,a.ecell.col),n&&(r=t.GetElementPosition(n.element),o.container.style.left=r.left-1+"px",o.container.style.top=r.top-1+"px"),o.hint.innerHTML=a.ecell.coord,o.container.style.display="block",o.interval&&e.clearInterval(o.interval),o.interval=e.setInterval(t.InputEchoHeartbeat,50)):(o.interval&&e.clearInterval(o.interval),o.container.style.display="none"))},t.SetInputEchoText=function(e,o){var i,n,r=t.Constants,a=t.special_chars(o);a=a.replace(/\n/g,"<br>"),e.text!=a&&(e.main.innerHTML=a,e.text=a);var s=o.match(/.*[\+\-\*\/\&\^\<\>\=\,\(]([A-Za-z][A-Za-z][\w\.]*?)\([^\)]*$/);"="==o.charAt(0)&&s?(i=s[1].toUpperCase(),t.Formula.FunctionList[i]?(t.Formula.FillFunctionInfo(),n=t.special_chars(i+"("+t.Formula.FunctionArgString(i)+")")):n=r.ietUnknownFunction+i,e.prompt.innerHTML!=n&&(e.prompt.innerHTML=n,e.prompt.style.display="block")):"none"!=e.prompt.style.display&&(e.prompt.innerHTML="",e.prompt.style.display="none")},t.InputEchoHeartbeat=function(){var e=t.Keyboard.focusTable;return e?void e.inputEcho.SetText(e.inputBox.GetText()+"_"):!0},t.InputEchoMouseDown=function(o){var i=(o||e.event,t.Keyboard.focusTable);return i?void i.inputBox.element.focus():!0},t.CellHandles=function(e){t.Constants;if(!e.noEdit){this.editor=e,this.noCursorSuffix=!1,this.movedmouse=!1,this.draghandle=document.createElement("div"),t.setStyles(this.draghandle,"display:none;position:absolute;zIndex:8;border:1px solid white;width:4px;height:4px;fontSize:1px;backgroundColor:#0E93D8;cursor:default;"),this.draghandle.innerHTML="&nbsp;",e.toplevel.appendChild(this.draghandle),t.AssignID(e,this.draghandle,"draghandle");var o="png";if(navigator.userAgent.match(/MSIE 6\.0/)&&(o="gif"),this.dragpalette=document.createElement("div"),t.setStyles(this.dragpalette,"display:none;position:absolute;zIndex:8;width:90px;height:90px;fontSize:1px;textAlign:center;cursor:default;backgroundImage:url("+t.Constants.defaultImagePrefix+"drag-handles."+o+");"),this.dragpalette.innerHTML="&nbsp;",e.toplevel.appendChild(this.dragpalette),t.AssignID(e,this.dragpalette,"dragpalette"),this.dragtooltip=document.createElement("div"),t.setStyles(this.dragtooltip,"display:none;position:absolute;zIndex:9;border:1px solid black;width:100px;height:auto;fontSize:10px;backgroundColor:#FFFFFF;"),this.dragtooltip.innerHTML="&nbsp;",e.toplevel.appendChild(this.dragtooltip),t.AssignID(e,this.dragtooltip,"dragtooltip"),this.fillinghandle=document.createElement("div"),t.setStyles(this.fillinghandle,"display:none;position:absolute;zIndex:9;border:1px solid black;width:auto;height:14px;fontSize:10px;backgroundColor:#FFFFFF;"),this.fillinghandle.innerHTML="&nbsp;",e.toplevel.appendChild(this.fillinghandle),t.AssignID(e,this.fillinghandle,"fillinghandle"),this.draghandle.addEventListener)this.draghandle.addEventListener("mousemove",t.CellHandlesMouseMoveOnHandle,!1),this.dragpalette.addEventListener("mousedown",t.CellHandlesMouseDown,!1),this.dragpalette.addEventListener("mousemove",t.CellHandlesMouseMoveOnHandle,!1);else{if(!this.draghandle.attachEvent)throw"Browser not supported";this.draghandle.attachEvent("onmousemove",t.CellHandlesMouseMoveOnHandle),this.dragpalette.attachEvent("onmousedown",t.CellHandlesMouseDown),this.dragpalette.attachEvent("onmousemove",t.CellHandlesMouseMoveOnHandle)}}},t.CellHandles.prototype.ShowCellHandles=function(e,o){return t.ShowCellHandles(this,e,o)},t.ShowCellHandles=function(e,o,i){var n,r,a,s=e.editor,l=!1,c=1,u=1;if(s&&s.ecell){do{if(!o)break;if(r=s.ecell.row,a=s.ecell.col,"start"!=s.state)break;if(r>=s.lastvisiblerow)break;if(a>=s.lastvisiblecol)break;if(r<s.firstscrollingrow)break;if(a<s.firstscrollingcol)break;for(;"yes"==s.context.sheetobj.colattribs.hide[t.rcColname(a+c)];)c++;for(;"yes"==s.context.sheetobj.rowattribs.hide[r+u];)u++;if(n=s.context.sheetobj.cells[t.crToCoord(a+c-1,r+u-1)],"undefined"!=typeof n&&(c+=(n.colspan||1)-1,u+=(n.rowspan||1)-1),s.rowpositions[r+u]+20>s.horizontaltablecontrol.controlborder)break;if(s.rowpositions[r+u]-10<s.headposition.top)break;if(s.colpositions[a+c]+20>s.verticaltablecontrol.controlborder)break;if(s.colpositions[a+c]-30<s.headposition.left)break;e.draghandle.style.left=s.colpositions[a+c]-1+"px",e.draghandle.style.top=s.rowpositions[r+u]-1+"px",e.draghandle.style.display="block",i&&(e.draghandle.style.display="none",e.dragpalette.style.left=s.colpositions[a+c]-45+"px",e.dragpalette.style.top=s.rowpositions[r+u]-45+"px",e.dragpalette.style.display="block",e.dragtooltip.style.left=s.colpositions[a+c]-45+"px",e.dragtooltip.style.top=s.rowpositions[r+u]+45+"px",e.dragtooltip.style.display="none"),l=!0}while(!1);l||(e.draghandle.style.display="none"),i||(e.dragpalette.style.display="none",e.dragtooltip.style.display="none")}},t.CellHandlesMouseMoveOnHandle=function(o){var i=t.Constants,n=o||e.event,r=n.target||n.srcElement,a=t.Keyboard.focusTable;if(!a)return!0;var s=a.cellhandles;if(!s.editor)return!0;var l=t.GetElementPositionWithScroll(a.toplevel),c=n.clientX-l.left,u=n.clientY-l.top;if(!a.cellhandles.mouseDown){if(a.cellhandles.ShowCellHandles(!0,!0),r==s.dragpalette){var d=t.SegmentDivHit([i.CH_radius1,i.CH_radius2],a.cellhandles.dragpalette,c,u);if(0==d)return void t.CellHandlesHoverTimeout()}s.timer&&(e.clearTimeout(s.timer),s.timer=null),s.timer=e.setTimeout(t.CellHandlesHoverTimeout,3e3)}},t.SegmentDivHit=function(e,t,o,i){var n=t.offsetWidth,r=t.offsetHeight,a=t.offsetLeft,s=t.offsetTop,l=0,c=e,u=Math.sqrt(Math.pow(o-a-(n/2-.5),2)+Math.pow(i-s-(r/2-.5),2));if(2==c.length)return o>=a&&a+n/2>o&&i>=s&&s+r/2>i&&(u<=e[0]?l=-1:u<=e[1]&&(l=1)),o>=a+n/2&&a+n>o&&i>=s&&s+r/2>i&&(u<=e[0]?l=-2:u<=e[1]&&(l=2)),o>=a+n/2&&a+n>o&&i>=s+r/2&&s+r>i&&(u<=e[0]?l=-3:u<=e[1]&&(l=3)),o>=a&&a+n/2>o&&i>=s+r/2&&s+r>i&&(u<=e[0]?l=-4:u<=e[1]&&(l=4)),l;for(;;)if(o>=a&&a+n/2>o&&i>=s&&s+r/2>i){if(quadrant+="1",l=c[0],"number"==typeof l)break;c=l,n/=2,r/=2}else if(o>=a+n/2&&a+n>o&&i>=s&&s+r/2>i){if(quadrant+="2",l=c[1],"number"==typeof l)break;c=l,n/=2,a+=n,r/=2}else if(o>=a+n/2&&a+n>o&&i>=s+r/2&&s+r>i){if(quadrant+="3",l=c[2],"number"==typeof l)break;c=l,n/=2,a+=n,r/=2,s+=r}else{if(!(o>=a&&a+n/2>o&&i>=s+r/2&&s+r>i))return 0;if(quadrant+="4",l=c[3],"number"==typeof l)break;c=l,n/=2,r/=2,s+=r}return l},t.CellHandlesHoverTimeout=function(){if(editor=t.Keyboard.focusTable,!editor)return!0;var o=editor.cellhandles;o.timer&&(e.clearTimeout(o.timer),o.timer=null),editor.cellhandles.ShowCellHandles(!0,!1)},t.CellHandlesMouseDown=function(o){var i,n,r,a=t.Constants,s=o||e.event,l=t.EditorMouseInfo;if(i=t.Keyboard.focusTable,!i)return!0;if(!i.busy){var c=i.cellhandles;c.movedmouse=!1;var u=t.GetElementPositionWithScroll(i.toplevel),d=s.clientX-u.left,h=s.clientY-u.top;c.timer&&(e.clearTimeout(c.timer),c.timer=null),c.dragtooltip.innerHTML="&nbsp;",c.dragtooltip.style.display="none",r=i.range;var p=t.SegmentDivHit([a.CH_radius1,a.CH_radius2],i.cellhandles.dragpalette,d,h);if(1==p||-1==p||0==p)return void c.ShowCellHandles(!0,!1);switch(l.ignore=!0,-3==p?(c.dragtype="Fill",c.noCursorSuffix=!1):3==p?(c.dragtype="FillC",c.noCursorSuffix=!1):-2==p?(c.dragtype="Move",c.noCursorSuffix=!0):-4==p?(c.dragtype="MoveI",c.noCursorSuffix=!1):2==p?(c.dragtype="MoveC",c.noCursorSuffix=!0):4==p&&(c.dragtype="MoveIC",c.noCursorSuffix=!1),c.filltype=null,c.dragtype){case"Fill":case"FillC":r.hasrange||i.RangeAnchor(),i.range2.top=i.range.top,i.range2.right=i.range.right,i.range2.bottom=i.range.bottom,i.range2.left=i.range.left,i.range2.hasrange=!0;break;case"Move":case"MoveI":case"MoveC":case"MoveIC":r.hasrange||i.RangeAnchor(),i.range2.top=i.range.top,i.range2.right=i.range.right,i.range2.bottom=i.range.bottom,i.range2.left=i.range.left,i.range2.hasrange=!0,i.RangeRemove();break;default:return}c.fillinghandle.style.left=d+"px",c.fillinghandle.style.top=h-17+"px",c.fillinghandle.innerHTML=a.s_CHindicatorOperationLookup[c.dragtype]+(a.s_CHindicatorDirectionLookup[i.cellhandles.filltype]||""),c.fillinghandle.style.display="block",c.ShowCellHandles(!0,!1),c.mouseDown=!0,l.editor=i,n=i.ecell.coord,c.startingcoord=n,c.startingX=d,c.startingY=h,l.mouselastcoord=n,t.KeyboardSetFocus(i),document.addEventListener?(document.addEventListener("mousemove",t.CellHandlesMouseMove,!0),document.addEventListener("mouseup",t.CellHandlesMouseUp,!0)):c.draghandle.attachEvent&&(c.draghandle.setCapture(),c.draghandle.attachEvent("onmousemove",t.CellHandlesMouseMove),c.draghandle.attachEvent("onmouseup",t.CellHandlesMouseUp),c.draghandle.attachEvent("onlosecapture",t.CellHandlesMouseUp)),t.StopPropagation(s)}},t.CellHandlesMouseMove=function(o){var i,n,r,a,s,l,c,u=t.Constants,d=o||e.event,h=t.EditorMouseInfo;if(i=h.editor){var p=i.cellhandles;n=h.element;var f=t.GetElementPositionWithScroll(i.toplevel),m=d.clientX-f.left,g=d.clientY-f.top;if(r=t.GridMousePosition(i,m,g)){if(r&&!r.coord)return void t.SetDragAutoRepeat(i,r,t.CellHandlesDragAutoRepeat);if(t.SetDragAutoRepeat(i,null),r.coord){switch(a=t.coordToCr(i.cellhandles.startingcoord),s=t.coordToCr(r.coord),p.movedmouse=!0,p.dragtype){case"Fill":case"FillC":r.coord==p.startingcoord?(p.filltype=null,p.startingX=m,p.startingY=g):p.filltype?"Down"==p.filltype?(s.col=a.col,s.row<a.row&&(s.row=a.row)):(s.row=a.row,s.col<a.col&&(s.col=a.col)):(Math.abs(g-p.startingY)>10?p.filltype="Down":Math.abs(m-p.startingX)>10&&(p.filltype="Right"),s.col=a.col,s.row=a.row),r.coord=t.crToCoord(s.col,s.row),r.coord!=h.mouselastcoord&&(i.MoveECell(r.coord),i.RangeExtend());break;case"Move":case"MoveC":r.coord!=h.mouselastcoord&&(i.MoveECell(r.coord),l=i.range2.right-i.range2.left+r.col,c=i.range2.bottom-i.range2.top+r.row,i.RangeAnchor(t.crToCoord(l,c)),i.RangeExtend());break;case"MoveI":case"MoveIC":r.coord==p.startingcoord?(p.filltype=null,p.startingX=m,p.startingY=g):p.filltype?"Vertical"==p.filltype?(s.col=i.range2.left,s.row>=i.range2.top&&s.row<=i.range2.bottom+1&&(s.row=i.range2.bottom+2)):(s.row=i.range2.top,s.col>=i.range2.left&&s.col<=i.range2.right+1&&(s.col=i.range2.right+2)):(Math.abs(g-p.startingY)>10?p.filltype="Vertical":Math.abs(m-p.startingX)>10&&(p.filltype="Horizontal"),s.col=a.col,s.row=a.row),r.coord=t.crToCoord(s.col,s.row),r.coord!=h.mouselastcoord&&(i.MoveECell(r.coord),p.filltype?(l=i.range2.right-i.range2.left+s.col,c=i.range2.bottom-i.range2.top+s.row,i.RangeAnchor(t.crToCoord(l,c)),i.RangeExtend()):i.RangeRemove())}p.fillinghandle.style.left=m+"px",p.fillinghandle.style.top=g-17+"px",p.fillinghandle.innerHTML=u.s_CHindicatorOperationLookup[p.dragtype]+(u.s_CHindicatorDirectionLookup[i.cellhandles.filltype]||""),p.fillinghandle.style.display="block",h.mouselastcoord=r.coord,t.StopPropagation(d)}}}},t.CellHandlesDragAutoRepeat=function(e,o){var i=t.EditorMouseInfo,n=i.editor;if(n){var r,a,s,l=n.cellhandles,c=t.coordToCr(n.cellhandles.startingcoord),u=t.coordToCr(e),d=0,h=0;switch("left"==o?h=-1:"right"==o?h=1:"up"==o?d=-1:"down"==o&&(d=1),n.ScrollRelativeBoth(d,h),l.dragtype){case"Fill":case"FillC":l.filltype?"Down"==l.filltype?(u.col=c.col,u.row<c.row&&(u.row=c.row)):(u.row=c.row,u.col<c.col&&(u.col=c.col)):(u.col=c.col,u.row=c.row),r=t.crToCoord(u.col,u.row),r!=i.mouselastcoord&&(n.MoveECell(e),n.RangeExtend());break;case"Move":case"MoveC":e!=i.mouselastcoord&&(n.MoveECell(e),a=n.range2.right-n.range2.left+n.ecell.col,s=n.range2.bottom-n.range2.top+n.ecell.row,n.RangeAnchor(t.crToCoord(a,s)),n.RangeExtend());break;case"MoveI":case"MoveIC":l.filltype?"Vertical"==l.filltype?(u.col=n.range2.left,u.row>=n.range2.top&&u.row<=n.range2.bottom+1&&(u.row=n.range2.bottom+2)):(u.row=n.range2.top,u.col>=n.range2.left&&u.col<=n.range2.right+1&&(u.col=n.range2.right+2)):(u.col=c.col,u.row=c.row),r=t.crToCoord(u.col,u.row),r!=i.mouselastcoord&&(n.MoveECell(r),a=n.range2.right-n.range2.left+u.col,s=n.range2.bottom-n.range2.top+u.row,n.RangeAnchor(t.crToCoord(a,s)),n.RangeExtend())}i.mouselastcoord=r}},t.CellHandlesMouseUp=function(o){var i,n,r,a,s,l,c,u,d,h,p,f,m=o||e.event,g=t.EditorMouseInfo;if(i=g.editor){var v=i.cellhandles;n=g.element,g.ignore=!1;var b=t.GetElementPositionWithScroll(i.toplevel),y=m.clientX-b.left,C=m.clientY-b.top;switch(r=t.GridMousePosition(i,y,C),t.SetDragAutoRepeat(i,null),v.mouseDown=!1,v.noCursorSuffix=!1,v.fillinghandle.style.display="none",r||(r={}),r.coord||(r.coord=i.ecell.coord),v.dragtype){case"Fill":case"Move":case"MoveI":l=" all";break;case"FillC":case"MoveC":case"MoveIC":l=" formulas"}switch(v.movedmouse||(v.dragtype="Nothing"),v.dragtype){case"Nothing":i.Range2Remove(),i.RangeRemove();break;case"Fill":case"FillC":c=t.coordToCr(v.startingcoord),u=t.coordToCr(r.coord),v.filltype&&("Down"==v.filltype?u.col=c.col:u.row=c.row),r.coord=t.crToCoord(u.col,u.row),i.MoveECell(r.coord),i.RangeExtend(),s="Right"==i.cellhandles.filltype?"right":"down",a="fill"+s+" "+t.crToCoord(i.range.left,i.range.top)+":"+t.crToCoord(i.range.right,i.range.bottom)+l,i.EditorScheduleSheetCommands(a,!0,!1);break;case"Move":case"MoveC":i.context.cursorsuffix="",a="movepaste "+t.crToCoord(i.range2.left,i.range2.top)+":"+t.crToCoord(i.range2.right,i.range2.bottom)+" "+i.ecell.coord+l,i.EditorScheduleSheetCommands(a,!0,!1),i.Range2Remove();break;case"MoveI":case"MoveIC":i.context.cursorsuffix="",d=i.range2.right-i.range2.left,h=i.range2.bottom-i.range2.top,p=i.ecell.col-i.range2.left,f=i.ecell.row-i.range2.top,a="moveinsert "+t.crToCoord(i.range2.left,i.range2.top)+":"+t.crToCoord(i.range2.right,i.range2.bottom)+" "+i.ecell.coord+l,i.EditorScheduleSheetCommands(a,!0,!1),i.Range2Remove(),i.RangeRemove()," Horizontal"==i.cellhandles.filltype&&p>0?i.MoveECell(t.crToCoord(i.ecell.col-d-1,i.ecell.row)):" Vertical"==i.cellhandles.filltype&&f>0&&i.MoveECell(t.crToCoord(i.ecell.col,i.ecell.row-h-1)),i.RangeAnchor(t.crToCoord(i.ecell.col+d,i.ecell.row+h)),i.RangeExtend()}return t.RemoveMouseMoveUp(t.CellHandlesMouseMove,t.CellHandlesMouseUp,v.draghandle,m),g.editor=null,!1}},t.TableControl=function(e,o,i){var n=t.Constants;this.editor=e,this.vertical=o,this.size=i,this.main=null,this.endcap=null,this.paneslider=null,this.lessbutton=null,this.morebutton=null,this.scrollarea=null,this.thumb=null,this.controlborder=null,this.endcapstart=null,this.panesliderstart=null,this.lessbuttonstart=null,this.morebuttonstart=null,this.scrollareastart=null,this.scrollareaend=null,this.scrollareasize=null,this.thumbpos=null,this.controlthickness=n.defaultTableControlThickness,this.sliderthickness=n.defaultTCSliderThickness,this.buttonthickness=n.defaultTCButtonThickness,this.thumbthickness=n.defaultTCThumbThickness,this.minscrollingpanesize=this.buttonthickness+this.buttonthickness+this.thumbthickness+20
},t.TableControl.prototype.CreateTableControl=function(){return t.CreateTableControl(this)},t.TableControl.prototype.PositionTableControlElements=function(){t.PositionTableControlElements(this)},t.TableControl.prototype.ComputeTableControlPositions=function(){t.ComputeTableControlPositions(this)},t.CreateTableControl=function(e){var o,i,n,r=t.AssignID,a=t.setStyles,s=t.Constants,l=e.editor.imageprefix,c=e.vertical?"v":"h",u=t.LocalizeString;return e.main=document.createElement("div"),o=e.main.style,o.height=(e.vertical?e.size:e.controlthickness)+"px",o.width=(e.vertical?e.controlthickness:e.size)+"px",o.zIndex=0,a(e.main,s.TCmainStyle),o.backgroundImage="url("+l+"main-"+c+".gif)",s.TCmainClass&&(e.main.className=s.TCmainClass),e.main.style.display="none",e.endcap=document.createElement("div"),o=e.endcap.style,o.height=e.controlthickness+"px",o.width=e.controlthickness+"px",o.zIndex=1,o.overflow="hidden",o.position="absolute",a(e.endcap,s.TCendcapStyle),o.backgroundImage="url("+l+"endcap-"+c+".gif)",s.TCendcapClass&&(e.endcap.className=s.TCendcapClass),r(e.editor,e.endcap,"endcap"+c),e.main.appendChild(e.endcap),e.paneslider=document.createElement("div"),o=e.paneslider.style,o.height=(e.vertical?e.sliderthickness:e.controlthickness)+"px",o.overflow="hidden",o.width=(e.vertical?e.controlthickness:e.sliderthickness)+"px",o.position="absolute",o[e.vertical?"top":"left"]="4px",o.zIndex=3,o.backgroundImage="url("+l+"paneslider-"+c+".gif)",s.TCpanesliderClass&&(e.paneslider.className=s.TCpanesliderClass),r(e.editor,e.paneslider,"paneslider"+c),e.paneslider.title=u(e.vertical?"Drag to lock pane horizontally":"Drag to lock pane vertically"),i={MouseDown:t.TCPSDragFunctionStart,MouseMove:t.TCPSDragFunctionMove,MouseUp:t.TCPSDragFunctionStop,Disabled:function(){return e.editor.busy}},i.control=e,1!=t._app&&t.DragRegister(e.paneslider,e.vertical,!e.vertical,i,e.editor.toplevel),e.main.appendChild(e.paneslider),e.lessbutton=document.createElement("div"),o=e.lessbutton.style,o.height=(e.vertical?e.buttonthickness:e.controlthickness)+"px",o.width=(e.vertical?e.controlthickness:e.buttonthickness)+"px",o.zIndex=2,o.overflow="hidden",o.position="absolute",a(e.lessbutton,s.TClessbuttonStyle),o.backgroundImage="url("+l+"less-"+c+"n.gif)",s.TClessbuttonClass&&(e.lessbutton.className=s.TClessbuttonClass),r(e.editor,e.lessbutton,"lessbutton"+c),n={repeatwait:s.TClessbuttonRepeatWait,repeatinterval:s.TClessbuttonRepeatInterval,normalstyle:"backgroundImage:url("+l+"less-"+c+"n.gif);",downstyle:"backgroundImage:url("+l+"less-"+c+"d.gif);",hoverstyle:"backgroundImage:url("+l+"less-"+c+"h.gif);"},i={MouseDown:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,-1)},Repeat:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,-1)},Disabled:function(){return e.editor.busy}},t.ButtonRegister(e.editor,e.lessbutton,n,i),e.main.appendChild(e.lessbutton),e.morebutton=document.createElement("div"),o=e.morebutton.style,o.height=(e.vertical?e.buttonthickness:e.controlthickness)+"px",o.width=(e.vertical?e.controlthickness:e.buttonthickness)+"px",o.zIndex=2,o.overflow="hidden",o.position="absolute",a(e.morebutton,s.TCmorebuttonStyle),o.backgroundImage="url("+l+"more-"+c+"n.gif)",s.TCmorebuttonClass&&(e.morebutton.className=s.TCmorebuttonClass),r(e.editor,e.morebutton,"morebutton"+c),n={repeatwait:s.TCmorebuttonRepeatWait,repeatinterval:s.TCmorebuttonRepeatInterval,normalstyle:"backgroundImage:url("+l+"more-"+c+"n.gif);",downstyle:"backgroundImage:url("+l+"more-"+c+"d.gif);",hoverstyle:"backgroundImage:url("+l+"more-"+c+"h.gif);"},i={MouseDown:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,1)},Repeat:function(){e.editor.busy||e.editor.ScrollRelative(e.vertical,1)},Disabled:function(){return e.editor.busy}},t.ButtonRegister(e.editor,e.morebutton,n,i),e.main.appendChild(e.morebutton),e.scrollarea=document.createElement("div"),o=e.scrollarea.style,o.height=e.controlthickness+"px",o.width=e.controlthickness+"px",o.zIndex=1,o.overflow="hidden",o.position="absolute",a(e.scrollarea,s.TCscrollareaStyle),o.backgroundImage="url("+l+"scrollarea-"+c+".gif)",s.TCscrollareaClass&&(e.scrollarea.className=s.TCscrollareaClass),r(e.editor,e.scrollarea,"scrollarea"+c),n={repeatwait:s.TCscrollareaRepeatWait,repeatinterval:s.TCscrollareaRepeatWait},i={MouseDown:t.ScrollAreaClick,Repeat:t.ScrollAreaClick,Disabled:function(){return e.editor.busy}},i.control=e,t.ButtonRegister(e.editor,e.scrollarea,n,i),e.main.appendChild(e.scrollarea),e.thumb=document.createElement("div"),o=e.thumb.style,o.height=(e.vertical?e.thumbthickness:e.controlthickness)+"px",o.width=(e.vertical?e.controlthickness:e.thumbthickness)+"px",o.zIndex=2,o.overflow="hidden",o.position="absolute",a(e.thumb,s.TCthumbStyle),e.thumb.style.backgroundImage="url("+l+"thumb-"+c+"n.gif)",s.TCthumbClass&&(e.thumb.className=s.TCthumbClass),r(e.editor,e.thumb,"thumb"+c),i={MouseDown:t.TCTDragFunctionStart,MouseMove:t.TCTDragFunctionMove,MouseUp:t.TCTDragFunctionStop,Disabled:function(){return e.editor.busy}},i.control=e,1!=t._app&&t.DragRegister(e.thumb,e.vertical,!e.vertical,i,e.editor.toplevel),n={normalstyle:"backgroundImage:url("+l+"thumb-"+c+"n.gif)",name:"Thumb",downstyle:"backgroundImage:url("+l+"thumb-"+c+"d.gif)",hoverstyle:"backgroundImage:url("+l+"thumb-"+c+"h.gif)"},t.ButtonRegister(e.editor,e.thumb,n,null),e.main.appendChild(e.thumb),e.main},t.ScrollAreaClick=function(e,o,i){var n=i.functionobj.control,r=t.GetElementPositionWithScroll(n.editor.toplevel),a=n.vertical?o.clientY-r.top:o.clientX-r.left;n.editor.busy||n.editor.PageRelative(n.vertical,a>n.thumbpos?1:-1)},t.PositionTableControlElements=function(e){var t,o,i,n=e.editor;e.vertical?(t=e.controlborder+"px",e.endcap.style.top=e.endcapstart+"px",e.endcap.style.left=t,e.paneslider.style.top=e.panesliderstart+"px",e.paneslider.style.left=t,e.lessbutton.style.top=e.lessbuttonstart+"px",e.lessbutton.style.left=t,e.morebutton.style.top=e.morebuttonstart+"px",e.morebutton.style.left=t,e.scrollarea.style.top=e.scrollareastart+"px",e.scrollarea.style.left=t,e.scrollarea.style.height=e.scrollareasize+"px",o=Math.max(n.context.sheetobj.attribs.lastrow,n.firstscrollingrow+1),i=(n.firstscrollingrow-(n.lastnonscrollingrow+1))*(e.scrollareasize-3*e.thumbthickness)/(o-(n.lastnonscrollingrow+1))+e.scrollareastart-1,i=Math.floor(i),e.thumb.style.top=i+"px",e.thumb.style.left=t):(t=e.controlborder+"px",e.endcap.style.left=e.endcapstart+"px",e.endcap.style.top=t,e.paneslider.style.left=e.panesliderstart+"px",e.paneslider.style.top=t,e.lessbutton.style.left=e.lessbuttonstart+"px",e.lessbutton.style.top=t,e.morebutton.style.left=e.morebuttonstart+"px",e.morebutton.style.top=t,e.scrollarea.style.left=e.scrollareastart+"px",e.scrollarea.style.top=t,e.scrollarea.style.width=e.scrollareasize+"px",o=Math.max(n.context.sheetobj.attribs.lastcol,n.firstscrollingcol+1),i=(n.firstscrollingcol-(n.lastnonscrollingcol+1))*(e.scrollareasize-e.thumbthickness)/(o-n.lastnonscrollingcol)+e.scrollareastart-1,i=Math.floor(i),e.thumb.style.left=i+"px",e.thumb.style.top=t),e.thumbpos=i,e.main.style.display="block"},t.ComputeTableControlPositions=function(e){var t=e.editor;if(!t.gridposition||!t.headposition)throw"Can't compute table control positions before editor positions";e.vertical?(e.controlborder=t.gridposition.left+t.tablewidth,e.endcapstart=t.gridposition.top,e.panesliderstart=t.firstscrollingrowtop-e.sliderthickness,e.lessbuttonstart=t.firstscrollingrowtop-1,e.morebuttonstart=t.gridposition.top+t.tableheight-e.buttonthickness,e.scrollareastart=t.firstscrollingrowtop-1+e.buttonthickness,e.scrollareaend=e.morebuttonstart-1,e.scrollareasize=e.scrollareaend-e.scrollareastart+1):(e.controlborder=t.gridposition.top+t.tableheight,e.endcapstart=t.gridposition.left,e.panesliderstart=t.firstscrollingcolleft-e.sliderthickness,e.lessbuttonstart=t.firstscrollingcolleft-1,e.morebuttonstart=t.gridposition.left+t.tablewidth-e.buttonthickness,e.scrollareastart=t.firstscrollingcolleft-1+e.buttonthickness,e.scrollareaend=e.morebuttonstart-1,e.scrollareasize=e.scrollareaend-e.scrollareastart+1)},t.TCPSDragFunctionStart=function(e,o,i){var n=i.functionobj.control.editor,r=t.Constants;t.DragFunctionStart(e,o,i),o.trackingline=document.createElement("div"),o.trackingline.style.height=i.vertical?r.TCPStrackinglineThickness:n.tableheight-(n.headposition.top-n.gridposition.top)+"px",o.trackingline.style.width=i.vertical?n.tablewidth-(n.headposition.left-n.gridposition.left)+"px":r.TCPStrackinglineThickness,o.trackingline.style.backgroundImage="url("+n.imageprefix+"trackingline-"+(i.vertical?"v":"h")+".gif)",r.TCPStrackinglineClass&&(o.trackingline.className=r.TCPStrackinglineClass),t.setStyles(o.trackingline,r.TCPStrackinglineStyle),i.vertical?(row=t.Lookup(o.clientY+i.functionobj.control.sliderthickness,n.rowpositions),o.trackingline.style.top=(n.rowpositions[row]||n.headposition.top)+"px",o.trackingline.style.left=n.headposition.left+"px",o.trackingline.id="trackingline-vertical",n.context.rowpanes.length-1&&(n.context.SetRowPaneFirstLast(1,n.context.rowpanes[0].last+1,n.context.rowpanes[0].last+1),n.FitToEditTable(),n.ScheduleRender())):(col=t.Lookup(o.clientX+i.functionobj.control.sliderthickness,n.colpositions),o.trackingline.style.top=n.headposition.top+"px",o.trackingline.style.left=(n.colpositions[col]||n.headposition.left)+"px",o.trackingline.id="trackingline-horizon",n.context.colpanes.length-1&&(n.context.SetColPaneFirstLast(1,n.context.colpanes[0].last+1,n.context.colpanes[0].last+1),n.FitToEditTable(),n.ScheduleRender())),n.griddiv.appendChild(o.trackingline)},t.TCPSDragFunctionMove=function(e,o,i){var n,r,a,s,l=i.functionobj.control,c=l.sliderthickness,u=l.editor;if(i.vertical){for(a=l.morebuttonstart-l.minscrollingpanesize-o.offsetY,o.clientY>a&&(o.clientY=a),s=u.headposition.top-c-o.offsetY,o.clientY<s&&(o.clientY=s),n=t.Lookup(o.clientY+c,u.rowpositions);"yes"==u.context.sheetobj.rowattribs.hide[n];)n++;o.trackingline.style.top=(u.rowpositions[n]||u.headposition.top)+"px"}else{for(a=l.morebuttonstart-l.minscrollingpanesize-o.offsetX,o.clientX>a&&(o.clientX=a),s=u.headposition.left-c-o.offsetX,o.clientX<s&&(o.clientX=s),r=t.Lookup(o.clientX+c,u.colpositions);"yes"==u.context.sheetobj.colattribs.hide[t.rcColname(r)];)r++;o.trackingline.style.left=(u.colpositions[r]||u.headposition.left)+"px"}t.DragFunctionPosition(e,o,i)},t.TCPSDragFunctionStop=function(e,o,i){var n,r,a,s,l=i.functionobj.control,c=l.sliderthickness,u=l.editor;if(i.vertical){for(a=l.morebuttonstart-l.minscrollingpanesize-o.offsetY,o.clientY>a&&(o.clientY=a),s=u.headposition.top-c-o.offsetY,o.clientY<s&&(o.clientY=s),n=t.Lookup(o.clientY+c,u.rowpositions),n>u.context.sheetobj.attribs.lastrow&&(n=u.context.sheetobj.attribs.lastrow);"yes"==u.context.sheetobj.rowattribs.hide[n];)n++;u.EditorScheduleSheetCommands("pane row "+n,!0,!1)}else{for(a=l.morebuttonstart-l.minscrollingpanesize-o.offsetX,o.clientX>a&&(o.clientX=a),s=u.headposition.left-c-o.offsetX,o.clientX<s&&(o.clientX=s),r=t.Lookup(o.clientX+c,u.colpositions),r>u.context.sheetobj.attribs.lastcol&&(r=u.context.sheetobj.attribs.lastcol);"yes"==u.context.sheetobj.colattribs.hide[t.rcColname(r)];)r++;u.EditorScheduleSheetCommands("pane col "+r,!0,!1)}},t.TCTDragFunctionStart=function(e,o,i){var n=i.functionobj.control,r=n.editor,a=t.Constants;if(t.DragFunctionStart(e,o,i),o.thumbstatus&&(o.thumbstatus.rowmsgele&&(o.thumbstatus.rowmsgele=null),o.thumbstatus.rowpreviewele&&(o.thumbstatus.rowpreviewele=null),r.toplevel.removeChild(o.thumbstatus),o.thumbstatus=null),o.thumbstatus=document.createElement("div"),i.vertical){a.TCTDFSthumbstatusvClass&&(o.thumbstatus.className=a.TCTDFSthumbstatusvClass),t.setStyles(o.thumbstatus,a.TCTDFSthumbstatusvStyle),o.thumbstatus.style.top=o.clientY+a.TCTDFStopOffsetv+"px",o.thumbstatus.style.left=n.controlborder-10-r.tablewidth/2+"px",o.thumbstatus.style.width=r.tablewidth/2+"px",o.thumbcontext=new t.RenderContext(r.context.sheetobj),o.thumbcontext.showGrid=!0,o.thumbcontext.rowpanes=[{first:1,last:1}];var s=r.context.colpanes[r.context.colpanes.length-1];o.thumbcontext.colpanes=[{first:s.first,last:s.last}],o.thumbstatus.innerHTML='<table cellspacing="0" cellpadding="0"><tr><td valign="top" style="'+a.TCTDFSthumbstatusrownumStyle+'" class="'+a.TCTDFSthumbstatusrownumClass+'"><div>msg</div></td><td valign="top"><div style="overflow:hidden;">preview</div></td></tr></table>',o.thumbstatus.rowmsgele=o.thumbstatus.firstChild.firstChild.firstChild.firstChild.firstChild,o.thumbstatus.rowpreviewele=o.thumbstatus.firstChild.firstChild.firstChild.childNodes[1].firstChild,r.toplevel.appendChild(o.thumbstatus),t.TCTDragFunctionRowSetStatus(o,r,r.firstscrollingrow||1)}else a.TCTDFSthumbstatushClass&&(o.thumbstatus.className=a.TCTDFSthumbstatushClass),t.setStyles(o.thumbstatus,a.TCTDFSthumbstatushStyle),o.thumbstatus.style.top=n.controlborder+a.TCTDFStopOffseth+"px",o.thumbstatus.style.left=o.clientX+a.TCTDFSleftOffseth+"px",r.toplevel.appendChild(o.thumbstatus),o.thumbstatus.innerHTML=a.s_TCTDFthumbstatusPrefixh+t.rcColname(r.firstscrollingcol)},t.TCTDragFunctionRowSetStatus=function(e,o,i){var n=t.Constants,r=n.s_TCTDFthumbstatusPrefixv+i+" ";e.thumbstatus.rowmsgele.innerHTML=r,e.thumbcontext.rowpanes=[{first:i,last:i}],e.thumbrowshown=i;e.thumbcontext.RenderSheet(e.thumbstatus.rowpreviewele.firstChild,{type:"html"})},t.TCTDragFunctionMove=function(e,o,i){var n,r,a=i.functionobj.control,s=(a.thumbthickness,a.editor),l=t.Constants;i.vertical?(o.clientY>a.scrollareaend-o.offsetY-a.thumbthickness+2&&(o.clientY=a.scrollareaend-o.offsetY-a.thumbthickness+2),o.clientY<a.scrollareastart-o.offsetY-1&&(o.clientY=a.scrollareastart-o.offsetY-1),o.thumbstatus.style.top=o.clientY+"px",n=(o.clientY+o.offsetY-a.scrollareastart+1)/(a.scrollareasize-a.thumbthickness)*(s.context.sheetobj.attribs.lastrow-s.lastnonscrollingrow)+s.lastnonscrollingrow+1,n=Math.floor(n),n<=s.lastnonscrollingrow&&(n=s.lastnonscrollingrow+1),n>s.context.sheetobj.attribs.lastrow&&(n=s.context.sheetobj.attribs.lastrow),n!=o.thumbrowshown&&t.TCTDragFunctionRowSetStatus(o,s,n)):(o.clientX>a.scrollareaend-o.offsetX-a.thumbthickness+2&&(o.clientX=a.scrollareaend-o.offsetX-a.thumbthickness+2),o.clientX<a.scrollareastart-o.offsetX-1&&(o.clientX=a.scrollareastart-o.offsetX-1),o.thumbstatus.style.left=o.clientX+"px",n=(o.clientX+o.offsetX-a.scrollareastart+1)/(a.scrollareasize-a.thumbthickness)*(s.context.sheetobj.attribs.lastcol-s.lastnonscrollingcol)+s.lastnonscrollingcol+1,n=Math.floor(n),n<=s.lastnonscrollingcol&&(n=s.lastnonscrollingcol+1),n>s.context.sheetobj.attribs.lastcol&&(n=s.context.sheetobj.attribs.lastcol),r=l.s_TCTDFthumbstatusPrefixh+t.rcColname(n),o.thumbstatus.innerHTML=r),t.DragFunctionPosition(e,o,i)},t.TCTDragFunctionStop=function(e,t,o){var i,n=o.functionobj.control,r=n.editor;o.vertical?(i=(t.clientY+t.offsetY-n.scrollareastart+1)/(n.scrollareasize-n.thumbthickness)*(r.context.sheetobj.attribs.lastrow-r.lastnonscrollingrow)+r.lastnonscrollingrow+1,i=Math.floor(i),i<=r.lastnonscrollingrow&&(i=r.lastnonscrollingrow+1),i>r.context.sheetobj.attribs.lastrow&&(i=r.context.sheetobj.attribs.lastrow),r.context.SetRowPaneFirstLast(r.context.rowpanes.length-1,i,i+1)):(i=(t.clientX+t.offsetX-n.scrollareastart+1)/(n.scrollareasize-n.thumbthickness)*(r.context.sheetobj.attribs.lastcol-r.lastnonscrollingcol)+r.lastnonscrollingcol+1,i=Math.floor(i),i<=r.lastnonscrollingcol&&(i=r.lastnonscrollingcol+1),i>r.context.sheetobj.attribs.lastcol&&(i=r.context.sheetobj.attribs.lastcol),r.context.SetColPaneFirstLast(r.context.colpanes.length-1,i,i+1)),r.FitToEditTable(),t.thumbstatus.rowmsgele&&(t.thumbstatus.rowmsgele=null),t.thumbstatus.rowpreviewele&&(t.thumbstatus.rowpreviewele=null),r.toplevel.removeChild(t.thumbstatus),t.thumbstatus=null,r.ScheduleRender()},t.DragInfo={registeredElements:[],draggingElement:null,startX:0,startY:0,startZ:0,clientX:0,clientY:0,offsetX:0,offsetY:0,relativeOffset:{left:0,top:0}},t.DragRegister=function(e,o,i,n,r){var a=t.DragInfo;if(n||(n={MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null}),a.registeredElements.push({element:e,vertical:o,horizontal:i,functionobj:n,parent:r}),e.addEventListener)e.addEventListener("mousedown",t.DragMouseDown,!1);else{if(!e.attachEvent)throw t.Constants.s_BrowserNotSupported;e.attachEvent("onmousedown",t.DragMouseDown)}},t.DragUnregister=function(e){var o,i=t.DragInfo;if(e)for(o=0;o<i.registeredElements.length;o++)if(i.registeredElements[o].element==e)return i.registeredElements.splice(o,1),void(e.removeEventListener?e.removeEventListener("mousedown",t.DragMouseDown,!1):e.detachEvent("onmousedown",t.DragMouseDown))},t.DragMouseDown=function(o){var i=o||e.event,n=t.DragInfo,r=t.LookupElement(i.target||i.srcElement,n.registeredElements);return!r||r&&r.functionobj&&r.functionobj.Disabled&&r.functionobj.Disabled(i,n,r)?void 0:(n.draggingElement=r,r.parent&&(n.relativeOffset=t.GetElementPositionWithScroll(r.parent)),n.clientX=i.clientX-n.relativeOffset.left,n.clientY=i.clientY-n.relativeOffset.top,n.startX=n.clientX,n.startY=n.clientY,n.startZ=r.element.style.zIndex,n.offsetX=0,n.offsetY=0,r.element.style.zIndex="100",t.SetMouseMoveUp(t.DragMouseMove,t.DragMouseUp,r.element,i),r&&r.functionobj&&r.functionobj.MouseDown&&r.functionobj.MouseDown(i,n,r),!1)},t.DragMouseMove=function(o){var i=o||e.event,n=t.DragInfo,r=n.draggingElement;return n.clientX=i.clientX-n.relativeOffset.left,n.clientY=i.clientY-n.relativeOffset.top,t.StopPropagation(i),r&&r.functionobj&&r.functionobj.MouseMove&&r.functionobj.MouseMove(i,n,r),!1},t.DragMouseUp=function(o){var i=o||e.event,n=t.DragInfo,r=n.draggingElement;return n.clientX=i.clientX-n.relativeOffset.left,n.clientY=i.clientY-n.relativeOffset.top,r.element.style.zIndex=n.startZ,r&&r.functionobj&&r.functionobj.MouseUp&&r.functionobj.MouseUp(i,n,r),t.RemoveMouseMoveUp(t.DragMouseMove,t.DragMouseUp,r.element,i),n.draggingElement=null,!1},t.DragFunctionStart=function(e,t,o){var i=o.functionobj.positionobj||o.element;t.offsetY=parseInt(i.style.top)-t.clientY,t.offsetX=parseInt(i.style.left)-t.clientX},t.DragFunctionPosition=function(e,t,o){var i=o.functionobj.positionobj||o.element;o.vertical&&(i.style.top=t.clientY+t.offsetY+"px"),o.horizontal&&(i.style.left=t.clientX+t.offsetX+"px")},t.ButtonInfo={registeredElements:[],buttonElement:null,doingHover:!1,buttonDown:!1,timer:null,relativeOffset:null,clientX:0,clientY:0},t.ButtonRegister=function(e,o,i,n){var r=t.ButtonInfo;if(i||(i={}),r.registeredElements.push({name:i.name,element:o,editor:e,normalstyle:i.normalstyle,hoverstyle:i.hoverstyle,downstyle:i.downstyle,repeatwait:i.repeatwait,repeatinterval:i.repeatinterval,functionobj:n}),o.addEventListener)o.addEventListener("mousedown",t.ButtonMouseDown,!1),o.addEventListener("mouseover",t.ButtonMouseOver,!1),o.addEventListener("mouseout",t.ButtonMouseOut,!1);else{if(!o.attachEvent)throw t.Constants.s_BrowserNotSupported;o.attachEvent("onmousedown",t.ButtonMouseDown),o.attachEvent("onmouseover",t.ButtonMouseOver),o.attachEvent("onmouseout",t.ButtonMouseOut)}},t.ButtonMouseOver=function(o){var i=o||e.event,n=t.ButtonInfo,r=t.LookupElement(i.target||i.srcElement,n.registeredElements);if(r){if(n.buttonDown)return void(n.buttonElement==r&&(n.doingHover=!0));n.buttonElement&&n.buttonElement!=r&&n.doingHover&&t.setStyles(n.buttonElement.element,n.buttonElement.normalstyle),n.buttonElement=r,n.doingHover=!0,t.setStyles(r.element,r.hoverstyle),r&&r.functionobj&&r.functionobj.MouseOver&&r.functionobj.MouseOver(i,n,r)}},t.ButtonMouseOut=function(o){var i=o||e.event,n=t.ButtonInfo;if(n.buttonDown)return void(n.doingHover=!1);var r=t.LookupElement(i.target||i.srcElement,n.registeredElements);n.doingHover&&(n.buttonElement&&t.setStyles(n.buttonElement.element,n.buttonElement.normalstyle),n.buttonElement=null,n.doingHover=!1),r&&r.functionobj&&r.functionobj.MouseOut&&r.functionobj.MouseOut(i,n,r)},t.ButtonMouseDown=function(o){var i=o||e.event,n=t.ButtonInfo,r=(t.GetViewportInfo(),t.LookupElement(i.target||i.srcElement,n.registeredElements));r&&(r&&r.functionobj&&r.functionobj.Disabled&&r.functionobj.Disabled(i,n,r)||(n.buttonElement=r,n.buttonDown=!0,t.setStyles(r.element,n.buttonElement.downstyle),document.addEventListener?document.addEventListener("mouseup",t.ButtonMouseUp,!0):r.element.attachEvent&&(r.element.setCapture(),r.element.attachEvent("onmouseup",t.ButtonMouseUp),r.element.attachEvent("onlosecapture",t.ButtonMouseUp)),t.StopPropagation(i),n.relativeOffset=t.GetElementPositionWithScroll(r.editor.toplevel),n.clientX=i.clientX-n.relativeOffset.left,n.clientY=i.clientY-n.relativeOffset.top,r&&r.functionobj&&r.functionobj.MouseDown&&r.functionobj.MouseDown(i,n,r),r.repeatwait&&(n.timer=e.setTimeout(t.ButtonRepeat,r.repeatwait))))},t.ButtonMouseUp=function(o){var i=o||e.event,n=t.ButtonInfo,r=n.buttonElement;n.timer&&(e.clearTimeout(n.timer),n.timer=null),n.buttonDown&&(t.StopPropagation(i),document.removeEventListener?document.removeEventListener("mouseup",t.ButtonMouseUp,!0):document.detachEvent&&(r.element.detachEvent("onlosecapture",t.ButtonMouseUp),r.element.detachEvent("onmouseup",t.ButtonMouseUp),r.element.releaseCapture()),n.buttonElement.downstyle&&(n.doingHover?t.setStyles(r.element,n.buttonElement.hoverstyle):t.setStyles(r.element,n.buttonElement.normalstyle)),n.buttonDown=!1,r&&r.functionobj&&r.functionobj.MouseUp&&r.functionobj.MouseUp(i,n,r))},t.ButtonRepeat=function(){var o=t.ButtonInfo,i=o.buttonElement;i&&(i&&i.functionobj&&i.functionobj.Repeat&&i.functionobj.Repeat(null,o,i),o.timer=e.setTimeout(t.ButtonRepeat,i.repeatinterval||100))},t.MouseWheelInfo={registeredElements:[]},t.MouseWheelRegister=function(e,o){var i=t.MouseWheelInfo;if(i.registeredElements.push({element:e,functionobj:o}),e.addEventListener)e.addEventListener("DOMMouseScroll",t.ProcessMouseWheel,!1),e.addEventListener("mousewheel",t.ProcessMouseWheel,!1);else{if(!e.attachEvent)throw t.Constants.s_BrowserNotSupported;e.attachEvent("onmousewheel",t.ProcessMouseWheel)}},t.ProcessMouseWheel=function(o){var i,n=o||e.event;if(!t.Keyboard.passThru){var r,a=t.MouseWheelInfo,s=n.target||n.srcElement;for(r=null;!r&&s;s=s.parentNode)r=t.LookupElement(s,a.registeredElements);r&&(i=n.wheelDelta?n.wheelDelta/120:-n.detail/3,i||(i=0),r.functionobj&&r.functionobj.WheelMove&&r.functionobj.WheelMove(n,i,a,r),n.preventDefault&&n.preventDefault(),n.returnValue=!1)}},t.keyboardTables={specialKeysCommon:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},specialKeysIE:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysIE:{65:"[ctrl-a]",67:"[ctrl-c]",83:"[ctrl-s]",86:"[ctrl-v]",88:"[ctrl-x]",90:"[ctrl-z]"},specialKeysOpera:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysOpera:{65:"[ctrl-a]",67:"[ctrl-c]",83:"[ctrl-s]",86:"[ctrl-v]",88:"[ctrl-x]",90:"[ctrl-z]"},specialKeysSafari:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",63232:"[aup]",63233:"[adown]",63234:"[aleft]",63235:"[aright]",63272:"[del]",63273:"[home]",63275:"[end]",63276:"[pgup]",63277:"[pgdn]",63237:"[f2]"},controlKeysSafari:{97:"[ctrl-a]",99:"[ctrl-c]",115:"[ctrl-s]",118:"[ctrl-v]",120:"[ctrl-x]",122:"[ctrl-z]"},ignoreKeysSafari:{63236:"[f1]",63238:"[f3]",63239:"[f4]",63240:"[f5]",63241:"[f6]",63242:"[f7]",63243:"[f8]",63244:"[f9]",63245:"[f10]",63246:"[f11]",63247:"[f12]",63289:"[numlock]"},specialKeysFirefox:{8:"[backspace]",9:"[tab]",13:"[enter]",25:"[tab]",27:"[esc]",33:"[pgup]",34:"[pgdn]",35:"[end]",36:"[home]",37:"[aleft]",38:"[aup]",39:"[aright]",40:"[adown]",45:"[ins]",46:"[del]",113:"[f2]"},controlKeysFirefox:{97:"[ctrl-a]",99:"[ctrl-c]",115:"[ctrl-s]",118:"[ctrl-v]",120:"[ctrl-x]",122:"[ctrl-z]"},ignoreKeysFirefox:{16:"[shift]",17:"[ctrl]",18:"[alt]",20:"[capslock]",19:"[pause]",44:"[printscreen]",91:"[windows]",92:"[windows]",112:"[f1]",114:"[f3]",115:"[f4]",116:"[f5]",117:"[f6]",118:"[f7]",119:"[f8]",120:"[f9]",121:"[f10]",122:"[f11]",123:"[f12]",144:"[numlock]",145:"[scrolllock]",224:"[cmd]"}},t.Keyboard={areListener:!1,focusTable:null,passThru:null,didProcessKey:!1,statusFromProcessKey:!1,repeatingKeyPress:!1,chForProcessKey:""},t.KeyboardSetFocus=function(o){t.Keyboard.focusTable=o,t.Keyboard.areListener||(document.onkeydown=t.ProcessKeyDown,document.onkeypress=t.ProcessKeyPress,t.Keyboard.areListener=!0),t.Keyboard.passThru&&(t.Keyboard.passThru.blur&&t.Keyboard.passThru.blur(),t.Keyboard.passThru=null),e.focus()},t.KeyboardFocus=function(){t.Keyboard.passThru=null,e.focus()},t.ProcessKeyDown=function(o){var i=t.keyboardTables;i.didProcessKey=!1,i.statusFromProcessKey=!1,i.repeatingKeyPress=!1;var n="",r=!0;if(!t._app&&!t.Keyboard.passThru){if(o=o||e.event,void 0==o.which){if(n=i.specialKeysCommon[o.keyCode],!n&&(o.ctrlKey&&(n=i.controlKeysIE[o.keyCode]),!n))return!0;r=t.ProcessKey(n,o),r||(o.preventDefault&&o.preventDefault(),o.returnValue=!1)}else{if(n=i.specialKeysCommon[o.keyCode],!n&&((o.ctrlKey||o.metaKey)&&(n=i.controlKeysIE[o.keyCode]),!n))return!0;r=t.ProcessKey(n,o),i.didProcessKey=!0,i.statusFromProcessKey=r,i.chForProcessKey=n}return r}},t.ProcessKeyPress=function(o){var i=t.keyboardTables,n="";if(o=o||e.event,!t._app&&!t.Keyboard.passThru){if(i.didProcessKey)return i.repeatingKeyPress?t.ProcessKey(i.chForProcessKey,o):(i.repeatingKeyPress=!0,i.statusFromProcessKey);if(void 0==o.which)n=String.fromCharCode(o.keyCode);else{if(!o.which)return!1;if(void 0==o.charCode){if(0==o.which)return!0;if(o.which<32||144==o.which){if(n=i.specialKeysOpera[o.which])return!0}else n=o.ctrlKey?i.controlKeysOpera[o.keyCode]:String.fromCharCode(o.which)}else{if(0==o.keyCode&&0==o.charCode)return;if(o.keyCode==o.charCode){if(n=i.specialKeysSafari[o.keyCode],!n){if(i.ignoreKeysSafari[o.keyCode])return!0;n=o.metaKey?i.controlKeysSafari[o.keyCode]:String.fromCharCode(o.which)}}else{if(i.specialKeysFirefox[o.keyCode])return!0;n=String.fromCharCode(o.which),(o.ctrlKey||o.metaKey)&&(n=i.controlKeysFirefox[o.which])}}}var r=t.ProcessKey(n,o);return r||(o.preventDefault&&o.preventDefault(),o.returnValue=!1),r}},t.ProcessKey=function(e,o){var i=t.Keyboard.focusTable;return i?i.EditorProcessKey(e,o):!0};var t;t||(t={}),t.FormatNumber={},t.FormatNumber.format_definitions={},t.FormatNumber.separatorchar=",",t.FormatNumber.decimalchar=".",t.FormatNumber.daynames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t.FormatNumber.daynames3=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t.FormatNumber.monthnames3=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t.FormatNumber.monthnames=["January","February","March","April","May","June","July","August","September","October","November","December"],t.FormatNumber.allowedcolors={BLACK:"#000000",BLUE:"#0000FF",CYAN:"#00FFFF",GREEN:"#00FF00",MAGENTA:"#FF00FF",RED:"#FF0000",WHITE:"#FFFFFF",YELLOW:"#FFFF00"},t.FormatNumber.alloweddates={H:"h]",M:"m]",MM:"mm]",S:"s]",SS:"ss]"},t.FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12},t.FormatNumber.datevalues={julian_offset:2415019,seconds_in_a_day:86400,seconds_in_an_hour:3600},t.FormatNumber.formatNumberWithFormat=function(e,o,i){var n,r,a,s,l,c,u,d,h,p,f,m,g,v,b,y,C,w,x,_,S,k,T,F,E,D,P,A,I,M,R,N,L,O,z,H,B,U,j,V=t.Constants,W=t.FormatNumber,G="";if("string"==typeof e&&!e.length)return"";if(j=e-0,!isFinite(j))return"string"==typeof e?W.formatTextWithFormat(e,o):"NaN";e=j;var $=0>j?1:0;$&&(j=-j);var Y=0==j?1:0;if(i=i||V.FormatNumber_DefaultCurrency,W.parse_format_string(W.format_definitions,o),C=W.format_definitions[o],!C)throw"Format not parsed error!";if(w=C.sectioninfo.length-1,C.hascomparison)for(w=0,x=0,k=0;;k++){if(n=C.operators[k],r=C.operands[k],!n){x&&(o="General",W.parse_format_string(W.format_definitions,o),C=W.format_definitions[o],w=0);break}if(n!=W.commands.section){if(n==W.commands.comparison){if(E=r.indexOf(":"),_=r.substring(0,E),S=r.substring(E+1)-0,"<"==_&&S>e||"<="==_&&S>=e||"="==_&&e==S||"<>"==_&&e!=S||">="==_&&e>=S||">"==_&&e>S)break;x=1}}else{if(!x)break;x=0,w++}}else w>0&&(1==w?$?($=0,w=1):w=0:(2==w||3==w)&&($?($=0,w=1):w=Y?2:0));if(F=C.sectioninfo[w],F.commas>0)for(E=0;E<F.commas;E++)j/=1e3;if(F.percent>0)for(E=0;E<F.percent;E++)j*=100;for(D=1,E=0;E<F.fractiondigits;E++)D*=10;if(P=Math.floor(j*D+.5),P/=D,"number"!=typeof P)return"NaN";if(!isFinite(P))return"NaN";if(A=P+"",0==P&&(F.fractiondigits||F.integerdigits)&&($=0),A.indexOf("e")>=0)return e+"";if(I=A.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),!I)return"NaN";if(M=I[1],M&&"0"!=M||(M=""),R=I[2],R||(R=""),F.hasdate){if(0>e)return"??-???-??&nbsp;??:??:??";for(c=(e-Math.floor(e))*W.datevalues.seconds_in_a_day,u=e*W.datevalues.seconds_in_a_day,d=Math.floor(c/W.datevalues.seconds_in_an_hour),f=Math.floor(u/W.datevalues.seconds_in_an_hour),c-=d*W.datevalues.seconds_in_an_hour,h=Math.floor(c/60),m=Math.floor(u/60),p=c-60*h,D=1,E=0;E<F.fractiondigits;E++)D*=10;for(p=Math.floor(p*D+.5),p/=D,g=Math.floor(u*D+.5),g/=D,p>=60&&(p=0,h++,m++,h>=60&&(h=0,d++,f++,d>=24&&(d=0,e++))),R=p-Math.floor(p)+"",R=R.substring(2),b=t.FormatNumber.convert_date_julian_to_gregorian(Math.floor(e+W.datevalues.julian_offset)),y=0,mspos=F.sectionstart;(n=C.operators[mspos],r=C.operands[mspos],n)&&n!=W.commands.section;mspos++)n==W.commands.date?("am/pm"!=r.toLowerCase()&&"a/p"!=r.toLowerCase()||v||(d>=12?(d-=12,v="a/p"==r.toLowerCase()?V.s_FormatNumber_pm1:V.s_FormatNumber_pm):v="a/p"==r.toLowerCase()?V.s_FormatNumber_am1:V.s_FormatNumber_am,r.indexOf(v)<0&&(v=v.toLowerCase())),!y||"m"!=r&&"mm"!=r||(C.operands[mspos]+="in"),y="h"==r.charAt(0)?1:0):n!=W.commands.copy&&(y=0);for(y=0,--mspos;(n=C.operators[mspos],r=C.operands[mspos],n)&&n!=W.commands.section;mspos--)n==W.commands.date?(!y||"m"!=r&&"mm"!=r||(C.operands[mspos]+="in"),y="ss"==r?1:0):n!=W.commands.copy&&(y=0)}for(N=0,L=0,O=0,z="",H="",B=V.FormatNumber_separatorchar,B.indexOf(" ")>=0&&(B=B.replace(/ /g,"&nbsp;")),U=V.FormatNumber_decimalchar,U.indexOf(" ")>=0&&(U=U.replace(/ /g,"&nbsp;")),T=F.sectionstart;n=C.operators[T];)if(r=C.operands[T++],n==W.commands.copy)G+=r;else if(n==W.commands.color)z=r;else if(n==W.commands.style)H=r;else if(n==W.commands.integer_placeholder){if($&&(G+="-",$=0),N++,1==N&&M.length>F.integerdigits)for(;L<M.length-F.integerdigits;L++)G+=M.charAt(L),F.thousandssep&&(a=M.length-L-1,a>2&&a%3==0&&(G+=B));M.length<F.integerdigits&&N<=F.integerdigits-M.length?("0"==r||"?"==r)&&(G+="0"==r?"0":"&nbsp;",F.thousandssep&&(a=F.integerdigits-N,a>2&&a%3==0&&(G+=B))):(G+=M.charAt(L),F.thousandssep&&(a=M.length-L-1,a>2&&a%3==0&&(G+=B)),L++)}else if(n==W.commands.fraction_placeholder)O>=R.length?("0"==r||"?"==r)&&(G+="0"==r?"0":"&nbsp;"):G+=R.charAt(O),O++;else if(n==W.commands.decimal)$&&(G+="-",$=0),G+=U;else if(n==W.commands.currency)$&&(G+="-",$=0),G+=r;else if(n==W.commands.general){if(0!=j){var K=Math.floor(Math.LOG10E*Math.log(j));if(K=Math.pow(10,13-K),j=Math.floor(K*j+.5)/K,!isFinite(j))return"NaN"}if($&&(G+="-"),A=j+"",A.indexOf("e")>=0){G+=A;continue}if(I=A.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/),M=I[1],M&&"0"!=M||(M=""),R=I[2],R||(R=""),L=0,O=0,M.length)for(;L<M.length;L++)G+=M.charAt(L),F.thousandssep&&(a=M.length-L-1,a>2&&a%3==0&&(G+=B));else G+="0";if(R.length)for(G+=U;O<R.length;O++)G+=R.charAt(O)}else if(n==W.commands.date)l=r.toLowerCase(),"y"==l||"yy"==l?G+=(b.year+"").substring(2):"yyyy"==l?G+=b.year+"":"d"==l?G+=b.day+"":"dd"==l?(s=1e3+b.day,G+=(s+"").substr(2)):"ddd"==l?(s=Math.floor(e+6)%7,G+=V.s_FormatNumber_daynames3[s]):"dddd"==l?(s=Math.floor(e+6)%7,G+=V.s_FormatNumber_daynames[s]):"m"==l?G+=b.month+"":"mm"==l?(s=1e3+b.month,G+=(s+"").substr(2)):"mmm"==l?G+=V.s_FormatNumber_monthnames3[b.month-1]:"mmmm"==l?G+=V.s_FormatNumber_monthnames[b.month-1]:"mmmmm"==l?G+=V.s_FormatNumber_monthnames[b.month-1].charAt(0):"h"==l?G+=d+"":"h]"==l?G+=f+"":"mmin"==l?(s=1e3+h+"",G+=s.substr(2)):"mm]"==l?100>m?(s=1e3+m+"",G+=s.substr(2)):G+=m+"":"min"==l?G+=h+"":"m]"==l?G+=m+"":"hh"==l?(s=1e3+d+"",G+=s.substr(2)):"s"==l?(s=Math.floor(p),G+=s+""):"ss"==l?(s=1e3+Math.floor(p)+"",G+=s.substr(2)):"am/pm"==l||"a/p"==l?G+=v:"ss]"==l&&(100>g?(s=1e3+Math.floor(g)+"",G+=s.substr(2)):(s=Math.floor(g),G+=s+""));
else{if(n==W.commands.section)break;if(n==W.commands.comparison)continue;G+="!! Parse error !!"}return z&&(G='<span style="color:'+z+';">'+G+"</span>"),H&&(G='<span style="'+H+';">'+G+"</span>"),G},t.FormatNumber.formatTextWithFormat=function(e,o){var i,n,r,a,s=(t.Constants,t.FormatNumber),l=e+"",c="",u="",d="";if(s.parse_format_string(s.format_definitions,o),thisformat=s.format_definitions[o],!thisformat)throw"Format not parsed error!";if(i=thisformat.sectioninfo.length-1,0==i)i=0;else{if(3!=i)return l;i=3}for(n=thisformat.sectioninfo[i],r=n.sectionstart;op=thisformat.operators[r];)a=thisformat.operands[r++],op==s.commands.copy?c+="@"==a?l:a.replace(/ /g,"&nbsp;"):op==s.commands.color?u=a:op==s.commands.style&&(d=a);return u&&(c='<span style="color:'+u+';">'+c+"</span>"),d&&(c='<span style="'+d+';">'+c+"</span>"),c},t.FormatNumber.parse_format_string=function(e,o){var i,n,r,a,s,l,c,u,d,h,p,f,m,g,v,b,y,C=t.FormatNumber,w=1;if(!e[o]){for(i={operators:[],operands:[],sectioninfo:[{}]},e[o]=i,n=0,sectioninfo=i.sectioninfo[n],sectioninfo.sectionstart=0,sectioninfo.integerdigits=0,sectioninfo.fractiondigits=0,sectioninfo.commas=0,sectioninfo.percent=0,b=0;b<o.length;b++)if(y=o.charAt(b),c){if('"'==y){c=0,i.operators.push(C.commands.copy),i.operands.push(u);continue}u+=y}else if(d){if("]"==y){if(d=0,p=t.FormatNumber.parse_format_bracket(h),p.operator==C.commands.separator){sectioninfo.thousandssep=1;continue}p.operator==C.commands.date&&(sectioninfo.hasdate=1),p.operator==C.commands.comparison&&(i.hascomparison=1),i.operators.push(p.operator),i.operands.push(p.operand);continue}h+=y}else if(a)i.operators.push(C.commands.copy),i.operands.push(y),a=!1;else if(s)i.operators.push(C.commands.copy),i.operands.push(y+y+y+y+y),s=!1;else if(l)i.operators.push(C.commands.copy),i.operands.push("&nbsp;"),l=!1;else{if(f){if("general".charAt(f)==y.toLowerCase()){f++,7==f&&(i.operators.push(C.commands.general),i.operands.push(y),f=0);continue}f=0}if(v){if(v.charAt(0)==y){v+=y;continue}i.operators.push(C.commands.date),i.operands.push(v),sectioninfo.hasdate=1,v=""}m?(m+=y,g=m.toLowerCase(),g!="am/pm".substring(0,g.length)&&g!="a/p".substring(0,g.length)?ampstr="":("am/pm"==g||"a/p"==g)&&(i.operators.push(C.commands.date),i.operands.push(m),m="")):"#"==y||"0"==y||"?"==y?w?(sectioninfo.integerdigits++,sectioninfo.commas&&(sectioninfo.thousandssep=1,sectioninfo.commas=0),r=1,i.operators.push(C.commands.integer_placeholder),i.operands.push(y)):(sectioninfo.fractiondigits++,r=1,i.operators.push(C.commands.fraction_placeholder),i.operands.push(y)):"."==y?(r=0,i.operators.push(C.commands.decimal),i.operands.push(y),w=0):"$"==y?(r=0,i.operators.push(C.commands.currency),i.operands.push(y)):","==y?r?sectioninfo.commas++:(i.operators.push(C.commands.copy),i.operands.push(y)):"%"==y?(r=0,sectioninfo.percent++,i.operators.push(C.commands.copy),i.operands.push(y)):'"'==y?(r=0,c=1,u=""):"["==y?(r=0,d=1,h=""):"\\"==y?(a=1,r=0):"*"==y?(s=1,r=0):"_"==y?(l=1,r=0):";"==y?(n++,i.sectioninfo[n]={},sectioninfo=i.sectioninfo[n],sectioninfo.sectionstart=1+i.operators.length,sectioninfo.integerdigits=0,sectioninfo.fractiondigits=0,sectioninfo.commas=0,sectioninfo.percent=0,w=1,r=0,i.operators.push(C.commands.section),i.operands.push(y)):"g"==y.toLowerCase()?(f=1,r=0):"a"==y.toLowerCase()?(m=y,r=0):"dmyhHs".indexOf(y)>=0?v=y:(r=0,i.operators.push(C.commands.copy),i.operands.push(y))}v&&(i.operators.push(C.commands.date),i.operands.push(v),sectioninfo.hasdate=1)}},t.FormatNumber.parse_format_bracket=function(e){var o,i=t.FormatNumber,n=t.Constants,r={};return"$"==e.charAt(0)?(r.operator=i.commands.currency,o=e.match(/^\$(.+?)(\-.+?){0,1}$/),r.operand=o?o[1]||n.FormatNumber_defaultCurrency||"$":e.substring(1)||n.FormatNumber_defaultCurrency||"$"):"?$"==e?(r.operator=i.commands.currency,r.operand="[?$]"):i.allowedcolors[e.toUpperCase()]?(r.operator=i.commands.color,r.operand=i.allowedcolors[e.toUpperCase()]):(o=e.match(/^style=([^"]*)$/))?(r.operator=i.commands.style,r.operand=o[1]):","==e?(r.operator=i.commands.separator,r.operand=e):i.alloweddates[e.toUpperCase()]?(r.operator=i.commands.date,r.operand=i.alloweddates[e.toUpperCase()]):(o=e.match(/^[<>=]/))?(o=e.match(/^([<>=]+)(.+)$/),r.operator=i.commands.comparison,r.operand=o[1]+":"+o[2]):(r.operator=i.commands.copy,r.operand="["+e+"]"),r},t.FormatNumber.convert_date_gregorian_to_julian=function(e,o,i){var n;return n=i-32075+t.intFunc(1461*(e+4800+t.intFunc((o-14)/12))/4),n+=t.intFunc(367*(o-2-12*t.intFunc((o-14)/12))/12),n-=t.intFunc(3*t.intFunc((e+4900+t.intFunc((o-14)/12))/100)/4)},t.FormatNumber.convert_date_julian_to_gregorian=function(e){var t,o,i,n,r;return t=e+68569,o=Math.floor(4*t/146097),t-=Math.floor((146097*o+3)/4),i=Math.floor(4e3*(t+1)/1461001),t=t-Math.floor(1461*i/4)+31,n=Math.floor(80*t/2447),r=t-Math.floor(2447*n/80),t=Math.floor(n/11),n=n+2-12*t,i=100*(o-49)+i+t,{year:i,month:n,day:r}},t.intFunc=function(e){return 0>e?-Math.floor(-e):Math.floor(e)};var t;t||(t={}),t.Formula={},t.TriggerIoAction={},t.Formula.ParseState={num:1,alpha:2,coord:3,string:4,stringquote:5,numexp1:6,numexp2:7,alphanumeric:8,specialvalue:9},t.Formula.TokenType={num:1,coord:2,op:3,name:4,error:5,string:6,space:7},t.Formula.CharClass={num:1,numstart:2,op:3,eof:4,alpha:5,incoord:6,error:7,quote:8,space:9,specialstart:10},t.Formula.CharClassTable={" ":9,"!":3,'"':8,"'":8,"#":10,$:6,"%":3,"&":3,"(":3,")":3,"*":3,"+":3,",":3,"-":3,".":2,"/":3,0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,":":3,"<":3,"=":3,">":3,A:5,B:5,C:5,D:5,E:5,F:5,G:5,H:5,I:5,J:5,K:5,L:5,M:5,N:5,O:5,P:5,Q:5,R:5,S:5,T:5,U:5,V:5,W:5,X:5,Y:5,Z:5,"^":3,_:5,a:5,b:5,c:5,d:5,e:5,f:5,g:5,h:5,i:5,j:5,k:5,l:5,m:5,n:5,o:5,p:5,q:5,r:5,s:5,t:5,u:5,v:5,w:5,x:5,y:5,z:5},t.Formula.UpperCaseTable={a:"A",b:"B",c:"C",d:"D",e:"E",f:"F",g:"G",h:"H",i:"I",j:"J",k:"K",l:"L",m:"M",n:"N",o:"O",p:"P",q:"Q",r:"R",s:"S",t:"T",u:"U",v:"V",w:"W",x:"X",y:"Y",z:"Z",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z"},t.Formula.SpecialConstants={"#NULL!":"0,e#NULL!","#NUM!":"0,e#NUM!","#DIV/0!":"0,e#DIV/0!","#VALUE!":"0,e#VALUE!","#REF!":"0,e#REF!","#NAME?":"0,e#NAME?"},t.Formula.TokenPrecedence={"!":1,":":2,",":2,M:-3,P:-3,"%":4,"^":5,"*":6,"/":6,"+":7,"-":7,"&":8,"<":9,">":9,G:9,L:9,N:9},t.Formula.TokenOpExpansion={G:">=",L:"<=",M:"-",N:"<>",P:"+"},t.Formula.TypeLookupTable={unaryminus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unaryplus:{"n*":"|n*:1|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},unarypercent:{"n*":"|n:n%|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},plus:{"n%":"|n%:n%|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",nd:"|n%:n|nd:nd|nt:ndt|ndt:ndt|n$:n|n:nd|n*:n|b:n|e*:2|t*:e#VALUE!|",nt:"|n%:n|nd:ndt|nt:nt|ndt:ndt|n$:n|n:nt|n*:n|b:n|e*:2|t*:e#VALUE!|",ndt:"|n%:n|nd:ndt|nt:ndt|ndt:ndt|n$:n|n:ndt|n*:n|b:n|e*:2|t*:e#VALUE!|",n$:"|n%:n|nd:n|nt:n|ndt:n|n$:n$|n:n$|n*:n|b:n|e*:2|t*:e#VALUE!|",nl:"|n%:n|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",n:"|n%:n|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|",b:"|n%:n%|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|","t*":"|ni:1|n*:e#VALUE!|t*:e#VALUE!|b:e#VALUE!|e*:2|","n*":"|ni:1|e*:2|","e*":"|e*:1|n*:1|t*:1|b:1|"},concat:{t:"|t:t|th:th|tw:tw|tl:t|tr:tr|t*:2|e*:2|",th:"|t:th|th:th|tw:t|tl:th|tr:t|t*:t|e*:2|",tw:"|t:tw|th:t|tw:tw|tl:tw|tr:tw|t*:t|e*:2|",tl:"|t:tl|th:th|tw:tw|tl:tl|tr:tr|t*:t|e*:2|","t*":"|t*:t|e*:2|","e*":"|e*:1|n*:1|t*:1|"},oneargnumeric:{"n*":"|n*:n|","e*":"|e*:1|","t*":"|t*:e#VALUE!|",b:"|b:n|"},twoargnumeric:{"n*":"|n*:n|t*:e#VALUE!|e*:2|","e*":"|e*:1|n*:1|t*:1|","t*":"|t*:e#VALUE!|n*:e#VALUE!|e*:2|"},propagateerror:{"n*":"|n*:2|e*:2|","e*":"|e*:2|","t*":"|t*:2|e*:2|",b:"|b:2|e*:2|"}},t.Formula.ParseFormulaIntoTokens=function(e){var o,i,n,r,a,s,l,c,u=t.Formula,d=t.Constants,h=u.ParseState,p=u.TokenType,f=u.CharClass,m=u.CharClassTable,g=u.UpperCaseTable,v=u.ParsePushToken,b=/^\$?[A-Z]{1,2}\$?[1-9]\d*$/i,y=[],C="",w=0,r=!1,x="";for(o=0;o<=e.length;o++)o<e.length?(i=e.charAt(o),n=m[i]):(i="",n=f.eof),w==h.num&&(n==f.num?C+=i:n!=f.numstart||r?"E"==i||"e"==i?(C+=i,r=!1,w=h.numexp1):(v(y,C,p.num,0),r=!1,w=0):(r=!0,C+=i)),w==h.numexp1&&(n==h.num?w=h.numexp2:"+"!=i&&"-"!=i||"E"!=g[C.charAt(C.length-1)]?"E"==i||"e"==i||(v(y,d.s_parseerrexponent,p.error,0),w=0):C+=i),w==h.numexp2&&(n==f.num?C+=i:(v(y,C,p.num,0),w=0)),w==h.alpha&&(n==f.num?w=h.coord:n==f.alpha||"."==i?C+=i:n==f.incoord?w=h.coord:n==f.op||n==f.numstart||n==f.space||n==f.eof?(v(y,C.toUpperCase(),p.name,0),w=0):(v(y,d.s_parseerrchar,p.error,0),w=0)),w==h.coord&&(n==f.num?C+=i:n==f.incoord?C+=i:n==f.alpha?w=h.alphanumeric:n==f.op||n==f.numstart||n==f.eof||n==f.space?(c=b.test(C)?p.coord:p.name,v(y,C.toUpperCase(),c,0),w=0):(v(y,d.s_parseerrchar,p.error,0),w=0)),w==h.alphanumeric&&(n==f.num||n==f.alpha?C+=i:n==f.op||n==f.numstart||n==f.space||n==f.eof?(v(y,C.toUpperCase(),p.name,0),w=0):(v(y,d.s_parseerrchar,p.error,0),w=0)),w==h.string?n==f.quote?w=h.stringquote:n==f.eof?(v(y,d.s_parseerrstring,p.error,0),w=0):C+=i:w==h.stringquote?n==f.quote?(C+=i,w=h.string):(v(y,C,p.string,0),w=0):w==h.specialvalue&&("!"==C.charAt(C.length-1)?(v(y,C,p.name,0),w=0):n==f.eof?(v(y,d.s_parseerrspecialvalue,p.error,0),w=0):C+=i),0==w&&(n==f.num?(C=i,w=h.num):n==f.numstart?(C=i,r=!0,w=h.num):n==f.alpha||n==f.incoord?(C=i,w=h.alpha):n==f.specialstart?(C=i,w=h.specialvalue):n==f.op?(C=i,y.length>0?(a=y[y.length-1],s=a.type,l=a.text,s==f.op&&(x=l+C,("<="==x||">="==x||"<>"==x)&&(C=l+C,y.pop(),y.length>0?(a=y[y.length-1],s=a.type,l=a.text):(s=f.eof,l="EOF")))):(s=f.eof,l="EOF"),c=p.op,0==y.length||s==f.op&&")"!=l&&"%"!=l?"-"==C?(C="M",i="M"):"+"==C?(C="P",i="P"):")"==C&&"("==l||"("!=C&&(c=p.error,C=d.s_parseerrtwoops):C.length>1&&(">="==C?(C="G",i="G"):"<="==C?(C="L",i="L"):"<>"==C?(C="N",i="N"):(c=p.error,C=d.s_parseerrtwoops)),v(y,C,c,i),w=0):n==f.quote?(C="",w=h.string):n==f.space||n==f.eof||v(y,d.s_parseerrchar,p.error,0));return y},t.Formula.ParsePushToken=function(e,t,o,i){e.push({text:t,type:o,opcode:i})},t.Formula.evaluate_parsed_formula=function(e,o,i){{var n,r,a=t.Formula;a.TokenType}return r=a.ConvertInfixToPolish(e),n=a.EvaluatePolish(e,r,o,i)},t.Formula.ConvertInfixToPolish=function(e){var o,i,n,r,a,s,l=t.Formula,c=t.Constants,u=l.TokenType,d=l.TokenPrecedence,h=[],p=[],f="",m=-1;for(o=0;o<e.length;o++)if(i=e[o],n=i.type,r=i.text,n==u.num||n==u.coord||n==u.string)h.push(o);else if(n==u.name)p.push(o),h.push(m);else{if(n==u.space)continue;if(","==r){for(;p.length&&"("!=e[p[p.length-1]].text;)h.push(p.pop());if(0==p.length){f=c.s_parseerrmissingopenparen;break}}else if("("==r)p.push(o);else if(")"==r){for(;p.length&&"("!=e[p[p.length-1]].text;)h.push(p.pop());if(0==p.length){f=c.s_parseerrcloseparennoopen;break}p.pop(),p.length&&e[p[p.length-1]].type==u.name&&h.push(p.pop())}else{if(n!=u.op){if(n==u.error){f=r;break}f="Internal error while processing parsed formula. ";break}for(p.length&&e[p[p.length-1]].type==u.name&&h.push(p.pop());!(!p.length||e[p[p.length-1]].type!=u.op||"("==e[p[p.length-1]].text||(a=d[i.opcode],s=d[e[p[p.length-1]].opcode],a>=0&&s>a)||0>a&&(a=-a,0>s&&(s=-s),s>=a));)h.push(p.pop());p.push(o)}}for(;p.length>0;){if("("==e[p[p.length-1]].text){f=c.s_parseerrmissingcloseparen;break}h.push(p.pop())}return f?f:h},"undefined"==typeof t.debug_log&&(t.debug_log=[]),t.DebugLog=function(){},t.Formula.EvaluatePolish=function(e,o,i,n){var r,a,s,l,c,u,d,h,p,f,m,g,v,b,y=t.Formula,C=t.Constants,w=y.TokenType,x=y.LookupResultType,_=y.TypeLookupTable,S=y.OperandAsNumber,k=y.OperandAsText,T=y.OperandValueAndType,F=y.OperandsAsCoordOnSheet,E=t.format_number_for_display||function(e){return e+""},D="",P=-1,A={value:"",type:"e#VALUE!",error:C.s_parseerrmissingoperand},I=[],M=function(e,t){I.push({type:e,value:t})};if(!(e.length&&o instanceof Array))return{value:"",type:"e#VALUE!",error:"string"==typeof o?o:""};var R=[];for(r=0;r<o.length;r++)if(a=o[r],a!=P)if(s=e[a],l=s.type,c=s.text,R.push(s),l==w.num)M("n",c-0);else if(l==w.coord)M("coord",c);else if(l==w.string)M("t",c);else if(l==w.op){if(I.length<=0)return A;if("M"==c)u=S(i,I),f=x(u.type,u.type,_.unaryminus),M(f,-u.value);else if("P"==c)u=S(i,I),f=x(u.type,u.type,_.unaryplus),M(f,u.value);else if("%"==c)u=S(i,I),f=x(u.type,u.type,_.unarypercent),M(f,.01*u.value);else if("&"==c){if(I.length<=1)return A;d=k(i,I),u=k(i,I),f=x(u.type,u.type,_.concat),M(f,u.value+d.value)}else if(":"==c){if(I.length<=1)return A;u=y.OperandsAsRangeOnSheet(i,I),u.error&&(D=D||u.error),M(u.type,u.value)}else if("!"==c){if(I.length<=1)return A;u=F(i,I),u.error&&(D=D||u.error),M(u.type,u.value)}else if("<"==c||"L"==c||"="==c||"G"==c||">"==c||"N"==c){if(I.length<=1){D=C.s_parseerrmissingoperand;break}d=T(i,I),u=T(i,I),"n"==u.type.charAt(0)&&"n"==d.type.charAt(0)?(g=0,"<"==c?g=u.value<d.value?1:0:"L"==c?g=u.value<=d.value?1:0:"="==c?g=u.value==d.value?1:0:"G"==c?g=u.value>=d.value?1:0:">"==c?g=u.value>d.value?1:0:"N"==c&&(g=u.value!=d.value?1:0),M("nl",g)):"e"==u.type.charAt(0)?M(u.type,0):"e"==d.type.charAt(0)?M(d.type,0):(h=u.type.charAt(0),p=d.type.charAt(0),"n"==h?u.value=E(u.value,"n",""):"b"==h&&(u.value=""),"n"==p?d.value=E(d.value,"n",""):"b"==p&&(d.value=""),g=0,u.value=u.value.toLowerCase(),d.value=d.value.toLowerCase(),"<"==c?g=u.value<d.value?1:0:"L"==c?g=u.value<=d.value?1:0:"="==c?g=u.value==d.value?1:0:"G"==c?g=u.value>=d.value?1:0:">"==c?g=u.value>d.value?1:0:"N"==c&&(g=u.value!=d.value?1:0),M("nl",g))}else{if(I.length<=1){D=C.s_parseerrmissingoperand;break}"+"==c?(d=T(i,I),u=T(i,I),f=x(u.type,d.type,_.plus),M(f,u.value+d.value)):(d=S(i,I),u=S(i,I)),"-"==c?(f=x(u.type,d.type,_.plus),M(f,u.value-d.value)):"*"==c?(f=x(u.type,d.type,_.plus),M(f,u.value*d.value)):"/"==c?0!=d.value?M("n",u.value/d.value):M("e#DIV/0!",0):"^"==c&&(u.value=Math.pow(u.value,d.value),u.type="n",isNaN(u.value)&&(u.value=0,u.type="e#NUM!"),M(u.type,u.value))}}else{if(l!=w.name){D=C.s_InternalError+"Unknown token "+l+" ("+c+"). ";break}if(D=y.CalculateFunction(c,I,i,e.coord))break}else M("start",0);return value=I[0]?I[0].value:"",h=I[0]?I[0].type:"","name"==h&&(u=t.Formula.LookupName(i,value),value=u.value,h=u.type,D=D||u.error),"coord"==h&&(u=T(i,I),value=u.value,h=u.type,"b"==h&&(h="n",value=0)),I.length>1&&!D&&(D+=C.s_parseerrerrorinformula),m=h,"e"==h.charAt(0)?D=D||h.substring(1)||C.s_calcerrerrorvalueinformula:"range"==h&&(v=value.match(/^(.*)\|(.*)\|/),b=v[1].indexOf("!"),v[1]=b>=0?v[1].substring(b+1)+"!"+v[1].substring(0,b).toUpperCase():v[1].toUpperCase(),value=v[1]+":"+v[2].toUpperCase(),n||(D=C.s_formularangeresult+" "+value)),D&&"e"!=m.charAt(0)&&(value=D,m="e"),"n"!=m.charAt(0)||!isNaN(value)&&isFinite(value)||(value=0,m="e#NUM!",D=isNaN(value)?C.s_calcerrnumericnan:C.s_calcerrnumericoverflow),{value:value,type:m,error:D}},t.Formula.LookupResultType=function(e,t,o){var i,n,r,a=o[e];return a||(a=o[e.charAt(0)+"*"])?(i=a.indexOf("|"+t+":"),i>=0?(n=a.indexOf("|",i+1),0>n?"e#VALUE! (internal error, incorrect LookupResultType "+a+")":(r=a.substring(i+t.length+2,n),"1"==r?e:"2"==r?t:r)):(i=a.indexOf("|"+t.charAt(0)+"*:"),i>=0?(n=a.indexOf("|",i+1),0>n?"e#VALUE! (internal error, incorrect LookupResultType "+a+")":(r=a.substring(i+4,n),"1"==r?e:"2"==r?t:r)):"e#VALUE!")):"e#VALUE! (internal error, missing LookupResultType "+e.charAt(0)+"*)"},t.Formula.TopOfStackValueAndType=function(e,o){var i=t.Formula,n={type:"",value:""},r=o.length;return r?(n.value=o[r-1].value,n.type=o[r-1].type,o.pop(),"name"==n.type&&(n=i.LookupName(e,n.value)),n):(n.error=t.Constants.s_InternalError+"no operand on stack",n)},t.Formula.OperandAsNumber=function(e,o){var i,n,r=t.Formula.OperandValueAndType(e,o);return i=r.type.charAt(0),"n"==i?r.value=r.value-0:"b"==i?(r.type="n",r.value=0):"e"==i?r.value=0:(n=t.DetermineValueType?t.DetermineValueType(r.value):{value:r.value-0,type:"n"},"n"==n.type.charAt(0)?(r.value=n.value-0,r.type=n.type):(r.value=0,r.type=n.type)),r},t.Formula.OperandAsText=function(e,o){var i,n=t.Formula.OperandValueAndType(e,o);return i=n.type.charAt(0),"t"==i||("n"==i?(n.value=t.format_number_for_display?t.format_number_for_display(n.value,n.type,""):n.value=n.value+"",n.type="t"):"b"==i?(n.value="",n.type="t"):"e"==i?n.value="":(o.value=n.value+"",o.type="t")),n},t.Formula.OperandValueAndType=function(e,o){var i,n,r,a,s=t.Formula,l={type:"",value:""},c=o.length;if(!c)return l.error=t.Constants.s_InternalError+"no operand on stack",l;if(l.value=o[c-1].value,l.type=o[c-1].type,o.pop(),"name"==l.type&&(l=s.LookupName(e,l.value)),"range"==l.type&&(l=s.StepThroughRangeDown(o,l.value)),"coord"==l.type){if(a=e,r=l.value.indexOf("!"),-1!=r){if(a=s.FindInSheetCache(l.value.substring(r+1)),null==a)return l.type="e#REF!",l.error=t.Constants.s_sheetunavailable+" "+l.value.substring(r+1),l.value=0,l;l.value=l.value.substring(0,r)}a?(n=a.cells[t.Formula.PlainCoord(l.value)],n?(i=n.valuetype,l.value=n.datavalue):i="b"):(i="e#N/A",l.value=0),l.type=i||"b","b"==l.type&&(l.value=0)}return l},t.Formula.OperandAsCoord=function(e,o){return t.Formula.OperandAsType(e,o,"coord")},t.Formula.OperandAsRange=function(e,o){return t.Formula.OperandAsType(e,o,"range")},t.Formula.OperandAsType=function(e,o,i){var n=(t.Formula,{type:"",value:""}),r=o.length;return n.value=o[r-1].value,n.type=o[r-1].type,o.pop(),"name"==n.type&&(n=t.Formula.LookupName(e,n.value)),n.type==i?n:(n.value=t.Constants.s_calcerrcellrefmissing,n.type="e#REF!",n)},t.Formula.OperandsAsCoordOnSheet=function(e,o){var i,n,r,a,s={},l={},c=t.Formula,u=o.length;return s.value=o[u-1].value,s.type=o[u-1].type,o.pop(),i=c.OperandAsSheetName(e,o),n=c.FindInSheetCache(i.value),null==n?(l.type="e#REF!",l.value=0,l.error=t.Constants.s_sheetunavailable+" "+i.value,l):("name"==s.type&&(s=c.LookupName(n,s.value)),l.type=s.type,"coord"==s.type?l.value=s.value+"!"+i.value:"range"==s.type?(r=s.value.indexOf("|"),a=s.value.indexOf("|",r+1),l.value=s.value.substring(0,r)+"!"+i.value+"|"+s.value.substring(r+1,a)+"|"):"e"==s.type.charAt(0)?l.value=s.value:(l.error=t.Constants.s_calcerrcellrefmissing,l.type="e#REF!",l.value=0),l)},t.Formula.OperandsAsRangeOnSheet=function(e,o){var i,n,r,a,s={},l=t.Formula,c=t.Constants,u=o.length;return s.value=o[u-1].value,s.type=o[u-1].type,o.pop(),i=l.OperandAsCoord(e,o),"coord"!=i.type?{value:0,type:"e#REF!"}:(n=e,r=i.value.indexOf("!"),-1!=r&&(a=i.value.indexOf("|",r+1),0>a&&(a=i.value.length),n=l.FindInSheetCache(i.value.substring(r+1,a)),null==n)?{value:0,type:"e#REF!",errortext:c.s_sheetunavailable+" "+i.value.substring(r+1,a)}:("name"==s.type&&(s=l.LookupName(n,s.value,"end")),"coord"==s.type?{value:i.value+"|"+s.value+"|",type:"range"}:{value:c.s_calcerrcellrefmissing,type:"e#REF!"}))},t.Formula.OperandAsSheetName=function(e,o){var i,n,r=(t.Formula,{type:"",value:""}),a=o.length;if(r.value=o[a-1].value,r.type=o[a-1].type,o.pop(),"name"==r.type){if(i=t.Formula.LookupName(e,r.value),!i.value)return r;r.value=i.value,r.type=i.type}return"coord"==r.type&&(n=e.cells[t.Formula.PlainCoord(r.value)],n?(r.value=n.datavalue,r.type=n.valuetype):(r.value="",r.type="b")),"t"==r.type.charAt(0)?r:(r.value="",r.error=t.Constants.s_calcerrsheetnamemissing,r)},t.Formula.LookupName=function(e,o,i){var n,r,a,s=e.names,l={},c=!1;if(s[o.toUpperCase()]){if(l.value=s[o.toUpperCase()].definition,"="==l.value.charAt(0)){if(e.checknamecirc){if(e.checknamecirc[o])return l.type="e#NAME?",l.error=t.Constants.s_circularnameref+' "'+o+'".',l}else e.checknamecirc={},c=!0;if(e.checknamecirc[o]=!0,a=t.Formula.ParseFormulaIntoTokens(l.value.substring(1)),l=t.Formula.evaluate_parsed_formula(a,e,1),delete e.checknamecirc[o],c&&delete e.checknamecirc,"range"!=l.type)return l}return n=l.value.indexOf(":"),-1!=n?(l.type="range",l.value=l.value.substring(0,n)+"|"+l.value.substring(n+1)+"|",l.value=l.value.toUpperCase()):(l.type="coord",l.value=l.value.toUpperCase()),l}return(r=t.Formula.SpecialConstants[o.toUpperCase()])?(n=r.indexOf(","),l.value=r.substring(0,n)-0,l.type=r.substring(n+1),l):/^[a-zA-Z][a-zA-Z]?$/.test(o)?(l.type="coord",l.value=o.toUpperCase()+(i?e.attribs.lastrow:1),l):(l.value="",l.type="e#NAME?",l.error=t.Constants.s_calcerrunknownname+' "'+o+'"',l)},t.Formula.StepThroughRangeDown=function(e,o){var i,n,r,a,s,l,c,u,d,h,p=t.Formula;for(a=o.indexOf("|"),s=o.indexOf("|",a+1),i=o.substring(0,a),n=o.substring(a+1,s),r=o.substring(s+1)-0,a=i.indexOf("!"),-1!=a?(l=i.substring(a),i=i.substring(0,a)):l="",a=n.indexOf("!"),-1!=a&&(n=n.substring(0,a)),c=p.OrderRangeParts(i,n),h=0,d=c.r1;d<=c.r2;d++)for(u=c.c1;u<=c.c2;u++)if(h++,h>r)return(d!=c.r2||u!=c.c2)&&p.PushOperand(e,"range",i+l+"|"+n+"|"+h),{value:t.crToCoord(u,d)+l,type:"coord"}},t.Formula.DecodeRangeParts=function(e,o){var i,n,r,a,s,l,c,u=t.Formula;return r=o.indexOf("|"),a=o.indexOf("|",r+1),i=o.substring(0,r),n=o.substring(r+1,a),r=i.indexOf("!"),-1!=r?(s=i.substring(r+1),i=i.substring(0,r)):s="",r=n.indexOf("!"),-1!=r&&(n=n.substring(0,r)),l=e,s&&(l=u.FindInSheetCache(s),null==l)?null:(c=u.OrderRangeParts(i,n),{sheetdata:l,sheetname:s,col1num:c.c1,ncols:c.c2-c.c1+1,row1num:c.r1,nrows:c.r2-c.r1+1})},t.Formula.FunctionList||(t.Formula.FunctionList={}),t.Formula.FunctionClasses=null,t.Formula.FunctionArgDefs={},t.Formula.StoreIoEventFormula=function(e,o,i,n,r){var a=[];if(t.Formula.Clone(a,i),a.reverse(),0!=a.length){if("undefined"==typeof n.ioEventTree&&(n.ioEventTree={}),"undefined"==typeof n.ioParameterList&&(n.ioParameterList={}),"undefined"==typeof n.ioTimeTriggerList&&(n.ioTimeTriggerList={}),"undefined"==typeof n.radioGroupList&&(n.radioGroupList={}),"undefined"==typeof n.ioParameterList[o]&&(n.ioParameterList[o]={}),n.ioParameterList[o]=a,n.ioParameterList[o].function_name=e,"TimeTrigger"==r){var s=function(e,t,o){var i=o.cells[t];"undefined"!=typeof i&&"n"==i.valuetype.charAt(0)&&e.push(i.datavalue)},l=t.Formula.PlainCoord(a[0].value),c=[];if("range"==a[0].type)for(var u=t.Formula.DecodeRangeParts(n,l),d=0;d<u.ncols;d++)for(var h=0;h<u.nrows;h++){var p=t.crToCoord(u.col1num+d,u.row1num+h);s(c,p,n)}if("coord"==a[0].type&&s(c,l,n),"n"==a[0].type.charAt(0)&&c.push(a[0].value),"undefined"==typeof n.ioTimeTriggerList[o]||0==t.Formula.ArrayValuesEqual(n.ioTimeTriggerList[o],c)){n.ioTimeTriggerList[o]=c;for(var f=(new Date).getTimezoneOffset(),m=25569,g=[],v=0;v<c.length;++v)g[v]=Math.floor(24*(c[v]-m)*60+f);n.ScheduleSheetCommands("settimetrigger "+o+" "+g.toString())}}if("EventTree"==r&&("coord"==a[0].type||"range"==a[0].type)){var b=a[0].value.replace(/\$/g,""),y=function(e,t,o){"undefined"==typeof e[t]&&(e[t]={}),e[t][o]=o};if("range"==a[0].type)for(var u=t.Formula.DecodeRangeParts(n,b),d=0;d<u.ncols;d++)for(var h=0;h<u.nrows;h++){var C=t.crToCoord(u.col1num+d,u.row1num+h);y(n.ioEventTree,C,o)}"coord"==a[0].type&&y(n.ioEventTree,b,o)}if("Input"==r){var w=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject.formDataViewer:t.CurrentSpreadsheetViewerObject.formDataViewer;if(null!=w&&1==w.loaded){null==w.formFields&&t.Formula.LoadFormFields();var x=(e+o).toLowerCase(),_=null;if(null==w.formFields[x]){var S=w.formFields[x]=w.formFieldsLength++ +2,k=t.crToCoord(S,1);_="set "+k+" text t "+t.encodeForSave(e.toLowerCase()+o)}if("t"==a[0].type.charAt(0)||"n"==a[0].type.charAt(0)){var T=t.crToCoord(w.formFields[x],2);if(null==w.sheet.cells[T]||w.sheet.cells[T].datavalue!=a[0].value){var F="set "+T+" text t "+t.encodeForSave(a[0].value);_=null!=_?_+"\n"+F:F}}null!=_&&w.sheet.ScheduleSheetCommands(_,!1)}}}},t.Formula.ArrayValuesEqual=function(e,t){var o=e.length;if(o!=t.length)return!1;for(;o--;)if(e[o]!==t[o])return!1;return!0},t.Formula.Clone=function(e,o){for(var i in o)"object"==typeof o[i]&&null!==o[i]&&e[i]?t.Formula.Clone(e[i],o[i]):e[i]=o[i]},t.Formula.LoadFormFields=function(){var e=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject.formDataViewer:t.CurrentSpreadsheetViewerObject.formDataViewer;e.formFields={},null==e.sheet.cells.A1&&e.sheet.ScheduleSheetCommands("set A1 text t "+t.encodeForSave("FieldName:"),!1),null==e.sheet.cells.A2&&e.sheet.ScheduleSheetCommands("set A2 text t "+t.encodeForSave("Pending:"),!1);for(var o=2;;){var i=t.crToCoord(o,1),n=e.sheet.cells[i];if(!n)break;e.formFields[n.datavalue.toLowerCase()]=o,o++}e.formFieldsLength=o-2},t.Formula.CalculateFunction=function(e,o,i,n){var r,a,s,l,c,u=t.Formula,d="";if(r=u.FunctionList[e]){if(a=[],s=r[0],l=r[1],u.CopyFunctionArgs(o,a),r[6]&&""!=r[6]&&(t.DebugLog("action:"+e),u.StoreIoEventFormula(e,n,a,i,r[6])),100!=l)if(0>l){if(a.length<-l)return d=u.FunctionArgsError(e,o)}else if(a.length!=l)return d=u.FunctionArgsError(e,o);d=s(e,o,a,i,n)}else c=e,o.length&&"start"==o[o.length-1].type?(o.pop(),u.PushOperand(o,"name",c)):d=t.Constants.s_sheetfuncunknownfunction+" "+c+". ";return d},t.Formula.PushOperand=function(e,t,o){e.push({type:t,value:o})},t.Formula.CopyFunctionArgs=function(e,o){var o;for(t.Formula;e.length>0&&"start"!=e[e.length-1].type;)o.push(e.pop());e.pop()},t.Formula.FunctionArgsError=function(e,o){var i=t.Constants.s_calcerrincorrectargstofunction+" "+e+". ";return t.Formula.PushOperand(o,"e#VALUE!",i),i},t.Formula.FunctionSpecificError=function(e,o,i,n){return t.Formula.PushOperand(o,i,n),n},t.Formula.CheckForErrorValue=function(e,t){return"e"==t.type.charAt(0)?(e.push(t),!0):!1},t.Formula.FillFunctionInfo=function(){var e,o,i,n,r,a=t.Formula,s=t.Constants;if(!a.FunctionClasses){for(e in a.FunctionList)o=a.FunctionList[e],o[2]&&(a.FunctionArgDefs[o[2]]=s["s_farg_"+o[2]]||""),o[3]||s["s_fdef_"+e]&&(a.FunctionList[e][3]=s["s_fdef_"+e]);for(a.FunctionClasses={},r=0;r<s.function_classlist.length;r++)n=s.function_classlist[r],a.FunctionClasses[n]={name:s["s_fclass_"+n],items:[]};for(e in a.FunctionList)for(o=a.FunctionList[e],i=o[4]?o[4].split(","):[],i.push("all"),r=0;r<i.length;r++)n=i[r],a.FunctionClasses[n].items.push(e);for(n in a.FunctionClasses)a.FunctionClasses[n].items.sort()}},t.Formula.FunctionArgString=function(e){var o,i,n,r=t.Formula,a=r.FunctionList[e],s=a[2];if(!s){if(o=a[1],0!=o){if(o>0){for(n="v1",i=2;o>=i;i++)n+=", v"+i;return n}if(0>o){for(n="v1",i=2;-o>i;i++)n+=", v"+i;return n+", ..."}return"nargs: "+o}s=" "}return n=r.FunctionArgDefs[s]||s},t.Formula.SeriesFunctions=function(e,o,i,n){for(var r,a,s,l,c,u,d,h,p,f=t.Formula,m=f.OperandValueAndType,g=f.LookupResultType,v=f.TypeLookupTable.plus,b=function(e,t){o.push({type:e,value:t})},y="",C=0,w="",x=0,_=0,S=0,k=1;i.length>0;)r=m(n,i),a=r.type.charAt(0),"n"==a&&(x+=1),"b"!=a&&(_+=1),"b"==a&&(S+=1),"e"!=a&&"b"!=a&&(y+=r.value),"n"==a?(s=r.value-0,C+=s,k*=s,l=void 0!=l?s>l?s:l:s,c=void 0!=c?c>s?s:c:s,1==x?(h=s,p=0):(u=h+(s-h)/x,d=p+(s-h)*(s-u),p=d,h=u),w=g(r.type,w||r.type,v)):"e"==a&&"e"!=w.charAt(0)&&(w=r.type);switch(w=w||"n",e){case"CONCAT":case"CONCATENATE":b("t",y);break;case"SUM":b(w,C);break;case"PRODUCT":b(w,k);break;case"MIN":b(w,c||0);break;case"MAX":b(w,l||0);break;case"COUNT":b("n",x);break;case"COUNTA":b("n",_);break;case"COUNTBLANK":b("n",S);break;case"AVERAGE":x>0?b(w,C/x):b("e#DIV/0!",0);break;case"STDEV":x>1?b(w,Math.sqrt(d/(x-1))):b("e#DIV/0!",0);break;case"STDEVP":x>1?b(w,Math.sqrt(d/x)):b("e#DIV/0!",0);break;case"VAR":x>1?b(w,d/(x-1)):b("e#DIV/0!",0);break;case"VARP":x>1?b(w,d/x):b("e#DIV/0!",0)}return null},t.Formula.FunctionList.AVERAGE=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.CONCAT=[t.Formula.SeriesFunctions,-1,"vn",null,"text"],t.Formula.FunctionList.CONCATENATE=[t.Formula.SeriesFunctions,-1,"vn",null,"text"],t.Formula.FunctionList.COUNT=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.COUNTA=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.COUNTBLANK=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.MAX=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.MIN=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.PRODUCT=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.STDEV=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.STDEVP=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.SUM=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.VAR=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.FunctionList.VARP=[t.Formula.SeriesFunctions,-1,"vn",null,"stat"],t.Formula.SumProductFunction=function(e,o,n,r){for(var a,s=[],l=0,c=t.Formula,u=0,d=0,h=function(e,t){o.push({type:e,value:t})};n.length>0;){if(a=c.TopOfStackValueAndType(r,n),"range"!=a.type)return void h("e#VALUE!",0);if(rangeinfo=c.DecodeRangeParts(r,a.value),u){if(u!=rangeinfo.ncols)return void h("e#VALUE!",0)}else u=rangeinfo.ncols;if(d){if(d!=rangeinfo.nrows)return void h("e#VALUE!",0)}else d=rangeinfo.nrows;for(i=0;i<rangeinfo.ncols;i++)for(j=0;j<rangeinfo.nrows;j++)k=i*rangeinfo.nrows+j,cellcr=t.crToCoord(rangeinfo.col1num+i,rangeinfo.row1num+j),cell=rangeinfo.sheetdata.GetAssuredCell(cellcr),value="n"==cell.valuetype?cell.datavalue:0,s[k]=("undefined"!=typeof s[k]?s[k]:1)*value}for(i=0;i<s.length;i++)l+=s[i];h("n",l)},t.Formula.FunctionList.SUMPRODUCT=[t.Formula.SumProductFunction,-1,"rangen","","stat"],t.Formula.DSeriesFunctions=function(e,o,i,n){var r,a,s,l,c,u,d,h,p,f,m,g,v,b,y,C,w,x,_,S,k,T,F,E,D,P,A=t.Formula,I=(A.OperandValueAndType,A.LookupResultType),M=A.TypeLookupTable.plus,R=function(e,t){o.push({type:e,value:t})},r={},N=0,L="",O=0,z=0,H=0,B=0,U=1;if(s=A.TopOfStackValueAndType(n,i),l=A.OperandValueAndType(n,i),c=A.TopOfStackValueAndType(n,i),"range"!=s.type||"range"!=c.type)return A.FunctionArgsError(e,o);if(u=A.DecodeRangeParts(n,s.value),d=A.DecodeRangeParts(n,c.value),h=A.FieldToColnum(u.sheetdata,u.col1num,u.ncols,u.row1num,l.value,l.type),0>=h)return void R("e#VALUE!",0);for(p=u.col1num+h-1,b=[],f=0;f<d.ncols;f++){if(v=d.sheetdata.GetAssuredCell(t.crToCoord(d.col1num+f,d.row1num)),criterianum=A.FieldToColnum(u.sheetdata,u.col1num,u.ncols,u.row1num,v.datavalue,v.valuetype),0>=criterianum)return void R("e#VALUE!",0);b.push(u.col1num+criterianum-1)}for(f=1;f<u.nrows;f++){y=!1;e:for(m=1;m<d.nrows;m++){for(g=0;g<d.ncols;g++)if(C=t.crToCoord(d.col1num+g,d.row1num+m),v=d.sheetdata.GetAssuredCell(C),w=v.datavalue,("string"!=typeof w||0!=w.length)&&(x=b[g],_=t.crToCoord(x,u.row1num+f),v=u.sheetdata.GetAssuredCell(_),!A.TestCriteria(v.datavalue,v.valuetype||"b",w)))continue e;y=!0;break e}y&&(a=t.crToCoord(p,u.row1num+f),v=u.sheetdata.GetAssuredCell(a),r.value=v.datavalue,r.type=v.valuetype,S=r.type.charAt(0),B+=1,"n"==S&&(O+=1),"b"!=S&&(z+=1),"b"==S&&(H+=1),"n"==S?(v1=r.value-0,N+=v1,U*=v1,k=void 0!=k?v1>k?v1:k:v1,T=void 0!=T?T>v1?v1:T:v1,1==O?(D=v1,P=0):(F=D+(v1-D)/O,E=P+(v1-D)*(v1-F),P=E,D=F),L=I(r.type,L||r.type,M)):"e"==S&&"e"!=L.charAt(0)&&(L=r.type))}switch(L=L||"n",e){case"DSUM":R(L,N);break;case"DPRODUCT":R(L,U);break;case"DMIN":R(L,T||0);break;case"DMAX":R(L,k||0);break;case"DCOUNT":R("n",O);break;case"DCOUNTA":R("n",z);break;case"DAVERAGE":O>0?R(L,N/O):R("e#DIV/0!",0);break;case"DSTDEV":O>1?R(L,Math.sqrt(E/(O-1))):R("e#DIV/0!",0);break;case"DSTDEVP":O>1?R(L,Math.sqrt(E/O)):R("e#DIV/0!",0);break;case"DVAR":O>1?R(L,E/(O-1)):R("e#DIV/0!",0);break;case"DVARP":O>1?R(L,E/O):R("e#DIV/0!",0);break;case"DGET":1==B?R(r.type,r.value):0==B?R("e#VALUE!",0):R("e#NUM!",0)}},t.Formula.FunctionList.DAVERAGE=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DCOUNT=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DCOUNTA=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DGET=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DMAX=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DMIN=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DPRODUCT=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DSTDEV=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DSTDEVP=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DSUM=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DVAR=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FunctionList.DVARP=[t.Formula.DSeriesFunctions,3,"dfunc","","stat"],t.Formula.FieldToColnum=function(e,o,i,n,r,a){var s,l,c;
if("n"==a.charAt(0))return s=r-0,0>=s||s>i?0:Math.floor(s);if("t"!=a.charAt(0))return 0;for(r=r?r.toLowerCase():"",s=0;i>s;s++)if(l=e.GetAssuredCell(t.crToCoord(o+s,n)),c=l.datavalue,c=(c+"").toLowerCase(),c==r)return s+1;return 0},t.Formula.LookupFunctions=function(e,o,i,n){var r,a,s,l,c,u,d,h,p,f,m,g,v,b,y,C,r,w=t.Formula,x=w.OperandValueAndType,_=(w.LookupResultType,w.TypeLookupTable.plus,function(e,t){o.push({type:e,value:t})});if(r=x(n,i),"string"==typeof r.value&&(r.value=r.value.toLowerCase()),a=w.TopOfStackValueAndType(n,i),s=1,"MATCH"==e){if(i.length){if(s=w.OperandAsNumber(n,i),"n"!=s.type.charAt(0))return void _("e#VALUE!",0);if(i.length)return w.FunctionArgsError(e,o),0;s=s.value-0}}else{if(l=w.OperandAsNumber(n,i),"n"!=l.type.charAt(0))return void _("e#VALUE!",0);if(l=Math.floor(l.value),i.length){if(s=w.OperandAsNumber(n,i),"n"!=s.type.charAt(0))return void _("e#VALUE!",0);if(i.length)return w.FunctionArgsError(e,o),0;s=s.value?1:0}}if(r.type=r.type.charAt(0),"n"==r.type&&(r.value=r.value-0),"range"!=a.type)return w.FunctionArgsError(e,o),0;if(c=w.DecodeRangeParts(n,a.value,a.type),!c)return void _("e#REF!",0);if(u=0,d=0,h=0,p=0,"HLOOKUP"==e){if(h=1,l>c.nrows)return void _("e#REF!",0)}else if("VLOOKUP"==e){if(p=1,l>c.ncols)return void _("e#REF!",0)}else{if("MATCH"!=e)return w.FunctionArgsError(e,o),0;if(c.ncols>1){if(c.nrows>1)return void _("e#N/A",0);h=1}else p=1}if(1>l&&"MATCH"!=e)return _("e#VALUE!",0),0;for(;;){if(C=t.crToCoord(c.col1num+u,c.row1num+d),v=c.sheetdata.GetAssuredCell(C),b=v.datavalue,y=v.valuetype?v.valuetype.charAt(0):"b","n"==y&&(b-=0),s){if("n"==r.type&&"n"==y){if(r.value==b)break;if(s>0&&r.value>b||0>s&&r.value<b)f=1,m=u,g=d;else if(f){f=2;break}}else if("t"==r.type&&"t"==y){if(b="string"==typeof b?b.toLowerCase():"",r.value==b)break;if(s>0&&r.value>b||0>s&&r.value<b)f=1,m=u,g=d;else if(f){f=2;break}}}else if("n"==r.type&&"n"==y){if(r.value==b)break}else if("t"==r.type&&"t"==y&&(b="string"==typeof b?b.toLowerCase():"",r.value==b))break;if(d+=p,u+=h,d>=c.nrows||u>=c.ncols){if(f){f=2;break}return void _("e#N/A",0)}}2==f&&(d=g,u=m),"MATCH"==e?(b=u+d+1,y="n"):(C=t.crToCoord(c.col1num+u+("VLOOKUP"==e?l-1:0),c.row1num+d+("HLOOKUP"==e?l-1:0)),v=c.sheetdata.GetAssuredCell(C),b=v.datavalue,y=v.valuetype),_(y,b)},t.Formula.FunctionList.HLOOKUP=[t.Formula.LookupFunctions,-3,"hlookup","","lookup"],t.Formula.FunctionList.MATCH=[t.Formula.LookupFunctions,-2,"match","","lookup"],t.Formula.FunctionList.VLOOKUP=[t.Formula.LookupFunctions,-3,"vlookup","","lookup"],t.Formula.IndexFunction=function(e,o,i,n){var r,a,s,l,c,u,d,h=t.Formula,p=function(e,t){o.push({type:e,value:t})};if(r=h.TopOfStackValueAndType(n,i),"range"!=r.type)return h.FunctionArgsError(e,o),0;if(s=h.DecodeRangeParts(n,r.value,r.type),a=s.sheetname?"!"+s.sheetname:"",l={value:0},c={value:0},i.length){if(l=h.OperandAsNumber(n,i),"n"!=l.type.charAt(0)||l.value<0)return void p("e#VALUE!",0);if(i.length){if(c=h.OperandAsNumber(n,i),"n"!=c.type.charAt(0)||c.value<0)return void p("e#VALUE!",0);if(i.length)return h.FunctionArgsError(e,o),0}else 1==s.nrows&&(c.value=l.value,l.value=0)}return l.value>s.nrows||c.value>s.ncols?void p("e#REF!",0):(0==l.value?0==c.value?1==s.nrows&&1==s.ncols?(u=t.crToCoord(s.col1num,s.row1num)+a,d="coord"):(u=t.crToCoord(s.col1num,s.row1num)+a+"|"+t.crToCoord(s.col1num+s.ncols-1,s.row1num+s.nrows-1)+"|",d="range"):1==s.nrows?(u=t.crToCoord(s.col1num+c.value-1,s.row1num)+a,d="coord"):(u=t.crToCoord(s.col1num+c.value-1,s.row1num)+a+"|"+t.crToCoord(s.col1num+c.value-1,s.row1num+s.nrows-1)+"|",d="range"):0==c.value?1==s.ncols?(u=t.crToCoord(s.col1num,s.row1num+l.value-1)+a,d="coord"):(u=t.crToCoord(s.col1num,s.row1num+l.value-1)+a+"|"+t.crToCoord(s.col1num+s.ncols-1,s.row1num+l.value-1)+"|",d="range"):(u=t.crToCoord(s.col1num+c.value-1,s.row1num+l.value-1)+a,d="coord"),void p(d,u))},t.Formula.FunctionList.INDEX=[t.Formula.IndexFunction,-1,"index","","lookup"],t.Formula.CountifSumifFunctions=function(e,o,i,n){var r,a,s,l,c,u,d=0,h="",p=0,f=t.Formula,m=f.OperandValueAndType,g=f.LookupResultType,v=f.TypeLookupTable.plus,b=function(e,t){o.push({type:e,value:t})};if(r=f.TopOfStackValueAndType(n,i),a=f.OperandAsText(n,i),"SUMIF"==e)if(1==i.length)s=f.TopOfStackValueAndType(n,i);else{if(0!=i.length)return f.FunctionArgsError(e,o),0;s={value:r.value,type:r.type}}else s={value:r.value,type:r.type};if("n"==a.type.charAt(0)?a.value=a.value+"":"e"==a.type.charAt(0)?a.value=null:"b"==a.type.charAt(0)&&(a.value=null),"coord"!=r.type&&"range"!=r.type)return f.FunctionArgsError(e,o),0;if("SUMIF"==e&&"coord"!=s.type&&"range"!=s.type)return f.FunctionArgsError(e,o),0;for(i.push(r),l=[],l.push(s);i.length;)c=m(n,i),u=m(n,l),f.TestCriteria(c.value,c.type,a.value)&&(p+=1,"n"==u.type.charAt(0)?(d+=u.value-0,h=g(u.type,h||u.type,v)):"e"==u.type.charAt(0)&&"e"!=h.charAt(0)&&(h=u.type));h=h||"n","SUMIF"==e?b(h,d):"COUNTIF"==e&&b("n",p)},t.Formula.FunctionList.COUNTIF=[t.Formula.CountifSumifFunctions,2,"rangec","","stat"],t.Formula.FunctionList.SUMIF=[t.Formula.CountifSumifFunctions,-2,"sumif","","stat"],t.Formula.SumifsFunction=function(e,o,i,n){var r,a,s,l,c,u,d=0,h="",p=t.Formula,f=p.OperandValueAndType,m=p.LookupResultType,g=p.TypeLookupTable.plus,v=function(e,t){o.push({type:e,value:t})};if(s=p.TopOfStackValueAndType(n,i),"coord"!=s.type&&"range"!=s.type)return p.FunctionArgsError(e,o),0;for(var b=[],y=[];i.length;){if(r=p.TopOfStackValueAndType(n,i),a=p.OperandAsText(n,i),"n"==a.type.charAt(0)?a.value=a.value+"":"e"==a.type.charAt(0)?a.value=null:"b"==a.type.charAt(0)&&(a.value=null),"coord"!=r.type&&"range"!=r.type)return p.FunctionArgsError(e,o),0;b.push([r]),y.push(a)}for(l=[],l.push(s);l.length;){u=f(n,l);for(var C=!0,w=0;w<b.length;w++)c=f(n,b[w]),C&&(p.TestCriteria(c.value,c.type,y[w].value)||(C=!1));C&&("n"==u.type.charAt(0)?(d+=u.value-0,h=m(u.type,h||u.type,g)):"e"==u.type.charAt(0)&&"e"!=h.charAt(0)&&(h=u.type))}h=h||"n",v(h,d)},t.Formula.FunctionList.SUMIFS=[t.Formula.SumifsFunction,-3,"sum_range, criteria_range1, criteria1, [criteria_range2, criteria2, ... criteria_range_n, criteria_n]","","stat"],t.Formula.IfFunction=function(e,o,i,n){var r,a,s=t.Formula;if(r=t.Formula.OperandValueAndType(n,i),a=r.type.charAt(0),"n"!=a&&"b"!=a)return void o.push({type:"e#VALUE!",value:0});var l,c;if(l=i.pop(),1==i.length)c=i.pop();else{if(0!=i.length)return void s.FunctionArgsError(e,o);c={type:"n",value:0}}o.push(r.value?l:c)},t.Formula.FunctionList.IF=[t.Formula.IfFunction,-2,"iffunc","","test"],t.Formula.DateFunction=function(e,o,i,n){var r=t.Formula,a=0,s=r.OperandAsNumber(n,i),l=r.OperandAsNumber(n,i),c=r.OperandAsNumber(n,i),u=r.LookupResultType(s.type,l.type,r.TypeLookupTable.twoargnumeric);u=r.LookupResultType(u,c.type,r.TypeLookupTable.twoargnumeric),"n"==u.charAt(0)&&(a=t.FormatNumber.convert_date_gregorian_to_julian(Math.floor(s.value),Math.floor(l.value),Math.floor(c.value))-t.FormatNumber.datevalues.julian_offset,u="nd"),r.PushOperand(o,u,a)},t.Formula.FunctionList.DATE=[t.Formula.DateFunction,3,"date","","datetime"],t.Formula.TimeFunction=function(e,o,i,n){var r=t.Formula,a=0,s=r.OperandAsNumber(n,i),l=r.OperandAsNumber(n,i),c=r.OperandAsNumber(n,i),u=r.LookupResultType(s.type,l.type,r.TypeLookupTable.twoargnumeric);u=r.LookupResultType(u,c.type,r.TypeLookupTable.twoargnumeric),"n"==u.charAt(0)&&(a=(60*s.value*60+60*l.value+c.value)/86400,u="nt"),r.PushOperand(o,u,a)},t.Formula.FunctionList.TIME=[t.Formula.TimeFunction,3,"hms","","datetime"],t.Formula.DMYFunctions=function(e,o,i,n){var r,a,s,l=t.Formula,c=0,u=l.OperandAsNumber(n,i),d=l.LookupResultType(u.type,u.type,l.TypeLookupTable.oneargnumeric);if("n"==d.charAt(0))switch(r=t.FormatNumber.convert_date_julian_to_gregorian(Math.floor(u.value+t.FormatNumber.datevalues.julian_offset)),e){case"DAY":c=r.day;break;case"MONTH":c=r.month;break;case"YEAR":c=r.year;break;case"WEEKDAY":if(a={value:1},i.length){if(a=l.OperandAsNumber(n,i),"n"!=a.type.charAt(0)||a.value<1||a.value>3)return void l.PushOperand(o,"e#VALUE!",0);if(i.length)return void l.FunctionArgsError(e,o)}s=6,a.value>1&&(s-=1),c=Math.floor(u.value+s)%7+(a.value<3?1:0)}l.PushOperand(o,d,c)},t.Formula.FunctionList.DAY=[t.Formula.DMYFunctions,1,"v","","datetime"],t.Formula.FunctionList.MONTH=[t.Formula.DMYFunctions,1,"v","","datetime"],t.Formula.FunctionList.YEAR=[t.Formula.DMYFunctions,1,"v","","datetime"],t.Formula.FunctionList.WEEKDAY=[t.Formula.DMYFunctions,-1,"weekday","","datetime"],t.Formula.HMSFunctions=function(e,o,i,n){var r,a,s,l,c=t.Formula,u=0,d=c.OperandAsNumber(n,i),h=c.LookupResultType(d.type,d.type,c.TypeLookupTable.oneargnumeric);if("n"==h.charAt(0)){if(d.value<0)return void c.PushOperand(o,"e#NUM!",0);l=d.value-Math.floor(d.value),l*=24,r=Math.floor(l),l-=Math.floor(l),l*=60,a=Math.floor(l),l-=Math.floor(l),l*=60,s=Math.floor(l+(d.value>=0?.5:-.5)),"HOUR"==e?u=r:"MINUTE"==e?u=a:"SECOND"==e&&(u=s)}c.PushOperand(o,h,u)},t.Formula.FunctionList.HOUR=[t.Formula.HMSFunctions,1,"v","","datetime"],t.Formula.FunctionList.MINUTE=[t.Formula.HMSFunctions,1,"v","","datetime"],t.Formula.FunctionList.SECOND=[t.Formula.HMSFunctions,1,"v","","datetime"],t.Formula.ExactFunction=function(e,o,i,n){var r=t.Formula,a=0,s="nl",l=r.OperandValueAndType(n,i),c=l.type.charAt(0),u=r.OperandValueAndType(n,i),d=u.type.charAt(0);"t"==c?"t"==d?a=l.value==u.value?1:0:"b"==d?a=l.value.length?0:1:"n"==d?a=l.value==u.value+""?1:0:"e"==d?(a=u.value,s=u.type):a=0:"n"==c?"n"==d?a=l.value-0==u.value-0?1:0:"b"==d?a=0:"t"==d?a=l.value+""==u.value?1:0:"e"==d?(a=u.value,s=u.type):a=0:"b"==c?"t"==d?a=u.value.length?0:1:"b"==d?a=1:"n"==d?a=0:"e"==d?(a=u.value,s=u.type):a=0:"e"==c&&(a=l.value,s=l.type),r.PushOperand(o,s,a)},t.Formula.FunctionList.EXACT=[t.Formula.ExactFunction,2,"","","text"],t.Formula.ArgList={FIND:[1,1,0],LEFT:[1,0],LEN:[1],LOWER:[1],MID:[1,0,0],PROPER:[1],REPLACE:[1,0,0,1],REPT:[1,0],RIGHT:[1,0],SUBSTITUTE:[1,1,1,0],TRIM:[1],HEXCODE:[1],UPPER:[1]},t.Formula.StringFunctions=function(e,o,i,n){var r,a,s,l,c,u,d=t.Formula,h=0,p="e#VALUE!",f=i.length,m=d.ArgList[e],g=[],v=[];for(r=1;f>=r;r++){if(r>m.length)return void d.FunctionArgsError(e,o);if(0==m[r-1]?a=d.OperandAsNumber(n,i):1==m[r-1]?a=d.OperandAsText(n,i):-1==m[r-1]&&(a=d.OperandValueAndType(n,i)),g[r]=a.value,v[r]=a.type,"e"==a.type.charAt(0))return void d.PushOperand(o,a.type,h)}switch(e){case"FIND":s=v[3]?g[3]-1:0,0>s?h="Start is before string":(h=g[2].indexOf(g[1],s),h>=0?(h+=1,p="n"):h="Not found");break;case"LEFT":l=v[2]?g[2]-0:1,0>l?h="Negative length":(h=g[1].substring(0,l),p="t");break;case"LEN":h=g[1].length,p="n";break;case"LOWER":h=g[1].toLowerCase(),p="t";break;case"MID":c=g[2]-0,l=g[3]-0,1>l||1>c?h="Bad arguments":(h=g[1].substring(c-1,c+l-1),p="t");break;case"PROPER":h=g[1].replace(/\b\w+\b/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}),p="t";break;case"REPLACE":c=g[2]-0,l=g[3]-0,0>l||1>c?h="Bad arguments":(h=g[1].substring(0,c-1)+g[4]+g[1].substring(c-1+l),p="t");break;case"REPT":if(u=g[2]-0,0>u)h="Negative count";else{for(h="";u>0;u--)h+=g[1];p="t"}break;case"RIGHT":l=v[2]?g[2]-0:1,0>l?h="Negative length":(h=g[1].slice(-l),p="t");break;case"SUBSTITUTE":if(fulltext=g[1],oldtext=g[2],newtext=g[3],null!=g[4]){if(which=g[4]-0,0>=which){h="Non-positive instance number";break}}else which=0;for(u=0,oldpos=0,h="";;){if(pos=fulltext.indexOf(oldtext,oldpos),!(pos>=0)){h+=fulltext.substring(oldpos);break}if(u++,h+=fulltext.substring(oldpos,pos),0==which)h+=newtext;else{if(which==u){h+=newtext+fulltext.substring(pos+oldtext.length);break}h+=oldtext}oldpos=pos+oldtext.length}p="t";break;case"TRIM":h=g[1],h=h.replace(/^ */,""),h=h.replace(/ *$/,""),h=h.replace(/ +/g," "),p="t";break;case"HEXCODE":h=String(g[1]);var b=h.charCodeAt(0);if(b>=55296&&56319>=b){var y=h.charCodeAt(1);y>=56320&&57343>=y&&(b=1024*(b-55296)+(y-56320)+65536)}h=b.toString(16).toUpperCase(),p="t";break;case"UPPER":h=g[1].toUpperCase(),p="t"}d.PushOperand(o,p,h)},t.Formula.FunctionList.FIND=[t.Formula.StringFunctions,-2,"find","","text"],t.Formula.FunctionList.LEFT=[t.Formula.StringFunctions,-2,"tc","","text"],t.Formula.FunctionList.LEN=[t.Formula.StringFunctions,1,"txt","","text"],t.Formula.FunctionList.LOWER=[t.Formula.StringFunctions,1,"txt","","text"],t.Formula.FunctionList.MID=[t.Formula.StringFunctions,3,"mid","","text"],t.Formula.FunctionList.PROPER=[t.Formula.StringFunctions,1,"v","","text"],t.Formula.FunctionList.REPLACE=[t.Formula.StringFunctions,4,"replace","","text"],t.Formula.FunctionList.REPT=[t.Formula.StringFunctions,2,"tc","","text"],t.Formula.FunctionList.RIGHT=[t.Formula.StringFunctions,-1,"tc","","text"],t.Formula.FunctionList.SUBSTITUTE=[t.Formula.StringFunctions,-3,"subs","","text"],t.Formula.FunctionList.TRIM=[t.Formula.StringFunctions,1,"v","","text"],t.Formula.FunctionList.HEXCODE=[t.Formula.StringFunctions,1,"v","","text"],t.Formula.FunctionList.UPPER=[t.Formula.StringFunctions,1,"v","","text"],t.Formula.IsFunctions=function(e,o,i,n){var r=t.Formula,a=0,s="nl",l=r.OperandValueAndType(n,i),c=l.type.charAt(0);switch(e){case"ISBLANK":a="b"==l.type?1:0;break;case"ISERR":a="e"==c?"e#N/A"==l.type?0:1:0;break;case"ISERROR":a="e"==c?1:0;break;case"ISLOGICAL":a="nl"==l.type?1:0;break;case"ISNA":a="e#N/A"==l.type?1:0;break;case"ISNONTEXT":a="t"==c?0:1;break;case"ISNUMBER":a="n"==c?1:0;break;case"ISTEXT":a="t"==c?1:0}r.PushOperand(o,s,a)},t.Formula.FunctionList.ISBLANK=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISERR=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISERROR=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISLOGICAL=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISNA=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISNONTEXT=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISNUMBER=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.FunctionList.ISTEXT=[t.Formula.IsFunctions,1,"v","","test"],t.Formula.NTVFunctions=function(e,o,i,n){var r=t.Formula,a=0,s="e#VALUE!",l=r.OperandValueAndType(n,i),c=l.type.charAt(0);switch(e){case"N":a="n"==c?l.value-0:0,s="n";break;case"T":a="t"==c?l.value+"":"",s="t";break;case"VALUE":"n"==c||"b"==c?(a=l.value||0,s="n"):"t"==c&&(l=t.DetermineValueType(l.value),"n"!=l.type.charAt(0)?(a=0,s="e#VALUE!"):(a=l.value-0,s="n"))}"e"==c&&(s=l.type),r.PushOperand(o,s,a)},t.Formula.FunctionList.N=[t.Formula.NTVFunctions,1,"v","","math"],t.Formula.FunctionList.T=[t.Formula.NTVFunctions,1,"v","","text"],t.Formula.FunctionList.VALUE=[t.Formula.NTVFunctions,1,"v","","text"],t.Formula.Math1Functions=function(e,o,i,n){var r,a,s,l={},c=t.Formula;if(r=c.OperandAsNumber(n,i),a=r.value,l.type=c.LookupResultType(r.type,r.type,c.TypeLookupTable.oneargnumeric),"n"==l.type)switch(e){case"ABS":a=Math.abs(a);break;case"ACOS":a>=-1&&1>=a?a=Math.acos(a):l.type="e#NUM!";break;case"ASIN":a>=-1&&1>=a?a=Math.asin(a):l.type="e#NUM!";break;case"ATAN":a=Math.atan(a);break;case"COS":a=Math.cos(a);break;case"DEGREES":a=180*a/Math.PI;break;case"EVEN":a=0>a?-a:a,a!=Math.floor(a)?a=Math.floor(a+1)+Math.floor(a+1)%2:a+=a%2,r.value<0&&(a=-a);break;case"EXP":a=Math.exp(a);break;case"FACT":for(s=1,a=Math.floor(a);a>0;a--)s*=a;a=s;break;case"INT":a=Math.floor(a);break;case"LN":0>=a&&(l.type="e#NUM!",l.error=t.Constants.s_sheetfunclnarg),a=Math.log(a);break;case"LOG10":0>=a&&(l.type="e#NUM!",l.error=t.Constants.s_sheetfunclog10arg),a=Math.log(a)/Math.log(10);break;case"ODD":a=0>a?-a:a,a!=Math.floor(a)?a=Math.floor(a+1)+(1-Math.floor(a+1)%2):a+=1-a%2,r.value<0&&(a=-a);break;case"RADIANS":a=a*Math.PI/180;break;case"SIN":a=Math.sin(a);break;case"SQRT":a>=0?a=Math.sqrt(a):l.type="e#NUM!";break;case"TAN":0!=Math.cos(a)?a=Math.tan(a):l.type="e#NUM!"}return l.value=a,o.push(l),null},t.Formula.FunctionList.ABS=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.ACOS=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.ASIN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.ATAN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.COS=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.DEGREES=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.EVEN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.EXP=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.FACT=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.INT=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.LN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.LOG10=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.ODD=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.RADIANS=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.SIN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.SQRT=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.FunctionList.TAN=[t.Formula.Math1Functions,1,"v","","math"],t.Formula.Math2Functions=function(e,o,i,n){var r,a,s,l,c,u,d={},h=t.Formula;if(r=h.OperandAsNumber(n,i),a=h.OperandAsNumber(n,i),s=0,d.type=h.LookupResultType(r.type,a.type,h.TypeLookupTable.twoargnumeric),"n"==d.type)switch(e){case"ATAN2":0==r.value&&0==a.value?d.type="e#DIV/0!":d.value=Math.atan2(a.value,r.value);break;case"POWER":d.value=Math.pow(r.value,a.value),isNaN(d.value)&&(d.value=0,d.type="e#NUM!");break;case"MOD":0==a.value?d.type="e#DIV/0!":(l=r.value/a.value,l=Math.floor(l),d.value=r.value-l*a.value);break;case"TRUNC":if(c=1,a.value>=0){for(a.value=Math.floor(a.value),u=0;u<a.value;u++)c*=10;d.value=Math.floor(Math.abs(r.value)*c)/c}else if(a.value<0){for(a.value=Math.floor(-a.value),u=0;u<a.value;u++)c*=10;d.value=Math.floor(Math.abs(r.value)/c)*c}r.value<0&&(d.value=-d.value)}return o.push(d),null},t.Formula.FunctionList.ATAN2=[t.Formula.Math2Functions,2,"xy","","math"],t.Formula.FunctionList.MOD=[t.Formula.Math2Functions,2,"","","math"],t.Formula.FunctionList.POWER=[t.Formula.Math2Functions,2,"","","math"],t.Formula.FunctionList.TRUNC=[t.Formula.Math2Functions,2,"valpre","","math"],t.Formula.LogFunction=function(e,o,i,n){var r,a,s={},l=t.Formula;if(s.value=0,r=l.OperandAsNumber(n,i),s.type=l.LookupResultType(r.type,r.type,l.TypeLookupTable.oneargnumeric),1==i.length){if(a=l.OperandAsNumber(n,i),"n"!=a.type.charAt(0)||a.value<=0)return l.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfunclogsecondarg),0}else{if(0!=i.length)return l.FunctionArgsError(e,o),0;a={value:Math.E,type:"n"}}if("n"==s.type){if(r.value<=0)return l.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfunclogfirstarg),0;s.value=Math.log(r.value)/Math.log(a.value)}o.push(s)},t.Formula.FunctionList.LOG=[t.Formula.LogFunction,-1,"log","","math"],t.Formula.RoundFunction=function(e,o,i,n){var r,a,s,l,c=t.Formula,u=0,d="e#VALUE!",h=c.OperandValueAndType(n,i),d=c.LookupResultType(h.type,h.type,c.TypeLookupTable.oneargnumeric);if(1==i.length){if(r=c.OperandValueAndType(n,i),"n"!=r.type.charAt(0))return c.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfuncroundsecondarg),0}else{if(0!=i.length)return c.FunctionArgsError(e,o),0;r={value:0,type:"n"}}if("n"==d)if(r.value=r.value-0,0==r.value)u=Math.round(h.value);else if(r.value>0){for(a=1,r.value=Math.floor(r.value),l=0;l<r.value;l++)a*=10;s=Math.round(h.value*a),u=s/a}else if(r.value<0){for(a=1,r.value=Math.floor(-r.value),l=0;l<r.value;l++)a*=10;s=Math.round(h.value/a),u=s*a}c.PushOperand(o,d,u)},t.Formula.FunctionList.ROUND=[t.Formula.RoundFunction,-1,"vp","","math"],t.Formula.CeilingFloorFunctions=function(e,o,i,n){var r,a,s,l=t.Formula,c=function(e,t){o.push({type:e,value:t})};if(r=l.OperandValueAndType(n,i),s=r.type.charAt(0),"n"!=s)return void c("e#VALUE!",0);if(0==r.value)return void c("n",0);if(1==i.length){if(a=l.OperandValueAndType(n,i),s=r.type.charAt(0),"n"!=s)return void c("e#VALUE!",0)}else{if(0!=i.length)return void c("e#VALUE!",0);a={type:"n",value:r.value>0?1:-1}}if(0==a.value)return void c("n",0);if(a.value*r.value<0)return void c("e#NUM!",0);switch(e){case"CEILING":c("n",Math.ceil(r.value/a.value)*a.value);break;case"FLOOR":c("n",Math.floor(r.value/a.value)*a.value)}},t.Formula.FunctionList.CEILING=[t.Formula.CeilingFloorFunctions,-1,"vsig","","math"],t.Formula.FunctionList.FLOOR=[t.Formula.CeilingFloorFunctions,-1,"vsig","","math"],t.Formula.AndOrFunctions=function(e,o,i,n){var r,a,s=t.Formula,l="";for("AND"==e?a=1:"OR"==e&&(a=0);i.length;)r=s.OperandValueAndType(n,i),"n"==r.type.charAt(0)?(r.value=r.value-0,"AND"==e?a=0!=r.value?a:0:"OR"==e&&(a=0!=r.value?1:a),l=s.LookupResultType(r.type,l||"nl",s.TypeLookupTable.propagateerror)):"e"==r.type.charAt(0)&&"e"!=l.charAt(0)&&(l=r.type);l.length<1&&(l="e#VALUE!",a=0),s.PushOperand(o,l,a)},t.Formula.FunctionList.AND=[t.Formula.AndOrFunctions,-1,"vn","","test"],t.Formula.FunctionList.OR=[t.Formula.AndOrFunctions,-1,"vn","","test"],t.Formula.NotFunction=function(e,o,i,n){var r=0,a=t.Formula,s=a.OperandValueAndType(n,i),l=a.LookupResultType(s.type,s.type,a.TypeLookupTable.propagateerror);"n"==s.type.charAt(0)||"b"==s.type?(r=s.value-0!=0?0:1,l="nl"):"t"==s.type.charAt(0)&&(l="e#VALUE!"),a.PushOperand(o,l,r)},t.Formula.FunctionList.NOT=[t.Formula.NotFunction,1,"v","","test"],t.Formula.ChooseFunction=function(e,o,i,n){var r,a,s,l=0,c=t.Formula,u=c.OperandAsNumber(n,i);for("n"!=u.type.charAt(0)&&(u.value=0),u.value=Math.floor(u.value),a=0;i.length;)if(s=c.TopOfStackValueAndType(n,i),a+=1,u.value==a){l=s.value,r=s.type;break}r?c.PushOperand(o,r,l):c.PushOperand(o,"e#VALUE!",0)},t.Formula.FunctionList.CHOOSE=[t.Formula.ChooseFunction,-2,"choose","","lookup"],t.Formula.ColumnsRowsFunctions=function(e,o,i,n){var r,a,s=0,l=t.Formula,c=l.TopOfStackValueAndType(n,i);"coord"==c.type?(s=1,r="n"):"range"==c.type?(a=l.DecodeRangeParts(n,c.value),"COLUMNS"==e?s=a.ncols:"ROWS"==e&&(s=a.nrows),r="n"):(s=0,r="e#VALUE!"),l.PushOperand(o,r,s)},t.Formula.FunctionList.COLUMNS=[t.Formula.ColumnsRowsFunctions,1,"range","","lookup"],t.Formula.FunctionList.ROWS=[t.Formula.ColumnsRowsFunctions,1,"range","","lookup"],t.Formula.ZeroArgFunctions=function(e,o){var i,n,r,a,s,l={value:0};switch(e){case"FALSE":l.type="nl",l.value=0;break;case"NA":l.type="e#N/A";break;case"NOW":i=new Date,n=i.getTimezoneOffset(),i=i.getTime()/1e3,r=25569,a=86400,s=r+i/a-n/1440,l.value=s,l.type="ndt",t.Formula.FreshnessInfo.volatile.NOW=!0;break;case"PI":l.type="n",l.value=Math.PI;break;case"TODAY":i=new Date,n=i.getTimezoneOffset(),i=i.getTime()/1e3,r=25569,a=86400,s=r+i/a-n/1440,l.value=Math.floor(s),l.type="nd",t.Formula.FreshnessInfo.volatile.TODAY=!0;break;case"TRUE":l.type="nl",l.value=1;break;case"RAND":l.type="n",l.value=Math.random(),t.Formula.FreshnessInfo.volatile.RAND=!0}return o.push(l),null},t.Formula.FunctionList.FALSE=[t.Formula.ZeroArgFunctions,0,"","","test"],t.Formula.FunctionList.NA=[t.Formula.ZeroArgFunctions,0,"","","test"],t.Formula.FunctionList.NOW=[t.Formula.ZeroArgFunctions,0,"","","datetime"],t.Formula.FunctionList.RAND=[t.Formula.ZeroArgFunctions,0,"","","math"],t.Formula.FunctionList.PI=[t.Formula.ZeroArgFunctions,0,"","","math"],t.Formula.FunctionList.TODAY=[t.Formula.ZeroArgFunctions,0,"","","datetime"],t.Formula.FunctionList.TRUE=[t.Formula.ZeroArgFunctions,0,"","","test"],t.Formula.DDBFunction=function(e,o,i,n){var r,a,s,l,c=t.Formula,u=c.OperandAsNumber(n,i),d=c.OperandAsNumber(n,i),h=c.OperandAsNumber(n,i),p=c.OperandAsNumber(n,i);if(!(c.CheckForErrorValue(o,u)||c.CheckForErrorValue(o,d)||c.CheckForErrorValue(o,h)||c.CheckForErrorValue(o,p))){if(h.value<1)return c.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfuncddblife),0;if(r={value:2,type:"n"},i.length>0&&(r=c.OperandAsNumber(n,i)),0!=i.length)return c.FunctionArgsError(e,o),0;if(!c.CheckForErrorValue(o,r)){for(a=0,s=0,l=1;l<=p.value-0&&l<=h.value;l++)a=(u.value-s)*(r.value/h.value),u.value-s-a<d.value&&(a=u.value-s-d.value),s+=a;c.PushOperand(o,"n$",a)}}},t.Formula.FunctionList.DDB=[t.Formula.DDBFunction,-4,"ddb","","financial"],t.Formula.SLNFunction=function(e,o,i,n){var r,a=t.Formula,s=a.OperandAsNumber(n,i),l=a.OperandAsNumber(n,i),c=a.OperandAsNumber(n,i);if(!a.CheckForErrorValue(o,s)&&!a.CheckForErrorValue(o,l)&&!a.CheckForErrorValue(o,c)){if(c.value<1)return a.FunctionSpecificError(e,o,"e#NUM!",t.Constants.s_sheetfuncslnlife),0;r=(s.value-l.value)/c.value,a.PushOperand(o,"n$",r)}},t.Formula.FunctionList.SLN=[t.Formula.SLNFunction,3,"csl","","financial"],t.Formula.SYDFunction=function(e,o,i,n){var r,a,s=t.Formula,l=s.OperandAsNumber(n,i),c=s.OperandAsNumber(n,i),u=s.OperandAsNumber(n,i),d=s.OperandAsNumber(n,i);if(!(s.CheckForErrorValue(o,l)||s.CheckForErrorValue(o,c)||s.CheckForErrorValue(o,u)||s.CheckForErrorValue(o,d))){if(u.value<1||d.value<=0)return s.PushOperand(o,"e#NUM!",0),0;a=(u.value+1)*u.value/2,r=(l.value-c.value)*(u.value-d.value+1)/a,s.PushOperand(o,"n$",r)}},t.Formula.FunctionList.SYD=[t.Formula.SYDFunction,4,"cslp","","financial"],t.Formula.InterestFunctions=function(e,o,i,n){var r,a,s,l,c,u,d,h,p,f,m,g,v,b,y,C,w,x,_,S,h,k,T,F=t.Formula,E=F.OperandAsNumber(n,i),D=F.OperandAsNumber(n,i),P=F.OperandAsNumber(n,i);if(r=F.LookupResultType(E.type,D.type,F.TypeLookupTable.twoargnumeric),r=F.LookupResultType(r,P.type,F.TypeLookupTable.twoargnumeric),i.length&&(s=F.OperandAsNumber(n,i),r=F.LookupResultType(r,s.type,F.TypeLookupTable.twoargnumeric),i.length&&(l=F.OperandAsNumber(n,i),r=F.LookupResultType(r,l.type,F.TypeLookupTable.twoargnumeric),i.length))){if("RATE"!=e)return F.FunctionArgsError(e,o),0;c=F.OperandAsNumber(n,i),r=F.LookupResultType(r,c.type,F.TypeLookupTable.twoargnumeric)}if("n"==r)switch(e){case"FV":h=E.value,p=D.value,f=P.value,u=null!=s?s.value:0,m=null!=l&&l.value?1:0,d=0==h?-u-f*p:-(u*Math.pow(1+h,p)+f*(1+h*m)*(Math.pow(1+h,p)-1)/h),a=d,r="n$";break;case"NPER":if(h=E.value,f=D.value,u=P.value,d=null!=s?s.value:0,m=null!=l&&l.value?1:0,0==h){if(0==f)return void F.PushOperand(o,"e#NUM!",0);p=(u+d)/-f}else{if(v=f*(1+h*m)/h,b=u+v,0==b||-1>=h)return void F.PushOperand(o,"e#NUM!",0);if(y=(v-d)/b,0>=y)return void F.PushOperand(o,"e#NUM!",0);C=Math.log(y),w=Math.log(1+h),p=C/w}a=p,r="n";break;case"PMT":if(h=E.value,p=D.value,u=P.value,d=null!=s?s.value:0,m=null!=l&&l.value?1:0,0==p)return void F.PushOperand(o,"e#NUM!",0);f=0==h?(d-u)/p:(0-d-u*Math.pow(1+h,p))/((1+h*m)*(Math.pow(1+h,p)-1)/h),a=f,r="n$";break;case"PV":if(h=E.value,p=D.value,f=P.value,d=null!=s?s.value:0,m=null!=l&&l.value?1:0,-1==h)return void F.PushOperand(o,"e#DIV/0!",0);u=0==h?-d-f*p:(-d-f*(1+h*m)*(Math.pow(1+h,p)-1)/h)/Math.pow(1+h,p),a=u,r="n$";break;case"RATE":for(p=E.value,f=D.value,u=P.value,d=null!=s?s.value:0,m=null!=l&&l.value?1:0,g=null!=c?c.value:.1,_=100,S=0,delta=1,epsilon=1e-7,h=g||1e-8;(delta>=0?delta:-delta)>epsilon&&h!=k;)if(delta=d+u*Math.pow(1+h,p)+f*(1+h*m)*(Math.pow(1+h,p)-1)/h,null!=x?(T=(delta-x)/(h-k)||.001,k=h,h-=delta/T,x=delta):(k=h,h=1.1*h,x=delta),S++,S>=_)return void F.PushOperand(o,"e#NUM!",0);a=h,r="n%"}F.PushOperand(o,r,a)},t.Formula.FunctionList.FV=[t.Formula.InterestFunctions,-3,"fv","","financial"],t.Formula.FunctionList.NPER=[t.Formula.InterestFunctions,-3,"nper","","financial"],t.Formula.FunctionList.PMT=[t.Formula.InterestFunctions,-3,"pmt","","financial"],t.Formula.FunctionList.PV=[t.Formula.InterestFunctions,-3,"pv","","financial"],t.Formula.FunctionList.RATE=[t.Formula.InterestFunctions,-3,"rate","","financial"],t.Formula.NPVFunction=function(e,o,i,n){var r,a,s,l,c,u=t.Formula,a=u.OperandAsNumber(n,i);if(!u.CheckForErrorValue(o,a)){for(s=0,r="n",l=1;i.length;)if(c=u.OperandValueAndType(n,i),"n"==c.type.charAt(0)){if(l*=1+a.value,0==l)return void u.PushOperand(o,"e#DIV/0!",0);s+=c.value/l,r=u.LookupResultType(c.type,r||c.type,u.TypeLookupTable.plus)}else if("e"==c.type.charAt(0)&&"e"!=r.charAt(0)){r=c.type;break}"n"==r.charAt(0)&&(r="n$"),u.PushOperand(o,r,s)}},t.Formula.FunctionList.NPV=[t.Formula.NPVFunction,-2,"npv","","financial"],t.Formula.IRRFunction=function(e,o,i,n){var r,a,s,l,c,u,d,h,p,f,m,g,v=[],b=[],y=t.Formula;for(v.push(i.pop());v.length;)if(r=y.OperandValueAndType(n,v),"n"==r.type.charAt(0))b.push(r.value);else if("e"==r.type.charAt(0))return void y.PushOperand(o,"e#VALUE!",0);if(!b.length)return void y.PushOperand(o,"e#NUM!",0);if(a={value:0},i.length){if(a=y.OperandAsNumber(n,i),"n"!=a.type.charAt(0)&&"b"!=a.type.charAt(0))return void y.PushOperand(o,"e#VALUE!",0);if(i.length)return void y.FunctionArgsError(e,o)}for(a.value=a.value||.1,l=20,c=0,u=1e-7,d=a.value,f=1;(f>=0?f:-f)>u&&d!=h;){for(f=0,m=1,g=0;g<b.length;g++){if(m*=1+d,0==m)return void y.PushOperand(o,"e#DIV/0!",0);f+=b[g]/m}if(null!=s?(p=(f-s)/(d-h),h=d,d-=f/p,s=f):(h=d,d=1.1*d,s=f),c++,c>=l)return void y.PushOperand(o,"e#NUM!",0)}y.PushOperand(o,"n%",d)},t.Formula.FunctionList.IRR=[t.Formula.IRRFunction,-1,"irr","","financial"],t.Formula.IoFunctions=function(o,i,n,r,a){var s,l,c,u,d={BUTTON:[2],IMAGEBUTTON:[2],EMAIL:[14,14,14,14],EMAILIF:[13,14,14,14,14],EMAILONEDIT:[14,14,14,14,14],EMAILAT:[13,14,14,14,14],EMAILONEDITIF:[14,13,14,14,14,14],EMAILATIF:[13,13,14,14,14,14],SUBMIT:[2],TEXTBOX:[2],AUTOCOMPLETE:[2,14],SELECT:[2,14,1,1],CHECKBOX:[3],RADIOBUTTON:[2,2],COPYVALUE:[4,12,15],COPYFORMULA:[4,12,12],INSERT:[4,8,-12,-15],DELETEIF:[4,7,8],COMMAND:[4,14],COMMANDIF:[4,13,14],PANEL:[15,-12],SPLASH:[12],STYLE:[6]},h=t.Formula,p=0,f="e#VALUE!",m=n.length,g=d[o],v=[],b=[],y=-1;for(s=1;m>=s;s++){if(-1!=y)u=Math.abs(g[c+(s-1-c)%y]);else{if(s>g.length)return void h.FunctionArgsError(o,i);u=g[s-1],0>u&&(y=g.length-(s-1),c=s-1,u=Math.abs(u))}if(1==u)l=h.OperandAsNumber(r,n);else if(2==u)l=h.OperandAsText(r,n);else if(3==u)l=h.OperandValueAndType(r,n);else{var C=n[n.length-1].type,w=!1;if(("n"==C.charAt(0)&&0!=(1&u)||"t"==C.charAt(0)&&0!=(2&u))&&(w=!0,l=h.OperandValueAndType(r,n)),"coord"==C&&0!=(4&u)&&(w=!0,l=h.OperandAsCoord(r,n),l.value=t.Formula.PlainCoord(l.value)),"range"==C&&0!=(8&u)&&(w=!0,l=h.OperandAsRange(r,n),l.value=t.Formula.PlainCoord(l.value)),0==w)return void h.FunctionArgsError(o,i)}if(v[s]=l.value,b[s]=l.type,"e"==l.type.charAt(0))return void h.PushOperand(i,l.type,p)}switch(o){case"STYLE":var x=r.ioParameterList[a];if(x){var _=t.Formula.getStandardizedList(r,{value:v[1],type:b[1]});_.length>0&&(x.css=_[0],x.cssParameter="t"==b[1]?'"'+v[1]+'"':v[1]),p="",f="ni"}break;case"SELECT":var x=r.ioParameterList[a],S=t.Formula.getStandardizedList(r,x[1]);if(x.html=[],x.html[0]=1==v[4]?"multiple":"",x.html[1]=v[3]?""+v[3]:"1",S.length>0){var k="<option>"+S.join("</option><option>")+"</option>",T=new RegExp("<option>"+v[1],"");x.html[2]=k.replace(T,"<option selected>"+v[1])}p=v[1],f="ti"+o;break;case"SUBMIT":p="Submit";case"BUTTON":case"IMAGEBUTTON":case"TEXTBOX":case"AUTOCOMPLETE":m>0&&(p=v[1]),f="ti"+o;break;case"EMAIL":case"EMAILIF":f="ti"+o,p="Send";break;case"EMAILONEDIT":case"EMAILONEDITIF":case"EMAILAT":case"EMAILATIF":f="ti"+o,p="Send Now";break;case"CHECKBOX":case"RADIOBUTTON":p="t"==b[1].charAt(0)?"TRUE"==v[1].toUpperCase()?1:0:0==v[1]?0:1,f="ni"+o;break;case"COPYVALUE":case"COPYFORMULA":case"INSERT":case"DELETEIF":case"COMMAND":case"COMMANDIF":var F=r.cells[v[1]];if("undefined"==typeof F)break;p=F.datavalue,p=String(p).split("/"),p=p[p.length-1],f="t";break;case"PANEL":case"SPLASH":var E,D=2;if("SPLASH"==o){if(p="SPLASH:"+v[1],f="t",1==r.splashdone)break;r.splashdone=!0,D=1,E=[0]}else E=t.Formula.getStandardizedList(r,{value:v[1],type:b[1]}),p=o+":"+E;if(f="t",t._app){for(var P=[],A=[],I=D;I<v.length;++I){var M=!1;for(var R in E)if(E[R]==I-1){M=!0;break}if(M!==!1){for(var N=t.Formula.getStandardizedCoords(r,{value:v[I],type:b[I]}),s=0;s<N.ncols;s++)A[N.col1num+s]=!0;for(var L=0;L<N.nrows;L++)P[N.row1num+L]=!0}}var O=e.spreadsheet;null==O&&(O=e.ss);var z=!1,H=0,B=function(e,t,o,i,n){for(var r=1;t>=r;r++){var a=n(r);"undefined"==typeof o[a]?i[r]!==!0?(o[a]="yes",z=!0):H=r:i[r]===!0&&(delete o[a],z=!0,H=r)}},U=function(e){return e};B(r,r.attribs.lastrow,r.rowattribs.hide,P,U),H=0,B(r,r.attribs.lastcol,r.colattribs.hide,A,t.rcColname),r.attribs.usermaxcol=H,z&&(r.renderneeded=!0,r.widgetsClean=!1,O.editor.context.rowpanes[0].first=1,O.editor.context.CalculateColWidthData(),O.width=O.editor.context.totalwidth,O.height=2500,O.editor.ResizeTableEditor(O.editor.context.totalwidth,2500))
}}h.PushOperand(i,f,p)},t.Formula.FunctionList.BUTTON=[t.Formula.IoFunctions,1,"label","","gui","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Button('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],t.Formula.FunctionList.IMAGEBUTTON=[t.Formula.IoFunctions,1,"imageurl","","gui","<input type='image' src='<%=display_value%>' alt='Submit' onclick=\"SocialCalc.TriggerIoAction.Button('<%=cell_reference%>');\">","ParameterList"],t.Formula.FunctionList.EMAIL=[t.Formula.IoFunctions,-3,"to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],t.Formula.FunctionList.EMAILIF=[t.Formula.IoFunctions,-4,"condition_range, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],t.Formula.FunctionList.EMAILONEDIT=[t.Formula.IoFunctions,-4,"editRange, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","EventTree"],t.Formula.FunctionList.EMAILAT=[t.Formula.IoFunctions,-4,"datetime_value, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","TimeTrigger"],t.Formula.FunctionList.EMAILONEDITIF=[t.Formula.IoFunctions,-5,"editRange, condition, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","EventTree"],t.Formula.FunctionList.EMAILATIF=[t.Formula.IoFunctions,-5,"datetime_value, condition, to_range subject_range, body_range","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\"><%=formated_value%></button>","TimeTrigger"],t.Formula.FunctionList.SUBMIT=[t.Formula.IoFunctions,100,"[label]","","action","<button type='button' onclick=\"SocialCalc.TriggerIoAction.Submit('<%=cell_reference%>');\"><%=formated_value%></button>","ParameterList"],t.Formula.FunctionList.TEXTBOX=[t.Formula.IoFunctions,1,"value","","gui","<input type='text' id='TEXTBOX_<%=cell_reference%>' onblur='SocialCalc.CmdGotFocus(null);' oninput=\"SocialCalc.TriggerIoAction.TextBox('<%=cell_reference%>')\" value='<%=display_value%>' >","Input"],t.Formula.FunctionList.AUTOCOMPLETE=[t.Formula.IoFunctions,2,"value, range or csv_text","","gui","<input type='text' id='AUTOCOMPLETE_<%=cell_reference%>' onfocus=\"SocialCalc.TriggerIoAction.AddAutocomplete('<%=cell_reference%>');\" onblur='SocialCalc.CmdGotFocus(null);' value='<%=display_value%>' >","Input"],t.Formula.FunctionList.SELECT=[t.Formula.IoFunctions,-2,"value, range or csv_text [,size]","","gui","<select size='<%=html1_value%>' id='SELECT_<%=cell_reference%>' onchange=\"SocialCalc.TriggerIoAction.SelectList('<%=cell_reference%>')\" <%=html0_value%>><%=html2_value%></select>","Input"],t.Formula.FunctionList.CHECKBOX=[t.Formula.IoFunctions,1,"value","","gui","<input type='checkbox' id='CHECKBOX_<%=cell_reference%>' <%=checked%> onblur='SocialCalc.CmdGotFocus(null);' onchange=\"SocialCalc.TriggerIoAction.CheckBox('<%=cell_reference%>')\" >","Input"],t.Formula.FunctionList.RADIOBUTTON=[t.Formula.IoFunctions,2,"value, groupname","","gui","<input type='radio' value='<%=cell_reference%>' id='RADIOBUTTON_<%=cell_reference%>' <%=checked%> name='<%=parameter1_value%>' onblur=\"SocialCalc.CmdGotFocus(null);\" onclick=\"SocialCalc.TriggerIoAction.RadioButton('<%=parameter1_value%>');\" >","Input"],t.Formula.FunctionList.COPYVALUE=[t.Formula.IoFunctions,3,"trigger_cell, destinationCell, value_or_range","","action","","EventTree"],t.Formula.FunctionList.COPYFORMULA=[t.Formula.IoFunctions,3,"trigger_cell, destinationCell, formula_range","","action","","EventTree"],t.Formula.FunctionList.INSERT=[t.Formula.IoFunctions,-2,"trigger_cell, destination_range [,formula_range,value_or_range,formula_range, ...]","","action","","EventTree"],t.Formula.FunctionList.DELETEIF=[t.Formula.IoFunctions,-1,"trigger_cell, criteria , test_range","","action","","EventTree"],t.Formula.FunctionList.COMMAND=[t.Formula.IoFunctions,-1,"trigger_cell, commands","","action","","EventTree"],t.Formula.FunctionList.COMMANDIF=[t.Formula.IoFunctions,-1,"trigger_cell, conditions, commands","","action","","EventTree"],t.Formula.FunctionList.PANEL=[t.Formula.IoFunctions,-1,"showindices_range_or_csv, panel1_range [, panel2_range , ...]","","gui",""],t.Formula.FunctionList.SPLASH=[t.Formula.IoFunctions,-1,"splash_panel_range","","gui",""],t.Formula.FunctionList.STYLE=[t.Formula.IoFunctions,-1,"css","","gui",""],t.TriggerIoAction.AddAutocomplete=function(o){var i=e.spreadsheet;null==i&&(i=e.ss);var n=i.sheet,r=(t.Formula,n.ioParameterList[o]);if("undefined"!=typeof r){var a=t.Formula.getStandardizedList(n,r[1]);$.ui.autocomplete.filter=function(e,t){var o=new RegExp("\\b"+$.ui.autocomplete.escapeRegex(t),"i");return $.grep(e,function(e){return o.test(e.label||e.value||e)})},$("#AUTOCOMPLETE_"+o).autocomplete({source:a,minLength:1,autoFocus:!0,select:function(e,i){$(this).val(i.item.label),t.TriggerIoAction.AutoComplete(o)},change:function(e,i){null===i.item&&$(this).val(""),t.TriggerIoAction.AutoComplete(o)}})}},t.TriggerIoAction.Button=function(o){var i=e.spreadsheet;null==i&&(i=e.ss);{var n=i.sheet;t.Formula}if("undefined"!=typeof n.ioEventTree&&"undefined"!=typeof n.ioParameterList&&"undefined"!==n.ioEventTree[o])for(var r in n.ioEventTree[o]){var a=n.ioParameterList[r],s=null;switch(a.function_name){case"COPYVALUE":var l=t.Formula.getStandardizedValues(n,a[2]),c=t.coordToCr(a[1].value),u=t.TriggerIoAction.CopyValueToRange(l,c);i.editor.EditorScheduleSheetCommands(u,!0,!1);break;case"COPYFORMULA":var l=t.Formula.getStandardizedValues(n,a[2]),c=t.coordToCr(a[1].value),u=t.TriggerIoAction.CopyFormulaToRange(l,c);i.editor.EditorScheduleSheetCommands(u,!0,!1);break;case"INSERT":var l=t.Formula.getStandardizedValues(n,a[1]);if("range"!=l.type)break;var d,h,p;l.ncols>1&&(h=1,p=0,d="insertcol"),l.nrows>1&&(h=0,p=1,d="insertrow");for(var f=l.cellcoord[h][p],u=d+" "+f,c=t.coordToCr(f),m=2;m<a.length;)("range"==a[m].type||"coord"==a[m].type||m%2==1)&&(copyCellRange=t.Formula.getStandardizedValues(n,a[m]),u=m%2==0?u+"\n"+t.TriggerIoAction.CopyFormulaToRange(copyCellRange,c):u+"\n"+t.TriggerIoAction.CopyValueToRange(copyCellRange,c),l.nrows>1&&(c.col+=copyCellRange.ncols),l.ncols>1&&(c.row+=copyCellRange.nrows)),m++;i.editor.EditorScheduleSheetCommands(u,!0,!1);break;case"DELETEIF":var h,p,g,v=t.Formula.getStandardizedValues(n,a[1]),b=t.Formula.getStandardizedValues(n,a[2]),u="";if(b.ncols>1&&b.nrows>1)return;b.ncols>1&&(h=1,p=0,g="deletecol"),b.nrows>1&&(h=0,p=1,g="deleterow");for(var y=v.celldata[0][0].datavalue,C=b.ncols-h-1;C>=h;C--)for(var w=b.nrows-p-1;w>=p;w--){var x=b.celldata[C][w];1==t.Formula.TestCriteria(x.datavalue,x.valuetype,y)&&(""!=u&&(u+="\n"),u=u+g+" "+b.cellcoord[C][w])}""!=u&&i.editor.EditorScheduleSheetCommands(u,!0,!1);break;case"COMMANDIF":s=t.Formula.getStandardizedValues(n,a[1]);case"COMMAND":var _,u="";if(null!=s){var _=t.Formula.getStandardizedValues(n,a[2]);if(s.ncols!=_.ncols||s.nrows!=_.nrows)break}else _=t.Formula.getStandardizedValues(n,a[1]);for(var C=0;C<_.ncols;C++)for(var w=0;w<_.nrows;w++){if(null!=s){var S=s.celldata[C][w];if(0==S.datavalue)continue}""!=u&&(u+="\n");var k=_.celldata[C][w];u+=k.datavalue.toString().trim()}""!=u&&i.editor.EditorScheduleSheetCommands(u,!0,!1)}}},t.TriggerIoAction.CopyFormulaToRange=function(e,o){for(var i,n="",r=0;r<e.ncols;r++)for(var a=0;a<e.nrows;a++){var s=e.celldata[r][a],l=t.crToCoord(o.col+r,o.row+a);if((0!=r||0!=a)&&(n+="\n"),"undefined"!=typeof s&&"b"!=s.valuetype){var c=s.datatype,u=s.valuetype,d=s.datavalue,h=s.formula;"f"==c?(h=t.OffsetFormulaCoords(h,o.col-e.col1num,o.row-e.row1num),d="",u=""):"c"!=c&&(h=""),i="set "+l+" "+t.Constants.cellDataType[c]+" "+u+" "+t.encodeForSave(d)+" "+h}else i="set "+l+" empty";n+=i.trim()}return n},t.TriggerIoAction.CopyValueToRange=function(e,o){for(var i,n="",r=0;r<e.ncols;r++)for(var a=0;a<e.nrows;a++){var s=e.celldata[r][a],l=t.crToCoord(o.col+r,o.row+a);if((0!=r||0!=a)&&(n+="\n"),"undefined"!=typeof s&&"b"!=s.valuetype){var c=s.datatype,u=s.valuetype,d=s.datavalue,h=s.formula;"f"==c?(h="",c=u,"n"!=u&&"t"!=u.charAt(0)&&(c="c",h=s.displaystring),"t"==u.charAt(0)&&(c="t")):"c"!=c&&(h=""),i="set "+l+" "+t.Constants.cellDataType[c]+" "+u+" "+t.encodeForSave(d)+" "+h}else i="set "+l+" empty";n+=i.trim()}return n},t.TriggerIoAction.Email=function(o,i){i="undefined"!=typeof i?i:null;var n=t.Formula,r=e.spreadsheet;null==r&&(r=e.ss);var a=r.sheet,s=a.cells[o];if("undefined"!=typeof a.ioParameterList){var l=a.ioParameterList[o];if("undefined"!=typeof l){for(var c=[],u=[],d=1,h=0;h<l.length;h++)if("t"==l[h].type.charAt(0)&&(c[h]=[String(l[h].value).replace(/ /g,"%20")]),"coord"==l[h].type&&(c[h]=[String(a.GetAssuredCell(l[h].value).datavalue).replace(/ /g,"%20")]),"range"==l[h].type){var p=n.DecodeRangeParts(a,l[h].value);c[h]=[],u[h]=[];for(var f=0,m=0;m<p.ncols;m++)for(var g=0;g<p.nrows;g++){var v=t.crToCoord(p.col1num+m,p.row1num+g),s=p.sheetdata.GetAssuredCell(v);c[h].push(s.datavalue.toString().replace(/ /g,"%20")),u[h].push(v),f++}f>d&&(d=f)}var b=-1,y=0;switch(l.function_name){case"EMAILIF":b=0;case"EMAILAT":case"EMAILONEDIT":y=1;break;case"EMAILONEDITIF":case"EMAILATIF":b=1,y=2;break;case"EMAIL":}switch(l.function_name){case"EMAILONEDIT":case"EMAILONEDITIF":i&&"coord"==l[0].type&&l[0].value==i&&(i=null);break;default:i=null}for(var C=!1,w=[],x=d-1;x>-1;x--){if(-1!=b){var _=x>=c[b].length?0:x;if(0==c[b][_])continue}if(!i||i==u[0][x]){var S=x>=c[y].length?0:x,k=x>=c[y+1].length?0:x,T=x>=c[y+2].length?0:x,F=c[y][S]+" "+c[y+1][k]+" "+c[y+2][T];C=!0,a.ScheduleSheetCommands("sendemail "+F,!1),w.push([c[y][S],c[y+1][k],c[y+2][T]])}}return C&&t.EditorSheetStatusCallback(null,"emailing",null,r.editor),w}}},t.TriggerIoAction.Submit=function(){var o=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject.formDataViewer:t.CurrentSpreadsheetViewerObject.formDataViewer;if(null!=o&&1==o.loaded){var i=e.spreadsheet;null==i&&(i=e.ss);for(var n=i.sheet,r=new Date,a=""+r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()+" "+r.getHours()+":"+r.getMinutes()+":"+r.getSeconds(),s=2;s<=o.formFieldsLength+1;s++){var l=t.crToCoord(s,2);a+="\r"+o.sheet.cells[l].datavalue}n.ScheduleSheetCommands("submitform \r"+a,!1)}},t.TriggerIoAction.SelectList=function(e){var o=function(e){return e.value},i="SELECT";t.TriggerIoAction.updateInputWidgetFormula(i,e,o)},t.TriggerIoAction.AutoComplete=function(e){var o=function(e){return e.value},i="AUTOCOMPLETE";t.TriggerIoAction.updateInputWidgetFormula(i,e,o)},t.TriggerIoAction.TextBox=function(e){var o=function(e){return e.value},i="TEXTBOX";t.TriggerIoAction.updateInputWidgetFormula(i,e,o)},t.TriggerIoAction.CheckBox=function(e){var o=function(e){return e.checked?"TRUE":"FALSE"},i="CHECKBOX";t.TriggerIoAction.updateInputWidgetFormula(i,e,o)},t.TriggerIoAction.RadioButton=function(e){var o=function(e){return e.checked?"TRUE":"FALSE"},i="RADIOBUTTON";$('input[name="'+e+'"]').each(function(){t.TriggerIoAction.updateInputWidgetFormula(i,$(this).attr("id").replace(/RADIOBUTTON_/,""),o)})},t.TriggerIoAction.updateInputWidgetFormula=function(o,i,n){var r=e.spreadsheet;null==r&&(r=e.ss);var a=r.sheet,s=(a.cells[i],a.ioParameterList[i]);if("undefined"!=typeof s){var l=document.getElementById(o+"_"+i),c=n(l);c=t.encodeForSave(c);for(var u="set "+i+" formula "+o+'("'+c+'"',d=1;d<s.length;d++)"n"==s[d].type.charAt(0)&&(u+=","+s[d].value),"t"==s[d].type.charAt(0)&&(u+=',"'+s[d].value+'"'),"range"==s[d].type&&(u+=","+s[d].value.toString().replace(/(\$?[A-Z]+\$?[0-9]+)([!]?)([^|]*)[|](\$?[A-Z]+\$?[0-9]+)[|]/i,"$3$2$1:$4")),"coord"==s[d].type&&(u+=","+s[d].value);u+=")",s.cssParameter&&(u+="+style("+s.cssParameter+")"),r.editor.EditorScheduleSheetCommands(u,!0,!1),t.TriggerIoAction.UpdateFormDataSheet(o,i,c)}},t.TriggerIoAction.UpdateFormDataSheet=function(e,o,i){var n=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject.formDataViewer:t.CurrentSpreadsheetViewerObject.formDataViewer;if(null!=n){var r=(e+o).toLowerCase();if(null!=n.formFields[r]){var a=t.crToCoord(n.formFields[r],2);n.sheet.ScheduleSheetCommands("set "+a+" text t "+i,!1)}}},t.Formula.getStandardizedValues=function(e,o){return t.Formula.getStandardizedParameter(e,o,!0,!0)},t.Formula.getStandardizedCoords=function(e,o){return t.Formula.getStandardizedParameter(e,o,!0,!1)},t.Formula.getStandardizedList=function(e,o){var i=[],n=t.Formula.getStandardizedValues(e,o);if(1==n.ncols&&1==n.nrows)i=String(n.celldata[0][0].datavalue).split(",");else for(var r=0;r<n.ncols;r++)for(var a=0;a<n.nrows;a++){var s=n.celldata[r][a];i.push(s.datavalue.toString())}return i},t.Formula.getStandardizedParameter=function(e,o,i,n){var r={type:o.type,value:o.value};if(n&&(r.celldata=[]),"coord"!=o.type&&"range"!=o.type){if(r.ncols=1,r.nrows=1,r.col1num=1,r.row1num=1,i&&(r.cellcoord=null),n){r.celldata[0]=[];var a="n"==o.type?"v":"t"==o.type?o.type:"c";r.celldata[0][0]={coord:null,datatype:a,valuetype:o.type,datavalue:o.value}}}else{var s,l=t.Formula;if("coord"==o.type){var c=t.Formula.PlainCoord(o.value);s=l.DecodeRangeParts(e,c+"|"+c+"|")}"range"==o.type&&(s=l.DecodeRangeParts(e,o.value)),i&&(r.cellcoord=[]);for(var u=0;u<s.ncols;u++)for(var d=0;d<s.nrows;d++){var h=t.crToCoord(s.col1num+u,s.row1num+d);if(i&&("undefined"==typeof r.cellcoord[u]&&(r.cellcoord[u]=[]),r.cellcoord[u][d]=h),n){"undefined"==typeof r.celldata[u]&&(r.celldata[u]=[]);var p=s.sheetdata.GetAssuredCell(h);r.celldata[u][d]=p}}r.ncols=s.ncols,r.nrows=s.nrows,r.col1num=s.col1num,r.row1num=s.row1num}return r},t.Formula.SheetCache={sheets:{},waitingForLoading:null,constants:{asloaded:0,recalcing:1,recalcdone:2},loadsheet:null},t.Formula.FindInSheetCache=function(e){var o=t.Formula.SheetCache,i=t.Formula.NormalizeSheetName(e);return o.sheets[i]?o.sheets[i].sheet:o.waitingForLoading?null:o.loadsheet?(alert("Using SocialCalc.Formula.SheetCache.loadsheet - deprecated"),t.Formula.AddSheetToCache(i,o.loadsheet(i))):(o.waitingForLoading=i,null)},t.Formula.AddSheetToCache=function(e,o,i){var n=null,r=t.Formula.SheetCache,a=r.constants,s=t.Formula.NormalizeSheetName(e);return o&&(n=new t.Sheet,n.ParseSheetSave(o)),r.sheets[s]={sheet:n,recalcstate:a.asloaded,name:s},t.Formula.FreshnessInfo.sheets[s]="undefined"==typeof i||i===!1,n},t.Formula.NormalizeSheetName=function(e){return t.Callbacks.NormalizeSheetName?t.Callbacks.NormalizeSheetName(e):e.toLowerCase()},t.Formula.RemoteFunctionInfo={waitingForServer:null},t.Formula.FreshnessInfo={sheets:{},"volatile":{},recalc_completed:!1},t.Formula.FreshnessInfoReset=function(){var e=t.Formula.FreshnessInfo,o=t.Formula.SheetCache;for(var i in e.sheets)e.sheets[i]===!1&&delete o.sheets[i];e.sheets={},e.volatile={},e.recalc_completed=!1},t.Formula.PlainCoord=function(e){return-1==e.indexOf("$")?e:e.replace(/\$/g,"")},t.Formula.OrderRangeParts=function(e,o){var i,n,r={};return i=t.coordToCr(e),n=t.coordToCr(o),i.col>n.col?(r.c1=n.col,r.c2=i.col):(r.c1=i.col,r.c2=n.col),i.row>n.row?(r.r1=n.row,r.r2=i.row):(r.r1=i.row,r.r2=n.row),r},t.Formula.TestCriteria=function(e,o,i){var n,r,a,s,l;if(null==i)return!1;if(i+="",n=i.charAt(0),"="==n||"<"==n||">"==n?r=i.substring(1):-1!=i.search(/([^~]\*|^\*)/)||-1!=i.search(/([^~]\?|^\?)/)?(n="regex","*"==i?r=".+":(r=i.split("").reverse().join(""),r=r.replace(/\?(?=[^~])|\?$/g,"?.").replace(/\?~/g,"?\\").replace(/\*(?=[^~])|\*$/g,"*.").replace(/\*~/,"*\\"),r=r.split("").reverse().join("")),r="^"+r+"$"):(n=i.substring(0,2),"<="==n||"<>"==n||">="==n?r=i.substring(2):(n="none",r=i)),a=t.DetermineValueType(r),!a.type){if("none"==n)return!1;if("b"==o.charAt(0)){if("="==n)return!0}else if("<>"==n)return!0;return!1}if(s=!1,"n"==a.type.charAt(0)&&"t"==o.charAt(0)&&(l=t.DetermineValueType(e),"n"==l.type.charAt(0)&&(e=l.value,o=l.type)),"n"==o.charAt(0)&&"n"==a.type.charAt(0))switch(e-=0,a.value=a.value-0,n){case"<":s=e<a.value;break;case"<=":s=e<=a.value;break;case"=":case"none":s=e==a.value;break;case">=":s=e>=a.value;break;case">":s=e>a.value;break;case"<>":s=e!=a.value}else if("e"==o.charAt(0))s=!1;else if("e"==a.type.charAt(0))s=!1;else{if("n"==o.charAt(0)&&(e=t.format_number_for_display(e,"n","")),"n"==a.type.charAt(0))return!1;switch(e=e?e.toLowerCase():"",a.value=a.value?a.value.toLowerCase():"",n){case"<":s=e<a.value;break;case"<=":s=e<=a.value;break;case"=":s=e==a.value;break;case"none":s=e.substring(0,a.value.length)==a.value;break;case">=":s=e>=a.value;break;case">":s=e>a.value;break;case"<>":s=e!=a.value;break;case"regex":try{s=-1!=e.search(new RegExp(a.value))}catch(c){s=!1}}}return s};var t;t||(t={}),t.Popup={},t.Popup.Types={},t.Popup.Controls={},t.Popup.Current={},t.Popup.LocalizeString=function(e){return e},t.Popup.Create=function(e,o,i){var n=t.Popup.Types[e];n&&n.Create&&n.Create(e,o,i),t.Popup.imagePrefix=t.Constants.defaultImagePrefix},t.Popup.SetValue=function(e,o){var i=t.Popup,n=i.Types,r=i.Controls;if(!r[e])return void alert("Unknown control "+e);var a=r[e].type,s=n[a],l=r[e].data;s&&s.Create&&(s.SetValue(a,e,o),l.attribs&&l.attribs.changedcallback&&l.attribs.changedcallback(l.attribs,e,o))},t.Popup.SetDisabled=function(e,o){var i=t.Popup,n=i.Types,r=i.Controls;if(!r[e])return void alert("Unknown control "+e);var a=r[e].type,s=n[a];s&&s.Create&&(i.Current.id&&e==i.Current.id&&(s.Hide(a,i.Current.id),i.Current.id=null),s.SetDisabled(a,e,o))},t.Popup.GetValue=function(e){var o=t.Popup,i=o.Types,n=o.Controls;if(!n[e])return void alert("Unknown control "+e);var r=n[e].type,a=i[r];return a&&a.Create?a.GetValue(r,e):null},t.Popup.Initialize=function(e,o){var i=t.Popup,n=i.Types,r=i.Controls;if(!r[e])return void alert("Unknown control "+e);var a=r[e].type,s=n[a];s&&s.Initialize&&s.Initialize(a,e,o)},t.Popup.Reset=function(e){{var o=t.Popup,i=o.Types;o.Controls}i[e].Reset&&i[e].Reset(e)},t.Popup.CClick=function(e){var o=t.Popup,i=o.Types,n=o.Controls;if(!n[e])return void alert("Unknown control "+e);if(!n[e].data||!n[e].data.disabled){var r=n[e].type,a=i[r];if(o.Current.id&&(i[n[o.Current.id].type].Hide(r,o.Current.id),e==o.Current.id))return void(o.Current.id=null);a&&a.Show&&a.Show(r,e),o.Current.id=e}},t.Popup.Close=function(){{var e=t.Popup;e.Types,e.Controls}e.Current.id&&e.CClick(e.Current.id)},t.Popup.Cancel=function(){var e=t.Popup,o=e.Types,i=e.Controls;if(e.Current.id){var n=i[e.Current.id].type,r=o[n];r.Cancel(n,e.Current.id),e.Current.id=null}},t.Popup.CreatePopupDiv=function(e,o){var i,n=t.Popup,r=n.Controls,a=r[e].data,s=document.createElement("div");return s.style.position="absolute",i=t.GetElementPosition(a.mainele),s.style.top=i.top+a.mainele.offsetHeight+"px",s.style.left=i.left+"px",s.style.zIndex=100,s.style.backgroundColor="#FFF",s.style.border="1px solid black",o.width&&(s.style.width=o.width),a.mainele.appendChild(s),o.title&&(s.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">'+o.title+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.Popup.Cancel();">&nbsp;X&nbsp;</td></tr></table>',o.moveable&&(a.dragregistered=s.firstChild.firstChild.firstChild.firstChild,t.DragRegister(a.dragregistered,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:s},a.mainele))),s},t.Popup.EnsurePosition=function(e,o){function i(e){var o=t.GetElementPosition(e);return o.height=e.offsetHeight,o.width=e.offsetWidth,o.bottom=o.top+o.height,o.right=o.left+o.width,o}var n=t.Popup,r=n.Controls,a=r[e].data,s=a.mainele.firstChild;if(!s)return void alert("No main popup element firstChild.");var l=a.popupele,c=i(l),u=i(o),d=i(s),h=0;d.bottom+c.height<u.bottom&&d.left+c.width<u.right?(l.style.top=d.bottom+"px",l.style.left=d.left+"px",h=1):d.top-c.height>u.top&&d.left+c.width<u.right?(l.style.top=d.top-c.height+"px",l.style.left=d.left+"px",h=2):d.bottom+c.height<u.bottom&&d.right-c.width>u.left?(l.style.top=d.bottom+"px",l.style.left=d.right-c.width+"px",h=3):d.top-c.height>u.top&&d.right-c.width>u.left?(l.style.top=d.top-c.height+"px",l.style.left=d.right-c.width+"px",h=4):d.bottom+c.height<u.bottom&&c.width<u.width?(l.style.top=d.bottom+"px",l.style.left=u.left+Math.floor((u.width-c.width)/2)+"px",h=5):d.top-c.height>u.top&&c.width<u.width?(l.style.top=d.top-c.height+"px",l.style.left=u.left+Math.floor((u.width-c.width)/2)+"px",h=6):c.height<u.height&&d.right+c.width<u.right?(l.style.top=u.top+Math.floor((u.height-c.height)/2)+"px",l.style.left=d.right+"px",h=7):c.height<u.height&&d.left-c.width>u.left&&(l.style.top=u.top+Math.floor((u.height-c.height)/2)+"px",l.style.left=d.left-c.width+"px",h=8)},t.Popup.DestroyPopupDiv=function(e,o){e&&(e.innerHTML="",t.DragUnregister(o),e.parentNode&&e.parentNode.removeChild(e))},t.Popup.RGBToHex=function(e){var o=t.Popup;if(""==e)return"000000";var i=e.match(/(\d+)\D+(\d+)\D+(\d+)/);return i?o.ToHex(i[1])+o.ToHex(i[2])+o.ToHex(i[3]):"000000"},t.Popup.HexDigits="0123456789ABCDEF",t.Popup.ToHex=function(e){var o=t.Popup,i=Math.floor(e/16),n=e%16;return o.HexDigits.charAt(i)+o.HexDigits.charAt(n)},t.Popup.FromHex=function(e){var o=t.Popup,i=o.HexDigits.indexOf(e.charAt(0).toUpperCase()),n=o.HexDigits.indexOf(e.charAt(1).toUpperCase());return 16*(i>=0?i:0)+(n>=0?n:0)},t.Popup.HexToRGB=function(e){var o=t.Popup;return"rgb("+o.FromHex(e.substring(1,3))+","+o.FromHex(e.substring(3,5))+","+o.FromHex(e.substring(5,7))+")"},t.Popup.makeRGB=function(e,t,o){return"rgb("+(e>0?e:0)+","+(t>0?t:0)+","+(o>0?o:0)+")"},t.Popup.splitRGB=function(e){var t=e.match(/(\d+)\D+(\d+)\D+(\d+)\D/);return t?{r:t[1]-0,g:t[2]-0,b:t[3]-0}:{r:0,g:0,b:0}},t.Popup.Types.List={},t.Popup.Types.List.Create=function(e,o,i){var n=t.Popup,r=(n.Types,n.Controls),a={type:e,value:"",display:"",data:{}};r[o]=a;var s=a.data;s.attribs=i||{};var l=document.getElementById(o);return l?(s.mainele=l,l.innerHTML='<input style="cursor:pointer;width:100px;font-size:smaller;" onfocus="this.blur();" onclick="SocialCalc.Popup.CClick(\''+o+'\');" value="">',void(s.options=[])):void alert("Missing element "+o)},t.Popup.Types.List.SetValue=function(e,i,n){var r,a=t.Popup,s=(a.Types,a.Controls),l=s[i].data;for(l.value=n,l.custom=!1,r=0;r<l.options.length;r++)if(o=l.options[r],!(o.a&&(o.a.skip||o.a.custom||o.a.cancel)||o.v!=l.value)){l.display=o.o;break}r==l.options.length&&(l.display="Custom",l.custom=!0),l.mainele&&l.mainele.firstChild&&(l.mainele.firstChild.value=l.display)},t.Popup.Types.List.SetDisabled=function(e,o,i){var n=t.Popup,r=(n.Types,n.Controls),a=r[o].data;a.disabled=i,a.mainele&&a.mainele.firstChild&&(a.mainele.firstChild.disabled=i)},t.Popup.Types.List.GetValue=function(e,o){var i=t.Popup,n=(i.Types,i.Controls),r=n[o].data;return r.value},t.Popup.Types.List.Initialize=function(e,o,i){var n,r=t.Popup,a=(r.Types,r.Controls),s=a[o].data;for(n in i.attribs)s.attribs[n]=i.attribs[n];s.options=i?i.options:[],i.value&&r.SetValue(o,i.value)},t.Popup.Types.List.Reset=function(e){var o=t.Popup,i=o.Types,n=o.Controls;o.Current.id&&n[o.Current.id].type==e&&(i[e].Hide(e,o.Current.id),o.Current.id=null)},t.Popup.Types.List.Show=function(e,o){var i,n=t.Popup,r=(n.Types,n.Controls),a=r[o].data,s="";a.popupele=n.CreatePopupDiv(o,a.attribs),a.custom?(s=t.Popup.Types.List.MakeCustom(e,o),i=document.createElement("div"),i.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+s+"</div>",a.customele=i.firstChild.firstChild.childNodes[1],a.listdiv=null,a.contentele=i):(s=t.Popup.Types.List.MakeList(e,o),i=document.createElement("div"),i.innerHTML='<div style="cursor:default;padding:4px;">'+s+"</div>",a.customele=null,a.listdiv=i.firstChild,a.contentele=i),a.mainele&&a.mainele.firstChild&&(a.mainele.firstChild.disabled=!0),a.popupele.appendChild(i),a.attribs.ensureWithin&&t.Popup.EnsurePosition(o,a.attribs.ensureWithin)},t.Popup.Types.List.MakeList=function(e,o){var i,n,r,a=t.Popup,s=(a.Types,a.Controls),l=s[o].data,c='<table cellspacing="0" cellpadding="0"><tr>',u='<td style="vertical-align:top;">';for(c+=u,l.ncols=1,i=0;i<l.options.length;i++){if(n=l.options[i],n.a){if(n.a.newcol){c+="</td>"+u+"&nbsp;&nbsp;&nbsp;&nbsp;</td>"+u,l.ncols+=1;continue}if(n.a.skip){c+='<div style="font-size:x-small;white-space:nowrap;">'+n.o+"</div>";continue}}r=n.v!=l.value||n.a&&(n.a.custom||n.a.cancel)?"":"background-color:#DDF;",c+='<div style="font-size:x-small;white-space:nowrap;'+r+'" onclick="SocialCalc.Popup.Types.List.ItemClicked(\''+o+"','"+i+"');\" onmousemove=\"SocialCalc.Popup.Types.List.MouseMove('"+o+"',this);\">"+n.o+"</div>"}return c+="</td></tr></table>"},t.Popup.Types.List.MakeCustom=function(e,o){var i=t.Popup.LocalizeString,n=t.Popup,r=(n.Types,n.Controls),a=r[o].data,s='style="font-size:smaller;"',l="",c=a.value;return c=t.special_chars(c),l='<div style="white-space:nowrap;"><br><input id="customvalue" value="'+c+'"><br><br><input '+s+' type="button" value="'+i("OK")+'" onclick="SocialCalc.Popup.Types.List.CustomOK(\''+o+"');return false;\"><input "+s+' type="button" value="'+i("List")+'" onclick="SocialCalc.Popup.Types.List.CustomToList(\''+o+"');\"><input "+s+' type="button" value="'+i("Cancel")+'" onclick="SocialCalc.Popup.Close();"><br></div>'},t.Popup.Types.List.ItemClicked=function(e,o){var i,n,r,a=t.Popup,s=(a.Types,a.Controls),l=s[e].data,c=l.options[o].a;return c&&c.custom?(i=l.contentele,n=t.Popup.Types.List.MakeCustom("List",e),r=document.createElement("div"),r.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+n+"</div>",l.customele=r.firstChild.firstChild.childNodes[1],l.listdiv=null,l.contentele=r,l.popupele.replaceChild(r,i),void(l.attribs.ensureWithin&&t.Popup.EnsurePosition(e,l.attribs.ensureWithin))):c&&c.cancel?void t.Popup.Close():(t.Popup.SetValue(e,l.options[o].v),void t.Popup.Close())},t.Popup.Types.List.CustomToList=function(e){var o,i,n,r=t.Popup,a=(r.Types,r.Controls),s=a[e].data;o=s.contentele,i=t.Popup.Types.List.MakeList("List",e),n=document.createElement("div"),n.innerHTML='<div style="cursor:default;padding:4px;">'+i+"</div>",s.customele=null,s.listdiv=n.firstChild,s.contentele=n,s.popupele.replaceChild(n,o),s.attribs.ensureWithin&&t.Popup.EnsurePosition(e,s.attribs.ensureWithin)},t.Popup.Types.List.CustomOK=function(e){var o=t.Popup,i=(o.Types,o.Controls),n=i[e].data;t.Popup.SetValue(e,n.customele.value),t.Popup.Close()},t.Popup.Types.List.MouseMove=function(e,o){var i,n,r=t.Popup,a=(r.Types,r.Controls),s=a[e].data,l=s.listdiv;if(l){var c=l.firstChild.firstChild.firstChild;for(i=0;i<s.ncols;i++)for(n=0;n<c.childNodes[2*i].childNodes.length;n++)c.childNodes[2*i].childNodes[n].style.backgroundColor="#FFF";o.style.backgroundColor="#DDF"}},t.Popup.Types.List.Hide=function(e,o){var i=t.Popup,n=(i.Types,i.Controls),r=n[o].data;i.DestroyPopupDiv(r.popupele,r.dragregistered),r.popupele=null,r.mainele&&r.mainele.firstChild&&(r.mainele.firstChild.disabled=!1)},t.Popup.Types.List.Cancel=function(e,o){t.Popup.Types.List.Hide(e,o)},t.Popup.Types.ColorChooser={},t.Popup.Types.ColorChooser.Create=function(e,o,i){var n=t.Popup,r=(n.Types,n.Controls),a={type:e,value:"",display:"",data:{}};r[o]=a;var s=a.data;s.attribs=i||{};var l=s.attribs;s.value="";var c=document.getElementById(o);return c?(s.mainele=c,void(c.innerHTML='<div style="cursor:pointer;border:1px solid black;vertical-align:top;width:'+(l.sampleWidth||"15px")+";height:"+(l.sampleHeight||"15px")+';" onclick="SocialCalc.Popup.Types.ColorChooser.ControlClicked(\''+o+"');\">&nbsp;</div>")):void alert("Missing element "+o)},t.Popup.Types.ColorChooser.SetValue=function(e,o,i){var n,r,a=t.Popup,s=(a.Types,a.Controls),l=s[o].data,c=l.attribs;l.value=i,l.custom=!1,l.mainele&&l.mainele.firstChild&&(l.value?(l.mainele.firstChild.style.backgroundColor=l.value,n=c.backgroundImage?"url("+a.imagePrefix+c.backgroundImage+")":"",r="center center"):(l.mainele.firstChild.style.backgroundColor="#FFF",c.backgroundImageDefault?(n="url("+a.imagePrefix+c.backgroundImageDefault+")",r="center center"):(n="url("+a.imagePrefix+"defaultcolor.gif)",r="left top")),l.mainele.firstChild.style.backgroundPosition=r,l.mainele.firstChild.style.backgroundImage=n)},t.Popup.Types.ColorChooser.SetDisabled=function(e,o,i){var n=t.Popup,r=(n.Types,n.Controls),a=r[o].data,s=a.attribs;a.disabled=i,a.mainele&&a.mainele.firstChild&&(i?(a.mainele.firstChild.style.backgroundColor="#DDD",s.backgroundImageDisabled?(img="url("+n.imagePrefix+s.backgroundImageDisabled+")",pos="center center"):(img="url("+n.imagePrefix+"defaultcolor.gif)",pos="left top"),a.mainele.firstChild.style.backgroundPosition=pos,a.mainele.firstChild.style.backgroundImage=img):n.SetValue(o,a.value))},t.Popup.Types.ColorChooser.GetValue=function(e,o){var i=t.Popup,n=(i.Types,i.Controls),r=n[o].data;return r.value},t.Popup.Types.ColorChooser.Initialize=function(e,o,i){var n,r=t.Popup,a=(r.Types,r.Controls),s=a[o].data;for(n in i.attribs)s.attribs[n]=i.attribs[n];i.value&&r.SetValue(o,i.value)},t.Popup.Types.ColorChooser.Reset=function(e){var o=t.Popup,i=o.Types,n=o.Controls;o.Current.id&&n[o.Current.id].type==e&&(i[e].Hide(e,o.Current.id),o.Current.id=null)},t.Popup.Types.ColorChooser.Show=function(e,o){var i,n,r=t.Popup,a=(r.Types,r.Controls),s=a[o].data,l="";s.oldvalue=s.value,s.popupele=r.CreatePopupDiv(o,s.attribs),s.custom?(l=t.Popup.Types.ColorChooser.MakeCustom(e,o),i=document.createElement("div"),i.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+l+"</div>",s.customele=i.firstChild.firstChild.childNodes[2],s.contentele=i):(n=t.Popup.Types.ColorChooser.CreateGrid(e,o),i=document.createElement("div"),i.style.padding="3px",i.style.backgroundColor="#CCC",i.appendChild(n),s.customele=null,s.contentele=i),s.popupele.appendChild(i),s.attribs.ensureWithin&&t.Popup.EnsurePosition(o,s.attribs.ensureWithin)},t.Popup.Types.ColorChooser.MakeCustom=function(e,o){var i=t.Popup,n=(i.Types,i.Controls),r=n[o].data,a=i.LocalizeString,s='style="font-size:smaller;"',l="";return l='<div style="white-space:nowrap;"><br>#<input id="customvalue" style="width:75px;" value="'+r.value+'"><br><br><input '+s+' type="button" value="'+a("OK")+'" onclick="SocialCalc.Popup.Types.ColorChooser.CustomOK(\''+o+"');return false;\"><input "+s+' type="button" value="'+a("Grid")+'" onclick="SocialCalc.Popup.Types.ColorChooser.CustomToGrid(\''+o+"');\"><br></div>"},t.Popup.Types.ColorChooser.ItemClicked=function(e){{var o=t.Popup,i=(o.Types,o.Controls);i[e].data}t.Popup.Close()},t.Popup.Types.ColorChooser.CustomToList=function(e){{var o=t.Popup,i=(o.Types,o.Controls);i[e].data}},t.Popup.Types.ColorChooser.CustomOK=function(e){var o=t.Popup,i=(o.Types,o.Controls),n=i[e].data;o.SetValue(e,n.customele.value),o.Close()},t.Popup.Types.ColorChooser.Hide=function(e,o){var i=t.Popup,n=(i.Types,i.Controls),r=n[o].data;i.DestroyPopupDiv(r.popupele,r.dragregistered),r.popupele=null},t.Popup.Types.ColorChooser.Cancel=function(e,o){var i=t.Popup,n=(i.Types,i.Controls),r=n[o].data;i.SetValue(o,r.oldvalue),t.Popup.Types.ColorChooser.Hide(e,o)},t.Popup.Types.ColorChooser.CreateGrid=function(e,o){var i,n,r,a,s,l=t.Popup,c=l.Types,u=l.Controls,d=l.LocalizeString,h=u[o].data;h.grid={};var p=h.grid,f=document.createElement("div");for(i=document.createElement("table"),i.cellSpacing=0,i.cellPadding=0,i.style.width="100px",p.table=i,i=document.createElement("tbody"),p.table.appendChild(i),p.tbody=i,n=0;16>n;n++){for(r=document.createElement("tr"),a=0;5>a;a++)s={},p[n+","+a]=s,i=document.createElement("td"),i.style.fontSize="1px",i.innerHTML="&nbsp;",i.style.height="10px",1>=a?(i.style.width="17px",i.style.borderRight="3px solid white"):(i.style.width="20px",i.style.backgroundRepeat="no-repeat"),r.appendChild(i),s.ele=i;
p.tbody.appendChild(r)}return f.appendChild(p.table),i=document.createElement("div"),i.style.marginTop="3px",i.innerHTML='<table cellspacing="0" cellpadding="0"><tr><td style="width:17px;background-color:#FFF;background-image:url('+l.imagePrefix+'defaultcolor.gif);height:16px;font-size:10px;cursor:pointer;" title="'+d("Default")+'">&nbsp;</td><td style="width:23px;height:16px;font-size:10px;text-align:center;cursor:pointer;" title="'+d("Custom")+'">#</td><td style="width:60px;height:16px;font-size:10px;text-align:center;cursor:pointer;">'+d("OK")+"</td></tr></table>",p.defaultbox=i.firstChild.firstChild.firstChild.childNodes[0],p.defaultbox.onclick=c.ColorChooser.DefaultClicked,p.custom=i.firstChild.firstChild.firstChild.childNodes[1],p.custom.onclick=c.ColorChooser.CustomClicked,p.msg=i.firstChild.firstChild.firstChild.childNodes[2],p.msg.onclick=c.ColorChooser.CloseOK,f.appendChild(i),p.table.onmousedown=c.ColorChooser.GridMouseDown,c.ColorChooser.DetermineColors(o),c.ColorChooser.SetColors(o),f},t.Popup.Types.ColorChooser.gridToG=function(e,t,o){return e[t+","+o]},t.Popup.Types.ColorChooser.DetermineColors=function(e){var o,i,n=t.Popup,r=n.Types,a=r.ColorChooser,s=n.Controls,l=s[e].data,c=l.grid,u=n.splitRGB(l.value);for(o=2,i=16-Math.floor((u.r+16)/16),c["selectedrow"+o]=i,i=0;16>i;i++)a.gridToG(c,i,o).rgb=n.makeRGB(17*(15-i),0,0);for(o=3,i=16-Math.floor((u.g+16)/16),c["selectedrow"+o]=i,i=0;16>i;i++)a.gridToG(c,i,o).rgb=n.makeRGB(0,17*(15-i),0);for(o=4,i=16-Math.floor((u.b+16)/16),c["selectedrow"+o]=i,i=0;16>i;i++)a.gridToG(c,i,o).rgb=n.makeRGB(0,0,17*(15-i));for(o=1,i=0;16>i;i++)a.gridToG(c,i,o).rgb=n.makeRGB(17*(15-i),17*(15-i),17*(15-i));o=0;var d,h=[0,68,153,204,255],p=["400","310","420","440","442","340","040","042","032","044","024","004","204","314","402","414"];for(i=0;16>i;i++)d=p[i],a.gridToG(c,i,o).rgb="rgb("+h[d.charAt(0)-0]+","+h[d.charAt(1)-0]+","+h[d.charAt(2)-0]+")"},t.Popup.Types.ColorChooser.SetColors=function(e){var o,i,n,r,a=t.Popup,s=a.Types,l=s.ColorChooser,c=a.Controls,u=c[e].data,d=u.grid;for(o=0;16>o;o++)for(i=0;5>i;i++)n=l.gridToG(d,o,i),n.ele.style.backgroundColor=n.rgb,n.ele.title=a.RGBToHex(n.rgb),n.ele.style.backgroundImage=d["selectedrow"+i]==o?"url("+a.imagePrefix+"chooserarrow.gif)":"";a.SetValue(e,u.value),d.msg.style.backgroundColor=u.value,r=a.splitRGB(u.value||"rgb(255,255,255)"),d.msg.style.color=r.r+r.g+r.b<220?"#FFF":"#000",u.value?(d.msg.style.backgroundImage="",d.msg.title=a.RGBToHex(u.value)):(d.msg.style.backgroundColor="#FFF",d.msg.style.backgroundImage="url("+a.imagePrefix+"defaultcolor.gif)",d.msg.title="Default")},t.Popup.Types.ColorChooser.GridMouseDown=function(o){var i=o||e.event,n=t.Popup,r=n.Types,a=r.ColorChooser,s=n.Controls,l=n.Current.id;if(l){var c=s[l].data,u=c.grid;switch(i.type){case"mousedown":u.mousedown=!0;break;case"mouseup":u.mousedown=!1;break;case"mousemove":if(!u.mousedown)return}var d=t.GetElementPositionWithScroll(c.mainele),h=i.clientX-d.left,p=i.clientY-d.top,f=t.GetElementPositionWithScroll(u.table);f.left-=d.left,f.top-=d.top;var m=Math.floor((p-f.top-2)/10);m=0>m?0:m;var g=Math.floor((h-f.left)/20);m=0>m?0:m>15?15:m,g=0>g?0:g>4?4:g;var v=a.gridToG(u,m,g).ele.style.backgroundColor,b=n.splitRGB(v),y=n.splitRGB(c.value);switch(g){case 2:c.value=n.makeRGB(b.r,y.g,y.b);break;case 3:c.value=n.makeRGB(y.r,b.g,y.b);break;case 4:c.value=n.makeRGB(y.r,y.g,b.b);break;case 0:case 1:c.value=v}a.DetermineColors(l),a.SetColors(l)}},t.Popup.Types.ColorChooser.ControlClicked=function(e){var o=t.Popup,i=o.Types,n=i.ColorChooser,r=(o.Controls,o.Current.id);return r&&e==r?void n.CloseOK():void o.CClick(e)},t.Popup.Types.ColorChooser.DefaultClicked=function(o){var i=(o||e.event,t.Popup),n=i.Types,r=(n.ColorChooser,i.Controls),a=i.Current.id;if(a){var s=r[a].data;s.value="",t.Popup.SetValue(a,s.value),t.Popup.Close()}},t.Popup.Types.ColorChooser.CustomClicked=function(o){var i=(o||e.event,t.Popup),n=i.Types,r=(n.ColorChooser,i.Controls),a=i.Current.id;if(a){var s,l,c,u=r[a].data;s=u.contentele,l=t.Popup.Types.ColorChooser.MakeCustom("ColorChooser",a),c=document.createElement("div"),c.innerHTML='<div style="cursor:default;padding:4px;background-color:#CCC;">'+l+"</div>",u.customele=c.firstChild.firstChild.childNodes[2],u.contentele=c,u.popupele.replaceChild(c,s),u.customele.value=i.RGBToHex(u.value),u.attribs.ensureWithin&&t.Popup.EnsurePosition(a,u.attribs.ensureWithin)}},t.Popup.Types.ColorChooser.CustomToGrid=function(e){var o,i,n=t.Popup,r=(n.Types,n.Controls),a=r[e].data;t.Popup.SetValue(e,n.HexToRGB("#"+a.customele.value));var o,s,i;o=a.contentele,s=t.Popup.Types.ColorChooser.CreateGrid("ColorChooser",e),i=document.createElement("div"),i.style.padding="3px",i.style.backgroundColor="#CCC",i.appendChild(s),a.customele=null,a.contentele=i,a.popupele.replaceChild(i,o),a.attribs.ensureWithin&&t.Popup.EnsurePosition(e,a.attribs.ensureWithin)},t.Popup.Types.ColorChooser.CustomOK=function(e){var o=t.Popup,i=(o.Types,o.Controls),n=i[e].data;t.Popup.SetValue(e,o.HexToRGB("#"+n.customele.value)),t.Popup.Close()},t.Popup.Types.ColorChooser.CloseOK=function(o){var i=(o||e.event,t.Popup),n=i.Types,r=(n.ColorChooser,i.Controls),a=i.Current.id;if(a){var s=r[a].data;t.Popup.SetValue(a,s.value),t.Popup.Close()}};var t;t||(alert("Main SocialCalc code module needed"),t={}),t.TableEditor||alert("SocialCalc TableEditor code module needed"),t.CurrentSpreadsheetControlObject=null,t.SpreadsheetControl=function(e){var o=t.Constants;this.parentNode=null,this.spreadsheetDiv=null,this.requestedHeight=0,this.requestedWidth=0,this.requestedSpaceBelow=0,this.height=0,this.width=0,this.viewheight=0,this.tabs=[],this.tabnums={},this.tabreplacements={},this.currentTab=-1,this.views={},this.sheet=null,this.context=null,this.editor=null,this.spreadsheetDiv=null,this.editorDiv=null,this.sortrange="",this.moverange="",this.idPrefix=e||"SocialCalc-",this.multipartBoundary="SocialCalcSpreadsheetControlSave",this.imagePrefix=o.defaultImagePrefix,this.toolbarbackground=o.SCToolbarbackground,this.tabbackground=o.SCTabbackground,this.tabselectedCSS=o.SCTabselectedCSS,this.tabplainCSS=o.SCTabplainCSS,this.toolbartext=o.SCToolbartext,this.formulabarheight=o.SCFormulabarheight,this.statuslineheight=o.SCStatuslineheight,this.statuslineCSS=o.SCStatuslineCSS,this.ExportCallback=null,"undefined"==typeof t.debug_log&&(t.debug_log=[]),this.sheet=new t.Sheet,this.context=new t.RenderContext(this.sheet),this.context.showGrid=!0,this.context.showRCHeaders=!0,this.editor=new t.TableEditor(this.context),this.editor.StatusCallback.statusline={func:t.SpreadsheetControlStatuslineCallback,params:{statuslineid:this.idPrefix+"statusline",recalcid1:this.idPrefix+"divider_recalc",recalcid2:this.idPrefix+"button_recalc"}},t.CurrentSpreadsheetControlObject=this,this.editor.MoveECellCallback.movefrom=function(e){var o=t.GetSpreadsheetControlObject();o.context.cursorsuffix="",e.range2.hasrange&&!e.cellhandles.noCursorSuffix&&(e.ecell.row==e.range2.top&&(e.ecell.col<e.range2.left||e.ecell.col>e.range2.right+1)&&(o.context.cursorsuffix="insertleft"),e.ecell.col==e.range2.left&&(e.ecell.row<e.range2.top||e.ecell.row>e.range2.bottom+1)&&(o.context.cursorsuffix="insertup"))},this.formulabuttons={formulafunctions:{image:"insertformula.png",tooltip:"Functions",command:t.SpreadsheetControl.DoFunctionList},multilineinput:{image:"listbox.png",tooltip:"Multi-line Input Box",command:t.SpreadsheetControl.DoMultiline},link:{image:"inserthyperlink.png",tooltip:"Link Input Box",command:t.SpreadsheetControl.DoLink},sum:{image:"autosum.png",tooltip:"Auto Sum",command:t.SpreadsheetControl.DoSum}},this.findbuttons={last:{image:"upsearch.png",tooltip:"Find Previous",command:t.SpreadsheetControl.SearchUp},next:{image:"downsearch.png",tooltip:"Find Next",command:t.SpreadsheetControl.SearchDown}},this.tabnums.edit=this.tabs.length,this.tabs.push({name:"edit",text:"Edit",html:' <div id="%id.edittools" style="padding:10px 0px 0px 0px;">&nbsp;<img id="%id.button_undo" src="%img.undo.png" style="vertical-align:bottom;"> <img id="%id.button_redo" src="%img.redo.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_copy" src="%img.copy.png" style="vertical-align:bottom;"> <img id="%id.button_cut" src="%img.cut.png" style="vertical-align:bottom;"> <img id="%id.button_paste" src="%img.paste.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_delete" src="%img.delete.png" style="vertical-align:bottom;"> <img id="%id.button_pasteformats" src="%img.formatpaintbrush.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp;  <span id="%id.locktools"><img id="%id.button_lock" src="%img.lock.png" style="vertical-align:bottom;"> <img id="%id.button_unlock" src="%img.unlock.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp;</span> <img id="%id.button_filldown" src="%img.filldown.png" style="vertical-align:bottom;"> <img id="%id.button_fillright" src="%img.fillright.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_movefrom" src="%img.movefromoff.gif" style="vertical-align:bottom;"> <img id="%id.button_movepaste" src="%img.movepasteoff.gif" style="vertical-align:bottom;"> <img id="%id.button_moveinsert" src="%img.moveinsertoff.gif" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_alignleft" src="%img.alignleft.png" style="vertical-align:bottom;"> <img id="%id.button_aligncenter" src="%img.aligncenter.png" style="vertical-align:bottom;"> <img id="%id.button_alignright" src="%img.alignright.png" style="vertical-align:bottom;"> &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_borderon" src="%img.borderson.png" style="vertical-align:bottom;">  <img id="%id.button_borderoff" src="%img.bordersoff.png" style="vertical-align:bottom;">  <img id="%id.button_swapcolors" src="%img.swapcolors.png" style="vertical-align:bottom;">  &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_merge" src="%img.mergecells.png" style="vertical-align:bottom;">  &nbsp;<img src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_insertrow" src="%img.insertrows.png" style="vertical-align:bottom;">  <img id="%id.button_insertcol" src="%img.insertcolumns.png" style="vertical-align:bottom;">  <img id="%id.button_deleterow" src="%img.deleterows.png" style="vertical-align:bottom;">  <img id="%id.button_deletecol" src="%img.deletecolumns.png" style="vertical-align:bottom;">  <img id="%id.button_hiderow" src="%img.hiderow.png" style="vertical-align:bottom;">  <img id="%id.button_hidecol" src="%img.hidecol.png" style="vertical-align:bottom;">  &nbsp;<img id="%id.divider_recalc" src="%img.divider1.png" style="vertical-align:bottom;">&nbsp; <img id="%id.button_recalc" src="%img.recalc.png" style="vertical-align:bottom;">  </div>',oncreate:null,onclick:null}),this.tabnums.settings=this.tabs.length,this.tabs.push({name:"settings",text:"Format",html:'<div id="%id.settingstools" style="display:none;"> <div id="%id.sheetsettingstoolbar" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr><td>   <div style="%tbt.">%loc!SHEET SETTINGS!:</div>   </td></tr><tr><td>   <input id="%id.settings-savesheet" type="button" value="%loc!Save!" onclick="SocialCalc.SettingsControlSave(\'sheet\');">   <input type="button" value="%loc!Cancel!" onclick="SocialCalc.SettingsControlSave(\'cancel\');">   <input type="button" value="%loc!Show Cell Settings!" onclick="SocialCalc.SpreadsheetControlSettingsSwitch(\'cell\');return false;">   </td></tr></table> </div> <div id="%id.cellsettingstoolbar" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr><td>   <div style="%tbt.">%loc!CELL SETTINGS!: <span id="%id.settingsecell">&nbsp;</span></div>   </td></tr><tr><td>  <input id="%id.settings-savecell" type="button" value="%loc!Save!" onclick="SocialCalc.SettingsControlSave(\'cell\');">  <input type="button" value="%loc!Cancel!" onclick="SocialCalc.SettingsControlSave(\'cancel\');">  <input type="button" value="%loc!Show Sheet Settings!" onclick="SocialCalc.SpreadsheetControlSettingsSwitch(\'sheet\');return false;">  </td></tr></table> </div></div>',view:"settings",onclick:function(e){t.SettingsControls.idPrefix=e.idPrefix,t.SettingControlReset();var o=e.sheet.EncodeSheetAttributes(),i=e.sheet.EncodeCellAttributes(e.editor.ecell.coord);t.SettingsControlLoadPanel(e.views.settings.values.sheetspanel,o),t.SettingsControlLoadPanel(e.views.settings.values.cellspanel,i),document.getElementById(e.idPrefix+"settingsecell").innerHTML=e.editor.ecell.coord,t.SpreadsheetControlSettingsSwitch("cell"),e.views.settings.element.style.height=e.viewheight+"px",e.views.settings.element.firstChild.style.height=e.viewheight+"px";var n;n=e.editor.range.hasrange?t.crToCoord(e.editor.range.left,e.editor.range.top)+":"+t.crToCoord(e.editor.range.right,e.editor.range.bottom):e.editor.ecell.coord,document.getElementById(e.idPrefix+"settings-savecell").value=t.LocalizeString("Save to")+": "+n},onclickFocus:!0}),this.views.settings={name:"settings",values:{},oncreate:function(e,o){var i=t.Constants;o.values.sheetspanel={colorchooser:{id:e.idPrefix+"scolorchooser"},formatnumber:{setting:"numberformat",type:"PopupList",id:e.idPrefix+"formatnumber",initialdata:i.SCFormatNumberFormats},formattext:{setting:"textformat",type:"PopupList",id:e.idPrefix+"formattext",initialdata:i.SCFormatTextFormats},fontfamily:{setting:"fontfamily",type:"PopupList",id:e.idPrefix+"fontfamily",initialdata:i.SCFormatFontfamilies},fontlook:{setting:"fontlook",type:"PopupList",id:e.idPrefix+"fontlook",initialdata:i.SCFormatFontlook},fontsize:{setting:"fontsize",type:"PopupList",id:e.idPrefix+"fontsize",initialdata:i.SCFormatFontsizes},textalignhoriz:{setting:"textalignhoriz",type:"PopupList",id:e.idPrefix+"textalignhoriz",initialdata:i.SCFormatTextAlignhoriz},numberalignhoriz:{setting:"numberalignhoriz",type:"PopupList",id:e.idPrefix+"numberalignhoriz",initialdata:i.SCFormatNumberAlignhoriz},alignvert:{setting:"alignvert",type:"PopupList",id:e.idPrefix+"alignvert",initialdata:i.SCFormatAlignVertical},textcolor:{setting:"textcolor",type:"ColorChooser",id:e.idPrefix+"textcolor"},bgcolor:{setting:"bgcolor",type:"ColorChooser",id:e.idPrefix+"bgcolor"},padtop:{setting:"padtop",type:"PopupList",id:e.idPrefix+"padtop",initialdata:i.SCFormatPadsizes},padright:{setting:"padright",type:"PopupList",id:e.idPrefix+"padright",initialdata:i.SCFormatPadsizes},padbottom:{setting:"padbottom",type:"PopupList",id:e.idPrefix+"padbottom",initialdata:i.SCFormatPadsizes},padleft:{setting:"padleft",type:"PopupList",id:e.idPrefix+"padleft",initialdata:i.SCFormatPadsizes},colwidth:{setting:"colwidth",type:"PopupList",id:e.idPrefix+"colwidth",initialdata:i.SCFormatColwidth},recalc:{setting:"recalc",type:"PopupList",id:e.idPrefix+"recalc",initialdata:i.SCFormatRecalc},usermaxcol:{setting:"usermaxcol",type:"PopupList",id:e.idPrefix+"usermaxcol",initialdata:i.SCFormatUserMaxCol},usermaxrow:{setting:"usermaxrow",type:"PopupList",id:e.idPrefix+"usermaxrow",initialdata:i.SCFormatUserMaxRow}},o.values.cellspanel={name:"cell",colorchooser:{id:e.idPrefix+"scolorchooser"},cformatnumber:{setting:"numberformat",type:"PopupList",id:e.idPrefix+"cformatnumber",initialdata:i.SCFormatNumberFormats},cformattext:{setting:"textformat",type:"PopupList",id:e.idPrefix+"cformattext",initialdata:i.SCFormatTextFormats},cfontfamily:{setting:"fontfamily",type:"PopupList",id:e.idPrefix+"cfontfamily",initialdata:i.SCFormatFontfamilies},cfontlook:{setting:"fontlook",type:"PopupList",id:e.idPrefix+"cfontlook",initialdata:i.SCFormatFontlook},cfontsize:{setting:"fontsize",type:"PopupList",id:e.idPrefix+"cfontsize",initialdata:i.SCFormatFontsizes},calignhoriz:{setting:"alignhoriz",type:"PopupList",id:e.idPrefix+"calignhoriz",initialdata:i.SCFormatTextAlignhoriz},calignvert:{setting:"alignvert",type:"PopupList",id:e.idPrefix+"calignvert",initialdata:i.SCFormatAlignVertical},ctextcolor:{setting:"textcolor",type:"ColorChooser",id:e.idPrefix+"ctextcolor"},cbgcolor:{setting:"bgcolor",type:"ColorChooser",id:e.idPrefix+"cbgcolor"},cbt:{setting:"bt",type:"BorderSide",id:e.idPrefix+"cbt"},cbr:{setting:"br",type:"BorderSide",id:e.idPrefix+"cbr"},cbb:{setting:"bb",type:"BorderSide",id:e.idPrefix+"cbb"},cbl:{setting:"bl",type:"BorderSide",id:e.idPrefix+"cbl"},cpadtop:{setting:"padtop",type:"PopupList",id:e.idPrefix+"cpadtop",initialdata:i.SCFormatPadsizes},cpadright:{setting:"padright",type:"PopupList",id:e.idPrefix+"cpadright",initialdata:i.SCFormatPadsizes},cpadbottom:{setting:"padbottom",type:"PopupList",id:e.idPrefix+"cpadbottom",initialdata:i.SCFormatPadsizes},cpadleft:{setting:"padleft",type:"PopupList",id:e.idPrefix+"cpadleft",initialdata:i.SCFormatPadsizes}},t.SettingsControlInitializePanel(o.values.sheetspanel),t.SettingsControlInitializePanel(o.values.cellspanel)},replacements:{itemtitle:{regex:/\%itemtitle\./g,replacement:'style="padding:12px 10px 0px 10px;font-weight:bold;text-align:right;vertical-align:top;font-size:small;"'},sectiontitle:{regex:/\%sectiontitle\./g,replacement:'style="padding:16px 10px 0px 0px;font-weight:bold;vertical-align:top;font-size:small;color:#C00;"'},parttitle:{regex:/\%parttitle\./g,replacement:'style="font-weight:bold;font-size:x-small;padding:0px 0px 3px 0px;"'},itembody:{regex:/\%itembody\./g,replacement:'style="padding:12px 0px 0px 0px;vertical-align:top;font-size:small;"'},bodypart:{regex:/\%bodypart\./g,replacement:'style="padding:0px 10px 0px 0px;font-size:small;vertical-align:top;"'}},divStyle:"border:1px solid black;overflow:auto;",html:'<div id="%id.scolorchooser" style="display:none;position:absolute;z-index:20;"></div><table cellspacing="0" cellpadding="0"> <tr><td style="vertical-align:top;"><table id="%id.sheetsettingstable" style="display:none;" cellspacing="0" cellpadding="0"><tr> <td %itemtitle.><br>%loc!Default Format!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id="%id.formatnumber"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id="%id.formattext"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Alignment!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Text Horizontal!</div>     <span id="%id.textalignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Number Horizontal!</div>     <span id="%id.numberalignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id="%id.alignvert"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Font!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id="%id.fontfamily"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id="%id.fontlook"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id="%id.fontsize"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id="%id.textcolor"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id="%id.bgcolor"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Padding!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id="%id.padtop"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id="%id.padright"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id="%id.padbottom"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id="%id.padleft"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Column Width!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id="%id.colwidth"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Recalculation!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id="%id.recalc"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Dimensions!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Columns!</div>     <span id="%id.usermaxcol"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Rows!</div>     <span id="%id.usermaxrow"></span>    </td>   </tr></table> </td></tr></table><table id="%id.cellsettingstable" cellspacing="0" cellpadding="0"><tr> <td %itemtitle.><br>%loc!Format!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id="%id.cformatnumber"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id="%id.cformattext"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Alignment!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Horizontal!</div>     <span id="%id.calignhoriz"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id="%id.calignvert"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Font!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id="%id.cfontfamily"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id="%id.cfontlook"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id="%id.cfontsize"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id="%id.ctextcolor"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id="%id.cbgcolor"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Borders!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0">    <tr><td %bodypart. colspan="3"><div %parttitle.>%loc!Top Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Right Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Bottom Border!</div></td>     <td %bodypart. colspan="3"><div %parttitle.>%loc!Left Border!</div></td>    </tr><tr>    <td %bodypart.>     <input id="%id.cbt-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbt-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbr-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbr-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbb-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbb-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id="%id.cbl-onoff-bcb" onclick="SocialCalc.SettingsControlOnchangeBorder(this);" type="checkbox">    </td>    <td %bodypart.>     <div id="%id.cbl-color"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Padding!:</td> <td %itembody.>   <table cellspacing="0" cellpadding="0"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id="%id.cpadtop"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id="%id.cpadright"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id="%id.cpadbottom"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id="%id.cpadleft"></span>    </td>   </tr></table> </td></tr></table> </td><td style="vertical-align:top;padding:12px 0px 0px 12px;">  <div style="width:100px;height:100px;overflow:hidden;border:1px solid black;background-color:#EEE;padding:6px;">   <table cellspacing="0" cellpadding="0"><tr>    <td id="sample-text" style="height:100px;width:100px;"><div>%loc!This is a<br>sample!</div><div>-1234.5</div></td>   </tr></table>  </div> </td></tr></table><br>'},this.tabnums.sort=this.tabs.length,this.tabs.push({name:"sort",text:"Sort",html:' <div id="%id.sorttools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:4px;width:160px;">    <div style="%tbt.">%loc!Set Cells To Sort!</div>    <select id="%id.sortlist" size="1" onfocus="%s.CmdGotFocus(this);"><option selected>[select range]</option><option value="all">Sort All</option></select>    <input type="button" value="%loc!OK!" onclick="%s.DoCmd(this, \'ok-setsort\');" style="font-size:x-small;">   </td>   <td style="vertical-align:middle;padding-right:16px;width:100px;text-align:right;">    <div style="%tbt.">&nbsp;</div>    <input type="button" id="%id.sortbutton" value="%loc!Sort Cells! A1:A1" onclick="%s.DoCmd(this, \'dosort\');" style="visibility:hidden;">   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Major Sort!</div>      <select id="%id.majorsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="majorsort" id="%id.majorsortup" value="up" checked><span style="font-size:x-small;color:#555753;">%loc!Up!</span><br>      <input type="radio" name="majorsort" id="%id.majorsortdown" value="down"><span style="font-size:x-small;color:#555753;">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Minor Sort!</div>      <select id="%id.minorsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="minorsort" id="%id.minorsortup" value="up" checked><span style="font-size:x-small;color:#555753;">%loc!Up!</span><br>      <input type="radio" name="minorsort" id="%id.minorsortdown" value="down"><span style="font-size:x-small;color:#555753;">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style="vertical-align:top;padding-right:16px;">    <table cellspacing="0" cellpadding="0"><tr>     <td style="vertical-align:top;">      <div style="%tbt.">%loc!Last Sort!</div>      <select id="%id.lastsort" size="1" onfocus="%s.CmdGotFocus(this);"></select>     </td><td>      <input type="radio" name="lastsort" id="%id.lastsortup" value="up" checked><span style="font-size:x-small;color:#555753;">%loc!Up!</span><br>      <input type="radio" name="lastsort" id="%id.lastsortdown" value="down"><span style="font-size:x-small;color:#555753;">%loc!Down!</span>     </td>    </tr></table>   </td>  </tr></table> </div>',onclick:t.SpreadsheetControlSortOnclick}),this.editor.SettingsCallbacks.sort={save:t.SpreadsheetControlSortSave,load:t.SpreadsheetControlSortLoad},this.tabnums.audit=this.tabs.length,this.tabs.push({name:"audit",text:"Audit",html:'<div id="%id.audittools" style="display:none;"> <div style="%tbt.">&nbsp;</div></div>',view:"audit",onclick:function(e){var o,i,n=t.LocalizeString,r='<table cellspacing="0" cellpadding="0" style="margin-bottom:10px;"><tr><td style="font-size:small;padding:6px;"><b>'+n("Audit Trail This Session")+":</b><br><br>",a=e.sheet.changes.stack,s=e.sheet.changes.tos;for(o=0;o<a.length;o++)for(o==s+1&&(r+='<br></td></tr><tr><td style="font-size:small;background-color:#EEE;padding:6px;">'+n("UNDONE STEPS")+":<br>"),i=0;i<a[o].command.length;i++)r+=t.special_chars(a[o].command[i])+"<br>";var l=function(e){if("string"==typeof e)return e;if(!e)return"null";if("object"==typeof e){l.check||(l.check=new Array);for(var t=0,o=l.check.length;o>t;++t)if(l.check[t]==e)return"{}";l.check.push(e)}var o="",i="undefined"==typeof e.length?1:0,n="";for(var r in e)i&&(o="'"+r+"':"),n+="string"==typeof e[r]?o+"'"+e[r]+"',":"object"==typeof e[r]?o+l(e[r])+",":o+e[r]+",";return"object"==typeof e&&l.check.pop(),i?"{"+n.slice(0,-1)+"}":"["+n.slice(0,-1)+"]"};if("undefined"!=typeof t.debug_log)for(var c in t.debug_log)r+=l(t.debug_log[c])+"<br>";e.views.audit.element.innerHTML=r+"</td></tr></table>",t.CmdGotFocus(!0)},onclickFocus:!0}),this.views.audit={name:"audit",divStyle:"border:1px solid black;overflow:auto;",html:"Audit Trail"},this.tabnums.comment=this.tabs.length,this.tabs.push({name:"comment",text:"Comment",html:'<div id="%id.commenttools" style="display:none;"><table cellspacing="0" cellpadding="0"><tr><td><textarea id="%id.commenttext" style="font-size:small;height:32px;width:600px;overflow:auto;" onfocus="%s.CmdGotFocus(this);"></textarea></td><td style="vertical-align:top;">&nbsp;<input type="button" value="%loc!Save!" onclick="%s.SpreadsheetControlCommentSet();" style="font-size:x-small;"></td></tr></table></div>',view:"sheet",onclick:t.SpreadsheetControlCommentOnclick,onunclick:t.SpreadsheetControlCommentOnunclick}),this.tabnums.names=this.tabs.length,this.tabs.push({name:"names",text:"Names",html:'<div id="%id.namestools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:24px;">    <div style="%tbt.">%loc!Existing Names!</div>    <select id="%id.nameslist" size="1" onchange="%s.SpreadsheetControlNamesChangedName();" onfocus="%s.CmdGotFocus(this);"><option selected>[New]</option></select>   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Name!</div>    <input type="text" id="%id.namesname" style="font-size:x-small;width:75px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Description!</div>    <input type="text" id="%id.namesdesc" style="font-size:x-small;width:150px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">%loc!Value!</div>    <input type="text" id="%id.namesvalue" width="16" style="font-size:x-small;width:100px;" onfocus="%s.CmdGotFocus(this);">   </td>   <td style="vertical-align:top;padding-right:12px;width:100px;">    <div style="%tbt.">%loc!Set Value To!</div>    <input type="button" id="%id.namesrangeproposal" value="A1" onclick="%s.SpreadsheetControlNamesSetValue();" style="font-size:x-small;">   </td>   <td style="vertical-align:top;padding-right:6px;">    <div style="%tbt.">&nbsp;</div>    <input type="button" value="%loc!Save!" onclick="%s.SpreadsheetControlNamesSave();" style="font-size:x-small;">    <input type="button" value="%loc!Delete!" onclick="%s.SpreadsheetControlNamesDelete()" style="font-size:x-small;">   </td>  </tr></table></div>',view:"sheet",onclick:t.SpreadsheetControlNamesOnclick,onunclick:t.SpreadsheetControlNamesOnunclick}),this.tabnums.clipboard=this.tabs.length,this.tabs.push({name:"clipboard",text:"Clipboard",html:'<div id="%id.clipboardtools" style="display:none;">  <table cellspacing="0" cellpadding="0"><tr>   <td style="vertical-align:top;padding-right:24px;">    <div style="%tbt.">     &nbsp;    </div>   </td>  </tr></table></div>',view:"clipboard",onclick:t.SpreadsheetControlClipboardOnclick,onclickFocus:"clipboardtext"}),this.views.clipboard={name:"clipboard",divStyle:"overflow:auto;",html:' <div style="font-size:x-small;padding:5px 0px 10px 0px;">  <b>%loc!Display Clipboard in!:</b>  <input type="radio" id="%id.clipboardformat-tab" name="%id.clipboardformat" checked onclick="%s.SpreadsheetControlClipboardFormat(\'tab\');"> %loc!Tab-delimited format! &nbsp;  <input type="radio" id="%id.clipboardformat-csv" name="%id.clipboardformat" onclick="%s.SpreadsheetControlClipboardFormat(\'csv\');"> %loc!CSV format! &nbsp;  <input type="radio" id="%id.clipboardformat-scsave" name="%id.clipboardformat" onclick="%s.SpreadsheetControlClipboardFormat(\'scsave\');"> %loc!SocialCalc-save format! </div> <input type="button" value="%loc!Load SocialCalc Clipboard With This!" style="font-size:x-small;" onclick="%s.SpreadsheetControlClipboardLoad();">&nbsp;  <input type="button" value="%loc!Clear SocialCalc Clipboard!" style="font-size:x-small;" onclick="%s.SpreadsheetControlClipboardClear();">&nbsp;  <br> <textarea id="%id.clipboardtext" style="font-size:small;height:350px;width:800px;overflow:auto;" onfocus="%s.CmdGotFocus(this);"></textarea>'}
},t.SpreadsheetControl.prototype.InitializeSpreadsheetControl=function(e,o,i,n){return t.InitializeSpreadsheetControl(this,e,o,i,n)},t.SpreadsheetControl.prototype.DoOnResize=function(){return t.DoOnResize(this)},t.SpreadsheetControl.prototype.SizeSSDiv=function(){return t.SizeSSDiv(this)},t.SpreadsheetControl.prototype.ExecuteCommand=function(e,o){return t.SpreadsheetControlExecuteCommand(this,e,o)},t.SpreadsheetControl.prototype.CreateSheetHTML=function(){return t.SpreadsheetControlCreateSheetHTML(this)},t.SpreadsheetControl.prototype.CreateSpreadsheetSave=function(e){return t.SpreadsheetControlCreateSpreadsheetSave(this,e)},t.SpreadsheetControl.prototype.DecodeSpreadsheetSave=function(e){return t.SpreadsheetControlDecodeSpreadsheetSave(this,e)},t.SpreadsheetControl.prototype.CreateCellHTML=function(e){return t.SpreadsheetControlCreateCellHTML(this,e)},t.SpreadsheetControl.prototype.CreateCellHTMLSave=function(e){return t.SpreadsheetControlCreateCellHTMLSave(this,e)},t.SpreadsheetControl.prototype.ParseSheetSave=function(e){return this.sheet.ParseSheetSave(e)},t.SpreadsheetControl.prototype.CreateSheetSave=function(){return this.sheet.CreateSheetSave()},t.InitializeSpreadsheetControl=function(e,o,i,n,r){var a,s,l,c,u,d,h,p,f=t.Constants,m=t.LocalizeString,g=t.LocalizeSubstrings,v=e.tabs,b=e.views;for(e.requestedHeight=i,e.requestedWidth=n,e.requestedSpaceBelow=r,"string"==typeof o&&(o=document.getElementById(o)),null==o&&alert("SocialCalc.SpreadsheetControl not given parent node."),e.parentNode=o,e.spreadsheetDiv=document.createElement("div"),e.SizeSSDiv(),s=o.firstChild;null!=s;s=o.firstChild)o.removeChild(s);for(a="<div>",a+='<div style="'+e.tabbackground+'"><table cellpadding="0" cellspacing="0"><tr>',l=0;l<v.length;l++)a+='  <td id="%id.'+v[l].name+'tab" style="'+(0==l?e.tabselectedCSS:e.tabplainCSS)+'" onclick="%s.SetTab(this);">'+m(v[l].text)+"</td>";for(a+=" </tr></table></div>",a+='<div style="'+e.toolbarbackground+'padding:12px 10px 10px 4px;">',l=0;l<v.length;l++)a+=v[l].html;a+="</div>",a+="</div>",e.currentTab=0;for(d in e.tabreplacements)a=a.replace(e.tabreplacements[d].regex,e.tabreplacements[d].replacement);a=a.replace(/\%s\./g,"SocialCalc."),a=a.replace(/\%id\./g,e.idPrefix),a=a.replace(/\%tbt\./g,e.toolbartext),a=a.replace(/\%img\./g,e.imagePrefix),a=g(a),e.spreadsheetDiv.innerHTML=a,o.appendChild(e.spreadsheetDiv),e.Buttons={button_undo:{tooltip:"Undo",command:"undo"},button_redo:{tooltip:"Redo",command:"redo"},button_copy:{tooltip:"Copy",command:"copy"},button_cut:{tooltip:"Cut",command:"cut"},button_paste:{tooltip:"Paste",command:"paste"},button_pasteformats:{tooltip:"Paste Formats",command:"pasteformats"},button_lock:{tooltip:"Lock Cell",command:"lock"},button_unlock:{tooltip:"Unlock Cell",command:"unlock"},button_delete:{tooltip:"Delete Cell Contents",command:"delete"},button_filldown:{tooltip:"Fill Down",command:"filldown"},button_fillright:{tooltip:"Fill Right",command:"fillright"},button_movefrom:{tooltip:"Set/Clear Move From",command:"movefrom"},button_movepaste:{tooltip:"Move Paste",command:"movepaste"},button_moveinsert:{tooltip:"Move Insert",command:"moveinsert"},button_alignleft:{tooltip:"Align Left",command:"align-left"},button_aligncenter:{tooltip:"Align Center",command:"align-center"},button_alignright:{tooltip:"Align Right",command:"align-right"},button_borderon:{tooltip:"Borders On",command:"borderon"},button_borderoff:{tooltip:"Borders Off",command:"borderoff"},button_swapcolors:{tooltip:"Swap Colors",command:"swapcolors"},button_merge:{tooltip:"Merge/Unmerge Cells",command:"merge"},button_insertrow:{tooltip:"Insert Row Before",command:"insertrow"},button_insertcol:{tooltip:"Insert Column Before",command:"insertcol"},button_deleterow:{tooltip:"Delete Row",command:"deleterow"},button_deletecol:{tooltip:"Delete Column",command:"deletecol"},button_hiderow:{tooltip:"Hide Row",command:"hiderow"},button_hidecol:{tooltip:"Hide Column",command:"hidecol"},button_recalc:{tooltip:"Recalculate",command:"recalc"}};for(h in e.Buttons)p=document.getElementById(e.idPrefix+h),p?(p.style.border="1px solid "+f.ISCButtonBorderNormal,p.title=m(e.Buttons[h].tooltip),t.ButtonRegister(e.editor,p,{normalstyle:"border:1px solid "+f.ISCButtonBorderNormal+";background-color:"+f.ISCButtonNormalBackground+";",hoverstyle:"border:1px solid "+f.ISCButtonBorderHover+";background-color:"+f.ISCButtonHoverBackground+";",downstyle:"border:1px solid "+f.ISCButtonBorderDown+";background-color:"+f.ISCButtonDownBackground+";"},{MouseDown:t.DoButtonCmd,command:e.Buttons[h].command})):alert("Button "+(e.idPrefix+h)+" missing");e.formulabarDiv=document.createElement("div"),e.formulabarDiv.innerHTML='<input type="text" size="60" value="">&nbsp;',e.spreadsheetDiv.appendChild(e.formulabarDiv);new t.InputBox(e.formulabarDiv.firstChild,e.editor);for(h in e.formulabuttons)p=document.createElement("img"),p.id=e.idPrefix+h,p.src=(e.formulabuttons[h].skipImagePrefix?"":e.imagePrefix)+e.formulabuttons[h].image,p.style.verticalAlign="middle",p.style.border="1px solid #FFF",p.style.marginLeft="4px",p.title=m(e.formulabuttons[h].tooltip),t.ButtonRegister(e.editor,p,{normalstyle:"border:1px solid #FFF;backgroundColor:#FFF;",hoverstyle:"border:1px solid #CCC;backgroundColor:#FFF;",downstyle:"border:1px solid #000;backgroundColor:#FFF;"},{MouseDown:e.formulabuttons[h].command,Disabled:function(){return e.editor.ECellReadonly()}}),e.formulabarDiv.appendChild(p);var y=$("<input id='searchbarinput' value='' placeholder='Search sheet…'>"),C=$("<span id='searchbar'></span>");C.append("<div id='searchstatus'></div>"),C.append(y);for(h in e.findbuttons)p=document.createElement("img"),p.id=e.idPrefix+h,p.src=e.imagePrefix+e.findbuttons[h].image,p.style.verticalAlign="middle",p.style.border="1px solid #FFF",p.title=m(e.findbuttons[h].tooltip),t.ButtonRegister(e.editor,p,{normalstyle:"border:1px solid #FFF;backgroundColor:#FFF;",hoverstyle:"border:1px solid #CCC;backgroundColor:#FFF;",downstyle:"border:1px solid #000;backgroundColor:#FFF;"},{MouseDown:e.findbuttons[h].command,Disabled:function(){return!1}}),C[0].appendChild(p);for(y.on("input",t.SpreadsheetControl.FindInSheet),y.on("focus",function(){t.Keyboard.passThru=!0}),y.on("blur",function(){t.Keyboard.passThru=!1}),y.keyup(function(e){13==e.keyCode&&(e.shiftKey?t.SpreadsheetControl.SearchUp():t.SpreadsheetControl.SearchDown())}),e.formulabarDiv.appendChild(C[0]),l=0;l<v.length;l++)v[l].oncreate&&v[l].oncreate(e,v[l].name);t.CalculateSheetNonViewHeight(e),e.viewheight=e.height-e.nonviewheight,e.editorDiv=e.editor.CreateTableEditor(e.width,e.viewheight);var w=document.createElement("div");w.id="te_appView",w.appendChild(e.editorDiv),e.editorDiv=w;var x=document.createElement("div");x.id="te_formData",x.style.display="none",e.editorDiv.appendChild(x),e.spreadsheetDiv.appendChild(e.editorDiv),e.formDataViewer=new t.SpreadsheetViewer("te_FormData-"),e.formDataViewer.InitializeSpreadsheetViewer(x.id,180,0,200),e.formDataViewer.editor.ignoreRender=!0;for(c in b){a=b[c].html;for(d in b[c].replacements)a=a.replace(b[c].replacements[d].regex,b[c].replacements[d].replacement);a=a.replace(/\%s\./g,"SocialCalc."),a=a.replace(/\%id\./g,e.idPrefix),a=a.replace(/\%tbt\./g,e.toolbartext),a=a.replace(/\%img\./g,e.imagePrefix),u=document.createElement("div"),t.setStyles(u,b[c].divStyle),u.style.display="none",u.style.width=e.width+"px",u.style.height=e.viewheight+"px",u.id=e.idPrefix+b[c].name+"view",a=g(a),u.innerHTML=a,e.spreadsheetDiv.appendChild(u),b[c].element=u,b[c].oncreate&&b[c].oncreate(e,b[c])}if(b.sheet={name:"sheet",element:e.editorDiv},e.statuslineDiv=document.createElement("div"),e.statuslineDiv.style.cssText=e.statuslineCSS,e.statuslineDiv.style.height=e.statuslineheight-(e.statuslineDiv.style.paddingTop.slice(0,-2)-0)-(e.statuslineDiv.style.paddingBottom.slice(0,-2)-0)+"px",e.statuslineDiv.id=e.idPrefix+"statusline",e.spreadsheetDiv.appendChild(e.statuslineDiv),e.spreadsheetDiv.addEventListener)e.spreadsheetDiv.addEventListener("mousedown",function(){t.SetSpreadsheetControlObject(e)},!1),e.spreadsheetDiv.addEventListener("mouseover",function(){t.SetSpreadsheetControlObject(e)},!1);else{if(!e.spreadsheetDiv.attachEvent)throw t.Constants.s_BrowserNotSupported;e.spreadsheetDiv.attachEvent("onmousedown",function(){t.SetSpreadsheetControlObject(e)}),e.spreadsheetDiv.attachEvent("onmouseover",function(){t.SetSpreadsheetControlObject(e)})}},t.CalculateSheetNonViewHeight=function(e){e.nonviewheight=e.statuslineheight;for(var t=0;t<e.spreadsheetDiv.childNodes.length;t++)"SocialCalc-statusline"!=e.spreadsheetDiv.childNodes[t].id&&(e.nonviewheight+=e.spreadsheetDiv.childNodes[t].offsetHeight)},t.LocalizeString=function(e){var o=t.LocalizeStringList[e];return o||(o=t.Constants["s_loc_"+e.toLowerCase().replace(/\s/g,"_").replace(/\W/g,"X")]||e,t.LocalizeStringList[e]=o),o},t.LocalizeStringList={},t.LocalizeSubstrings=function(e){var o=t.LocalizeString;return e.replace(/%(loc|ssc)!(.*?)!/g,function(e,i,n){return"ssc"==i?t.Constants[n]||alert("Missing constant: "+n):o(n)})},t.GetSpreadsheetControlObject=function(){var e=null!=t.CurrentSpreadsheetControlObject?t.CurrentSpreadsheetControlObject:t.CurrentSpreadsheetViewerObject;return e?e:void 0},t.SetSpreadsheetControlObject=function(e){t.CurrentSpreadsheetControlObject=e,t.Keyboard.focusTable&&e&&(t.Keyboard.focusTable=e.editor)},t.DoOnResize=function(e){var t,o=e.views,i=e.SizeSSDiv();if(i){for(vname in o)t=o[vname].element,t.style.width=e.width+"px",t.style.height=e.height-e.nonviewheight+"px";e.editor.ResizeTableEditor(e.width,e.height-e.nonviewheight)}},t.SizeSSDiv=function(e){var o,i,n,r,a,s=10,l=10;return n=!1,o=t.GetViewportInfo(),i=t.GetElementPosition(e.parentNode),i.bottom=0,i.right=0,r=e.parentNode.style,r.marginTop&&(i.top+=r.marginTop.slice(0,-2)-0),r.marginBottom&&(i.bottom+=r.marginBottom.slice(0,-2)-0),r.marginLeft&&(i.left+=r.marginLeft.slice(0,-2)-0),r.marginRight&&(i.right+=r.marginRight.slice(0,-2)-0),a=e.requestedHeight||o.height-(i.top+i.bottom+l)-(e.requestedSpaceBelow||0),e.height!=a&&(e.height=a,e.spreadsheetDiv.style.height=a+"px",n=!0),a=e.requestedWidth||o.width-(i.left+i.right+s)||700,e.width!=a&&(e.width=a,e.spreadsheetDiv.style.width=a+"px",n=!0),e.spreadsheetDiv.style.position="relative",n},t.SetTab=function(e){var o,i,n,r,a,s,l,c={},u={},d=t.GetSpreadsheetControlObject(),h=d.tabs,p=d.views;if(o="string"==typeof e?e:e.id.slice(d.idPrefix.length,-3),d.editor.busy&&(!h[d.currentTab].view||"sheet"==h[d.currentTab].view))for(a=0;a<h.length;a++)if(h[a].name==o&&h[a].view&&"sheet"!=h[a].view)return;for(d.tabs[d.currentTab].onunclick&&d.tabs[d.currentTab].onunclick(d,d.tabs[d.currentTab].name),a=0;a<h.length;a++)i=h[a].name,c[i]=document.getElementById(d.idPrefix+i+"tab"),u[i]=document.getElementById(d.idPrefix+i+"tools"),i==o?(n=a,u[i].style.display="block",c[i].style.cssText=d.tabselectedCSS):(u[i].style.display="none",c[i].style.cssText=d.tabplainCSS);d.currentTab=n,h[n].onclick&&h[n].onclick(d,o);for(s in p)!h[n].view&&"sheet"==s||h[n].view==s?(p[s].element.style.display="block",r=s):p[s].element.style.display="none";h[n].onclickFocus?(l=h[n].onclickFocus,"string"==typeof l&&(l=document.getElementById(d.idPrefix+l),l.focus()),t.CmdGotFocus(l)):t.KeyboardFocus(),p[r].needsresize&&p[r].onresize&&(p[r].needsresize=!1,p[r].onresize(d,p[r])),"sheet"==r?(d.statuslineDiv.style.display="block",d.editor.ScheduleRender()):d.statuslineDiv.style.display="none"},t.SpreadsheetControlStatuslineCallback=function(e,t,o,i){var n,r,a=document.getElementById(i.statuslineid);switch(a&&(a.innerHTML=e.GetStatuslineString(t,o,i)),t){case"cmdendnorender":case"calcfinished":case"doneposcalc":if(n=document.getElementById(i.recalcid1),r=document.getElementById(i.recalcid2),!n||!r)break;"yes"==e.context.sheetobj.attribs.needsrecalc?(n.style.display="inline",r.style.display="inline"):(n.style.display="none",r.style.display="none")}},t.UpdateSortRangeProposal=function(e){var o=document.getElementById(t.GetSpreadsheetControlObject().idPrefix+"sortlist");o.options[0].text=e.range.hasrange?t.crToCoord(e.range.left,e.range.top)+":"+t.crToCoord(e.range.right,e.range.bottom):t.LocalizeString("[select range]")},t.LoadColumnChoosers=function(e){var o,i,n,r,a,s,l,c=t.LocalizeString;e.sortrange&&-1==e.sortrange.indexOf(":")?(i=t.Formula.LookupName(e.sheet,e.sortrange||""),"range"==i.type?(n=i.value.match(/^(.*)\|(.*)\|$/),o=n[1]+":"+n[2]):o="A1:A1"):o=e.sortrange;var u=t.ParseRange(o);s=document.getElementById(e.idPrefix+"majorsort"),l=s.selectedIndex,s.options.length=0,s.options[s.options.length]=new Option(c("[None]"),"");for(var r=u.cr1.col;r<=u.cr2.col;r++)a=t.rcColname(r),s.options[s.options.length]=new Option(c("Column ")+a,a);s.selectedIndex=l>1&&l<=u.cr2.col-u.cr1.col+1?l:1,s=document.getElementById(e.idPrefix+"minorsort"),l=s.selectedIndex,s.options.length=0,s.options[s.options.length]=new Option(c("[None]"),"");for(var r=u.cr1.col;r<=u.cr2.col;r++)a=t.rcColname(r),s.options[s.options.length]=new Option(a,a);s.selectedIndex=l>0&&l<=u.cr2.col-u.cr1.col+1?l:0,s=document.getElementById(e.idPrefix+"lastsort"),l=s.selectedIndex,s.options.length=0,s.options[s.options.length]=new Option(c("[None]"),"");for(var r=u.cr1.col;r<=u.cr2.col;r++)a=t.rcColname(r),s.options[s.options.length]=new Option(a,a);s.selectedIndex=l>0&&l<=u.cr2.col-u.cr1.col+1?l:0},t.CmdGotFocus=function(e){t.Keyboard.passThru=e},t.DoButtonCmd=function(e,o,i){t.DoCmd(i.element,i.functionobj.command)},t.DoCmd=function(e,o){var i,n,r,a,s,l,c,u,d,h,p,f,m,g,v,b,y,C,w,x,_,S=t.GetSpreadsheetControlObject(),k=S.editor;switch(o){case"undo":S.ExecuteCommand("undo","");break;case"redo":S.ExecuteCommand("redo","");break;case"fill-rowcolstuff":case"fill-text":for(r=o.substring(5),s=document.getElementById(S.idPrefix+r+"list"),s.length=0,a=0;a<t.SpreadsheetCmdTable[r].length;a++)s.options[a]=new Option(t.SpreadsheetCmdTable[r][a].t);o="changed-"+r;case"changed-rowcolstuff":case"changed-text":for(r=o.substring(8),s=document.getElementById(S.idPrefix+r+"list"),l=t.SpreadsheetCmdTable.slists[t.SpreadsheetCmdTable[r][s.selectedIndex].s],c=document.getElementById(S.idPrefix+r+"slist"),c.length=0,a=0;a<(l.length||0);a++)c.options[a]=new Option(l[a].t,l[a].s);return;case"ok-rowcolstuff":case"ok-text":r=o.substring(3),s=document.getElementById(S.idPrefix+r+"list"),c=document.getElementById(S.idPrefix+r+"slist"),i=t.SpreadsheetCmdTable[r][s.selectedIndex].c,n=c[c.selectedIndex].value,t.SpreadsheetControlExecuteCommand(e,i,n);break;case"ok-setsort":if(p=document.getElementById(S.idPrefix+"sortlist"),0==p.selectedIndex)S.sortrange=k.range.hasrange?t.crToCoord(k.range.left,k.range.top)+":"+t.crToCoord(k.range.right,k.range.bottom):k.ecell.coord+":"+k.ecell.coord;else{var T=p.options[p.selectedIndex].value;if("all"==T){var F=S.sheet.cells,E=-1,D=-1,P=-1,A=-1;for(var I in F){var M=t.coordToCr(I);(-1==P||M.row<P)&&(P=M.row),(-1==E||M.col<E)&&(E=M.col),(-1==A||M.row>A)&&(A=M.row),(-1==D||M.col>D)&&(D=M.col)}S.sortrange=t.crToCoord(E,P)+":"+t.crToCoord(D,A),p.options[p.selectedIndex].text+=" ("+S.sortrange+")"}else S.sortrange=p.options[p.selectedIndex].value}return f=document.getElementById(S.idPrefix+"sortbutton"),f.value=t.LocalizeString("Sort ")+S.sortrange,f.style.visibility="visible",t.LoadColumnChoosers(S),e&&e.blur&&e.blur(),void t.KeyboardFocus();case"dosort":if(S.sortrange&&-1==S.sortrange.indexOf(":")){if(g=t.Formula.LookupName(S.sheet,S.sortrange||""),"range"!=g.type)return;v=g.value.match(/^(.*)\|(.*)\|$/),m=v[1]+":"+v[2]}else m=S.sortrange;if("A1:A1"==m)return;u="sort "+m+" ",d=document.getElementById(S.idPrefix+"majorsort"),h=document.getElementById(S.idPrefix+"majorsortup"),u+=d.options[d.selectedIndex].value+(h.checked?" up":" down"),d=document.getElementById(S.idPrefix+"minorsort"),d.selectedIndex>0&&(h=document.getElementById(S.idPrefix+"minorsortup"),u+=" "+d.options[d.selectedIndex].value+(h.checked?" up":" down")),d=document.getElementById(S.idPrefix+"lastsort"),d.selectedIndex>0&&(h=document.getElementById(S.idPrefix+"lastsortup"),u+=" "+d.options[d.selectedIndex].value+(h.checked?" up":" down")),S.ExecuteCommand(u,"");break;case"merge":i=t.SpreadsheetCmdLookup[o]||"",n=t.SpreadsheetCmdSLookup[o]||"",S.ExecuteCommand(i,n),k.range.hasrange&&(k.MoveECell(t.crToCoord(k.range.left,k.range.top)),k.RangeRemove());break;case"movefrom":k.range2.hasrange?(S.context.cursorsuffix="",k.Range2Remove(),S.ExecuteCommand("redisplay","")):k.range.hasrange?(k.range2.top=k.range.top,k.range2.right=k.range.right,k.range2.bottom=k.range.bottom,k.range2.left=k.range.left,k.range2.hasrange=!0,k.MoveECell(t.crToCoord(k.range.left,k.range.top))):(k.range2.top=k.ecell.row,k.range2.right=k.ecell.col,k.range2.bottom=k.ecell.row,k.range2.left=k.ecell.col,k.range2.hasrange=!0),u=k.range2.hasrange?"":"off",f=document.getElementById(S.idPrefix+"button_movefrom"),f.src=S.imagePrefix+"movefrom"+u+".gif",f=document.getElementById(S.idPrefix+"button_movepaste"),f.src=S.imagePrefix+"movepaste"+u+".gif",f=document.getElementById(S.idPrefix+"button_moveinsert"),f.src=S.imagePrefix+"moveinsert"+u+".gif",k.range2.hasrange&&k.RangeRemove();break;case"movepaste":case"moveinsert":k.range2.hasrange&&(S.context.cursorsuffix="",i=o+" "+t.crToCoord(k.range2.left,k.range2.top)+":"+t.crToCoord(k.range2.right,k.range2.bottom)+" "+k.ecell.coord,S.ExecuteCommand(i,""),k.Range2Remove(),f=document.getElementById(S.idPrefix+"button_movefrom"),f.src=S.imagePrefix+"movefromoff.gif",f=document.getElementById(S.idPrefix+"button_movepaste"),f.src=S.imagePrefix+"movepasteoff.gif",f=document.getElementById(S.idPrefix+"button_moveinsert"),f.src=S.imagePrefix+"moveinsertoff.gif");break;case"swapcolors":b=S.sheet,y=b.GetAssuredCell(k.ecell.coord),x=b.attribs.defaultcolor?b.colors[b.attribs.defaultcolor]:"rgb(0,0,0)",_=b.attribs.defaultbgcolor?b.colors[b.attribs.defaultbgcolor]:"rgb(255,255,255)",C=y.color?b.colors[y.color]:x,C==_&&(C=""),w=y.bgcolor?b.colors[y.bgcolor]:_,w==x&&(w=""),S.ExecuteCommand("set %C color "+w+"%Nset %C bgcolor "+C,"");break;default:i=t.SpreadsheetCmdLookup[o]||"",n=t.SpreadsheetCmdSLookup[o]||"",S.ExecuteCommand(i,n)}e&&e.blur&&e.blur(),t.KeyboardFocus()},t.SpreadsheetCmdLookup={copy:"copy %C all",cut:"cut %C all",paste:"paste %C all",pasteformats:"paste %C formats",lock:"set %C readonly yes",unlock:"set %C readonly no","delete":"erase %C formulas",filldown:"filldown %C all",fillright:"fillright %C all",erase:"erase %C all",borderon:"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S",borderoff:"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S",merge:"merge %C",unmerge:"unmerge %C","align-left":"set %C cellformat left","align-center":"set %C cellformat center","align-right":"set %C cellformat right","align-default":"set %C cellformat",insertrow:"insertrow %C",insertcol:"insertcol %C",deleterow:"deleterow %C",deletecol:"deletecol %C",hiderow:"set %H hide yes",hidecol:"set %W hide yes",undo:"undo",redo:"redo",recalc:"recalc"},t.SpreadsheetCmdSLookup={borderon:"1px solid rgb(0,0,0)",borderoff:""},t.SpreadsheetControlExecuteCommand=function(e,o,i){var n=t.GetSpreadsheetControlObject(),r=n.editor,a={};a.P="%",a.N="\n",r.range.hasrange?(a.R=t.crToCoord(r.range.left,r.range.top)+":"+t.crToCoord(r.range.right,r.range.bottom),a.C=a.R,a.W=t.rcColname(r.range.left)+":"+t.rcColname(r.range.right),a.H=r.range.top+":"+r.range.bottom):r.ecell?(a.C=r.ecell.coord,a.R=r.ecell.coord+":"+r.ecell.coord,a.W=t.rcColname(t.coordToCr(r.ecell.coord).col),a.H=t.coordToCr(r.ecell.coord).row):(a.C="A1",a.R="A1:A1",a.W=t.rcColname(t.coordToCr("A1").col),a.H=t.coordToCr("A1").row),a.S=i,o=o.replace(/%C/g,a.C),o=o.replace(/%R/g,a.R),o=o.replace(/%N/g,a.N),o=o.replace(/%S/g,a.S),o=o.replace(/%W/g,a.W),o=o.replace(/%H/g,a.H),o=o.replace(/%P/g,a.P),r.EditorScheduleSheetCommands(o,!0,!1)},t.SpreadsheetControlCreateSheetHTML=function(e){var o,i,n,r="";return o=new t.RenderContext(e.sheet),i=document.createElement("div"),n=o.RenderSheet(null,{type:"html"}),i.appendChild(n),delete o,r=i.innerHTML,delete n,delete i,r},t.SpreadsheetControlCreateCellHTML=function(e,o,i){var n="",r=e.sheet.cells[o];return r?(n=void 0==r.displaystring?t.FormatValueForDisplay(e.sheet,r.datavalue,o,i||e.context.defaultHTMLlinkstyle):r.displaystring,"&nbsp;"==n&&(n=""),n):""},t.SpreadsheetControlCreateCellHTMLSave=function(e,o,i){var n,r,a,s,l,c,u,d,h=[];for(d=o?t.ParseRange(o):{cr1:{row:1,col:1},cr2:{row:e.sheet.attribs.lastrow,col:e.sheet.attribs.lastcol}},n=d.cr1,r=d.cr2,h.push("version:1.0"),a=n.row;a<=r.row;a++)for(s=n.col;s<=r.col;s++)l=t.crToCoord(s,a),c=e.sheet.cells[l],c&&(u=void 0==c.displaystring?t.FormatValueForDisplay(e.sheet,c.datavalue,l,i||e.context.defaultHTMLlinkstyle):c.displaystring,"&nbsp;"!=u&&h.push(l+":"+t.encodeForSave(u)));return h.push(""),h.join("\n")},t.SpreadsheetControl.DoFunctionList=function(){var e,o,i,n=t.Formula,r=t.Constants,a=r.function_classlist,s=t.GetSpreadsheetControlObject(),l=s.idPrefix+"function";if(i=document.getElementById(l+"dialog"),!i){for(n.FillFunctionInfo(),o='<table><tr><td><span style="font-size:x-small;font-weight:bold">%loc!Category!</span><br><select id="'+l+'class" size="'+a.length+'" style="width:120px;" onchange="SocialCalc.SpreadsheetControl.FunctionClassChosen(this.options[this.selectedIndex].value);">',e=0;e<a.length;e++)o+='<option value="'+a[e]+'"'+(0==e?" selected>":">")+t.special_chars(n.FunctionClasses[a[e]].name)+"</option>";o+='</select></td><td>&nbsp;&nbsp;</td><td id="'+l+'list"><span style="font-size:x-small;font-weight:bold">%loc!Functions!</span><br><select id="'+l+'name" size="'+a.length+'" style="width:240px;" onchange="SocialCalc.SpreadsheetControl.FunctionChosen(this.options[this.selectedIndex].value);" ondblclick="SocialCalc.SpreadsheetControl.DoFunctionPaste();">',o+=t.SpreadsheetControl.GetFunctionNamesStr("all"),o+='</td></tr><tr><td colspan="3"><div id="'+l+'desc" style="width:380px;height:80px;overflow:auto;font-size:x-small;">'+t.SpreadsheetControl.GetFunctionInfoStr(n.FunctionClasses[a[0]].items[0])+'</div><div style="width:380px;text-align:right;padding-top:6px;font-size:small;"><input type="button" value="%loc!Paste!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoFunctionPaste();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideFunctions();"></div></td></tr></table>';var c=document.createElement("div");c.id=l+"dialog",c.style.position="absolute";var u=t.GetViewportInfo(),d=t.GetElementPositionWithScroll(s.spreadsheetDiv);c.style.top=u.height/3-d.top+"px",c.style.left=u.width/3-d.left+"px",c.style.zIndex=100,c.style.backgroundColor="#FFF",c.style.border="1px solid black",c.style.width="400px",o='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">&nbsp;%loc!Function List!</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideFunctions();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+o+"</div>",o=t.LocalizeSubstrings(o),c.innerHTML=o,t.DragRegister(c.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:c},s.spreadsheetDiv),s.spreadsheetDiv.appendChild(c),i=document.getElementById(l+"name"),i.focus(),t.CmdGotFocus(i)}},t.SpreadsheetControl.GetFunctionNamesStr=function(e){var o,i,n=t.Formula,r="";for(i=n.FunctionClasses[e],o=0;o<i.items.length;o++)r+='<option value="'+i.items[o]+'"'+(0==o?" selected>":">")+i.items[o]+"</option>";return r},t.SpreadsheetControl.FillFunctionNames=function(e,o){var i,n,r=t.Formula;for(o.length=0,n=r.FunctionClasses[e],i=0;i<n.items.length;i++)o.options[i]=new Option(n.items[i],n.items[i]),0==i&&(o.options[i].selected=!0)},t.SpreadsheetControl.GetFunctionInfoStr=function(e){var o=t.Formula,i=o.FunctionList[e],n=t.special_chars,r="<b>"+e+"("+n(o.FunctionArgString(e))+")</b><br>";return r+=n(i[3])},t.SpreadsheetControl.FunctionClassChosen=function(e){var o=t.GetSpreadsheetControlObject(),i=o.idPrefix+"function",n=t.Formula;t.SpreadsheetControl.FillFunctionNames(e,document.getElementById(i+"name")),t.SpreadsheetControl.FunctionChosen(n.FunctionClasses[e].items[0])},t.SpreadsheetControl.FunctionChosen=function(e){var o=t.GetSpreadsheetControlObject(),i=o.idPrefix+"function";document.getElementById(i+"desc").innerHTML=t.SpreadsheetControl.GetFunctionInfoStr(e)},t.SpreadsheetControl.HideFunctions=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"functiondialog");o.innerHTML="",t.DragUnregister(o),t.KeyboardFocus(),o.parentNode&&o.parentNode.removeChild(o)},t.SpreadsheetControl.DoFunctionPaste=function(){var e=t.GetSpreadsheetControlObject(),o=e.editor,i=document.getElementById(e.idPrefix+"functionname"),n=document.getElementById(e.idPrefix+"multilinetextarea"),r=i.value+"(";t.SpreadsheetControl.HideFunctions(),n?(n.value+=r,n.focus(),t.CmdGotFocus(n)):o.EditorAddToInput(r,"=")},t.SpreadsheetControl.DoMultiline=function(){var e,o,i,n=t.LocalizeSubstrings,r=(t.Constants,t.GetSpreadsheetControlObject()),a=r.editor,s=a.workingvalues,r=t.GetSpreadsheetControlObject(),l=r.idPrefix+"multiline";if(o=document.getElementById(l+"dialog"),!o){switch(a.state){case"start":s.ecoord=a.ecell.coord,s.erow=a.ecell.row,s.ecol=a.ecell.col,a.RangeRemove(),i=t.GetCellContents(a.context.sheetobj,s.ecoord);break;case"input":case"inputboxdirect":i=a.inputBox.GetText()}a.inputBox.element.disabled=!0,i=t.special_chars(i),e='<textarea id="'+l+'textarea" style="width:380px;height:120px;margin:10px 0px 0px 6px;">'+i+'</textarea><div style="width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;">'+n('<input type="button" value="%loc!Set Cell Contents!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoMultilinePaste();">&nbsp;<input type="button" value="%loc!Clear!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoMultilineClear();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideMultiline();"></div></div>');var c=document.createElement("div");c.id=l+"dialog",c.style.position="absolute";var u=t.GetViewportInfo(),d=t.GetElementPositionWithScroll(r.spreadsheetDiv);c.style.top=u.height/3-d.top+"px",c.style.left=u.width/3-d.left+"px",c.style.zIndex=100,c.style.backgroundColor="#FFF",c.style.border="1px solid black",c.style.width="400px",c.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">'+n("&nbsp;%loc!Multi-line Input Box!")+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideMultiline();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+e+"</div>",t.DragRegister(c.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:c},r.spreadsheetDiv),r.spreadsheetDiv.appendChild(c),o=document.getElementById(l+"textarea"),o.focus(),t.CmdGotFocus(o)}},t.SpreadsheetControl.HideMultiline=function(){var e=(t.Constants,t.GetSpreadsheetControlObject()),o=e.editor,i=document.getElementById(e.idPrefix+"multilinedialog");switch(i.innerHTML="",t.DragUnregister(i),t.KeyboardFocus(),i.parentNode&&i.parentNode.removeChild(i),o.state){case"start":o.inputBox.DisplayCellContents(null);break;case"input":case"inputboxdirect":o.inputBox.element.disabled=!1,o.inputBox.Focus()}},t.SpreadsheetControl.DoMultilineClear=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"multilinetextarea");o.value="",o.focus()},t.SpreadsheetControl.DoMultilinePaste=function(){var e=t.GetSpreadsheetControlObject(),o=e.editor,i=o.workingvalues,n=document.getElementById(e.idPrefix+"multilinetextarea"),r=n.value;switch(t.SpreadsheetControl.HideMultiline(),o.state){case"start":i.partialexpr="",i.ecoord=o.ecell.coord,i.erow=o.ecell.row,i.ecol=o.ecell.col;break;case"input":case"inputboxdirect":o.inputBox.Blur(),o.inputBox.ShowInputBox(!1),o.state="start"}o.EditorSaveEdit(r)},t.SpreadsheetControl.DoLink=function(){var e,o,i,n,r,a,s=t.LocalizeString,l=(t.Constants,t.GetSpreadsheetControlObject()),c=l.editor,u=c.workingvalues,l=t.GetSpreadsheetControlObject(),d=l.idPrefix+"link";if(o=document.getElementById(d+"dialog"),!o){switch(c.state){case"start":u.ecoord=c.ecell.coord,u.erow=c.ecell.row,u.ecol=c.ecell.col,c.RangeRemove(),i=t.GetCellContents(c.context.sheetobj,u.ecoord);break;case"input":case"inputboxdirect":i=c.inputBox.GetText()}c.inputBox.element.disabled=!0,"'"==i.charAt(0)&&(i=i.slice(1));var h=t.ParseCellLinkText(i);i=t.special_chars(i),n=l.sheet.cells[c.ecell.coord],r=n&&n.textvalueformat?"":" checked",a=h.newwin?" checked":"",e='<div style="padding:6px 0px 4px 6px;"><span style="font-size:smaller;">'+s("Description")+'</span><br><input type="text" id="'+d+'desc" style="width:380px;" value="'+t.special_chars(h.desc)+'"><br><span style="font-size:smaller;">'+s("URL")+'</span><br><input type="text" id="'+d+'url" style="width:380px;" value="'+t.special_chars(h.url)+'"><br>',t.Callbacks.MakePageLink&&(e+='<span style="font-size:smaller;">'+s("Page Name")+'</span><br><input type="text" id="'+d+'pagename" style="width:380px;" value="'+t.special_chars(h.pagename)+'"><br><span style="font-size:smaller;">'+s("Workspace")+'</span><br><input type="text" id="'+d+'workspace" style="width:380px;" value="'+t.special_chars(h.workspace)+'"><br>'),e+=t.LocalizeSubstrings('<input type="checkbox" id="'+d+'format"'+r+'>&nbsp;<span style="font-size:smaller;">%loc!Set to Link format!</span><br><input type="checkbox" id="'+d+'popup"'+a+'>&nbsp;<span style="font-size:smaller;">%loc!Show in new browser window!</span></div><div style="width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;"><input type="button" value="%loc!Set Cell Contents!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoLinkPaste();">&nbsp;<input type="button" value="%loc!Clear!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.DoLinkClear();">&nbsp;<input type="button" value="%loc!Cancel!" style="font-size:smaller;" onclick="SocialCalc.SpreadsheetControl.HideLink();"></div></div>');var p=document.createElement("div");p.id=d+"dialog",p.style.position="absolute";var f=t.GetViewportInfo(),m=t.GetElementPositionWithScroll(l.spreadsheetDiv);p.style.top=f.height/3-m.top+"px",p.style.left=f.width/3-m.left+"px",p.style.zIndex=100,p.style.backgroundColor="#FFF",p.style.border="1px solid black",p.style.width="400px",p.innerHTML='<table cellspacing="0" cellpadding="0" style="border-bottom:1px solid black;"><tr><td style="font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;">&nbsp;'+s("Link Input Box")+'</td><td style="font-size:10px;cursor:default;color:#666;" onclick="SocialCalc.SpreadsheetControl.HideLink();">&nbsp;X&nbsp;</td></tr></table><div style="background-color:#DDD;">'+e+"</div>",t.DragRegister(p.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:t.DragFunctionStart,MouseMove:t.DragFunctionPosition,MouseUp:t.DragFunctionPosition,Disabled:null,positionobj:p},l.spreadsheetDiv),l.spreadsheetDiv.appendChild(p),o=document.getElementById(d+"url"),o.focus(),t.CmdGotFocus(o)}},t.SpreadsheetControl.HideLink=function(){var e=(t.Constants,t.GetSpreadsheetControlObject()),o=e.editor,i=document.getElementById(e.idPrefix+"linkdialog");switch(i.innerHTML="",t.DragUnregister(i),t.KeyboardFocus(),i.parentNode&&i.parentNode.removeChild(i),o.state){case"start":o.inputBox.DisplayCellContents(null);break;case"input":case"inputboxdirect":o.inputBox.element.disabled=!1,o.inputBox.Focus()}},t.SpreadsheetControl.DoLinkClear=function(){var e=t.GetSpreadsheetControlObject();
document.getElementById(e.idPrefix+"linkdesc").value="",document.getElementById(e.idPrefix+"linkpagename").value="",document.getElementById(e.idPrefix+"linkworkspace").value="";var o=document.getElementById(e.idPrefix+"linkurl");o.value="",o.focus()},t.SpreadsheetControl.DoLinkPaste=function(){var e,o,i,n,r=t.GetSpreadsheetControlObject(),a=r.editor,s=a.workingvalues,l=document.getElementById(r.idPrefix+"linkdesc"),c=document.getElementById(r.idPrefix+"linkurl"),u=document.getElementById(r.idPrefix+"linkpagename"),d=document.getElementById(r.idPrefix+"linkworkspace"),h=document.getElementById(r.idPrefix+"linkformat"),p=document.getElementById(r.idPrefix+"linkpopup"),f="";switch(p.checked?(e="<<",o=">>",i="[[",n="]]"):(e="<",o=">",i="[",n="]"),f=u&&u.value?d.value?l.value+"{"+d.value+i+u.value+n+"}":l.value+i+u.value+n:l.value+e+c.value+o,t.SpreadsheetControl.HideLink(),a.state){case"start":s.partialexpr="",s.ecoord=a.ecell.coord,s.erow=a.ecell.row,s.ecol=a.ecell.col;break;case"input":case"inputboxdirect":a.inputBox.Blur(),a.inputBox.ShowInputBox(!1),a.state="start"}h.checked&&t.SpreadsheetControlExecuteCommand(null,"set %C textvalueformat text-link",""),a.EditorSaveEdit(f)},t.SpreadsheetControl.DoSum=function(){var e,o,i,n,r,a,s,l=t.GetSpreadsheetControlObject(),c=l.editor,u=c.context.sheetobj;if(c.range.hasrange)r=t.crToCoord(c.range.left,c.range.top)+":"+t.crToCoord(c.range.right,c.range.bottom),e="set "+t.crToCoord(c.range.right,c.range.bottom+1)+" formula sum("+r+")";else if(i=c.ecell.row-1,n=c.ecell.col,1>=i)e="set "+c.ecell.coord+" constant e#REF! 0 #REF!";else{for(s=!1;i>0;){if(a=t.crToCoord(n,i),o=u.GetAssuredCell(a),o.datatype&&"t"!=o.datatype)s=!0;else if(s){i++;break}i--}e="set "+c.ecell.coord+" formula sum("+t.crToCoord(n,i)+":"+t.crToCoord(n,c.ecell.row-1)+")"}c.EditorScheduleSheetCommands(e,!0,!1)},t.SpreadsheetControl.FindInSheet=function(){var e=$("#searchstatus"),o=t.GetSpreadsheetControlObject();if(!this.value.length)return e.text(""),o.sheet.search_cells=[],void(o.sheet.selected_search_cell=void 0);var i,n,r=o.sheet.cells,a=new RegExp(this.value,"im"),s=[];for(var l in r){i=r[l];var c=t.coordToCr(l);"yes"!==o.sheet.rowattribs.hide[c.row]&&"yes"!==o.sheet.colattribs.hide[t.rcColname(c.col)]&&(n="c"===i.datatype?i.displaystring:String(i.datavalue),void 0!==n&&n.match(a)&&s.push(l))}o.sheet.search_cells=s,s.length?(o.sheet.selected_search_cell=0,o.editor.MoveECell(s[0]),e.text("1 of "+s.length)):(o.sheet.selected_search_cell=void 0,e.text("No Matches"))},t.SpreadsheetControl.SearchSheet=function(e){var o=t.GetSpreadsheetControlObject(),i=o.sheet,n=i.search_cells;if(n.length){var r=i.selected_search_cell;r===(0===e?0:n.length-1)?r=0===e?n.length-1:0:r+=0===e?-1:1;var a=n[r];i.selected_search_cell=r,o.editor.MoveECell(a),document.getElementById("searchstatus").textContent=String(r+1)+" of "+n.length}},t.SpreadsheetControl.SearchUp=function(){t.SpreadsheetControl.SearchSheet(0)},t.SpreadsheetControl.SearchDown=function(){t.SpreadsheetControl.SearchSheet(1)},t.SpreadsheetControlSortOnclick=function(e){var o,i,n=[],r=document.getElementById(e.idPrefix+"sortlist");t.LoadColumnChoosers(e),e.editor.RangeChangeCallback.sort=t.UpdateSortRangeProposal;for(o in e.sheet.names)n.push(o);for(n.sort(),r.length=0,r.options[0]=new Option(t.LocalizeString("[select range]")),r.options[1]=new Option(t.LocalizeString("Sort All"),"all"),n_options=r.options.length,i=0;i<n.length;i++)o=n[i],r.options[i+n_options]=new Option(o,o),o==e.sortrange&&(r.options[i+n_options].selected=!0);""==e.sortrange&&(r.options[0].selected=!0),t.UpdateSortRangeProposal(e.editor),t.KeyboardFocus()},t.SpreadsheetControlSortSave=function(){var e,o,i,n=t.GetSpreadsheetControlObject();return e="sort:"+t.encodeForSave(n.sortrange)+":",o=document.getElementById(n.idPrefix+"majorsort"),i=document.getElementById(n.idPrefix+"majorsortup"),e+=o.selectedIndex+(i.checked?":up":":down"),o=document.getElementById(n.idPrefix+"minorsort"),o.selectedIndex>0?(i=document.getElementById(n.idPrefix+"minorsortup"),e+=":"+o.selectedIndex+(i.checked?":up":":down")):e+="::",o=document.getElementById(n.idPrefix+"lastsort"),o.selectedIndex>0?(i=document.getElementById(n.idPrefix+"lastsortup"),e+=":"+o.selectedIndex+(i.checked?":up":":down")):e+="::",e+"\n"},t.SpreadsheetControlSortLoad=function(e,o,i){var n,r,a=t.GetSpreadsheetControlObject();return n=i.split(":"),a.sortrange=t.decodeFromSave(n[1]),r=document.getElementById(a.idPrefix+"sortbutton"),a.sortrange?(r.value=t.LocalizeString("Sort ")+a.sortrange,r.style.visibility="visible"):r.style.visibility="hidden",t.LoadColumnChoosers(a),sele=document.getElementById(a.idPrefix+"majorsort"),sele.selectedIndex=n[2]-0,document.getElementById(a.idPrefix+"majorsort"+n[3]).checked=!0,sele=document.getElementById(a.idPrefix+"minorsort"),n[4]?(sele.selectedIndex=n[4]-0,document.getElementById(a.idPrefix+"minorsort"+n[5]).checked=!0):(sele.selectedIndex=0,document.getElementById(a.idPrefix+"minorsortup").checked=!0),sele=document.getElementById(a.idPrefix+"lastsort"),n[6]?(sele.selectedIndex=n[6]-0,document.getElementById(a.idPrefix+"lastsort"+n[7]).checked=!0):(sele.selectedIndex=0,document.getElementById(a.idPrefix+"lastsortup").checked=!0),!0},t.SpreadsheetControlCommentOnclick=function(e,o){e.editor.MoveECellCallback.comment=t.SpreadsheetControlCommentMoveECell,t.SpreadsheetControlCommentDisplay(e,o),t.KeyboardFocus()},t.SpreadsheetControlCommentDisplay=function(e){var t="";e.editor.ecell&&e.editor.ecell.coord&&e.sheet.cells[e.editor.ecell.coord]&&(t=e.sheet.cells[e.editor.ecell.coord].comment||""),document.getElementById(e.idPrefix+"commenttext").value=t},t.SpreadsheetControlCommentMoveECell=function(){t.SpreadsheetControlCommentDisplay(t.GetSpreadsheetControlObject(),"comment")},t.SpreadsheetControlCommentSet=function(){var e=t.GetSpreadsheetControlObject();e.ExecuteCommand("set %C comment "+t.encodeForSave(document.getElementById(e.idPrefix+"commenttext").value));var o=t.GetEditorCellElement(e.editor,e.editor.ecell.row,e.editor.ecell.col);e.editor.ECellReadonly()||(o.element.title=document.getElementById(e.idPrefix+"commenttext").value,e.editor.UpdateCellCSS(o,e.editor.ecell.row,e.editor.ecell.col)),t.KeyboardFocus()},t.SpreadsheetControlCommentOnunclick=function(e){delete e.editor.MoveECellCallback.comment},t.SpreadsheetControlNamesOnclick=function(e){document.getElementById(e.idPrefix+"namesname").value="",document.getElementById(e.idPrefix+"namesdesc").value="",document.getElementById(e.idPrefix+"namesvalue").value="",e.editor.RangeChangeCallback.names=t.SpreadsheetControlNamesRangeChange,e.editor.MoveECellCallback.names=t.SpreadsheetControlNamesRangeChange,t.SpreadsheetControlNamesRangeChange(e.editor),t.SpreadsheetControlNamesFillNameList(),t.SpreadsheetControlNamesChangedName()},t.SpreadsheetControlNamesFillNameList=function(){var e,o,i=t.LocalizeString,n=[],r=t.GetSpreadsheetControlObject(),a=document.getElementById(r.idPrefix+"nameslist"),s=document.getElementById(r.idPrefix+"namesname").value.toUpperCase().replace(/[^A-Z0-9_\.]/g,"");for(e in r.sheet.names)n.push(e);for(n.sort(),a.length=0,a.options[0]=new Option(n.length>0?i("[New]"):i("[None]")),o=0;o<n.length;o++)e=n[o],a.options[o+1]=new Option(e,e),e==s&&(a.options[o+1].selected=!0);""==s&&(a.options[0].selected=!0)},t.SpreadsheetControlNamesChangedName=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"nameslist"),i=o.options[o.selectedIndex].value;e.sheet.names[i]?(document.getElementById(e.idPrefix+"namesname").value=i,document.getElementById(e.idPrefix+"namesdesc").value=e.sheet.names[i].desc||"",document.getElementById(e.idPrefix+"namesvalue").value=e.sheet.names[i].definition||""):(document.getElementById(e.idPrefix+"namesname").value="",document.getElementById(e.idPrefix+"namesdesc").value="",document.getElementById(e.idPrefix+"namesvalue").value="")},t.SpreadsheetControlNamesRangeChange=function(e){var o=t.GetSpreadsheetControlObject(),i=document.getElementById(o.idPrefix+"namesrangeproposal");i.value=e.range.hasrange?t.crToCoord(e.range.left,e.range.top)+":"+t.crToCoord(e.range.right,e.range.bottom):e.ecell.coord},t.SpreadsheetControlNamesOnunclick=function(e){delete e.editor.RangeChangeCallback.names,delete e.editor.MoveECellCallback.names},t.SpreadsheetControlNamesSetValue=function(){var e=t.GetSpreadsheetControlObject();document.getElementById(e.idPrefix+"namesvalue").value=document.getElementById(e.idPrefix+"namesrangeproposal").value,t.KeyboardFocus()},t.SpreadsheetControlNamesSave=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"namesname").value;t.SetTab(e.tabs[0].name),t.KeyboardFocus(),""!=o&&e.ExecuteCommand("name define "+o+" "+document.getElementById(e.idPrefix+"namesvalue").value+"\nname desc "+o+" "+document.getElementById(e.idPrefix+"namesdesc").value)},t.SpreadsheetControlNamesDelete=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"namesname").value;t.SetTab(e.tabs[0].name),t.KeyboardFocus(),""!=o&&e.ExecuteCommand("name delete "+o),t.KeyboardFocus()},t.SpreadsheetControlClipboardOnclick=function(e){var e=t.GetSpreadsheetControlObject();clipele=document.getElementById(e.idPrefix+"clipboardtext"),document.getElementById(e.idPrefix+"clipboardformat-tab").checked=!0;try{clipele.value=t.ConvertSaveToOtherFormat(t.Clipboard.clipboard,"tab")}catch(o){console.error(o)}},t.SpreadsheetControlClipboardFormat=function(e){var o=t.GetSpreadsheetControlObject();clipele=document.getElementById(o.idPrefix+"clipboardtext"),clipele.value=t.ConvertSaveToOtherFormat(t.Clipboard.clipboard,e)},t.SpreadsheetControlClipboardLoad=function(){var e=t.GetSpreadsheetControlObject(),o="tab";t.SetTab(e.tabs[0].name),t.KeyboardFocus(),document.getElementById(e.idPrefix+"clipboardformat-csv").checked?o="csv":document.getElementById(e.idPrefix+"clipboardformat-scsave").checked&&(o="scsave"),e.editor.pastescclipboard=!0,e.editor.EditorScheduleSheetCommands("loadclipboard "+t.encodeForSave(t.ConvertOtherFormatToSave(document.getElementById(e.idPrefix+"clipboardtext").value,o)),!0,!1)},t.SpreadsheetControlClipboardClear=function(){var e=t.GetSpreadsheetControlObject(),o=document.getElementById(e.idPrefix+"clipboardtext");o.value="",e.editor.EditorScheduleSheetCommands("clearclipboard",!0,!1),o.focus()},t.SpreadsheetControlClipboardExport=function(){var e=t.GetSpreadsheetControlObject();e.ExportCallback&&e.ExportCallback(e),t.SetTab(e.tabs[0].name),t.KeyboardFocus()},t.SpreadsheetControlSettingsSwitch=function(e){t.SettingControlReset();var o=t.GetSpreadsheetControlObject(),i=document.getElementById(o.idPrefix+"sheetsettingstable"),n=document.getElementById(o.idPrefix+"cellsettingstable"),r=document.getElementById(o.idPrefix+"sheetsettingstoolbar"),a=document.getElementById(o.idPrefix+"cellsettingstoolbar");"sheet"==e?(i.style.display="block",n.style.display="none",r.style.display="block",a.style.display="none",t.SettingsControlSetCurrentPanel(o.views.settings.values.sheetspanel)):(i.style.display="none",n.style.display="block",r.style.display="none",a.style.display="block",t.SettingsControlSetCurrentPanel(o.views.settings.values.cellspanel))},t.SettingsControlSave=function(e){var o,i,n=t.GetSpreadsheetControlObject(),r=t.SettingsControls,a=r.CurrentPanel,s=t.SettingsControlUnloadPanel(a);t.SetTab(n.tabs[0].name),t.KeyboardFocus(),"sheet"==e?i=n.sheet.DecodeSheetAttributes(s):"cell"==e&&(n.editor.range.hasrange&&(o=t.crToCoord(n.editor.range.left,n.editor.range.top)+":"+t.crToCoord(n.editor.range.right,n.editor.range.bottom)),i=n.sheet.DecodeCellAttributes(n.editor.ecell.coord,s,o)),i&&n.editor.EditorScheduleSheetCommands(i,!0,!1)},t.SpreadsheetControlCreateSpreadsheetSave=function(e,t){var o,i,n,r="",a="";if(t)for(i in t)n="\n"!=t[i].charAt(t[i]-1)?"\n":"",r+="--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+t[i]+n,a+="part:"+i+"\n";return o="socialcalc:version:1.0\nMIME-Version: 1.0\nContent-Type: multipart/mixed; boundary="+e.multipartBoundary+"\n--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n# SocialCalc Spreadsheet Control Save\nversion:1.0\npart:sheet\npart:edit\npart:audit\n"+a+"--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+e.CreateSheetSave()+"--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+e.editor.SaveEditorSettings()+"--"+e.multipartBoundary+"\nContent-type: text/plain; charset=UTF-8\n\n"+e.sheet.CreateAuditString()+r+"--"+e.multipartBoundary+"--\n"},t.SpreadsheetControlDecodeSpreadsheetSave=function(e,t){var o,i,n,r,a,s,l,c,u,d,u,h,p={},f=[];if(o=t.search(/^MIME-Version:\s1\.0/im),0>o)return p;if(i=/^Content-Type:\s*multipart\/mixed;\s*boundary=(\S+)/gim,i.lastIndex=o,n=i.exec(t),i.lastIndex<=0)return p;if(r=n[1],a=new RegExp("^--"+r+"(?:\r\n|\n)","mg"),a.lastIndex=i.lastIndex,n=a.exec(t),s=/(?:\r\n|\n)(?:\r\n|\n)/gm,s.lastIndex=a.lastIndex,n=s.exec(t),!n)return p;if(l=s.lastIndex,a.lastIndex=l,n=a.exec(t),!n)return p;for(c=n.index,u=t.substring(l,c).split(/\r\n|\n/),d=0;d<u.length;d++)switch(line=u[d],h=line.split(":"),h[0]){case"version":break;case"part":f.push(h[1])}for(pnum=0;pnum<f.length;pnum++){if(s.lastIndex=c,n=s.exec(t),!n)return p;if(l=s.lastIndex,pnum==f.length-1&&(a=new RegExp("^--"+r+"--$","mg")),a.lastIndex=l,n=a.exec(t),!n)return p;c=n.index,p[f[pnum]]={start:l,end:c}}return p},t.SettingsControls={Controls:{},CurrentPanel:null},t.SettingsControlSetCurrentPanel=function(e){t.SettingsControls.CurrentPanel=e,t.SettingsControls.PopupChangeCallback({panelobj:e},"",null)},t.SettingsControlInitializePanel=function(e){var o,i=t.SettingsControls;for(o in e)"name"!=o&&(ctrl=i.Controls[e[o].type],ctrl&&ctrl.Initialize&&ctrl.Initialize(e,o))},t.SettingsControlLoadPanel=function(e,o){var i,n=t.SettingsControls;for(i in e)"name"!=i&&(ctrl=n.Controls[e[i].type],ctrl&&ctrl.SetValue&&ctrl.SetValue(e,i,o[e[i].setting]))},t.SettingsControlUnloadPanel=function(e){var o,i=t.SettingsControls,n={};for(o in e)"name"!=o&&(ctrl=i.Controls[e[o].type],ctrl&&ctrl.GetValue&&(n[e[o].setting]=ctrl.GetValue(e,o)));return n},t.SettingsControls.PopupChangeCallback=function(e){var o=t.Constants,i=document.getElementById("sample-text");if(i&&e&&e.panelobj){var n,r,a,s,l,c=t.CurrentSpreadsheetControlObject.idPrefix,u="cell"==e.panelobj.name?"c":"";a=o.defaultCellLayout.match(/^padding.(\S+) (\S+) (\S+) (\S+).vertical.align.(\S+);$/)||[];var d={color:["textcolor"],backgroundColor:["bgcolor","#FFF"],fontSize:["fontsize",o.defaultCellFontSize],fontFamily:["fontfamily"],paddingTop:["padtop",a[1]],paddingRight:["padright",a[2]],paddingBottom:["padbottom",a[3]],paddingLeft:["padleft",a[4]],verticalAlign:["alignvert",a[5]]};for(r in d)n=t.Popup.GetValue(c+u+d[r][0])||d[r][1]||"",i.style[r]=n;if("c"==u){d={borderTop:"cbt",borderRight:"cbr",borderBottom:"cbb",borderLeft:"cbl"};for(r in d)n=t.SettingsControls.BorderSideGetValue(e.panelobj,d[r]),i.style[r]=n?n.val||"":"";n=t.Popup.GetValue(c+"calignhoriz"),i.style.textAlign=n||"left",i.childNodes[1].style.textAlign=n||"right"}else i.style.border="",n=t.Popup.GetValue(c+"textalignhoriz"),i.style.textAlign=n||"left",n=t.Popup.GetValue(c+"numberalignhoriz"),i.childNodes[1].style.textAlign=n||"right";n=t.Popup.GetValue(c+u+"fontlook"),a=n?n.match(/^(\S+) (\S+)$/)||[]:[],i.style.fontStyle=a[1]||"",i.style.fontWeight=a[2]||"",n=t.Popup.GetValue(c+u+"formatnumber")||"General",s=t.FormatNumber.formatNumberWithFormat(9.8765,n,""),l=t.FormatNumber.formatNumberWithFormat(-1234.5,n,""),"??-???-??&nbsp;??:??:??"!=l&&(s+="<br>"+l),i.childNodes[1].innerHTML=s}},t.SettingsControls.PopupListSetValue=function(e,o,i){if(!i)return void alert(o+" no value");var n=t.Popup;i.def?n.SetValue(e[o].id,""):n.SetValue(e[o].id,i.val)},t.SettingsControls.PopupListGetValue=function(e,o){var i=e[o];if(!i)return null;var n=t.Popup.GetValue(i.id);return n?{def:!1,val:n}:{def:!0,val:0}},t.SettingsControls.PopupListInitialize=function(e,o){var i,n,r,a,s=t.SettingsControls,l=e[o].initialdata||s.Controls[e[o].type].InitialData||"";l=t.LocalizeSubstrings(l);var c=l.split(/\|/),u=[];for(i=0;i<(c.length||0);i++)n=c[i],r=n.indexOf(":"),a=n.substring(0,r),-1!=a.indexOf("\\")&&(a=a.replace(/\\c/g,":"),a=a.replace(/\\b/g,"\\")),a=t.special_chars(a),u[i]="[custom]"==a?{o:t.Constants.s_PopupListCustom,v:n.substring(r+1),a:{custom:!0}}:"[cancel]"==a?{o:t.Constants.s_PopupListCancel,v:"",a:{cancel:!0}}:"[break]"==a?{o:"-----",v:"",a:{skip:!0}}:"[newcol]"==a?{o:"",v:"",a:{newcol:!0}}:{o:a,v:n.substring(r+1)};t.Popup.Create("List",e[o].id,{}),t.Popup.Initialize(e[o].id,{options:u,attribs:{changedcallback:t.SettingsControls.PopupChangeCallback,panelobj:e}})},t.SettingsControls.PopupListReset=function(){t.Popup.Reset("List")},t.SettingsControls.Controls.PopupList={SetValue:t.SettingsControls.PopupListSetValue,GetValue:t.SettingsControls.PopupListGetValue,Initialize:t.SettingsControls.PopupListInitialize,OnReset:t.SettingsControls.PopupListReset,ChangedCallback:null},t.SettingsControls.ColorChooserSetValue=function(e,o,i){if(!i)return void alert(o+" no value");var n=t.Popup;i.def?n.SetValue(e[o].id,""):n.SetValue(e[o].id,i.val)},t.SettingsControls.ColorChooserGetValue=function(e,o){var i=t.Popup.GetValue(e[o].id);return i?{def:!1,val:i}:{def:!0,val:0}},t.SettingsControls.ColorChooserInitialize=function(e,o){t.SettingsControls;t.Popup.Create("ColorChooser",e[o].id,{}),t.Popup.Initialize(e[o].id,{attribs:{title:"&nbsp;",moveable:!0,width:"106px",changedcallback:t.SettingsControls.PopupChangeCallback,panelobj:e}})},t.SettingsControls.ColorChooserReset=function(){t.Popup.Reset("ColorChooser")},t.SettingsControls.Controls.ColorChooser={SetValue:t.SettingsControls.ColorChooserSetValue,GetValue:t.SettingsControls.ColorChooserGetValue,Initialize:t.SettingsControls.ColorChooserInitialize,OnReset:t.SettingsControls.ColorChooserReset,ChangedCallback:null},t.SettingsControls.BorderSideSetValue=function(e,o,i){var n,r,a,s=(t.SettingsControls,e[o].id);return i?(n=document.getElementById(s+"-onoff-bcb"),void(n&&(i.val?(n.checked=!0,n.value=i.val,a=i.val.match(/(\S+)\s+(\S+)\s+(\S.+)/),r=s+"-color",t.Popup.SetValue(r,a[3]),t.Popup.SetDisabled(r,!1)):(n.checked=!1,n.value=i.val,r=s+"-color",t.Popup.SetValue(r,""),t.Popup.SetDisabled(r,!0))))):void alert(o+" no value")},t.SettingsControls.BorderSideGetValue=function(e,o){var i,n,r=(t.SettingsControls,e[o].id);return(i=document.getElementById(r+"-onoff-bcb"))?i.checked?(n=t.Popup.GetValue(r+"-color"),n="1px solid "+(n||"rgb(0,0,0)"),{def:!1,val:n}):{def:!1,val:""}:void 0},t.SettingsControls.BorderSideInitialize=function(e,o){var i=(t.SettingsControls,e[o].id);t.Popup.Create("ColorChooser",i+"-color",{}),t.Popup.Initialize(i+"-color",{attribs:{title:"&nbsp;",width:"106px",moveable:!0,changedcallback:t.SettingsControls.PopupChangeCallback,panelobj:e}})},t.SettingsControlOnchangeBorder=function(e){var o=t.SettingsControls,i=o.CurrentPanel,n=e.id.match(/(^.*\-)(\w+)\-(\w+)\-(\w+)$/);if(n){var r=(n[1],n[2]),a=(n[3],n[4]),s=i[r].type;switch(a){case"bcb":e.checked?o.Controls[s].SetValue(o.CurrentPanel,r,{def:!1,val:e.value||"1px solid rgb(0,0,0)"}):o.Controls[s].SetValue(o.CurrentPanel,r,{def:!1,val:""})}}},t.SettingsControls.Controls.BorderSide={SetValue:t.SettingsControls.BorderSideSetValue,GetValue:t.SettingsControls.BorderSideGetValue,OnClick:t.SettingsControls.ColorComboOnClick,Initialize:t.SettingsControls.BorderSideInitialize,InitialData:{thickness:"1 pixel:1px",style:"Solid:solid"},ChangedCallback:null},t.SettingControlReset=function(){var e,o=t.SettingsControls;for(e in o.Controls)o.Controls[e].OnReset&&o.Controls[e].OnReset(e)},t.OtherSaveParts={},t.CtrlSEditor=function(e){var o,i;if(e.length>0)o=t.special_chars(t.OtherSaveParts[e]||"");else{o="Listing of Parts\n";for(i in t.OtherSaveParts)o+=t.special_chars("\nPart: "+i+"\n=====\n"+t.OtherSaveParts[i]+"\n")}var n=document.createElement("div");n.style.cssText="position:absolute;z-index:500;width:300px;height:300px;left:100px;top:200px;border:1px solid black;background-color:#EEE;text-align:center;",n.id="socialcalc-editbox",n.innerHTML=e+'<br><br><textarea id="socialcalc-editbox-textarea" style="width:250px;height:200px;">'+o+"</textarea><br><br><input type=button onclick=\"SocialCalc.CtrlSEditorDone ('socialcalc-editbox', '"+e+'\');" value="OK">',document.body.appendChild(n);var r=document.getElementById("socialcalc-editbox-textarea");r.focus(),t.CmdGotFocus(r)},t.CtrlSEditorDone=function(e,o){var i=document.getElementById(e+"-textarea"),n=i.value;o.length>0&&(n.length>0?t.OtherSaveParts[o]=n:delete t.OtherSaveParts[o]);var r=document.getElementById(e);t.KeyboardFocus(),r.parentNode.removeChild(r)};var t;return t||(alert("Main SocialCalc code module needed"),t={}),t.TableEditor||alert("SocialCalc TableEditor code module needed"),t.CurrentSpreadsheetViewerObject=null,t.SpreadsheetViewer=function(e){var o=t.Constants;this.parentNode=null,this.spreadsheetDiv=null,this.requestedHeight=0,this.requestedWidth=0,this.requestedSpaceBelow=0,this.height=0,this.width=0,this.viewheight=0,this.sheet=null,this.context=null,this.editor=null,this.spreadsheetDiv=null,this.editorDiv=null,this.sortrange="",this.idPrefix=e||"SocialCalc-",this.imagePrefix=o.defaultImagePrefix,this.statuslineheight=o.SVStatuslineheight,this.statuslineCSS=o.SVStatuslineCSS,this.sheet=new t.Sheet,this.context=new t.RenderContext(this.sheet),(1==t._app||1==t._view)&&(o.defaultImagePrefix=this.imagePrefix="../"+this.imagePrefix),1==t._app?(this.context.showGrid=!1,this.context.showRCHeaders=!1,this.context.highlightTypes.range.style="",this.context.sheetobj.cells.A1=new t.Cell("A1"),this.context.sheetobj.cells.A1.displaystring="Loading ... "):(this.context.showGrid=!0,this.context.showRCHeaders=!0),this.editor=new t.TableEditor(this.context),this.editor.noEdit=!0,this.editor.StatusCallback.statusline={func:t.SpreadsheetViewerStatuslineCallback,params:{}},this.hasStatusLine=!0,this.statuslineHTML='<table cellspacing="0" cellpadding="0"><tr><td width="100%" style="overflow:hidden;">{status}</td><td>&nbsp;</td></tr></table>',this.statuslineFull=!0,this.noRecalc=!0,this.repeatingMacroTimer=null,this.repeatingMacroInterval=60,this.repeatingMacroCommands="",t.CurrentSpreadsheetViewerObject=this},t.SpreadsheetViewer.prototype.InitializeSpreadsheetViewer=function(e,o,i,n){return t.InitializeSpreadsheetViewer(this,e,o,i,n)},t.SpreadsheetViewer.prototype.LoadSave=function(e){return t.SpreadsheetViewerLoadSave(this,e)},t.SpreadsheetViewer.prototype.DoOnResize=function(){return t.DoOnResize(this)},t.SpreadsheetViewer.prototype.SizeSSDiv=function(){return t.SizeSSDiv(this)},t.SpreadsheetViewer.prototype.DecodeSpreadsheetSave=function(e){return t.SpreadsheetViewerDecodeSpreadsheetSave(this,e)},t.SpreadsheetViewer.prototype.ParseSheetSave=function(e){return this.sheet.ParseSheetSave(e)},t.InitializeSpreadsheetViewer=function(e,o,i,n,r){{var a;t.Constants,t.LocalizeString,t.LocalizeSubstrings,e.tabs,e.views}for(e.requestedHeight=i,e.requestedWidth=n,e.requestedSpaceBelow=r,"string"==typeof o&&(o=document.getElementById(o)),null==o&&alert("SocialCalc.SpreadsheetControl not given parent node."),e.parentNode=o,e.spreadsheetDiv=document.createElement("div"),e.SizeSSDiv(),a=o.firstChild;null!=a;a=o.firstChild)o.removeChild(a);o.appendChild(e.spreadsheetDiv),e.nonviewheight=e.hasStatusLine?e.statuslineheight:0,e.viewheight=e.height-e.nonviewheight,e.editorDiv=e.editor.CreateTableEditor(e.width,e.viewheight),e.spreadsheetDiv.appendChild(e.editorDiv),e.hasStatusLine&&(e.statuslineDiv=document.createElement("div"),e.statuslineDiv.style.cssText=e.statuslineCSS,e.statuslineDiv.style.height=e.statuslineheight-(e.statuslineDiv.style.paddingTop.slice(0,-2)-0)-(e.statuslineDiv.style.paddingBottom.slice(0,-2)-0)+"px",e.statuslineDiv.id=e.idPrefix+"statusline",e.spreadsheetDiv.appendChild(e.statuslineDiv),e.editor.StatusCallback.statusline={func:t.SpreadsheetViewerStatuslineCallback,params:{spreadsheetobj:e}}),1==t._app&&(e.formDataViewer=new t.SpreadsheetViewer("te_FormData-"),e.formDataViewer.sheet.statuscallback=null,t.CurrentSpreadsheetViewerObject=e)},t.SpreadsheetViewerLoadSave=function(o,i){var n,r,a,s,l=o.DecodeSpreadsheetSave(i);l&&(l.sheet&&(o.sheet.ResetSheet(),o.sheet.ParseSheetSave(i.substring(l.sheet.start,l.sheet.end))),l.edit&&o.editor.LoadEditorSettings(i.substring(l.edit.start,l.edit.end)),l.startupmacro&&o.editor.EditorScheduleSheetCommands(i.substring(l.startupmacro.start,l.startupmacro.end),!1,!0),l.repeatingmacro&&(n=i.substring(l.repeatingmacro.start,l.repeatingmacro.end),n=n.replace("\r",""),r=n.indexOf("\n"),r>0&&(a=n.substring(0,r)-0,s=a,o.repeatingMacroInterval=a,o.repeatingMacroCommands=n.substring(r+1),s>0&&(o.repeatingMacroTimer=e.setTimeout(t.SpreadsheetViewerDoRepeatingMacro,1e3*o.repeatingMacroInterval))))),"off"==o.editor.context.sheetobj.attribs.recalc||o.noRecalc?o.editor.ScheduleRender():o.editor.EditorScheduleSheetCommands("recalc")},t.SpreadsheetViewerDoRepeatingMacro=function(){var e=t.GetSpreadsheetViewerObject(),o=e.editor;e.repeatingMacroTimer=null,t.SheetCommandInfo.CmdExtensionCallbacks.repeatmacro={func:t.SpreadsheetViewerRepeatMacroCommand,data:null},o.EditorScheduleSheetCommands(e.repeatingMacroCommands)},t.SpreadsheetViewerRepeatMacroCommand=function(o,i,n,r){var a=t.GetSpreadsheetViewerObject(),s=r.RestOfString(),l=s-0;l>0||(l=a.repeatingMacroInterval),a.repeatingMacroInterval=l,a.repeatingMacroTimer=e.setTimeout(t.SpreadsheetViewerDoRepeatingMacro,1e3*a.repeatingMacroInterval)},t.SpreadsheetViewerStopRepeatingMacro=function(){var o=t.GetSpreadsheetViewerObject();o.repeatingMacroTimer&&(e.clearTimeout(o.repeatingMacroTimer),o.repeatingMacroTimer=null)},t.SpreadsheetViewerDoButtonCmd=function(e,o,i){var n=i.element,r=i.functionobj.command,a=t.GetSpreadsheetViewerObject(),s=a.editor;switch(r){case"recalc":s.EditorScheduleSheetCommands("recalc")}n&&n.blur&&n.blur(),t.KeyboardFocus()},t.LocalizeString=function(e){var o=t.LocalizeStringList[e];return o||(o=t.Constants["s_loc_"+e.toLowerCase().replace(/\s/g,"_").replace(/\W/g,"X")]||e,t.LocalizeStringList[e]=o),o},t.LocalizeStringList={},t.LocalizeSubstrings=function(e){var o=t.LocalizeString;return e.replace(/%(loc|ssc)!(.*?)!/g,function(e,i,n){return"ssc"==i?t.Constants[n]||alert("Missing constant: "+n):o(n)})},t.GetSpreadsheetViewerObject=function(){var e=t.CurrentSpreadsheetViewerObject;if(e)return e;throw"No current SpreadsheetViewer object."},t.DoOnResize=function(e){var o,i=e.views,n=e.SizeSSDiv();if(n){for(vname in i)o=i[vname].element,o.style.width=e.width+"px",o.style.height=e.height-e.nonviewheight+"px";t._app||e.editor.ResizeTableEditor(e.width,e.height-e.nonviewheight)}},t.SizeSSDiv=function(e){var o,i,n,r,a,s=10,l=10;return n=!1,o=t.GetViewportInfo(),i=t.GetElementPosition(e.parentNode),i.bottom=0,i.right=0,r=e.parentNode.style,r.marginTop&&(i.top+=r.marginTop.slice(0,-2)-0),r.marginBottom&&(i.bottom+=r.marginBottom.slice(0,-2)-0),r.marginLeft&&(i.left+=r.marginLeft.slice(0,-2)-0),r.marginRight&&(i.right+=r.marginRight.slice(0,-2)-0),a=e.requestedHeight||o.height-(i.top+i.bottom+l)-(e.requestedSpaceBelow||0),e.height!=a&&(e.height=a,e.spreadsheetDiv.style.height=a+"px",n=!0),a=e.requestedWidth||o.width-(i.left+i.right+s)||700,e.width!=a&&(e.width=a,e.spreadsheetDiv.style.width=a+"px",n=!0),e.spreadsheetDiv.style.position="relative",n},t.SpreadsheetViewerStatuslineCallback=function(e,t,o,i){var n=i.spreadsheetobj,r="";switch(n&&n.statuslineDiv&&(r=n.statuslineFull?e.GetStatuslineString(t,o,i):e.ecell.coord,r=n.statuslineHTML.replace(/\{status\}/,r),n.statuslineDiv.innerHTML=r),t){case"cmdendnorender":case"calcfinished":case"doneposcalc":}},t.CmdGotFocus=function(e){t.Keyboard.passThru=e},t.SpreadsheetViewerCreateSheetHTML=function(e){var o,i,n,r="";return o=new t.RenderContext(e.sheet),i=document.createElement("div"),n=o.RenderSheet(null,{type:"html"}),i.appendChild(n),delete o,r=i.innerHTML,delete n,delete i,r},t.SpreadsheetViewerDecodeSpreadsheetSave=function(e,t){var o,i,n,r,a,s,l,c,u,d,u,h,p={},f=[],m=/[^\n]\r[^\n]/;if(m.test(t)&&(t=t.replace(/([^\n])\r([^\n])/g,"$1\r\n$2")),o=t.search(/^MIME-Version:\s1\.0/im),0>o)return p;if(i=/^Content-Type:\s*multipart\/mixed;\s*boundary=(\S+)/gim,i.lastIndex=o,n=i.exec(t),i.lastIndex<=0)return p;if(r=n[1],a=new RegExp("^--"+r+"(?:\r\n|\n)","mg"),a.lastIndex=i.lastIndex,n=a.exec(t),s=/(?:\r\n|\n)(?:\r\n|\n)/gm,s.lastIndex=a.lastIndex,n=s.exec(t),!n)return p;if(l=s.lastIndex,a.lastIndex=l,n=a.exec(t),!n)return p;for(c=n.index,u=t.substring(l,c).split(/\r\n|\n/),d=0;d<u.length;d++)switch(line=u[d],h=line.split(":"),h[0]){case"version":break;case"part":f.push(h[1])}for(pnum=0;pnum<f.length;pnum++){if(s.lastIndex=c,n=s.exec(t),!n)return p;if(l=s.lastIndex,pnum==f.length-1&&(a=new RegExp("^--"+r+"--$","mg")),a.lastIndex=l,n=a.exec(t),!n)return p;c=n.index,p[f[pnum]]={start:l,end:c}}return p},"undefined"==typeof document&&(t.GetEditorCellElement=function(){},t.ReplaceCell=function(){},t.EditorRenderSheet=function(){},t.SpreadsheetControlSortSave=function(){return""},t.SpreadsheetControlStatuslineCallback=function(){},t.DoPositionCalculations=function(e){t.EditorSheetStatusCallback(null,"doneposcalc",null,e)}),"undefined"!=typeof self&&self.thread&&(e.setTimeout=function(e,t){1>=t&&self.thread.nextTick(e)},e.clearTimeout=function(){}),t}),function(){Class=function(classDefinition,classWrapper){if(!classDefinition)throw"Class requires a class definition string as its first argument";if(!classWrapper)throw"Class requires a class wrapper function as its second argument";if(!classDefinition.match(/^([\w\.]+)(?:\(\s*([\w\.]+)\s*\))?(?:\s+(.*?)\s*)?$/))throw"Can't parse Class Definition: '"+classDefinition+"'";var className=RegExp.$1,baseClassName=RegExp.$2||"",options=[];RegExp.$3&&(options=RegExp.$3.split(/\s+/));for(var incValues=[],strict=!0,i=0,l=options.length;l>i;i++){var option=options[i];"-nostrict"==option&&(strict=!1),option.match(/^-inc=(.+)$/)&&(incValues=RegExp.$1.split(","))}for(var parts=className.split("."),klass=Class.global,i=0;i<parts.length;i++)klass[parts[i]]||(klass[parts[i]]=function(){try{this.init()}catch(e){}}),klass=klass[parts[i]];klass.className=className,klass.isa=function(baseName){klass.baseClassName=baseName,baseName&&(klass.prototype=eval("new "+baseName+"()"),klass.prototype.superFunc=function(name){return eval(baseName).prototype[name]})},klass.isa(baseClassName),klass.global=Class.global,klass.addGlobal=function(){return this.newGlobals++,Class.global},klass.extend=function(e){if("object"!=typeof e)throw"extend requires an object of name:value pairs";for(var t in e)klass.prototype[t]=e[t]};for(var ii=0,ll=incValues.length;ll>ii;ii++){var value=incValues[ii];incValues[ii]="proto"==value?klass.prototype:"this"==value?klass:Class.global[value]}return strict?Class.eval_strict(classWrapper,klass,incValues):classWrapper.apply(klass,incValues),klass}}(),Class.global=this,Class.eval_strict=function(e,t,o){var i,n=0;for(var r in Class.global)n++,i=r;t.newGlobals=0,e.apply(t,o);var a=0;for(var r in Class.global)a++;if(n+t.newGlobals!=a)throw"Class '"+t.className+"' defines "+(a-n)+" new global JavaScript variables without using this.addGlobal()";delete t.newGlobals},Class("Document.Emitter",function(){var proto=this.prototype;proto.className="Document.Emitter",proto.instantiate=function(){return eval("new "+this.className+"()")},proto.init=function(){this.output=""},proto.content=function(){return this.output},proto.insert=function(e){this.output+=e.output}}),Class("Document.Emitter.HTML(Document.Emitter)",function(){var e=this.prototype;e.className="Document.Emitter.HTML",e.begin_node=function(e){var t=e.type;switch(t){case"asis":case"line":return;case"br":case"hr":return void(this.output+="<"+t+" />");case"html":return void(this.output+='<span class="wafl">Raw HTML section. Edit in Wiki Text mode.</span>');case"waflparagraph":case"waflphrase":case"im":if(e._wafl.match(/^image:\s*(\S+)(?:\s+size=(\w+))?/)){var o="if (typeof(ss) != 'undefined' && ss.editor) { var recalc = function () { try { ss.editor.DoPositionCalculations() } catch (e) { setTimeout(recalc, 500) } }; recalc() } if (!window.image_dimension_cache) window.image_dimension_cache = {};window.image_dimension_cache['/data/wafl/"+e._label.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"\\'").replace(/\\/g,"\\\\")+"'] = [ this.offsetWidth, this.offsetHeight ]; this.style.width = this.offsetWidth + 'px'; this.style.height = this.offsetHeight + 'px'",i=RegExp.$1,n=RegExp.$2;
switch(n){case"small":n="100";break;case"medium":n="300";break;case"large":n="600"}return n&&(n=' width="'+n+'"'),void(this.output+='<img src="'+i.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'" onload="'+o+'"'+n+" />")}return void(this.output+='<span class="wafl">'+e._label.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"\\'").replace(/\\/g,"\\\\")+"</span>");case"a":case"wikilink":return void(this.output+='<a href="'+encodeURI(e._href)+'">');case"file":return void(this.output+='<a title="(network resource)" href="'+encodeURI(e._href)+'">');case"ul":case"ol":case"table":case"tr":return void(this.output+="<"+t+">\n");default:return void(this.output+="<"+t+">")}},e.end_node=function(e){var t=e.type;switch(t){case"asis":case"br":case"hr":case"html":case"waflparagraph":case"waflphrase":case"im":return;case"line":return void(this.output+="<br />");case"file":case"wikilink":return void(this.output+="</a>");default:return void(this.output+=0==t.search(/^(?:p|ul|ol|li|h\d|table|tr|td)$/)?"</"+t+">\n":"</"+t+">")}},e.text_node=function(e){this.output+=e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}}),Class("Document.Parser",function(){var proto=this.prototype;proto.className="Document.Parser",proto.init=function(){},proto.parse=function(e,t){return this.input=-1==e.search(/\n$/)?e+"\n":e,t&&(this.receiver=t),this.receiver.init(),this.grammar=this.create_grammar(),this.parse_blocks("top"),this.receiver.content()},proto.create_grammar=function(){throw"Please define create_grammar in a derived class of Document.Parser."},proto.parse_blocks=function(e){var t=this.grammar[e].blocks;if(t)for(;this.input.length;){for(var o=this.input.length,i=0;i<t.length;i++){var n=t[i],r=this.find_match("matched_block",n);if(r){this.input=this.input.substr(r.end),this.handle_match(n,r);break}}if(this.input.length>=o)throw this.classname+": Reduction error for:\n"+this.input+"\n"+JSON.stringify(this)}},proto.handle_match=function(e,t){var o=this.grammar[e],i=o.blocks?"parse_blocks":"parse_phrases";this.subparse(i,t,e,o.filter)},proto.find_match=function(e,t){var o=this.grammar[t].match;if(!o)throw"no regexp for type: "+t;var i=this.input.match(o);if(i){var n=this[e].call(this,i,this.grammar[t].lookbehind);return n.type=this.grammar[t].type||t,n}},proto.parse_phrases=function(e){var t=this.grammar[e].phrases;if(!t)return void this.receiver.text_node(this.input||"");for(;this.input.length;){for(var o=null,i=0;i<t.length;i++){var n=t[i],r=this.find_match("matched_phrase",n);if(r&&(!o||r.begin<o.begin)&&(o=r,0==o.begin))break}if(!o){this.receiver.text_node(this.input||"");break}0!=o.begin&&this.receiver.text_node(this.input.substr(0,o.begin)||""),this.input=this.input.substr(o.end),this.handle_match(o.type,o)}},proto.subparse=function(func,match,type,filter){match.type=this.grammar[type].type,null==match.type&&(match.type=type);var filtered_text=filter?filter(match):null;match.type&&this.receiver.begin_node(match);var parser=eval("new "+this.className+"()");parser.input=null==filtered_text?match.text:filtered_text,parser.grammar=this.grammar,parser.receiver=this.receiver.instantiate(),parser[func].call(parser,type),this.receiver.insert(parser.receiver),match.type&&this.receiver.end_node(match)},proto.matched_block=function(e){return{begin:e.index,text:e[1],end:e[0].length,1:e[2],2:e[3],3:e[4]}},proto.matched_phrase=function(e,t){if(t){var o=e[2],i=this.input.indexOf(e[1]);return{text:o,begin:i,end:i+e[1].length,1:RegExp.$2,2:RegExp.$3,3:RegExp.$4}}return{begin:e.index,text:e[1],end:e.index+e[0].length,1:e[2],2:e[3],3:e[4]}}}),Class("Document.Parser.Wikitext(Document.Parser)",function(){var e=this.prototype;e.className="Document.Parser.Wikitext",e.init=function(){},e.create_grammar=function(){var e=["pre","html","hr","hx","waflparagraph","ul","ol","blockquote","p","empty","else"],t=["waflphrase","asis","wikilink","wikilink2","a","im","mail","file","tt","b","i","del","a"],o=function(e,o){return o="\\"+(o||e),e="\\"+e,{match:new RegExp("(?:^|[^"+e+"\\w])("+e+"(?=\\S)(?!"+o+")(.*?)"+o+"(?=[^"+o+"\\w]|$))"),phrases:"\\`"==e?null:t,lookbehind:!0}},i={yahoo:"yahoo",ymsgr:"yahoo",callto:"callto",callme:"callto",skype:"callto",aim:"aim"},n={aim:"AIM: %1",yahoo:"Yahoo: %1",callto:"Skype: %1"},r="(\\b(";for(var a in i)r+=a+"|";r=r.replace(/\|$/,")\\:([^\\s\\>\\)]+))");var s=function(e,t){var o=new RegExp("(^|\n)"+t+" *","g");return{match:new RegExp("^("+e+"+ .*\n(?:[*-+#]+ .*\n)*)(?:s*\n)?"),blocks:["ul","ol","subl","li"],filter:function(e){return e.text.replace(o,"$1")}}};return{_all_blocks:e,_all_phrases:t,top:{blocks:e},ol:s("#","[*#]"),ul:s("[-+*]","[-+*#]"),blockquote:{match:/^((?:>[^\n]*\n)+)(?:\s*\n)?/,blocks:["blockquote","line"],filter:function(e){return e.text.replace(/(^|\n)>\ ?/g,"$1")}},line:{match:/([^\n]*)\n/,phrases:t},subl:{type:"li",match:/^(([^\n]*)\n[*#]+\ [^\n]*\n(?:[*#]+\ [^\n]*\n)*)(?:\s*\n)?/,blocks:["ul","ol","li2"]},li:{match:/([^\n]*)\n/,phrases:t},li2:{type:"",match:/([^\n]*)\n/,phrases:t},html:{match:/^(\.html\ *\n(?:[^\n]*\n)*?\.html)\ *\n(?:\s*\n)?/,filter:function(e){return e._html=e.text,""}},pre:{match:/^\.pre\ *\n((?:[^\n]*\n)*?)\.pre\ *\n(?:\s*\n)?/},hr:{match:/^--+(?:\s*\n)?/},hx:{match:/^((\^+) *([^\n]*?)(\s+=+)?\s*?\n+)/,phrases:t,filter:function(e){return e.type="h"+e[1].length,e[2]}},p:{match:/^((?:(?!(?:(?:\^+|\#+|\*+|\-+) |\>|\.\w+\s*\n|\{[^\}]+\}\s*\n))[^\n]*\S[^\n]*\n)+(?:(?=^|\n)\s*\n)*)/,phrases:t,filter:function(e){return e.text.replace(/\n$/,"")}},empty:{match:/^(\s*\n)/,filter:function(e){e.type=""}},"else":{match:/^(([^\n]*)\n)/,phrases:[],filter:function(e){e.type="p"}},waflparagraph:{match:/^\{(.*)\}[\ \t]*\n(?:\s*\n)?/,filter:function(e){return e._wafl=e._label=e.text,""}},waflphrase:{match:/(?:^|[\s\-])((?:"([^\n]+?)")?\{([\w-]+(?=[\:\ \}])(?:\s*:)?\s*[^\n]*?\s*)\}(?=[\W_]|$))/,filter:function(e){return e._wafl=e[2],e._label=e[1]||e._wafl,""},lookbehind:!0},asis:{match:/(\{\{([^\n]*?)\}\}(\}*))/,filter:function(e){return e.type="",e[1]+e[2]}},wikilink:{match:/(?:^|[_\W])(\[()(?=[^\s\[\]])(.*?)\](?=[_\W]|$))/,filter:function(e){return e._href="?"+e[2],e.text||e[2]},lookbehind:!0},wikilink2:{type:"wikilink",match:/(?:"([^"]*)"\s*)(\[(?=[^\s\[\]])(.*?)\](?=[_\W]|$))/,filter:function(e){return e._href="?"+e[2],e[1]||e[2]}},a:{match:/((?:"([^"]*)"\s*)?<?((?:http|https|ftp|irc|file):(?:\/\/)?[\;\/\?\:\@\&\=\+\$\,\[\]\#A-Za-z0-9\-\_\.\!\~\*\'\(\)]+[A-Za-z0-9\/#])>?)/,filter:function(e){return e._href=e[2],e[1]||e[2]}},file:{match:/((?:"([^"]*)")?<(\\\\[^\s\>\)]+)>)/,filter:function(e){var t=e[2].replace(/^\\\\/,"");return e._href="file://"+t.replace(/\\/g,"/"),e[1]||t}},im:{match:new RegExp(r),filter:function(e){return e._wafl=e[1]+": "+e[2],e._label=(n[i[e[1]]]||"%1").replace(/%1/g,e[2]),""}},mail:{match:/([\w+%\-\.]+@(?:[\w\-]+\.)+[\w\-]+)/,filter:function(e){e.type="a",e._href="mailto:"+e.text.replace(/%/g,"%25")}},tt:o("`"),b:o("*"),i:o("_"),del:o("-")}}}),!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function o(e){var t=e.length,o=rt.type(e);return"function"===o||rt.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===o||0===t||"number"==typeof t&&t>0&&t-1 in e}function i(e,t,o){if(rt.isFunction(t))return rt.grep(e,function(e,i){return!!t.call(e,i,e)!==o});if(t.nodeType)return rt.grep(e,function(e){return e===t!==o});if("string"==typeof t){if(pt.test(t))return rt.filter(t,e,o);t=rt.filter(t,e)}return rt.grep(e,function(e){return rt.inArray(e,t)>=0!==o})}function n(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function r(e){var t=wt[e]={};return rt.each(e.match(Ct)||[],function(e,o){t[o]=!0}),t}function a(){mt.addEventListener?(mt.removeEventListener("DOMContentLoaded",s,!1),e.removeEventListener("load",s,!1)):(mt.detachEvent("onreadystatechange",s),e.detachEvent("onload",s))}function s(){(mt.addEventListener||"load"===event.type||"complete"===mt.readyState)&&(a(),rt.ready())}function l(e,t,o){if(void 0===o&&1===e.nodeType){var i="data-"+t.replace(Tt,"-$1").toLowerCase();if(o=e.getAttribute(i),"string"==typeof o){try{o="true"===o?!0:"false"===o?!1:"null"===o?null:+o+""===o?+o:kt.test(o)?rt.parseJSON(o):o}catch(n){}rt.data(e,t,o)}else o=void 0}return o}function c(e){var t;for(t in e)if(("data"!==t||!rt.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function u(e,t,o,i){if(rt.acceptData(e)){var n,r,a=rt.expando,s=e.nodeType,l=s?rt.cache:e,c=s?e[a]:e[a]&&a;if(c&&l[c]&&(i||l[c].data)||void 0!==o||"string"!=typeof t)return c||(c=s?e[a]=K.pop()||rt.guid++:a),l[c]||(l[c]=s?{}:{toJSON:rt.noop}),("object"==typeof t||"function"==typeof t)&&(i?l[c]=rt.extend(l[c],t):l[c].data=rt.extend(l[c].data,t)),r=l[c],i||(r.data||(r.data={}),r=r.data),void 0!==o&&(r[rt.camelCase(t)]=o),"string"==typeof t?(n=r[t],null==n&&(n=r[rt.camelCase(t)])):n=r,n}}function d(e,t,o){if(rt.acceptData(e)){var i,n,r=e.nodeType,a=r?rt.cache:e,s=r?e[rt.expando]:rt.expando;if(a[s]){if(t&&(i=o?a[s]:a[s].data)){rt.isArray(t)?t=t.concat(rt.map(t,rt.camelCase)):t in i?t=[t]:(t=rt.camelCase(t),t=t in i?[t]:t.split(" ")),n=t.length;for(;n--;)delete i[t[n]];if(o?!c(i):!rt.isEmptyObject(i))return}(o||(delete a[s].data,c(a[s])))&&(r?rt.cleanData([e],!0):it.deleteExpando||a!=a.window?delete a[s]:a[s]=null)}}}function h(){return!0}function p(){return!1}function f(){try{return mt.activeElement}catch(e){}}function m(e){var t=Ot.split("|"),o=e.createDocumentFragment();if(o.createElement)for(;t.length;)o.createElement(t.pop());return o}function g(e,t){var o,i,n=0,r=typeof e.getElementsByTagName!==St?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==St?e.querySelectorAll(t||"*"):void 0;if(!r)for(r=[],o=e.childNodes||e;null!=(i=o[n]);n++)!t||rt.nodeName(i,t)?r.push(i):rt.merge(r,g(i,t));return void 0===t||t&&rt.nodeName(e,t)?rt.merge([e],r):r}function v(e){At.test(e.type)&&(e.defaultChecked=e.checked)}function b(e,t){return rt.nodeName(e,"table")&&rt.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function y(e){return e.type=(null!==rt.find.attr(e,"type"))+"/"+e.type,e}function C(e){var t=Kt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function w(e,t){for(var o,i=0;null!=(o=e[i]);i++)rt._data(o,"globalEval",!t||rt._data(t[i],"globalEval"))}function x(e,t){if(1===t.nodeType&&rt.hasData(e)){var o,i,n,r=rt._data(e),a=rt._data(t,r),s=r.events;if(s){delete a.handle,a.events={};for(o in s)for(i=0,n=s[o].length;n>i;i++)rt.event.add(t,o,s[o][i])}a.data&&(a.data=rt.extend({},a.data))}}function _(e,t){var o,i,n;if(1===t.nodeType){if(o=t.nodeName.toLowerCase(),!it.noCloneEvent&&t[rt.expando]){n=rt._data(t);for(i in n.events)rt.removeEvent(t,i,n.handle);t.removeAttribute(rt.expando)}"script"===o&&t.text!==e.text?(y(t).text=e.text,C(t)):"object"===o?(t.parentNode&&(t.outerHTML=e.outerHTML),it.html5Clone&&e.innerHTML&&!rt.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===o&&At.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===o?t.defaultSelected=t.selected=e.defaultSelected:("input"===o||"textarea"===o)&&(t.defaultValue=e.defaultValue)}}function S(t,o){var i=rt(o.createElement(t)).appendTo(o.body),n=e.getDefaultComputedStyle?e.getDefaultComputedStyle(i[0]).display:rt.css(i[0],"display");return i.detach(),n}function k(e){var t=mt,o=eo[e];return o||(o=S(e,t),"none"!==o&&o||(Qt=(Qt||rt("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=(Qt[0].contentWindow||Qt[0].contentDocument).document,t.write(),t.close(),o=S(e,t),Qt.detach()),eo[e]=o),o}function T(e,t){return{get:function(){var o=e();return null!=o?o?void delete this.get:(this.get=t).apply(this,arguments):void 0}}}function F(e,t){if(t in e)return t;for(var o=t.charAt(0).toUpperCase()+t.slice(1),i=t,n=fo.length;n--;)if(t=fo[n]+o,t in e)return t;return i}function E(e,t){for(var o,i,n,r=[],a=0,s=e.length;s>a;a++)i=e[a],i.style&&(r[a]=rt._data(i,"olddisplay"),o=i.style.display,t?(r[a]||"none"!==o||(i.style.display=""),""===i.style.display&&Dt(i)&&(r[a]=rt._data(i,"olddisplay",k(i.nodeName)))):r[a]||(n=Dt(i),(o&&"none"!==o||!n)&&rt._data(i,"olddisplay",n?o:rt.css(i,"display"))));for(a=0;s>a;a++)i=e[a],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?r[a]||"":"none"));return e}function D(e,t,o){var i=co.exec(t);return i?Math.max(0,i[1]-(o||0))+(i[2]||"px"):t}function P(e,t,o,i,n){for(var r=o===(i?"border":"content")?4:"width"===t?1:0,a=0;4>r;r+=2)"margin"===o&&(a+=rt.css(e,o+Et[r],!0,n)),i?("content"===o&&(a-=rt.css(e,"padding"+Et[r],!0,n)),"margin"!==o&&(a-=rt.css(e,"border"+Et[r]+"Width",!0,n))):(a+=rt.css(e,"padding"+Et[r],!0,n),"padding"!==o&&(a+=rt.css(e,"border"+Et[r]+"Width",!0,n)));return a}function A(e,t,o){var i=!0,n="width"===t?e.offsetWidth:e.offsetHeight,r=to(e),a=it.boxSizing()&&"border-box"===rt.css(e,"boxSizing",!1,r);if(0>=n||null==n){if(n=oo(e,t,r),(0>n||null==n)&&(n=e.style[t]),no.test(n))return n;i=a&&(it.boxSizingReliable()||n===e.style[t]),n=parseFloat(n)||0}return n+P(e,t,o||(a?"border":"content"),i,r)+"px"}function I(e,t,o,i,n){return new I.prototype.init(e,t,o,i,n)}function M(){return setTimeout(function(){mo=void 0}),mo=rt.now()}function R(e,t){var o,i={height:e},n=0;for(t=t?1:0;4>n;n+=2-t)o=Et[n],i["margin"+o]=i["padding"+o]=e;return t&&(i.opacity=i.width=e),i}function N(e,t,o){for(var i,n=(wo[t]||[]).concat(wo["*"]),r=0,a=n.length;a>r;r++)if(i=n[r].call(o,t,e))return i}function L(e,t,o){var i,n,r,a,s,l,c,u,d=this,h={},p=e.style,f=e.nodeType&&Dt(e),m=rt._data(e,"fxshow");o.queue||(s=rt._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,d.always(function(){d.always(function(){s.unqueued--,rt.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(o.overflow=[p.overflow,p.overflowX,p.overflowY],c=rt.css(e,"display"),u=k(e.nodeName),"none"===c&&(c=u),"inline"===c&&"none"===rt.css(e,"float")&&(it.inlineBlockNeedsLayout&&"inline"!==u?p.zoom=1:p.display="inline-block")),o.overflow&&(p.overflow="hidden",it.shrinkWrapBlocks()||d.always(function(){p.overflow=o.overflow[0],p.overflowX=o.overflow[1],p.overflowY=o.overflow[2]}));for(i in t)if(n=t[i],vo.exec(n)){if(delete t[i],r=r||"toggle"===n,n===(f?"hide":"show")){if("show"!==n||!m||void 0===m[i])continue;f=!0}h[i]=m&&m[i]||rt.style(e,i)}if(!rt.isEmptyObject(h)){m?"hidden"in m&&(f=m.hidden):m=rt._data(e,"fxshow",{}),r&&(m.hidden=!f),f?rt(e).show():d.done(function(){rt(e).hide()}),d.done(function(){var t;rt._removeData(e,"fxshow");for(t in h)rt.style(e,t,h[t])});for(i in h)a=N(f?m[i]:0,i,d),i in m||(m[i]=a.start,f&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}}function O(e,t){var o,i,n,r,a;for(o in e)if(i=rt.camelCase(o),n=t[i],r=e[o],rt.isArray(r)&&(n=r[1],r=e[o]=r[0]),o!==i&&(e[i]=r,delete e[o]),a=rt.cssHooks[i],a&&"expand"in a){r=a.expand(r),delete e[i];for(o in r)o in e||(e[o]=r[o],t[o]=n)}else t[i]=n}function z(e,t,o){var i,n,r=0,a=Co.length,s=rt.Deferred().always(function(){delete l.elem}),l=function(){if(n)return!1;for(var t=mo||M(),o=Math.max(0,c.startTime+c.duration-t),i=o/c.duration||0,r=1-i,a=0,l=c.tweens.length;l>a;a++)c.tweens[a].run(r);return s.notifyWith(e,[c,r,o]),1>r&&l?o:(s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:rt.extend({},t),opts:rt.extend(!0,{specialEasing:{}},o),originalProperties:t,originalOptions:o,startTime:mo||M(),duration:o.duration,tweens:[],createTween:function(t,o){var i=rt.Tween(e,c.opts,t,o,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var o=0,i=t?c.tweens.length:0;if(n)return this;for(n=!0;i>o;o++)c.tweens[o].run(1);return t?s.resolveWith(e,[c,t]):s.rejectWith(e,[c,t]),this}}),u=c.props;for(O(u,c.opts.specialEasing);a>r;r++)if(i=Co[r].call(c,e,u,c.opts))return i;return rt.map(u,N,c),rt.isFunction(c.opts.start)&&c.opts.start.call(e,c),rt.fx.timer(rt.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function H(e){return function(t,o){"string"!=typeof t&&(o=t,t="*");var i,n=0,r=t.toLowerCase().match(Ct)||[];if(rt.isFunction(o))for(;i=r[n++];)"+"===i.charAt(0)?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(o)):(e[i]=e[i]||[]).push(o)}}function B(e,t,o,i){function n(s){var l;return r[s]=!0,rt.each(e[s]||[],function(e,s){var c=s(t,o,i);return"string"!=typeof c||a||r[c]?a?!(l=c):void 0:(t.dataTypes.unshift(c),n(c),!1)}),l}var r={},a=e===Go;return n(t.dataTypes[0])||!r["*"]&&n("*")}function U(e,t){var o,i,n=rt.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((n[i]?e:o||(o={}))[i]=t[i]);return o&&rt.extend(!0,e,o),e}function j(e,t,o){for(var i,n,r,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(a in s)if(s[a]&&s[a].test(n)){l.unshift(a);break}if(l[0]in o)r=l[0];else{for(a in o){if(!l[0]||e.converters[a+" "+l[0]]){r=a;break}i||(i=a)}r=r||i}return r?(r!==l[0]&&l.unshift(r),o[r]):void 0}function V(e,t,o,i){var n,r,a,s,l,c={},u=e.dataTypes.slice();if(u[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(r=u.shift();r;)if(e.responseFields[r]&&(o[e.responseFields[r]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(a=c[l+" "+r]||c["* "+r],!a)for(n in c)if(s=n.split(" "),s[1]===r&&(a=c[l+" "+s[0]]||c["* "+s[0]])){a===!0?a=c[n]:c[n]!==!0&&(r=s[0],u.unshift(s[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(d){return{state:"parsererror",error:a?d:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}function W(e,t,o,i){var n;if(rt.isArray(t))rt.each(t,function(t,n){o||qo.test(e)?i(e,n):W(e+"["+("object"==typeof n?t:"")+"]",n,o,i)});else if(o||"object"!==rt.type(t))i(e,t);else for(n in t)W(e+"["+n+"]",t[n],o,i)}function G(){try{return new e.XMLHttpRequest}catch(t){}}function $(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function Y(e){return rt.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var K=[],q=K.slice,X=K.concat,J=K.push,Z=K.indexOf,Q={},et=Q.toString,tt=Q.hasOwnProperty,ot="".trim,it={},nt="1.11.0",rt=function(e,t){return new rt.fn.init(e,t)},at=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,st=/^-ms-/,lt=/-([\da-z])/gi,ct=function(e,t){return t.toUpperCase()};rt.fn=rt.prototype={jquery:nt,constructor:rt,selector:"",length:0,toArray:function(){return q.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:q.call(this)},pushStack:function(e){var t=rt.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return rt.each(this,e,t)},map:function(e){return this.pushStack(rt.map(this,function(t,o){return e.call(t,o,t)}))},slice:function(){return this.pushStack(q.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,o=+e+(0>e?t:0);return this.pushStack(o>=0&&t>o?[this[o]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:J,sort:K.sort,splice:K.splice},rt.extend=rt.fn.extend=function(){var e,t,o,i,n,r,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||rt.isFunction(a)||(a={}),s===l&&(a=this,s--);l>s;s++)if(null!=(n=arguments[s]))for(i in n)e=a[i],o=n[i],a!==o&&(c&&o&&(rt.isPlainObject(o)||(t=rt.isArray(o)))?(t?(t=!1,r=e&&rt.isArray(e)?e:[]):r=e&&rt.isPlainObject(e)?e:{},a[i]=rt.extend(c,r,o)):void 0!==o&&(a[i]=o));return a},rt.extend({expando:"jQuery"+(nt+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===rt.type(e)},isArray:Array.isArray||function(e){return"array"===rt.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return e-parseFloat(e)>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==rt.type(e)||e.nodeType||rt.isWindow(e))return!1;try{if(e.constructor&&!tt.call(e,"constructor")&&!tt.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(o){return!1}if(it.ownLast)for(t in e)return tt.call(e,t);for(t in e);return void 0===t||tt.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Q[et.call(e)]||"object":typeof e},globalEval:function(t){t&&rt.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(st,"ms-").replace(lt,ct)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var n,r=0,a=e.length,s=o(e);if(i){if(s)for(;a>r&&(n=t.apply(e[r],i),n!==!1);r++);else for(r in e)if(n=t.apply(e[r],i),n===!1)break}else if(s)for(;a>r&&(n=t.call(e[r],r,e[r]),n!==!1);r++);else for(r in e)if(n=t.call(e[r],r,e[r]),n===!1)break;return e},trim:ot&&!ot.call("﻿ ")?function(e){return null==e?"":ot.call(e)}:function(e){return null==e?"":(e+"").replace(at,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(o(Object(e))?rt.merge(i,"string"==typeof e?[e]:e):J.call(i,e)),i},inArray:function(e,t,o){var i;if(t){if(Z)return Z.call(t,e,o);for(i=t.length,o=o?0>o?Math.max(0,i+o):o:0;i>o;o++)if(o in t&&t[o]===e)return o}return-1},merge:function(e,t){for(var o=+t.length,i=0,n=e.length;o>i;)e[n++]=t[i++];if(o!==o)for(;void 0!==t[i];)e[n++]=t[i++];return e.length=n,e},grep:function(e,t,o){for(var i,n=[],r=0,a=e.length,s=!o;a>r;r++)i=!t(e[r],r),i!==s&&n.push(e[r]);return n},map:function(e,t,i){var n,r=0,a=e.length,s=o(e),l=[];if(s)for(;a>r;r++)n=t(e[r],r,i),null!=n&&l.push(n);else for(r in e)n=t(e[r],r,i),null!=n&&l.push(n);return X.apply([],l)},guid:1,proxy:function(e,t){var o,i,n;return"string"==typeof t&&(n=e[t],t=e,e=n),rt.isFunction(e)?(o=q.call(arguments,2),i=function(){return e.apply(t||this,o.concat(q.call(arguments)))},i.guid=e.guid=e.guid||rt.guid++,i):void 0},now:function(){return+new Date},support:it}),rt.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Q["[object "+t+"]"]=t.toLowerCase()});var ut=function(e){function t(e,t,o,i){var n,r,a,s,l,c,d,f,m,g;if((t?t.ownerDocument||t:B)!==I&&A(t),t=t||I,o=o||[],!e||"string"!=typeof e)return o;if(1!==(s=t.nodeType)&&9!==s)return[];if(R&&!i){if(n=bt.exec(e))if(a=n[1]){if(9===s){if(r=t.getElementById(a),!r||!r.parentNode)return o;if(r.id===a)return o.push(r),o}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(a))&&z(t,r)&&r.id===a)return o.push(r),o}else{if(n[2])return Q.apply(o,t.getElementsByTagName(e)),o;if((a=n[3])&&_.getElementsByClassName&&t.getElementsByClassName)return Q.apply(o,t.getElementsByClassName(a)),o}if(_.qsa&&(!N||!N.test(e))){if(f=d=H,m=t,g=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(c=h(e),(d=t.getAttribute("id"))?f=d.replace(Ct,"\\$&"):t.setAttribute("id",f),f="[id='"+f+"'] ",l=c.length;l--;)c[l]=f+p(c[l]);m=yt.test(e)&&u(t.parentNode)||t,g=c.join(",")}if(g)try{return Q.apply(o,m.querySelectorAll(g)),o}catch(v){}finally{d||t.removeAttribute("id")}}}return w(e.replace(lt,"$1"),t,o,i)}function o(){function e(o,i){return t.push(o+" ")>S.cacheLength&&delete e[t.shift()],e[o+" "]=i}var t=[];return e}function i(e){return e[H]=!0,e}function n(e){var t=I.createElement("div");try{return!!e(t)}catch(o){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function r(e,t){for(var o=e.split("|"),i=e.length;i--;)S.attrHandle[o[i]]=t}function a(e,t){var o=t&&e,i=o&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||K)-(~e.sourceIndex||K);if(i)return i;if(o)for(;o=o.nextSibling;)if(o===t)return-1;return e?1:-1}function s(e){return function(t){var o=t.nodeName.toLowerCase();return"input"===o&&t.type===e}}function l(e){return function(t){var o=t.nodeName.toLowerCase();return("input"===o||"button"===o)&&t.type===e}}function c(e){return i(function(t){return t=+t,i(function(o,i){for(var n,r=e([],o.length,t),a=r.length;a--;)o[n=r[a]]&&(o[n]=!(i[n]=o[n]))})})}function u(e){return e&&typeof e.getElementsByTagName!==Y&&e}function d(){}function h(e,o){var i,n,r,a,s,l,c,u=W[e+" "];if(u)return o?0:u.slice(0);for(s=e,l=[],c=S.preFilter;s;){(!i||(n=ct.exec(s)))&&(n&&(s=s.slice(n[0].length)||s),l.push(r=[])),i=!1,(n=ut.exec(s))&&(i=n.shift(),r.push({value:i,type:n[0].replace(lt," ")}),s=s.slice(i.length));for(a in S.filter)!(n=ft[a].exec(s))||c[a]&&!(n=c[a](n))||(i=n.shift(),r.push({value:i,type:a,matches:n}),s=s.slice(i.length));if(!i)break}return o?s.length:s?t.error(e):W(e,l).slice(0)}function p(e){for(var t=0,o=e.length,i="";o>t;t++)i+=e[t].value;return i}function f(e,t,o){var i=t.dir,n=o&&"parentNode"===i,r=j++;return t.first?function(t,o,r){for(;t=t[i];)if(1===t.nodeType||n)return e(t,o,r)}:function(t,o,a){var s,l,c=[U,r];if(a){for(;t=t[i];)if((1===t.nodeType||n)&&e(t,o,a))return!0}else for(;t=t[i];)if(1===t.nodeType||n){if(l=t[H]||(t[H]={}),(s=l[i])&&s[0]===U&&s[1]===r)return c[2]=s[2];if(l[i]=c,c[2]=e(t,o,a))return!0}}}function m(e){return e.length>1?function(t,o,i){for(var n=e.length;n--;)if(!e[n](t,o,i))return!1;return!0}:e[0]}function g(e,t,o,i,n){for(var r,a=[],s=0,l=e.length,c=null!=t;l>s;s++)(r=e[s])&&(!o||o(r,i,n))&&(a.push(r),c&&t.push(s));return a}function v(e,t,o,n,r,a){return n&&!n[H]&&(n=v(n)),r&&!r[H]&&(r=v(r,a)),i(function(i,a,s,l){var c,u,d,h=[],p=[],f=a.length,m=i||C(t||"*",s.nodeType?[s]:s,[]),v=!e||!i&&t?m:g(m,h,e,s,l),b=o?r||(i?e:f||n)?[]:a:v;if(o&&o(v,b,s,l),n)for(c=g(b,p),n(c,[],s,l),u=c.length;u--;)(d=c[u])&&(b[p[u]]=!(v[p[u]]=d));if(i){if(r||e){if(r){for(c=[],u=b.length;u--;)(d=b[u])&&c.push(v[u]=d);r(null,b=[],c,l)}for(u=b.length;u--;)(d=b[u])&&(c=r?tt.call(i,d):h[u])>-1&&(i[c]=!(a[c]=d))}}else b=g(b===a?b.splice(f,b.length):b),r?r(null,a,b,l):Q.apply(a,b)})}function b(e){for(var t,o,i,n=e.length,r=S.relative[e[0].type],a=r||S.relative[" "],s=r?1:0,l=f(function(e){return e===t},a,!0),c=f(function(e){return tt.call(t,e)>-1},a,!0),u=[function(e,o,i){return!r&&(i||o!==E)||((t=o).nodeType?l(e,o,i):c(e,o,i))}];n>s;s++)if(o=S.relative[e[s].type])u=[f(m(u),o)];else{if(o=S.filter[e[s].type].apply(null,e[s].matches),o[H]){for(i=++s;n>i&&!S.relative[e[i].type];i++);return v(s>1&&m(u),s>1&&p(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(lt,"$1"),o,i>s&&b(e.slice(s,i)),n>i&&b(e=e.slice(i)),n>i&&p(e))}u.push(o)}return m(u)}function y(e,o){var n=o.length>0,r=e.length>0,a=function(i,a,s,l,c){var u,d,h,p=0,f="0",m=i&&[],v=[],b=E,y=i||r&&S.find.TAG("*",c),C=U+=null==b?1:Math.random()||.1,w=y.length;for(c&&(E=a!==I&&a);f!==w&&null!=(u=y[f]);f++){if(r&&u){for(d=0;h=e[d++];)if(h(u,a,s)){l.push(u);break}c&&(U=C)}n&&((u=!h&&u)&&p--,i&&m.push(u))}if(p+=f,n&&f!==p){for(d=0;h=o[d++];)h(m,v,a,s);if(i){if(p>0)for(;f--;)m[f]||v[f]||(v[f]=J.call(l));v=g(v)}Q.apply(l,v),c&&!i&&v.length>0&&p+o.length>1&&t.uniqueSort(l)}return c&&(U=C,E=b),m};return n?i(a):a}function C(e,o,i){for(var n=0,r=o.length;r>n;n++)t(e,o[n],i);return i}function w(e,t,o,i){var n,r,a,s,l,c=h(e);if(!i&&1===c.length){if(r=c[0]=c[0].slice(0),r.length>2&&"ID"===(a=r[0]).type&&_.getById&&9===t.nodeType&&R&&S.relative[r[1].type]){if(t=(S.find.ID(a.matches[0].replace(wt,xt),t)||[])[0],!t)return o;e=e.slice(r.shift().value.length)}for(n=ft.needsContext.test(e)?0:r.length;n--&&(a=r[n],!S.relative[s=a.type]);)if((l=S.find[s])&&(i=l(a.matches[0].replace(wt,xt),yt.test(r[0].type)&&u(t.parentNode)||t))){if(r.splice(n,1),e=i.length&&p(r),!e)return Q.apply(o,i),o;break}}return F(e,c)(i,t,!R,o,yt.test(e)&&u(t.parentNode)||t),o}var x,_,S,k,T,F,E,D,P,A,I,M,R,N,L,O,z,H="sizzle"+-new Date,B=e.document,U=0,j=0,V=o(),W=o(),G=o(),$=function(e,t){return e===t&&(P=!0),0},Y="undefined",K=1<<31,q={}.hasOwnProperty,X=[],J=X.pop,Z=X.push,Q=X.push,et=X.slice,tt=X.indexOf||function(e){for(var t=0,o=this.length;o>t;t++)if(this[t]===e)return t;return-1},ot="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",it="[\\x20\\t\\r\\n\\f]",nt="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",rt=nt.replace("w","w#"),at="\\["+it+"*("+nt+")"+it+"*(?:([*^$|!~]?=)"+it+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+rt+")|)|)"+it+"*\\]",st=":("+nt+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+at.replace(3,8)+")*)|.*)\\)|)",lt=new RegExp("^"+it+"+|((?:^|[^\\\\])(?:\\\\.)*)"+it+"+$","g"),ct=new RegExp("^"+it+"*,"+it+"*"),ut=new RegExp("^"+it+"*([>+~]|"+it+")"+it+"*"),dt=new RegExp("="+it+"*([^\\]'\"]*?)"+it+"*\\]","g"),ht=new RegExp(st),pt=new RegExp("^"+rt+"$"),ft={ID:new RegExp("^#("+nt+")"),CLASS:new RegExp("^\\.("+nt+")"),TAG:new RegExp("^("+nt.replace("w","w*")+")"),ATTR:new RegExp("^"+at),PSEUDO:new RegExp("^"+st),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+it+"*(even|odd|(([+-]|)(\\d*)n|)"+it+"*(?:([+-]|)"+it+"*(\\d+)|))"+it+"*\\)|)","i"),bool:new RegExp("^(?:"+ot+")$","i"),needsContext:new RegExp("^"+it+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+it+"*((?:-\\d)?\\d*)"+it+"*\\)|)(?=[^-]|$)","i")},mt=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,bt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,Ct=/'|\\/g,wt=new RegExp("\\\\([\\da-f]{1,6}"+it+"?|("+it+")|.)","ig"),xt=function(e,t,o){var i="0x"+t-65536;return i!==i||o?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{Q.apply(X=et.call(B.childNodes),B.childNodes),X[B.childNodes.length].nodeType}catch(_t){Q={apply:X.length?function(e,t){Z.apply(e,et.call(t))}:function(e,t){for(var o=e.length,i=0;e[o++]=t[i++];);e.length=o-1}}}_=t.support={},T=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},A=t.setDocument=function(e){var t,o=e?e.ownerDocument||e:B,i=o.defaultView;return o!==I&&9===o.nodeType&&o.documentElement?(I=o,M=o.documentElement,R=!T(o),i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",function(){A()},!1):i.attachEvent&&i.attachEvent("onunload",function(){A()})),_.attributes=n(function(e){return e.className="i",!e.getAttribute("className")}),_.getElementsByTagName=n(function(e){return e.appendChild(o.createComment("")),!e.getElementsByTagName("*").length}),_.getElementsByClassName=vt.test(o.getElementsByClassName)&&n(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),_.getById=n(function(e){return M.appendChild(e).id=H,!o.getElementsByName||!o.getElementsByName(H).length}),_.getById?(S.find.ID=function(e,t){if(typeof t.getElementById!==Y&&R){var o=t.getElementById(e);return o&&o.parentNode?[o]:[]}},S.filter.ID=function(e){var t=e.replace(wt,xt);return function(e){return e.getAttribute("id")===t}}):(delete S.find.ID,S.filter.ID=function(e){var t=e.replace(wt,xt);return function(e){var o=typeof e.getAttributeNode!==Y&&e.getAttributeNode("id");return o&&o.value===t}}),S.find.TAG=_.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==Y?t.getElementsByTagName(e):void 0}:function(e,t){var o,i=[],n=0,r=t.getElementsByTagName(e);if("*"===e){for(;o=r[n++];)1===o.nodeType&&i.push(o);return i}return r},S.find.CLASS=_.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==Y&&R?t.getElementsByClassName(e):void 0},L=[],N=[],(_.qsa=vt.test(o.querySelectorAll))&&(n(function(e){e.innerHTML="<select t=''><option selected=''></option></select>",e.querySelectorAll("[t^='']").length&&N.push("[*^$]="+it+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||N.push("\\["+it+"*(?:value|"+ot+")"),e.querySelectorAll(":checked").length||N.push(":checked")}),n(function(e){var t=o.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&N.push("name"+it+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||N.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),N.push(",.*:")
})),(_.matchesSelector=vt.test(O=M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&n(function(e){_.disconnectedMatch=O.call(e,"div"),O.call(e,"[s!='']:x"),L.push("!=",st)}),N=N.length&&new RegExp(N.join("|")),L=L.length&&new RegExp(L.join("|")),t=vt.test(M.compareDocumentPosition),z=t||vt.test(M.contains)?function(e,t){var o=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(o.contains?o.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},$=t?function(e,t){if(e===t)return P=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!_.sortDetached&&t.compareDocumentPosition(e)===i?e===o||e.ownerDocument===B&&z(B,e)?-1:t===o||t.ownerDocument===B&&z(B,t)?1:D?tt.call(D,e)-tt.call(D,t):0:4&i?-1:1)}:function(e,t){if(e===t)return P=!0,0;var i,n=0,r=e.parentNode,s=t.parentNode,l=[e],c=[t];if(!r||!s)return e===o?-1:t===o?1:r?-1:s?1:D?tt.call(D,e)-tt.call(D,t):0;if(r===s)return a(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)c.unshift(i);for(;l[n]===c[n];)n++;return n?a(l[n],c[n]):l[n]===B?-1:c[n]===B?1:0},o):I},t.matches=function(e,o){return t(e,null,null,o)},t.matchesSelector=function(e,o){if((e.ownerDocument||e)!==I&&A(e),o=o.replace(dt,"='$1']"),!(!_.matchesSelector||!R||L&&L.test(o)||N&&N.test(o)))try{var i=O.call(e,o);if(i||_.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(n){}return t(o,I,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==I&&A(e),z(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==I&&A(e);var o=S.attrHandle[t.toLowerCase()],i=o&&q.call(S.attrHandle,t.toLowerCase())?o(e,t,!R):void 0;return void 0!==i?i:_.attributes||!R?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,o=[],i=0,n=0;if(P=!_.detectDuplicates,D=!_.sortStable&&e.slice(0),e.sort($),P){for(;t=e[n++];)t===e[n]&&(i=o.push(n));for(;i--;)e.splice(o[i],1)}return D=null,e},k=t.getText=function(e){var t,o="",i=0,n=e.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)o+=k(e)}else if(3===n||4===n)return e.nodeValue}else for(;t=e[i++];)o+=k(t);return o},S=t.selectors={cacheLength:50,createPseudo:i,match:ft,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(wt,xt),e[3]=(e[4]||e[5]||"").replace(wt,xt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,o=!e[5]&&e[2];return ft.CHILD.test(e[0])?null:(e[3]&&void 0!==e[4]?e[2]=e[4]:o&&ht.test(o)&&(t=h(o,!0))&&(t=o.indexOf(")",o.length-t)-o.length)&&(e[0]=e[0].slice(0,t),e[2]=o.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(wt,xt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=V[e+" "];return t||(t=new RegExp("(^|"+it+")"+e+"("+it+"|$)"))&&V(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==Y&&e.getAttribute("class")||"")})},ATTR:function(e,o,i){return function(n){var r=t.attr(n,e);return null==r?"!="===o:o?(r+="","="===o?r===i:"!="===o?r!==i:"^="===o?i&&0===r.indexOf(i):"*="===o?i&&r.indexOf(i)>-1:"$="===o?i&&r.slice(-i.length)===i:"~="===o?(" "+r+" ").indexOf(i)>-1:"|="===o?r===i||r.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,o,i,n){var r="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===n?function(e){return!!e.parentNode}:function(t,o,l){var c,u,d,h,p,f,m=r!==a?"nextSibling":"previousSibling",g=t.parentNode,v=s&&t.nodeName.toLowerCase(),b=!l&&!s;if(g){if(r){for(;m;){for(d=t;d=d[m];)if(s?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&b){for(u=g[H]||(g[H]={}),c=u[e]||[],p=c[0]===U&&c[1],h=c[0]===U&&c[2],d=p&&g.childNodes[p];d=++p&&d&&d[m]||(h=p=0)||f.pop();)if(1===d.nodeType&&++h&&d===t){u[e]=[U,p,h];break}}else if(b&&(c=(t[H]||(t[H]={}))[e])&&c[0]===U)h=c[1];else for(;(d=++p&&d&&d[m]||(h=p=0)||f.pop())&&((s?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++h||(b&&((d[H]||(d[H]={}))[e]=[U,h]),d!==t)););return h-=n,h===i||h%i===0&&h/i>=0}}},PSEUDO:function(e,o){var n,r=S.pseudos[e]||S.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return r[H]?r(o):r.length>1?(n=[e,e,"",o],S.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,t){for(var i,n=r(e,o),a=n.length;a--;)i=tt.call(e,n[a]),e[i]=!(t[i]=n[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:i(function(e){var t=[],o=[],n=F(e.replace(lt,"$1"));return n[H]?i(function(e,t,o,i){for(var r,a=n(e,null,i,[]),s=e.length;s--;)(r=a[s])&&(e[s]=!(t[s]=r))}):function(e,i,r){return t[0]=e,n(t,null,r,o),!o.pop()}}),has:i(function(e){return function(o){return t(e,o).length>0}}),contains:i(function(e){return function(t){return(t.textContent||t.innerText||k(t)).indexOf(e)>-1}}),lang:i(function(e){return pt.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(wt,xt).toLowerCase(),function(t){var o;do if(o=R?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return o=o.toLowerCase(),o===e||0===o.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var o=e.location&&e.location.hash;return o&&o.slice(1)===t.id},root:function(e){return e===M},focus:function(e){return e===I.activeElement&&(!I.hasFocus||I.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!S.pseudos.empty(e)},header:function(e){return gt.test(e.nodeName)},input:function(e){return mt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,o){return[0>o?o+t:o]}),even:c(function(e,t){for(var o=0;t>o;o+=2)e.push(o);return e}),odd:c(function(e,t){for(var o=1;t>o;o+=2)e.push(o);return e}),lt:c(function(e,t,o){for(var i=0>o?o+t:o;--i>=0;)e.push(i);return e}),gt:c(function(e,t,o){for(var i=0>o?o+t:o;++i<t;)e.push(i);return e})}},S.pseudos.nth=S.pseudos.eq;for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[x]=s(x);for(x in{submit:!0,reset:!0})S.pseudos[x]=l(x);return d.prototype=S.filters=S.pseudos,S.setFilters=new d,F=t.compile=function(e,t){var o,i=[],n=[],r=G[e+" "];if(!r){for(t||(t=h(e)),o=t.length;o--;)r=b(t[o]),r[H]?i.push(r):n.push(r);r=G(e,y(n,i))}return r},_.sortStable=H.split("").sort($).join("")===H,_.detectDuplicates=!!P,A(),_.sortDetached=n(function(e){return 1&e.compareDocumentPosition(I.createElement("div"))}),n(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||r("type|href|height|width",function(e,t,o){return o?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),_.attributes&&n(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||r("value",function(e,t,o){return o||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),n(function(e){return null==e.getAttribute("disabled")})||r(ot,function(e,t,o){var i;return o?void 0:e[t]===!0?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),t}(e);rt.find=ut,rt.expr=ut.selectors,rt.expr[":"]=rt.expr.pseudos,rt.unique=ut.uniqueSort,rt.text=ut.getText,rt.isXMLDoc=ut.isXML,rt.contains=ut.contains;var dt=rt.expr.match.needsContext,ht=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,pt=/^.[^:#\[\.,]*$/;rt.filter=function(e,t,o){var i=t[0];return o&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?rt.find.matchesSelector(i,e)?[i]:[]:rt.find.matches(e,rt.grep(t,function(e){return 1===e.nodeType}))},rt.fn.extend({find:function(e){var t,o=[],i=this,n=i.length;if("string"!=typeof e)return this.pushStack(rt(e).filter(function(){for(t=0;n>t;t++)if(rt.contains(i[t],this))return!0}));for(t=0;n>t;t++)rt.find(e,i[t],o);return o=this.pushStack(n>1?rt.unique(o):o),o.selector=this.selector?this.selector+" "+e:e,o},filter:function(e){return this.pushStack(i(this,e||[],!1))},not:function(e){return this.pushStack(i(this,e||[],!0))},is:function(e){return!!i(this,"string"==typeof e&&dt.test(e)?rt(e):e||[],!1).length}});var ft,mt=e.document,gt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,vt=rt.fn.init=function(e,t){var o,i;if(!e)return this;if("string"==typeof e){if(o="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:gt.exec(e),!o||!o[1]&&t)return!t||t.jquery?(t||ft).find(e):this.constructor(t).find(e);if(o[1]){if(t=t instanceof rt?t[0]:t,rt.merge(this,rt.parseHTML(o[1],t&&t.nodeType?t.ownerDocument||t:mt,!0)),ht.test(o[1])&&rt.isPlainObject(t))for(o in t)rt.isFunction(this[o])?this[o](t[o]):this.attr(o,t[o]);return this}if(i=mt.getElementById(o[2]),i&&i.parentNode){if(i.id!==o[2])return ft.find(e);this.length=1,this[0]=i}return this.context=mt,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):rt.isFunction(e)?"undefined"!=typeof ft.ready?ft.ready(e):e(rt):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),rt.makeArray(e,this))};vt.prototype=rt.fn,ft=rt(mt);var bt=/^(?:parents|prev(?:Until|All))/,yt={children:!0,contents:!0,next:!0,prev:!0};rt.extend({dir:function(e,t,o){for(var i=[],n=e[t];n&&9!==n.nodeType&&(void 0===o||1!==n.nodeType||!rt(n).is(o));)1===n.nodeType&&i.push(n),n=n[t];return i},sibling:function(e,t){for(var o=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&o.push(e);return o}}),rt.fn.extend({has:function(e){var t,o=rt(e,this),i=o.length;return this.filter(function(){for(t=0;i>t;t++)if(rt.contains(this,o[t]))return!0})},closest:function(e,t){for(var o,i=0,n=this.length,r=[],a=dt.test(e)||"string"!=typeof e?rt(e,t||this.context):0;n>i;i++)for(o=this[i];o&&o!==t;o=o.parentNode)if(o.nodeType<11&&(a?a.index(o)>-1:1===o.nodeType&&rt.find.matchesSelector(o,e))){r.push(o);break}return this.pushStack(r.length>1?rt.unique(r):r)},index:function(e){return e?"string"==typeof e?rt.inArray(this[0],rt(e)):rt.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(rt.unique(rt.merge(this.get(),rt(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),rt.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return rt.dir(e,"parentNode")},parentsUntil:function(e,t,o){return rt.dir(e,"parentNode",o)},next:function(e){return n(e,"nextSibling")},prev:function(e){return n(e,"previousSibling")},nextAll:function(e){return rt.dir(e,"nextSibling")},prevAll:function(e){return rt.dir(e,"previousSibling")},nextUntil:function(e,t,o){return rt.dir(e,"nextSibling",o)},prevUntil:function(e,t,o){return rt.dir(e,"previousSibling",o)},siblings:function(e){return rt.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return rt.sibling(e.firstChild)},contents:function(e){return rt.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:rt.merge([],e.childNodes)}},function(e,t){rt.fn[e]=function(o,i){var n=rt.map(this,t,o);return"Until"!==e.slice(-5)&&(i=o),i&&"string"==typeof i&&(n=rt.filter(i,n)),this.length>1&&(yt[e]||(n=rt.unique(n)),bt.test(e)&&(n=n.reverse())),this.pushStack(n)}});var Ct=/\S+/g,wt={};rt.Callbacks=function(e){e="string"==typeof e?wt[e]||r(e):rt.extend({},e);var t,o,i,n,a,s,l=[],c=!e.once&&[],u=function(r){for(o=e.memory&&r,i=!0,a=s||0,s=0,n=l.length,t=!0;l&&n>a;a++)if(l[a].apply(r[0],r[1])===!1&&e.stopOnFalse){o=!1;break}t=!1,l&&(c?c.length&&u(c.shift()):o?l=[]:d.disable())},d={add:function(){if(l){var i=l.length;!function r(t){rt.each(t,function(t,o){var i=rt.type(o);"function"===i?e.unique&&d.has(o)||l.push(o):o&&o.length&&"string"!==i&&r(o)})}(arguments),t?n=l.length:o&&(s=i,u(o))}return this},remove:function(){return l&&rt.each(arguments,function(e,o){for(var i;(i=rt.inArray(o,l,i))>-1;)l.splice(i,1),t&&(n>=i&&n--,a>=i&&a--)}),this},has:function(e){return e?rt.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],n=0,this},disable:function(){return l=c=o=void 0,this},disabled:function(){return!l},lock:function(){return c=void 0,o||d.disable(),this},locked:function(){return!c},fireWith:function(e,o){return!l||i&&!c||(o=o||[],o=[e,o.slice?o.slice():o],t?c.push(o):u(o)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!i}};return d},rt.extend({Deferred:function(e){var t=[["resolve","done",rt.Callbacks("once memory"),"resolved"],["reject","fail",rt.Callbacks("once memory"),"rejected"],["notify","progress",rt.Callbacks("memory")]],o="pending",i={state:function(){return o},always:function(){return n.done(arguments).fail(arguments),this},then:function(){var e=arguments;return rt.Deferred(function(o){rt.each(t,function(t,r){var a=rt.isFunction(e[t])&&e[t];n[r[1]](function(){var e=a&&a.apply(this,arguments);e&&rt.isFunction(e.promise)?e.promise().done(o.resolve).fail(o.reject).progress(o.notify):o[r[0]+"With"](this===i?o.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?rt.extend(e,i):i}},n={};return i.pipe=i.then,rt.each(t,function(e,r){var a=r[2],s=r[3];i[r[1]]=a.add,s&&a.add(function(){o=s},t[1^e][2].disable,t[2][2].lock),n[r[0]]=function(){return n[r[0]+"With"](this===n?i:this,arguments),this},n[r[0]+"With"]=a.fireWith}),i.promise(n),e&&e.call(n,n),n},when:function(e){var t,o,i,n=0,r=q.call(arguments),a=r.length,s=1!==a||e&&rt.isFunction(e.promise)?a:0,l=1===s?e:rt.Deferred(),c=function(e,o,i){return function(n){o[e]=this,i[e]=arguments.length>1?q.call(arguments):n,i===t?l.notifyWith(o,i):--s||l.resolveWith(o,i)}};if(a>1)for(t=new Array(a),o=new Array(a),i=new Array(a);a>n;n++)r[n]&&rt.isFunction(r[n].promise)?r[n].promise().done(c(n,i,r)).fail(l.reject).progress(c(n,o,t)):--s;return s||l.resolveWith(i,r),l.promise()}});var xt;rt.fn.ready=function(e){return rt.ready.promise().done(e),this},rt.extend({isReady:!1,readyWait:1,holdReady:function(e){e?rt.readyWait++:rt.ready(!0)},ready:function(e){if(e===!0?!--rt.readyWait:!rt.isReady){if(!mt.body)return setTimeout(rt.ready);rt.isReady=!0,e!==!0&&--rt.readyWait>0||(xt.resolveWith(mt,[rt]),rt.fn.trigger&&rt(mt).trigger("ready").off("ready"))}}}),rt.ready.promise=function(t){if(!xt)if(xt=rt.Deferred(),"complete"===mt.readyState)setTimeout(rt.ready);else if(mt.addEventListener)mt.addEventListener("DOMContentLoaded",s,!1),e.addEventListener("load",s,!1);else{mt.attachEvent("onreadystatechange",s),e.attachEvent("onload",s);var o=!1;try{o=null==e.frameElement&&mt.documentElement}catch(i){}o&&o.doScroll&&!function n(){if(!rt.isReady){try{o.doScroll("left")}catch(e){return setTimeout(n,50)}a(),rt.ready()}}()}return xt.promise(t)};var _t,St="undefined";for(_t in rt(it))break;it.ownLast="0"!==_t,it.inlineBlockNeedsLayout=!1,rt(function(){var e,t,o=mt.getElementsByTagName("body")[0];o&&(e=mt.createElement("div"),e.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",t=mt.createElement("div"),o.appendChild(e).appendChild(t),typeof t.style.zoom!==St&&(t.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(it.inlineBlockNeedsLayout=3===t.offsetWidth)&&(o.style.zoom=1)),o.removeChild(e),e=t=null)}),function(){var e=mt.createElement("div");if(null==it.deleteExpando){it.deleteExpando=!0;try{delete e.test}catch(t){it.deleteExpando=!1}}e=null}(),rt.acceptData=function(e){var t=rt.noData[(e.nodeName+" ").toLowerCase()],o=+e.nodeType||1;return 1!==o&&9!==o?!1:!t||t!==!0&&e.getAttribute("classid")===t};var kt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Tt=/([A-Z])/g;rt.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?rt.cache[e[rt.expando]]:e[rt.expando],!!e&&!c(e)},data:function(e,t,o){return u(e,t,o)},removeData:function(e,t){return d(e,t)},_data:function(e,t,o){return u(e,t,o,!0)},_removeData:function(e,t){return d(e,t,!0)}}),rt.fn.extend({data:function(e,t){var o,i,n,r=this[0],a=r&&r.attributes;if(void 0===e){if(this.length&&(n=rt.data(r),1===r.nodeType&&!rt._data(r,"parsedAttrs"))){for(o=a.length;o--;)i=a[o].name,0===i.indexOf("data-")&&(i=rt.camelCase(i.slice(5)),l(r,i,n[i]));rt._data(r,"parsedAttrs",!0)}return n}return"object"==typeof e?this.each(function(){rt.data(this,e)}):arguments.length>1?this.each(function(){rt.data(this,e,t)}):r?l(r,e,rt.data(r,e)):void 0},removeData:function(e){return this.each(function(){rt.removeData(this,e)})}}),rt.extend({queue:function(e,t,o){var i;return e?(t=(t||"fx")+"queue",i=rt._data(e,t),o&&(!i||rt.isArray(o)?i=rt._data(e,t,rt.makeArray(o)):i.push(o)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var o=rt.queue(e,t),i=o.length,n=o.shift(),r=rt._queueHooks(e,t),a=function(){rt.dequeue(e,t)};"inprogress"===n&&(n=o.shift(),i--),n&&("fx"===t&&o.unshift("inprogress"),delete r.stop,n.call(e,a,r)),!i&&r&&r.empty.fire()},_queueHooks:function(e,t){var o=t+"queueHooks";return rt._data(e,o)||rt._data(e,o,{empty:rt.Callbacks("once memory").add(function(){rt._removeData(e,t+"queue"),rt._removeData(e,o)})})}}),rt.fn.extend({queue:function(e,t){var o=2;return"string"!=typeof e&&(t=e,e="fx",o--),arguments.length<o?rt.queue(this[0],e):void 0===t?this:this.each(function(){var o=rt.queue(this,e,t);rt._queueHooks(this,e),"fx"===e&&"inprogress"!==o[0]&&rt.dequeue(this,e)})},dequeue:function(e){return this.each(function(){rt.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var o,i=1,n=rt.Deferred(),r=this,a=this.length,s=function(){--i||n.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)o=rt._data(r[a],e+"queueHooks"),o&&o.empty&&(i++,o.empty.add(s));return s(),n.promise(t)}});var Ft=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Et=["Top","Right","Bottom","Left"],Dt=function(e,t){return e=t||e,"none"===rt.css(e,"display")||!rt.contains(e.ownerDocument,e)},Pt=rt.access=function(e,t,o,i,n,r,a){var s=0,l=e.length,c=null==o;if("object"===rt.type(o)){n=!0;for(s in o)rt.access(e,t,s,o[s],!0,r,a)}else if(void 0!==i&&(n=!0,rt.isFunction(i)||(a=!0),c&&(a?(t.call(e,i),t=null):(c=t,t=function(e,t,o){return c.call(rt(e),o)})),t))for(;l>s;s++)t(e[s],o,a?i:i.call(e[s],s,t(e[s],o)));return n?e:c?t.call(e):l?t(e[0],o):r},At=/^(?:checkbox|radio)$/i;!function(){var e=mt.createDocumentFragment(),t=mt.createElement("div"),o=mt.createElement("input");if(t.setAttribute("className","t"),t.innerHTML="  <link/><table></table><a href='/a'>a</a>",it.leadingWhitespace=3===t.firstChild.nodeType,it.tbody=!t.getElementsByTagName("tbody").length,it.htmlSerialize=!!t.getElementsByTagName("link").length,it.html5Clone="<:nav></:nav>"!==mt.createElement("nav").cloneNode(!0).outerHTML,o.type="checkbox",o.checked=!0,e.appendChild(o),it.appendChecked=o.checked,t.innerHTML="<textarea>x</textarea>",it.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,e.appendChild(t),t.innerHTML="<input type='radio' checked='checked' name='t'/>",it.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,it.noCloneEvent=!0,t.attachEvent&&(t.attachEvent("onclick",function(){it.noCloneEvent=!1}),t.cloneNode(!0).click()),null==it.deleteExpando){it.deleteExpando=!0;try{delete t.test}catch(i){it.deleteExpando=!1}}e=t=o=null}(),function(){var t,o,i=mt.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})o="on"+t,(it[t+"Bubbles"]=o in e)||(i.setAttribute(o,"t"),it[t+"Bubbles"]=i.attributes[o].expando===!1);i=null}();var It=/^(?:input|select|textarea)$/i,Mt=/^key/,Rt=/^(?:mouse|contextmenu)|click/,Nt=/^(?:focusinfocus|focusoutblur)$/,Lt=/^([^.]*)(?:\.(.+)|)$/;rt.event={global:{},add:function(e,t,o,i,n){var r,a,s,l,c,u,d,h,p,f,m,g=rt._data(e);if(g){for(o.handler&&(l=o,o=l.handler,n=l.selector),o.guid||(o.guid=rt.guid++),(a=g.events)||(a=g.events={}),(u=g.handle)||(u=g.handle=function(e){return typeof rt===St||e&&rt.event.triggered===e.type?void 0:rt.event.dispatch.apply(u.elem,arguments)},u.elem=e),t=(t||"").match(Ct)||[""],s=t.length;s--;)r=Lt.exec(t[s])||[],p=m=r[1],f=(r[2]||"").split(".").sort(),p&&(c=rt.event.special[p]||{},p=(n?c.delegateType:c.bindType)||p,c=rt.event.special[p]||{},d=rt.extend({type:p,origType:m,data:i,handler:o,guid:o.guid,selector:n,needsContext:n&&rt.expr.match.needsContext.test(n),namespace:f.join(".")},l),(h=a[p])||(h=a[p]=[],h.delegateCount=0,c.setup&&c.setup.call(e,i,f,u)!==!1||(e.addEventListener?e.addEventListener(p,u,!1):e.attachEvent&&e.attachEvent("on"+p,u))),c.add&&(c.add.call(e,d),d.handler.guid||(d.handler.guid=o.guid)),n?h.splice(h.delegateCount++,0,d):h.push(d),rt.event.global[p]=!0);e=null}},remove:function(e,t,o,i,n){var r,a,s,l,c,u,d,h,p,f,m,g=rt.hasData(e)&&rt._data(e);if(g&&(u=g.events)){for(t=(t||"").match(Ct)||[""],c=t.length;c--;)if(s=Lt.exec(t[c])||[],p=m=s[1],f=(s[2]||"").split(".").sort(),p){for(d=rt.event.special[p]||{},p=(i?d.delegateType:d.bindType)||p,h=u[p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=r=h.length;r--;)a=h[r],!n&&m!==a.origType||o&&o.guid!==a.guid||s&&!s.test(a.namespace)||i&&i!==a.selector&&("**"!==i||!a.selector)||(h.splice(r,1),a.selector&&h.delegateCount--,d.remove&&d.remove.call(e,a));l&&!h.length&&(d.teardown&&d.teardown.call(e,f,g.handle)!==!1||rt.removeEvent(e,p,g.handle),delete u[p])}else for(p in u)rt.event.remove(e,p+t[c],o,i,!0);rt.isEmptyObject(u)&&(delete g.handle,rt._removeData(e,"events"))}},trigger:function(t,o,i,n){var r,a,s,l,c,u,d,h=[i||mt],p=tt.call(t,"type")?t.type:t,f=tt.call(t,"namespace")?t.namespace.split("."):[];if(s=u=i=i||mt,3!==i.nodeType&&8!==i.nodeType&&!Nt.test(p+rt.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),a=p.indexOf(":")<0&&"on"+p,t=t[rt.expando]?t:new rt.Event(p,"object"==typeof t&&t),t.isTrigger=n?2:3,t.namespace=f.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),o=null==o?[t]:rt.makeArray(o,[t]),c=rt.event.special[p]||{},n||!c.trigger||c.trigger.apply(i,o)!==!1)){if(!n&&!c.noBubble&&!rt.isWindow(i)){for(l=c.delegateType||p,Nt.test(l+p)||(s=s.parentNode);s;s=s.parentNode)h.push(s),u=s;u===(i.ownerDocument||mt)&&h.push(u.defaultView||u.parentWindow||e)}for(d=0;(s=h[d++])&&!t.isPropagationStopped();)t.type=d>1?l:c.bindType||p,r=(rt._data(s,"events")||{})[t.type]&&rt._data(s,"handle"),r&&r.apply(s,o),r=a&&s[a],r&&r.apply&&rt.acceptData(s)&&(t.result=r.apply(s,o),t.result===!1&&t.preventDefault());if(t.type=p,!n&&!t.isDefaultPrevented()&&(!c._default||c._default.apply(h.pop(),o)===!1)&&rt.acceptData(i)&&a&&i[p]&&!rt.isWindow(i)){u=i[a],u&&(i[a]=null),rt.event.triggered=p;try{i[p]()}catch(m){}rt.event.triggered=void 0,u&&(i[a]=u)}return t.result}},dispatch:function(e){e=rt.event.fix(e);var t,o,i,n,r,a=[],s=q.call(arguments),l=(rt._data(this,"events")||{})[e.type]||[],c=rt.event.special[e.type]||{};if(s[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(a=rt.event.handlers.call(this,e,l),t=0;(n=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=n.elem,r=0;(i=n.handlers[r++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,o=((rt.event.special[i.origType]||{}).handle||i.handler).apply(n.elem,s),void 0!==o&&(e.result=o)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var o,i,n,r,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==e.type)){for(n=[],r=0;s>r;r++)i=t[r],o=i.selector+" ",void 0===n[o]&&(n[o]=i.needsContext?rt(o,this).index(l)>=0:rt.find(o,this,null,[l]).length),n[o]&&n.push(i);n.length&&a.push({elem:l,handlers:n})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},fix:function(e){if(e[rt.expando])return e;var t,o,i,n=e.type,r=e,a=this.fixHooks[n];for(a||(this.fixHooks[n]=a=Rt.test(n)?this.mouseHooks:Mt.test(n)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new rt.Event(r),t=i.length;t--;)o=i[t],e[o]=r[o];return e.target||(e.target=r.srcElement||mt),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,r):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var o,i,n,r=t.button,a=t.fromElement;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||mt,n=i.documentElement,o=i.body,e.pageX=t.clientX+(n&&n.scrollLeft||o&&o.scrollLeft||0)-(n&&n.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||o&&o.scrollTop||0)-(n&&n.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?t.toElement:a),e.which||void 0===r||(e.which=1&r?1:2&r?3:4&r?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==f()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===f()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return rt.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return rt.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,o,i){var n=rt.extend(new rt.Event,o,{type:e,isSimulated:!0,originalEvent:{}});i?rt.event.trigger(n,null,t):rt.event.dispatch.call(t,n),n.isDefaultPrevented()&&o.preventDefault()}},rt.removeEvent=mt.removeEventListener?function(e,t,o){e.removeEventListener&&e.removeEventListener(t,o,!1)}:function(e,t,o){var i="on"+t;e.detachEvent&&(typeof e[i]===St&&(e[i]=null),e.detachEvent(i,o))},rt.Event=function(e,t){return this instanceof rt.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&(e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault())?h:p):this.type=e,t&&rt.extend(this,t),this.timeStamp=e&&e.timeStamp||rt.now(),void(this[rt.expando]=!0)):new rt.Event(e,t)},rt.Event.prototype={isDefaultPrevented:p,isPropagationStopped:p,isImmediatePropagationStopped:p,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=h,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=h,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=h,this.stopPropagation()}},rt.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){rt.event.special[e]={delegateType:t,bindType:t,handle:function(e){var o,i=this,n=e.relatedTarget,r=e.handleObj;return(!n||n!==i&&!rt.contains(i,n))&&(e.type=r.origType,o=r.handler.apply(this,arguments),e.type=t),o}}}),it.submitBubbles||(rt.event.special.submit={setup:function(){return rt.nodeName(this,"form")?!1:void rt.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,o=rt.nodeName(t,"input")||rt.nodeName(t,"button")?t.form:void 0;o&&!rt._data(o,"submitBubbles")&&(rt.event.add(o,"submit._submit",function(e){e._submit_bubble=!0}),rt._data(o,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&rt.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return rt.nodeName(this,"form")?!1:void rt.event.remove(this,"._submit")}}),it.changeBubbles||(rt.event.special.change={setup:function(){return It.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(rt.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),rt.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),rt.event.simulate("change",this,e,!0)})),!1):void rt.event.add(this,"beforeactivate._change",function(e){var t=e.target;It.test(t.nodeName)&&!rt._data(t,"changeBubbles")&&(rt.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||rt.event.simulate("change",this.parentNode,e,!0)}),rt._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return rt.event.remove(this,"._change"),!It.test(this.nodeName)}}),it.focusinBubbles||rt.each({focus:"focusin",blur:"focusout"},function(e,t){var o=function(e){rt.event.simulate(t,e.target,rt.event.fix(e),!0)};rt.event.special[t]={setup:function(){var i=this.ownerDocument||this,n=rt._data(i,t);n||i.addEventListener(e,o,!0),rt._data(i,t,(n||0)+1)},teardown:function(){var i=this.ownerDocument||this,n=rt._data(i,t)-1;n?rt._data(i,t,n):(i.removeEventListener(e,o,!0),rt._removeData(i,t))}}}),rt.fn.extend({on:function(e,t,o,i,n){var r,a;if("object"==typeof e){"string"!=typeof t&&(o=o||t,t=void 0);for(r in e)this.on(r,t,o,e[r],n);return this}if(null==o&&null==i?(i=t,o=t=void 0):null==i&&("string"==typeof t?(i=o,o=void 0):(i=o,o=t,t=void 0)),i===!1)i=p;else if(!i)return this;return 1===n&&(a=i,i=function(e){return rt().off(e),a.apply(this,arguments)},i.guid=a.guid||(a.guid=rt.guid++)),this.each(function(){rt.event.add(this,e,i,o,t)})},one:function(e,t,o,i){return this.on(e,t,o,i,1)},off:function(e,t,o){var i,n;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,rt(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(n in e)this.off(n,t,e[n]);return this}return(t===!1||"function"==typeof t)&&(o=t,t=void 0),o===!1&&(o=p),this.each(function(){rt.event.remove(this,e,o,t)})},trigger:function(e,t){return this.each(function(){rt.event.trigger(e,t,this)})},triggerHandler:function(e,t){var o=this[0];return o?rt.event.trigger(e,t,o,!0):void 0}});var Ot="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",zt=/ jQuery\d+="(?:null|\d+)"/g,Ht=new RegExp("<(?:"+Ot+")[\\s/>]","i"),Bt=/^\s+/,Ut=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,jt=/<([\w:]+)/,Vt=/<tbody/i,Wt=/<|&#?\w+;/,Gt=/<(?:script|style|link)/i,$t=/checked\s*(?:[^=]|=\s*.checked.)/i,Yt=/^$|\/(?:java|ecma)script/i,Kt=/^true\/(.*)/,qt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Xt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:it.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Jt=m(mt),Zt=Jt.appendChild(mt.createElement("div"));
Xt.optgroup=Xt.option,Xt.tbody=Xt.tfoot=Xt.colgroup=Xt.caption=Xt.thead,Xt.th=Xt.td,rt.extend({clone:function(e,t,o){var i,n,r,a,s,l=rt.contains(e.ownerDocument,e);if(it.html5Clone||rt.isXMLDoc(e)||!Ht.test("<"+e.nodeName+">")?r=e.cloneNode(!0):(Zt.innerHTML=e.outerHTML,Zt.removeChild(r=Zt.firstChild)),!(it.noCloneEvent&&it.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||rt.isXMLDoc(e)))for(i=g(r),s=g(e),a=0;null!=(n=s[a]);++a)i[a]&&_(n,i[a]);if(t)if(o)for(s=s||g(e),i=i||g(r),a=0;null!=(n=s[a]);a++)x(n,i[a]);else x(e,r);return i=g(r,"script"),i.length>0&&w(i,!l&&g(e,"script")),i=s=n=null,r},buildFragment:function(e,t,o,i){for(var n,r,a,s,l,c,u,d=e.length,h=m(t),p=[],f=0;d>f;f++)if(r=e[f],r||0===r)if("object"===rt.type(r))rt.merge(p,r.nodeType?[r]:r);else if(Wt.test(r)){for(s=s||h.appendChild(t.createElement("div")),l=(jt.exec(r)||["",""])[1].toLowerCase(),u=Xt[l]||Xt._default,s.innerHTML=u[1]+r.replace(Ut,"<$1></$2>")+u[2],n=u[0];n--;)s=s.lastChild;if(!it.leadingWhitespace&&Bt.test(r)&&p.push(t.createTextNode(Bt.exec(r)[0])),!it.tbody)for(r="table"!==l||Vt.test(r)?"<table>"!==u[1]||Vt.test(r)?0:s:s.firstChild,n=r&&r.childNodes.length;n--;)rt.nodeName(c=r.childNodes[n],"tbody")&&!c.childNodes.length&&r.removeChild(c);for(rt.merge(p,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=h.lastChild}else p.push(t.createTextNode(r));for(s&&h.removeChild(s),it.appendChecked||rt.grep(g(p,"input"),v),f=0;r=p[f++];)if((!i||-1===rt.inArray(r,i))&&(a=rt.contains(r.ownerDocument,r),s=g(h.appendChild(r),"script"),a&&w(s),o))for(n=0;r=s[n++];)Yt.test(r.type||"")&&o.push(r);return s=null,h},cleanData:function(e,t){for(var o,i,n,r,a=0,s=rt.expando,l=rt.cache,c=it.deleteExpando,u=rt.event.special;null!=(o=e[a]);a++)if((t||rt.acceptData(o))&&(n=o[s],r=n&&l[n])){if(r.events)for(i in r.events)u[i]?rt.event.remove(o,i):rt.removeEvent(o,i,r.handle);l[n]&&(delete l[n],c?delete o[s]:typeof o.removeAttribute!==St?o.removeAttribute(s):o[s]=null,K.push(n))}}}),rt.fn.extend({text:function(e){return Pt(this,function(e){return void 0===e?rt.text(this):this.empty().append((this[0]&&this[0].ownerDocument||mt).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=b(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=b(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var o,i=e?rt.filter(e,this):this,n=0;null!=(o=i[n]);n++)t||1!==o.nodeType||rt.cleanData(g(o)),o.parentNode&&(t&&rt.contains(o.ownerDocument,o)&&w(g(o,"script")),o.parentNode.removeChild(o));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&rt.cleanData(g(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&rt.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return rt.clone(this,e,t)})},html:function(e){return Pt(this,function(e){var t=this[0]||{},o=0,i=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(zt,""):void 0;if(!("string"!=typeof e||Gt.test(e)||!it.htmlSerialize&&Ht.test(e)||!it.leadingWhitespace&&Bt.test(e)||Xt[(jt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Ut,"<$1></$2>");try{for(;i>o;o++)t=this[o]||{},1===t.nodeType&&(rt.cleanData(g(t,!1)),t.innerHTML=e);t=0}catch(n){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,rt.cleanData(g(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=X.apply([],e);var o,i,n,r,a,s,l=0,c=this.length,u=this,d=c-1,h=e[0],p=rt.isFunction(h);if(p||c>1&&"string"==typeof h&&!it.checkClone&&$t.test(h))return this.each(function(o){var i=u.eq(o);p&&(e[0]=h.call(this,o,i.html())),i.domManip(e,t)});if(c&&(s=rt.buildFragment(e,this[0].ownerDocument,!1,this),o=s.firstChild,1===s.childNodes.length&&(s=o),o)){for(r=rt.map(g(s,"script"),y),n=r.length;c>l;l++)i=s,l!==d&&(i=rt.clone(i,!0,!0),n&&rt.merge(r,g(i,"script"))),t.call(this[l],i,l);if(n)for(a=r[r.length-1].ownerDocument,rt.map(r,C),l=0;n>l;l++)i=r[l],Yt.test(i.type||"")&&!rt._data(i,"globalEval")&&rt.contains(a,i)&&(i.src?rt._evalUrl&&rt._evalUrl(i.src):rt.globalEval((i.text||i.textContent||i.innerHTML||"").replace(qt,"")));s=o=null}return this}}),rt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){rt.fn[e]=function(e){for(var o,i=0,n=[],r=rt(e),a=r.length-1;a>=i;i++)o=i===a?this:this.clone(!0),rt(r[i])[t](o),J.apply(n,o.get());return this.pushStack(n)}});var Qt,eo={};!function(){var e,t,o=mt.createElement("div"),i="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";o.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=o.getElementsByTagName("a")[0],e.style.cssText="float:left;opacity:.5",it.opacity=/^0.5/.test(e.style.opacity),it.cssFloat=!!e.style.cssFloat,o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",it.clearCloneStyle="content-box"===o.style.backgroundClip,e=o=null,it.shrinkWrapBlocks=function(){var e,o,n,r;if(null==t){if(e=mt.getElementsByTagName("body")[0],!e)return;r="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",o=mt.createElement("div"),n=mt.createElement("div"),e.appendChild(o).appendChild(n),t=!1,typeof n.style.zoom!==St&&(n.style.cssText=i+";width:1px;padding:1px;zoom:1",n.innerHTML="<div></div>",n.firstChild.style.width="5px",t=3!==n.offsetWidth),e.removeChild(o),e=o=n=null}return t}}();var to,oo,io=/^margin/,no=new RegExp("^("+Ft+")(?!px)[a-z%]+$","i"),ro=/^(top|right|bottom|left)$/;e.getComputedStyle?(to=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)},oo=function(e,t,o){var i,n,r,a,s=e.style;return o=o||to(e),a=o?o.getPropertyValue(t)||o[t]:void 0,o&&(""!==a||rt.contains(e.ownerDocument,e)||(a=rt.style(e,t)),no.test(a)&&io.test(t)&&(i=s.width,n=s.minWidth,r=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=o.width,s.width=i,s.minWidth=n,s.maxWidth=r)),void 0===a?a:a+""}):mt.documentElement.currentStyle&&(to=function(e){return e.currentStyle},oo=function(e,t,o){var i,n,r,a,s=e.style;return o=o||to(e),a=o?o[t]:void 0,null==a&&s&&s[t]&&(a=s[t]),no.test(a)&&!ro.test(t)&&(i=s.left,n=e.runtimeStyle,r=n&&n.left,r&&(n.left=e.currentStyle.left),s.left="fontSize"===t?"1em":a,a=s.pixelLeft+"px",s.left=i,r&&(n.left=r)),void 0===a?a:a+""||"auto"}),!function(){function t(){var t,o,i=mt.getElementsByTagName("body")[0];i&&(t=mt.createElement("div"),o=mt.createElement("div"),t.style.cssText=c,i.appendChild(t).appendChild(o),o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",rt.swap(i,null!=i.style.zoom?{zoom:1}:{},function(){n=4===o.offsetWidth}),r=!0,a=!1,s=!0,e.getComputedStyle&&(a="1%"!==(e.getComputedStyle(o,null)||{}).top,r="4px"===(e.getComputedStyle(o,null)||{width:"4px"}).width),i.removeChild(t),o=i=null)}var o,i,n,r,a,s,l=mt.createElement("div"),c="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",u="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";l.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",o=l.getElementsByTagName("a")[0],o.style.cssText="float:left;opacity:.5",it.opacity=/^0.5/.test(o.style.opacity),it.cssFloat=!!o.style.cssFloat,l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",it.clearCloneStyle="content-box"===l.style.backgroundClip,o=l=null,rt.extend(it,{reliableHiddenOffsets:function(){if(null!=i)return i;var e,t,o,n=mt.createElement("div"),r=mt.getElementsByTagName("body")[0];return r?(n.setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=mt.createElement("div"),e.style.cssText=c,r.appendChild(e).appendChild(n),n.innerHTML="<table><tr><td></td><td>t</td></tr></table>",t=n.getElementsByTagName("td"),t[0].style.cssText="padding:0;margin:0;border:0;display:none",o=0===t[0].offsetHeight,t[0].style.display="",t[1].style.display="none",i=o&&0===t[0].offsetHeight,r.removeChild(e),n=r=null,i):void 0},boxSizing:function(){return null==n&&t(),n},boxSizingReliable:function(){return null==r&&t(),r},pixelPosition:function(){return null==a&&t(),a},reliableMarginRight:function(){var t,o,i,n;if(null==s&&e.getComputedStyle){if(t=mt.getElementsByTagName("body")[0],!t)return;o=mt.createElement("div"),i=mt.createElement("div"),o.style.cssText=c,t.appendChild(o).appendChild(i),n=i.appendChild(mt.createElement("div")),n.style.cssText=i.style.cssText=u,n.style.marginRight=n.style.width="0",i.style.width="1px",s=!parseFloat((e.getComputedStyle(n,null)||{}).marginRight),t.removeChild(o)}return s}})}(),rt.swap=function(e,t,o,i){var n,r,a={};for(r in t)a[r]=e.style[r],e.style[r]=t[r];n=o.apply(e,i||[]);for(r in t)e.style[r]=a[r];return n};var ao=/alpha\([^)]*\)/i,so=/opacity\s*=\s*([^)]*)/,lo=/^(none|table(?!-c[ea]).+)/,co=new RegExp("^("+Ft+")(.*)$","i"),uo=new RegExp("^([+-])=("+Ft+")","i"),ho={position:"absolute",visibility:"hidden",display:"block"},po={letterSpacing:0,fontWeight:400},fo=["Webkit","O","Moz","ms"];rt.extend({cssHooks:{opacity:{get:function(e,t){if(t){var o=oo(e,"opacity");return""===o?"1":o}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":it.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,o,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var n,r,a,s=rt.camelCase(t),l=e.style;if(t=rt.cssProps[s]||(rt.cssProps[s]=F(l,s)),a=rt.cssHooks[t]||rt.cssHooks[s],void 0===o)return a&&"get"in a&&void 0!==(n=a.get(e,!1,i))?n:l[t];if(r=typeof o,"string"===r&&(n=uo.exec(o))&&(o=(n[1]+1)*n[2]+parseFloat(rt.css(e,t)),r="number"),null!=o&&o===o&&("number"!==r||rt.cssNumber[s]||(o+="px"),it.clearCloneStyle||""!==o||0!==t.indexOf("background")||(l[t]="inherit"),!(a&&"set"in a&&void 0===(o=a.set(e,o,i)))))try{l[t]="",l[t]=o}catch(c){}}},css:function(e,t,o,i){var n,r,a,s=rt.camelCase(t);return t=rt.cssProps[s]||(rt.cssProps[s]=F(e.style,s)),a=rt.cssHooks[t]||rt.cssHooks[s],a&&"get"in a&&(r=a.get(e,!0,o)),void 0===r&&(r=oo(e,t,i)),"normal"===r&&t in po&&(r=po[t]),""===o||o?(n=parseFloat(r),o===!0||rt.isNumeric(n)?n||0:r):r}}),rt.each(["height","width"],function(e,t){rt.cssHooks[t]={get:function(e,o,i){return o?0===e.offsetWidth&&lo.test(rt.css(e,"display"))?rt.swap(e,ho,function(){return A(e,t,i)}):A(e,t,i):void 0},set:function(e,o,i){var n=i&&to(e);return D(e,o,i?P(e,t,i,it.boxSizing()&&"border-box"===rt.css(e,"boxSizing",!1,n),n):0)}}}),it.opacity||(rt.cssHooks.opacity={get:function(e,t){return so.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var o=e.style,i=e.currentStyle,n=rt.isNumeric(t)?"alpha(opacity="+100*t+")":"",r=i&&i.filter||o.filter||"";o.zoom=1,(t>=1||""===t)&&""===rt.trim(r.replace(ao,""))&&o.removeAttribute&&(o.removeAttribute("filter"),""===t||i&&!i.filter)||(o.filter=ao.test(r)?r.replace(ao,n):r+" "+n)}}),rt.cssHooks.marginRight=T(it.reliableMarginRight,function(e,t){return t?rt.swap(e,{display:"inline-block"},oo,[e,"marginRight"]):void 0}),rt.each({margin:"",padding:"",border:"Width"},function(e,t){rt.cssHooks[e+t]={expand:function(o){for(var i=0,n={},r="string"==typeof o?o.split(" "):[o];4>i;i++)n[e+Et[i]+t]=r[i]||r[i-2]||r[0];return n}},io.test(e)||(rt.cssHooks[e+t].set=D)}),rt.fn.extend({css:function(e,t){return Pt(this,function(e,t,o){var i,n,r={},a=0;if(rt.isArray(t)){for(i=to(e),n=t.length;n>a;a++)r[t[a]]=rt.css(e,t[a],!1,i);return r}return void 0!==o?rt.style(e,t,o):rt.css(e,t)},e,t,arguments.length>1)},show:function(){return E(this,!0)},hide:function(){return E(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Dt(this)?rt(this).show():rt(this).hide()})}}),rt.Tween=I,I.prototype={constructor:I,init:function(e,t,o,i,n,r){this.elem=e,this.prop=o,this.easing=n||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=r||(rt.cssNumber[o]?"":"px")},cur:function(){var e=I.propHooks[this.prop];return e&&e.get?e.get(this):I.propHooks._default.get(this)},run:function(e){var t,o=I.propHooks[this.prop];return this.pos=t=this.options.duration?rt.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),o&&o.set?o.set(this):I.propHooks._default.set(this),this}},I.prototype.init.prototype=I.prototype,I.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=rt.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){rt.fx.step[e.prop]?rt.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[rt.cssProps[e.prop]]||rt.cssHooks[e.prop])?rt.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},I.propHooks.scrollTop=I.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},rt.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},rt.fx=I.prototype.init,rt.fx.step={};var mo,go,vo=/^(?:toggle|show|hide)$/,bo=new RegExp("^(?:([+-])=|)("+Ft+")([a-z%]*)$","i"),yo=/queueHooks$/,Co=[L],wo={"*":[function(e,t){var o=this.createTween(e,t),i=o.cur(),n=bo.exec(t),r=n&&n[3]||(rt.cssNumber[e]?"":"px"),a=(rt.cssNumber[e]||"px"!==r&&+i)&&bo.exec(rt.css(o.elem,e)),s=1,l=20;if(a&&a[3]!==r){r=r||a[3],n=n||[],a=+i||1;do s=s||".5",a/=s,rt.style(o.elem,e,a+r);while(s!==(s=o.cur()/i)&&1!==s&&--l)}return n&&(a=o.start=+a||+i||0,o.unit=r,o.end=n[1]?a+(n[1]+1)*n[2]:+n[2]),o}]};rt.Animation=rt.extend(z,{tweener:function(e,t){rt.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var o,i=0,n=e.length;n>i;i++)o=e[i],wo[o]=wo[o]||[],wo[o].unshift(t)},prefilter:function(e,t){t?Co.unshift(e):Co.push(e)}}),rt.speed=function(e,t,o){var i=e&&"object"==typeof e?rt.extend({},e):{complete:o||!o&&t||rt.isFunction(e)&&e,duration:e,easing:o&&t||t&&!rt.isFunction(t)&&t};return i.duration=rt.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in rt.fx.speeds?rt.fx.speeds[i.duration]:rt.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){rt.isFunction(i.old)&&i.old.call(this),i.queue&&rt.dequeue(this,i.queue)},i},rt.fn.extend({fadeTo:function(e,t,o,i){return this.filter(Dt).css("opacity",0).show().end().animate({opacity:t},e,o,i)},animate:function(e,t,o,i){var n=rt.isEmptyObject(e),r=rt.speed(t,o,i),a=function(){var t=z(this,rt.extend({},e),r);(n||rt._data(this,"finish"))&&t.stop(!0)};return a.finish=a,n||r.queue===!1?this.each(a):this.queue(r.queue,a)},stop:function(e,t,o){var i=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof e&&(o=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",r=rt.timers,a=rt._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&yo.test(n)&&i(a[n]);for(n=r.length;n--;)r[n].elem!==this||null!=e&&r[n].queue!==e||(r[n].anim.stop(o),t=!1,r.splice(n,1));(t||!o)&&rt.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,o=rt._data(this),i=o[e+"queue"],n=o[e+"queueHooks"],r=rt.timers,a=i?i.length:0;for(o.finish=!0,rt.queue(this,e,[]),n&&n.stop&&n.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;a>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete o.finish})}}),rt.each(["toggle","show","hide"],function(e,t){var o=rt.fn[t];rt.fn[t]=function(e,i,n){return null==e||"boolean"==typeof e?o.apply(this,arguments):this.animate(R(t,!0),e,i,n)}}),rt.each({slideDown:R("show"),slideUp:R("hide"),slideToggle:R("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){rt.fn[e]=function(e,o,i){return this.animate(t,e,o,i)}}),rt.timers=[],rt.fx.tick=function(){var e,t=rt.timers,o=0;for(mo=rt.now();o<t.length;o++)e=t[o],e()||t[o]!==e||t.splice(o--,1);t.length||rt.fx.stop(),mo=void 0},rt.fx.timer=function(e){rt.timers.push(e),e()?rt.fx.start():rt.timers.pop()},rt.fx.interval=13,rt.fx.start=function(){go||(go=setInterval(rt.fx.tick,rt.fx.interval))},rt.fx.stop=function(){clearInterval(go),go=null},rt.fx.speeds={slow:600,fast:200,_default:400},rt.fn.delay=function(e,t){return e=rt.fx?rt.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,o){var i=setTimeout(t,e);o.stop=function(){clearTimeout(i)}})},function(){var e,t,o,i,n=mt.createElement("div");n.setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=n.getElementsByTagName("a")[0],o=mt.createElement("select"),i=o.appendChild(mt.createElement("option")),t=n.getElementsByTagName("input")[0],e.style.cssText="top:1px",it.getSetAttribute="t"!==n.className,it.style=/top/.test(e.getAttribute("style")),it.hrefNormalized="/a"===e.getAttribute("href"),it.checkOn=!!t.value,it.optSelected=i.selected,it.enctype=!!mt.createElement("form").enctype,o.disabled=!0,it.optDisabled=!i.disabled,t=mt.createElement("input"),t.setAttribute("value",""),it.input=""===t.getAttribute("value"),t.value="t",t.setAttribute("type","radio"),it.radioValue="t"===t.value,e=t=o=i=n=null}();var xo=/\r/g;rt.fn.extend({val:function(e){var t,o,i,n=this[0];return arguments.length?(i=rt.isFunction(e),this.each(function(o){var n;1===this.nodeType&&(n=i?e.call(this,o,rt(this).val()):e,null==n?n="":"number"==typeof n?n+="":rt.isArray(n)&&(n=rt.map(n,function(e){return null==e?"":e+""})),t=rt.valHooks[this.type]||rt.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,n,"value")||(this.value=n))})):n?(t=rt.valHooks[n.type]||rt.valHooks[n.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(o=t.get(n,"value"))?o:(o=n.value,"string"==typeof o?o.replace(xo,""):null==o?"":o)):void 0}}),rt.extend({valHooks:{option:{get:function(e){var t=rt.find.attr(e,"value");return null!=t?t:rt.text(e)}},select:{get:function(e){for(var t,o,i=e.options,n=e.selectedIndex,r="select-one"===e.type||0>n,a=r?null:[],s=r?n+1:i.length,l=0>n?s:r?n:0;s>l;l++)if(o=i[l],!(!o.selected&&l!==n||(it.optDisabled?o.disabled:null!==o.getAttribute("disabled"))||o.parentNode.disabled&&rt.nodeName(o.parentNode,"optgroup"))){if(t=rt(o).val(),r)return t;a.push(t)}return a},set:function(e,t){for(var o,i,n=e.options,r=rt.makeArray(t),a=n.length;a--;)if(i=n[a],rt.inArray(rt.valHooks.option.get(i),r)>=0)try{i.selected=o=!0}catch(s){i.scrollHeight}else i.selected=!1;return o||(e.selectedIndex=-1),n}}}}),rt.each(["radio","checkbox"],function(){rt.valHooks[this]={set:function(e,t){return rt.isArray(t)?e.checked=rt.inArray(rt(e).val(),t)>=0:void 0}},it.checkOn||(rt.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var _o,So,ko=rt.expr.attrHandle,To=/^(?:checked|selected)$/i,Fo=it.getSetAttribute,Eo=it.input;rt.fn.extend({attr:function(e,t){return Pt(this,rt.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){rt.removeAttr(this,e)})}}),rt.extend({attr:function(e,t,o){var i,n,r=e.nodeType;return e&&3!==r&&8!==r&&2!==r?typeof e.getAttribute===St?rt.prop(e,t,o):(1===r&&rt.isXMLDoc(e)||(t=t.toLowerCase(),i=rt.attrHooks[t]||(rt.expr.match.bool.test(t)?So:_o)),void 0===o?i&&"get"in i&&null!==(n=i.get(e,t))?n:(n=rt.find.attr(e,t),null==n?void 0:n):null!==o?i&&"set"in i&&void 0!==(n=i.set(e,o,t))?n:(e.setAttribute(t,o+""),o):void rt.removeAttr(e,t)):void 0},removeAttr:function(e,t){var o,i,n=0,r=t&&t.match(Ct);if(r&&1===e.nodeType)for(;o=r[n++];)i=rt.propFix[o]||o,rt.expr.match.bool.test(o)?Eo&&Fo||!To.test(o)?e[i]=!1:e[rt.camelCase("default-"+o)]=e[i]=!1:rt.attr(e,o,""),e.removeAttribute(Fo?o:i)},attrHooks:{type:{set:function(e,t){if(!it.radioValue&&"radio"===t&&rt.nodeName(e,"input")){var o=e.value;return e.setAttribute("type",t),o&&(e.value=o),t}}}}}),So={set:function(e,t,o){return t===!1?rt.removeAttr(e,o):Eo&&Fo||!To.test(o)?e.setAttribute(!Fo&&rt.propFix[o]||o,o):e[rt.camelCase("default-"+o)]=e[o]=!0,o}},rt.each(rt.expr.match.bool.source.match(/\w+/g),function(e,t){var o=ko[t]||rt.find.attr;ko[t]=Eo&&Fo||!To.test(t)?function(e,t,i){var n,r;return i||(r=ko[t],ko[t]=n,n=null!=o(e,t,i)?t.toLowerCase():null,ko[t]=r),n}:function(e,t,o){return o?void 0:e[rt.camelCase("default-"+t)]?t.toLowerCase():null}}),Eo&&Fo||(rt.attrHooks.value={set:function(e,t,o){return rt.nodeName(e,"input")?void(e.defaultValue=t):_o&&_o.set(e,t,o)}}),Fo||(_o={set:function(e,t,o){var i=e.getAttributeNode(o);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(o)),i.value=t+="","value"===o||t===e.getAttribute(o)?t:void 0}},ko.id=ko.name=ko.coords=function(e,t,o){var i;return o?void 0:(i=e.getAttributeNode(t))&&""!==i.value?i.value:null},rt.valHooks.button={get:function(e,t){var o=e.getAttributeNode(t);return o&&o.specified?o.value:void 0},set:_o.set},rt.attrHooks.contenteditable={set:function(e,t,o){_o.set(e,""===t?!1:t,o)}},rt.each(["width","height"],function(e,t){rt.attrHooks[t]={set:function(e,o){return""===o?(e.setAttribute(t,"auto"),o):void 0}}})),it.style||(rt.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var Do=/^(?:input|select|textarea|button|object)$/i,Po=/^(?:a|area)$/i;rt.fn.extend({prop:function(e,t){return Pt(this,rt.prop,e,t,arguments.length>1)},removeProp:function(e){return e=rt.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(t){}})}}),rt.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,o){var i,n,r,a=e.nodeType;return e&&3!==a&&8!==a&&2!==a?(r=1!==a||!rt.isXMLDoc(e),r&&(t=rt.propFix[t]||t,n=rt.propHooks[t]),void 0!==o?n&&"set"in n&&void 0!==(i=n.set(e,o,t))?i:e[t]=o:n&&"get"in n&&null!==(i=n.get(e,t))?i:e[t]):void 0},propHooks:{tabIndex:{get:function(e){var t=rt.find.attr(e,"tabindex");return t?parseInt(t,10):Do.test(e.nodeName)||Po.test(e.nodeName)&&e.href?0:-1}}}}),it.hrefNormalized||rt.each(["href","src"],function(e,t){rt.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),it.optSelected||(rt.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),rt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){rt.propFix[this.toLowerCase()]=this}),it.enctype||(rt.propFix.enctype="encoding");var Ao=/[\t\r\n\f]/g;rt.fn.extend({addClass:function(e){var t,o,i,n,r,a,s=0,l=this.length,c="string"==typeof e&&e;if(rt.isFunction(e))return this.each(function(t){rt(this).addClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(Ct)||[];l>s;s++)if(o=this[s],i=1===o.nodeType&&(o.className?(" "+o.className+" ").replace(Ao," "):" ")){for(r=0;n=t[r++];)i.indexOf(" "+n+" ")<0&&(i+=n+" ");a=rt.trim(i),o.className!==a&&(o.className=a)}return this},removeClass:function(e){var t,o,i,n,r,a,s=0,l=this.length,c=0===arguments.length||"string"==typeof e&&e;if(rt.isFunction(e))return this.each(function(t){rt(this).removeClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(Ct)||[];l>s;s++)if(o=this[s],i=1===o.nodeType&&(o.className?(" "+o.className+" ").replace(Ao," "):"")){for(r=0;n=t[r++];)for(;i.indexOf(" "+n+" ")>=0;)i=i.replace(" "+n+" "," ");a=e?rt.trim(i):"",o.className!==a&&(o.className=a)}return this},toggleClass:function(e,t){var o=typeof e;return"boolean"==typeof t&&"string"===o?t?this.addClass(e):this.removeClass(e):this.each(rt.isFunction(e)?function(o){rt(this).toggleClass(e.call(this,o,this.className,t),t)}:function(){if("string"===o)for(var t,i=0,n=rt(this),r=e.match(Ct)||[];t=r[i++];)n.hasClass(t)?n.removeClass(t):n.addClass(t);else(o===St||"boolean"===o)&&(this.className&&rt._data(this,"__className__",this.className),this.className=this.className||e===!1?"":rt._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",o=0,i=this.length;i>o;o++)if(1===this[o].nodeType&&(" "+this[o].className+" ").replace(Ao," ").indexOf(t)>=0)return!0;return!1}}),rt.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){rt.fn[t]=function(e,o){return arguments.length>0?this.on(t,null,e,o):this.trigger(t)}}),rt.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,o){return this.on(e,null,t,o)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,o,i){return this.on(t,e,o,i)},undelegate:function(e,t,o){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",o)}});var Io=rt.now(),Mo=/\?/,Ro=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;rt.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var o,i=null,n=rt.trim(t+"");return n&&!rt.trim(n.replace(Ro,function(e,t,n,r){return o&&t&&(i=0),0===i?e:(o=n||t,i+=!r-!n,"")}))?Function("return "+n)():rt.error("Invalid JSON: "+t)},rt.parseXML=function(t){var o,i;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(i=new DOMParser,o=i.parseFromString(t,"text/xml")):(o=new ActiveXObject("Microsoft.XMLDOM"),o.async="false",o.loadXML(t))}catch(n){o=void 0}return o&&o.documentElement&&!o.getElementsByTagName("parsererror").length||rt.error("Invalid XML: "+t),o};var No,Lo,Oo=/#.*$/,zo=/([?&])_=[^&]*/,Ho=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Bo=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Uo=/^(?:GET|HEAD)$/,jo=/^\/\//,Vo=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Wo={},Go={},$o="*/".concat("*");try{Lo=location.href}catch(Yo){Lo=mt.createElement("a"),Lo.href="",Lo=Lo.href}No=Vo.exec(Lo.toLowerCase())||[],rt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Lo,type:"GET",isLocal:Bo.test(No[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":$o,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":rt.parseJSON,"text xml":rt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?U(U(e,rt.ajaxSettings),t):U(rt.ajaxSettings,e)},ajaxPrefilter:H(Wo),ajaxTransport:H(Go),ajax:function(e,t){function o(e,t,o,i){var n,u,v,b,C,x=t;2!==y&&(y=2,s&&clearTimeout(s),c=void 0,a=i||"",w.readyState=e>0?4:0,n=e>=200&&300>e||304===e,o&&(b=j(d,w,o)),b=V(d,b,w,n),n?(d.ifModified&&(C=w.getResponseHeader("Last-Modified"),C&&(rt.lastModified[r]=C),C=w.getResponseHeader("etag"),C&&(rt.etag[r]=C)),204===e||"HEAD"===d.type?x="nocontent":304===e?x="notmodified":(x=b.state,u=b.data,v=b.error,n=!v)):(v=x,(e||!x)&&(x="error",0>e&&(e=0))),w.status=e,w.statusText=(t||x)+"",n?f.resolveWith(h,[u,x,w]):f.rejectWith(h,[w,x,v]),w.statusCode(g),g=void 0,l&&p.trigger(n?"ajaxSuccess":"ajaxError",[w,d,n?u:v]),m.fireWith(h,[w,x]),l&&(p.trigger("ajaxComplete",[w,d]),--rt.active||rt.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,n,r,a,s,l,c,u,d=rt.ajaxSetup({},t),h=d.context||d,p=d.context&&(h.nodeType||h.jquery)?rt(h):rt.event,f=rt.Deferred(),m=rt.Callbacks("once memory"),g=d.statusCode||{},v={},b={},y=0,C="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!u)for(u={};t=Ho.exec(a);)u[t[1].toLowerCase()]=t[2];t=u[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?a:null},setRequestHeader:function(e,t){var o=e.toLowerCase();return y||(e=b[o]=b[o]||e,v[e]=t),this},overrideMimeType:function(e){return y||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)g[t]=[g[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||C;return c&&c.abort(t),o(0,t),this}};if(f.promise(w).complete=m.add,w.success=w.done,w.error=w.fail,d.url=((e||d.url||Lo)+"").replace(Oo,"").replace(jo,No[1]+"//"),d.type=t.method||t.type||d.method||d.type,d.dataTypes=rt.trim(d.dataType||"*").toLowerCase().match(Ct)||[""],null==d.crossDomain&&(i=Vo.exec(d.url.toLowerCase()),d.crossDomain=!(!i||i[1]===No[1]&&i[2]===No[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(No[3]||("http:"===No[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=rt.param(d.data,d.traditional)),B(Wo,d,t,w),2===y)return w;l=d.global,l&&0===rt.active++&&rt.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Uo.test(d.type),r=d.url,d.hasContent||(d.data&&(r=d.url+=(Mo.test(r)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=zo.test(r)?r.replace(zo,"$1_="+Io++):r+(Mo.test(r)?"&":"?")+"_="+Io++)),d.ifModified&&(rt.lastModified[r]&&w.setRequestHeader("If-Modified-Since",rt.lastModified[r]),rt.etag[r]&&w.setRequestHeader("If-None-Match",rt.etag[r])),(d.data&&d.hasContent&&d.contentType!==!1||t.contentType)&&w.setRequestHeader("Content-Type",d.contentType),w.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+$o+"; q=0.01":""):d.accepts["*"]);for(n in d.headers)w.setRequestHeader(n,d.headers[n]);if(d.beforeSend&&(d.beforeSend.call(h,w,d)===!1||2===y))return w.abort();C="abort";for(n in{success:1,error:1,complete:1})w[n](d[n]);if(c=B(Go,d,t,w)){w.readyState=1,l&&p.trigger("ajaxSend",[w,d]),d.async&&d.timeout>0&&(s=setTimeout(function(){w.abort("timeout")},d.timeout));try{y=1,c.send(v,o)}catch(x){if(!(2>y))throw x;o(-1,x)}}else o(-1,"No Transport");return w},getJSON:function(e,t,o){return rt.get(e,t,o,"json")},getScript:function(e,t){return rt.get(e,void 0,t,"script")}}),rt.each(["get","post"],function(e,t){rt[t]=function(e,o,i,n){return rt.isFunction(o)&&(n=n||i,i=o,o=void 0),rt.ajax({url:e,type:t,dataType:n,data:o,success:i})}}),rt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){rt.fn[t]=function(e){return this.on(t,e)}}),rt._evalUrl=function(e){return rt.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},rt.fn.extend({wrapAll:function(e){if(rt.isFunction(e))return this.each(function(t){rt(this).wrapAll(e.call(this,t))});if(this[0]){var t=rt(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(rt.isFunction(e)?function(t){rt(this).wrapInner(e.call(this,t))}:function(){var t=rt(this),o=t.contents();o.length?o.wrapAll(e):t.append(e)})},wrap:function(e){var t=rt.isFunction(e);return this.each(function(o){rt(this).wrapAll(t?e.call(this,o):e)})},unwrap:function(){return this.parent().each(function(){rt.nodeName(this,"body")||rt(this).replaceWith(this.childNodes)}).end()}}),rt.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!it.reliableHiddenOffsets()&&"none"===(e.style&&e.style.display||rt.css(e,"display"))},rt.expr.filters.visible=function(e){return!rt.expr.filters.hidden(e)};var Ko=/%20/g,qo=/\[\]$/,Xo=/\r?\n/g,Jo=/^(?:submit|button|image|reset|file)$/i,Zo=/^(?:input|select|textarea|keygen)/i;
rt.param=function(e,t){var o,i=[],n=function(e,t){t=rt.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=rt.ajaxSettings&&rt.ajaxSettings.traditional),rt.isArray(e)||e.jquery&&!rt.isPlainObject(e))rt.each(e,function(){n(this.name,this.value)});else for(o in e)W(o,e[o],t,n);return i.join("&").replace(Ko,"+")},rt.fn.extend({serialize:function(){return rt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=rt.prop(this,"elements");return e?rt.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!rt(this).is(":disabled")&&Zo.test(this.nodeName)&&!Jo.test(e)&&(this.checked||!At.test(e))}).map(function(e,t){var o=rt(this).val();return null==o?null:rt.isArray(o)?rt.map(o,function(e){return{name:t.name,value:e.replace(Xo,"\r\n")}}):{name:t.name,value:o.replace(Xo,"\r\n")}}).get()}}),rt.ajaxSettings.xhr=void 0!==e.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&G()||$()}:G;var Qo=0,ei={},ti=rt.ajaxSettings.xhr();e.ActiveXObject&&rt(e).on("unload",function(){for(var e in ei)ei[e](void 0,!0)}),it.cors=!!ti&&"withCredentials"in ti,ti=it.ajax=!!ti,ti&&rt.ajaxTransport(function(e){if(!e.crossDomain||it.cors){var t;return{send:function(o,i){var n,r=e.xhr(),a=++Qo;if(r.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(n in e.xhrFields)r[n]=e.xhrFields[n];e.mimeType&&r.overrideMimeType&&r.overrideMimeType(e.mimeType),e.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");for(n in o)void 0!==o[n]&&r.setRequestHeader(n,o[n]+"");r.send(e.hasContent&&e.data||null),t=function(o,n){var s,l,c;if(t&&(n||4===r.readyState))if(delete ei[a],t=void 0,r.onreadystatechange=rt.noop,n)4!==r.readyState&&r.abort();else{c={},s=r.status,"string"==typeof r.responseText&&(c.text=r.responseText);try{l=r.statusText}catch(u){l=""}s||!e.isLocal||e.crossDomain?1223===s&&(s=204):s=c.text?200:404}c&&i(s,l,c,r.getAllResponseHeaders())},e.async?4===r.readyState?setTimeout(t):r.onreadystatechange=ei[a]=t:t()},abort:function(){t&&t(void 0,!0)}}}}),rt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return rt.globalEval(e),e}}}),rt.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),rt.ajaxTransport("script",function(e){if(e.crossDomain){var t,o=mt.head||rt("head")[0]||mt.documentElement;return{send:function(i,n){t=mt.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,o){(o||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,o||n(200,"success"))},o.insertBefore(t,o.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}});var oi=[],ii=/(=)\?(?=&|$)|\?\?/;rt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=oi.pop()||rt.expando+"_"+Io++;return this[e]=!0,e}}),rt.ajaxPrefilter("json jsonp",function(t,o,i){var n,r,a,s=t.jsonp!==!1&&(ii.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&ii.test(t.data)&&"data");return s||"jsonp"===t.dataTypes[0]?(n=t.jsonpCallback=rt.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(ii,"$1"+n):t.jsonp!==!1&&(t.url+=(Mo.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return a||rt.error(n+" was not called"),a[0]},t.dataTypes[0]="json",r=e[n],e[n]=function(){a=arguments},i.always(function(){e[n]=r,t[n]&&(t.jsonpCallback=o.jsonpCallback,oi.push(n)),a&&rt.isFunction(r)&&r(a[0]),a=r=void 0}),"script"):void 0}),rt.parseHTML=function(e,t,o){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(o=t,t=!1),t=t||mt;var i=ht.exec(e),n=!o&&[];return i?[t.createElement(i[1])]:(i=rt.buildFragment([e],t,n),n&&n.length&&rt(n).remove(),rt.merge([],i.childNodes))};var ni=rt.fn.load;rt.fn.load=function(e,t,o){if("string"!=typeof e&&ni)return ni.apply(this,arguments);var i,n,r,a=this,s=e.indexOf(" ");return s>=0&&(i=e.slice(s,e.length),e=e.slice(0,s)),rt.isFunction(t)?(o=t,t=void 0):t&&"object"==typeof t&&(r="POST"),a.length>0&&rt.ajax({url:e,type:r,dataType:"html",data:t}).done(function(e){n=arguments,a.html(i?rt("<div>").append(rt.parseHTML(e)).find(i):e)}).complete(o&&function(e,t){a.each(o,n||[e.responseText,t,e])}),this},rt.expr.filters.animated=function(e){return rt.grep(rt.timers,function(t){return e===t.elem}).length};var ri=e.document.documentElement;rt.offset={setOffset:function(e,t,o){var i,n,r,a,s,l,c,u=rt.css(e,"position"),d=rt(e),h={};"static"===u&&(e.style.position="relative"),s=d.offset(),r=rt.css(e,"top"),l=rt.css(e,"left"),c=("absolute"===u||"fixed"===u)&&rt.inArray("auto",[r,l])>-1,c?(i=d.position(),a=i.top,n=i.left):(a=parseFloat(r)||0,n=parseFloat(l)||0),rt.isFunction(t)&&(t=t.call(e,o,s)),null!=t.top&&(h.top=t.top-s.top+a),null!=t.left&&(h.left=t.left-s.left+n),"using"in t?t.using.call(e,h):d.css(h)}},rt.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){rt.offset.setOffset(this,e,t)});var t,o,i={top:0,left:0},n=this[0],r=n&&n.ownerDocument;return r?(t=r.documentElement,rt.contains(t,n)?(typeof n.getBoundingClientRect!==St&&(i=n.getBoundingClientRect()),o=Y(r),{top:i.top+(o.pageYOffset||t.scrollTop)-(t.clientTop||0),left:i.left+(o.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):i):void 0},position:function(){if(this[0]){var e,t,o={top:0,left:0},i=this[0];return"fixed"===rt.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),rt.nodeName(e[0],"html")||(o=e.offset()),o.top+=rt.css(e[0],"borderTopWidth",!0),o.left+=rt.css(e[0],"borderLeftWidth",!0)),{top:t.top-o.top-rt.css(i,"marginTop",!0),left:t.left-o.left-rt.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||ri;e&&!rt.nodeName(e,"html")&&"static"===rt.css(e,"position");)e=e.offsetParent;return e||ri})}}),rt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var o=/Y/.test(t);rt.fn[e]=function(i){return Pt(this,function(e,i,n){var r=Y(e);return void 0===n?r?t in r?r[t]:r.document.documentElement[i]:e[i]:void(r?r.scrollTo(o?rt(r).scrollLeft():n,o?n:rt(r).scrollTop()):e[i]=n)},e,i,arguments.length,null)}}),rt.each(["top","left"],function(e,t){rt.cssHooks[t]=T(it.pixelPosition,function(e,o){return o?(o=oo(e,t),no.test(o)?rt(e).position()[t]+"px":o):void 0})}),rt.each({Height:"height",Width:"width"},function(e,t){rt.each({padding:"inner"+e,content:t,"":"outer"+e},function(o,i){rt.fn[i]=function(i,n){var r=arguments.length&&(o||"boolean"!=typeof i),a=o||(i===!0||n===!0?"margin":"border");return Pt(this,function(t,o,i){var n;return rt.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(n=t.documentElement,Math.max(t.body["scroll"+e],n["scroll"+e],t.body["offset"+e],n["offset"+e],n["client"+e])):void 0===i?rt.css(t,o,a):rt.style(t,o,i,a)},t,r?i:void 0,r,null)}})}),rt.fn.size=function(){return this.length},rt.fn.andSelf=rt.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return rt});var ai=e.jQuery,si=e.$;return rt.noConflict=function(t){return e.$===rt&&(e.$=si),t&&e.jQuery===rt&&(e.jQuery=ai),rt},typeof t===St&&(e.jQuery=e.$=rt),rt}),function(){var e;e=function(e){var t,o;return t=!1,e(function(){var i;return i=(document.body||document.documentElement).style,t=void 0!==i.animation||void 0!==i.WebkitAnimation||void 0!==i.MozAnimation||void 0!==i.MsAnimation||void 0!==i.OAnimation,e(window).bind("keyup.vex",function(e){return 27===e.keyCode?o.closeByEscape():void 0})}),o={globalID:1,animationEndEvent:"animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",baseClassNames:{vex:"vex",content:"vex-content",overlay:"vex-overlay",close:"vex-close",closing:"vex-closing",open:"vex-open"},defaultOptions:{content:"",showCloseButton:!0,escapeButtonCloses:!0,overlayClosesOnClick:!0,appendLocation:"body",className:"",css:{},overlayClassName:"",overlayCSS:{},contentClassName:"",contentCSS:{},closeClassName:"",closeCSS:{}},open:function(t){return t=e.extend({},o.defaultOptions,t),t.id=o.globalID,o.globalID+=1,t.$vex=e("<div>").addClass(o.baseClassNames.vex).addClass(t.className).css(t.css).data({vex:t}),t.$vexOverlay=e("<div>").addClass(o.baseClassNames.overlay).addClass(t.overlayClassName).css(t.overlayCSS).data({vex:t}),t.overlayClosesOnClick&&t.$vexOverlay.bind("click.vex",function(t){return t.target===this?o.close(e(this).data().vex.id):void 0}),t.$vex.append(t.$vexOverlay),t.$vexContent=e("<div>").addClass(o.baseClassNames.content).addClass(t.contentClassName).css(t.contentCSS).append(t.content).data({vex:t}),t.$vex.append(t.$vexContent),t.showCloseButton&&(t.$closeButton=e("<div>").addClass(o.baseClassNames.close).addClass(t.closeClassName).css(t.closeCSS).data({vex:t}).bind("click.vex",function(){return o.close(e(this).data().vex.id)}),t.$vexContent.append(t.$closeButton)),e(t.appendLocation).append(t.$vex),o.setupBodyClassName(t.$vex),t.afterOpen&&t.afterOpen(t.$vexContent,t),setTimeout(function(){return t.$vexContent.trigger("vexOpen",t)},0),t.$vexContent},getAllVexes:function(){return e("."+o.baseClassNames.vex+':not(".'+o.baseClassNames.closing+'") .'+o.baseClassNames.content)},getVexByID:function(t){return o.getAllVexes().filter(function(){return e(this).data().vex.id===t})},close:function(e){var t;if(!e){if(t=o.getAllVexes().last(),!t.length)return!1;e=t.data().vex.id}return o.closeByID(e)},closeAll:function(){var t;return t=o.getAllVexes().map(function(){return e(this).data().vex.id}).toArray(),(null!=t?t.length:void 0)?(e.each(t.reverse(),function(e,t){return o.closeByID(t)}),!0):!1},closeByID:function(i){var n,r,a,s,l;return r=o.getVexByID(i),r.length?(n=r.data().vex.$vex,l=e.extend({},r.data().vex),a=function(){return l.beforeClose?l.beforeClose(r,l):void 0},s=function(){return r.trigger("vexClose",l),n.remove(),l.afterClose?l.afterClose(r,l):void 0},t?(a(),n.unbind(o.animationEndEvent).bind(o.animationEndEvent,function(){return s()}).addClass(o.baseClassNames.closing)):(a(),s()),!0):void 0},closeByEscape:function(){var t,i,n;return n=o.getAllVexes().map(function(){return e(this).data().vex.id}).toArray(),(null!=n?n.length:void 0)?(i=Math.max.apply(Math,n),t=o.getVexByID(i),t.data().vex.escapeButtonCloses!==!0?!1:o.closeByID(i)):!1},setupBodyClassName:function(t){return t.bind("vexOpen.vex",function(){return e("body").addClass(o.baseClassNames.open)}).bind("vexClose.vex",function(){return o.getAllVexes().length?void 0:e("body").removeClass(o.baseClassNames.open)})},hideLoading:function(){return e(".vex-loading-spinner").remove()},showLoading:function(){return o.hideLoading(),e("body").append('<div class="vex-loading-spinner '+o.defaultOptions.className+'"></div>')}}},"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):window.vex=e(jQuery)}.call(this),function(){var e;e=function(e,t){var o,i;return null==t?e.error("Vex is required to use vex.dialog"):(o=function(t){var o;return o={},e.each(t.serializeArray(),function(){return o[this.name]?(o[this.name].push||(o[this.name]=[o[this.name]]),o[this.name].push(this.value||"")):o[this.name]=this.value||""}),o},i={},i.buttons={YES:{text:"OK",type:"submit",className:"vex-dialog-button-primary"},NO:{text:"Cancel",type:"button",className:"vex-dialog-button-secondary",click:function(e){return e.data().vex.value=!1,t.close(e.data().vex.id)}}},i.defaultOptions={callback:function(){},afterOpen:function(){},message:"Message",input:'<input name="vex" type="hidden" value="_vex-empty-value" />',value:!1,buttons:[i.buttons.YES,i.buttons.NO],showCloseButton:!1,onSubmit:function(n){var r,a;return r=e(this),a=r.parent(),n.preventDefault(),n.stopPropagation(),a.data().vex.value=i.getFormValueOnSubmit(o(r)),t.close(a.data().vex.id)},focusFirstInput:!0},i.defaultAlertOptions={message:"Alert",buttons:[i.buttons.YES]},i.defaultConfirmOptions={message:"Confirm"},i.open=function(o){var n;return o=e.extend({},t.defaultOptions,i.defaultOptions,o),o.content=i.buildDialogForm(o),o.beforeClose=function(e){return o.callback(e.data().vex.value)},n=t.open(o),o.focusFirstInput&&n.find('input[type="submit"], textarea, input[type="date"], input[type="datetime"], input[type="datetime-local"], input[type="email"], input[type="month"], input[type="number"], input[type="password"], input[type="search"], input[type="tel"], input[type="text"], input[type="time"], input[type="url"], input[type="week"]').first().focus(),n},i.alert=function(t){return"string"==typeof t&&(t={message:t}),t=e.extend({},i.defaultAlertOptions,t),i.open(t)},i.confirm=function(t){return"string"==typeof t?e.error("dialog.confirm(options) requires options.callback."):(t=e.extend({},i.defaultConfirmOptions,t),i.open(t))},i.prompt=function(t){var o;return"string"==typeof t?e.error("dialog.prompt(options) requires options.callback."):(o={message:'<label for="vex">'+(t.label||"Prompt:")+"</label>",input:'<input name="vex" type="text" class="vex-dialog-prompt-input" placeholder="'+(t.placeholder||"")+'"  value="'+(t.value||"")+'" />'},t=e.extend({},o,t),i.open(t))},i.buildDialogForm=function(t){var o,n,r;return o=e('<form class="vex-dialog-form" />'),r=e('<div class="vex-dialog-message" />'),n=e('<div class="vex-dialog-input" />'),o.append(r.append(t.message)).append(n.append(t.input)).append(i.buttonsToDOM(t.buttons)).bind("submit.vex",t.onSubmit),o},i.getFormValueOnSubmit=function(e){return e.vex||""===e.vex?"_vex-empty-value"===e.vex?!0:e.vex:e},i.buttonsToDOM=function(o){var i;return i=e('<div class="vex-dialog-buttons" />'),e.each(o,function(n,r){return i.append(e('<input type="'+r.type+'" />').val(r.text).addClass(r.className+" vex-dialog-button "+(0===n?"vex-first ":"")+(n===o.length-1?"vex-last ":"")).bind("click.vex",function(o){return r.click?r.click(e(this).parents("."+t.baseClassNames.content),o):void 0}))}),i},i)},"function"==typeof define&&define.amd?define(["jquery","vex"],e):"object"==typeof exports?module.exports=e(require("jquery"),require("vex")):window.vex.dialog=e(window.jQuery,window.vex)}.call(this),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(t,i){var n,r,a,s=t.nodeName.toLowerCase();return"area"===s?(n=t.parentNode,r=n.name,t.href&&r&&"map"===n.nodeName.toLowerCase()?(a=e("img[usemap='#"+r+"']")[0],!!a&&o(a)):!1):(/^(input|select|textarea|button|object)$/.test(s)?!t.disabled:"a"===s?t.href||i:i)&&o(t)}function o(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}function i(e){for(var t,o;e.length&&e[0]!==document;){if(t=e.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(o=parseInt(e.css("zIndex"),10),!isNaN(o)&&0!==o))return o;e=e.parent()}return 0}function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=r(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function r(t){var o="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(o,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(o,"mouseover",a)}function a(){e.datepicker._isDisabledDatepicker(v.inline?v.dpDiv.parent()[0]:v.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function s(t,o){e.extend(t,o);for(var i in o)null==o[i]&&(t[i]=o[i]);return t}function l(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var o=this.css("position"),i="absolute"===o,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,r=this.parents().filter(function(){var t=e(this);return i&&"static"===t.css("position")?!1:n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==o&&r.length?r:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(o){return!!e.data(o,t)}}):function(t,o,i){return!!e.data(t,i[3])},focusable:function(o){return t(o,!isNaN(e.attr(o,"tabindex")))},tabbable:function(o){var i=e.attr(o,"tabindex"),n=isNaN(i);return(n||i>=0)&&t(o,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,o){function i(t,o,i,r){return e.each(n,function(){o-=parseFloat(e.css(t,"padding"+this))||0,i&&(o-=parseFloat(e.css(t,"border"+this+"Width"))||0),r&&(o-=parseFloat(e.css(t,"margin"+this))||0)}),o}var n="Width"===o?["Left","Right"]:["Top","Bottom"],r=o.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+o]=function(t){return void 0===t?a["inner"+o].call(this):this.each(function(){e(this).css(r,i(this,t)+"px")})},e.fn["outer"+o]=function(t,n){return"number"!=typeof t?a["outer"+o].call(this,t):this.each(function(){e(this).css(r,i(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(o){return arguments.length?t.call(this,e.camelCase(o)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(o,i){return"number"==typeof o?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),i&&i.call(t)},o)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var o,i,n=e(this[0]);n.length&&n[0]!==document;){if(o=n.css("position"),("absolute"===o||"relative"===o||"fixed"===o)&&(i=parseInt(n.css("zIndex"),10),!isNaN(i)&&0!==i))return i;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,o,i){var n,r=e.ui[t].prototype;for(n in i)r.plugins[n]=r.plugins[n]||[],r.plugins[n].push([o,i[n]])},call:function(e,t,o,i){var n,r=e.plugins[t];if(r&&(i||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;r.length>n;n++)e.options[r[n][0]]&&r[n][1].apply(e.element,o)}};var c=0,u=Array.prototype.slice;e.cleanData=function(t){return function(o){var i,n,r;for(r=0;null!=(n=o[r]);r++)try{i=e._data(n,"events"),i&&i.remove&&e(n).triggerHandler("remove")}catch(a){}t(o)}}(e.cleanData),e.widget=function(t,o,i){var n,r,a,s,l={},c=t.split(".")[0];return t=t.split(".")[1],n=c+"-"+t,i||(i=o,o=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[c]=e[c]||{},r=e[c][t],a=e[c][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new a(e,t)},e.extend(a,r,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),s=new o,s.options=e.widget.extend({},s.options),e.each(i,function(t,i){return e.isFunction(i)?void(l[t]=function(){var e=function(){return o.prototype[t].apply(this,arguments)},n=function(e){return o.prototype[t].apply(this,e)};return function(){var t,o=this._super,r=this._superApply;return this._super=e,this._superApply=n,t=i.apply(this,arguments),this._super=o,this._superApply=r,t}}()):void(l[t]=i)}),a.prototype=e.widget.extend(s,{widgetEventPrefix:r?s.widgetEventPrefix||t:t},l,{constructor:a,namespace:c,widgetName:t,widgetFullName:n}),r?(e.each(r._childConstructors,function(t,o){var i=o.prototype;e.widget(i.namespace+"."+i.widgetName,a,o._proto)}),delete r._childConstructors):o._childConstructors.push(a),e.widget.bridge(t,a),a},e.widget.extend=function(t){for(var o,i,n=u.call(arguments,1),r=0,a=n.length;a>r;r++)for(o in n[r])i=n[r][o],n[r].hasOwnProperty(o)&&void 0!==i&&(t[o]=e.isPlainObject(i)?e.isPlainObject(t[o])?e.widget.extend({},t[o],i):e.widget.extend({},i):i);return t},e.widget.bridge=function(t,o){var i=o.prototype.widgetFullName||t;e.fn[t]=function(n){var r="string"==typeof n,a=u.call(arguments,1),s=this;return r?this.each(function(){var o,r=e.data(this,i);return"instance"===n?(s=r,!1):r?e.isFunction(r[n])&&"_"!==n.charAt(0)?(o=r[n].apply(r,a),o!==r&&void 0!==o?(s=o&&o.jquery?s.pushStack(o.get()):o,!1):void 0):e.error("no such method '"+n+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+n+"'")}):(a.length&&(n=e.widget.extend.apply(null,[n].concat(a))),this.each(function(){var t=e.data(this,i);t?(t.option(n||{}),t._init&&t._init()):e.data(this,i,new o(n,this))})),s}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,o){o=e(o||this.defaultElement||this)[0],this.element=e(o),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),o!==this&&(e.data(o,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===o&&this.destroy()}}),this.document=e(o.style?o.ownerDocument:o.document||o),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,o){var i,n,r,a=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(a={},i=t.split("."),t=i.shift(),i.length){for(n=a[t]=e.widget.extend({},this.options[t]),r=0;i.length-1>r;r++)n[i[r]]=n[i[r]]||{},n=n[i[r]];if(t=i.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=o}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];a[t]=o}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,o,i){var n,r=this;"boolean"!=typeof t&&(i=o,o=t,t=!1),i?(o=n=e(o),this.bindings=this.bindings.add(o)):(i=o,o=this.element,n=this.widget()),e.each(i,function(i,a){function s(){return t||r.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof a?r[a]:a).apply(r,arguments):void 0}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=i.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+r.eventNamespace,u=l[2];u?n.delegate(u,c,s):o.bind(c,s)})},_off:function(t,o){o=(o||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(o).undelegate(o),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function o(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(o,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,o,i){var n,r,a=this.options[t];if(i=i||{},o=e.Event(o),o.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),o.target=this.element[0],r=o.originalEvent)for(n in r)n in o||(o[n]=r[n]);return this.element.trigger(o,i),!(e.isFunction(a)&&a.apply(this.element[0],[o].concat(i))===!1||o.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,o){e.Widget.prototype["_"+t]=function(i,n,r){"string"==typeof n&&(n={effect:n});var a,s=n?n===!0||"number"==typeof n?o:n.effect||o:t;n=n||{},"number"==typeof n&&(n={duration:n}),a=!e.isEmptyObject(n),n.complete=r,n.delay&&i.delay(n.delay),a&&e.effects&&e.effects.effect[s]?i[t](n):s!==t&&i[s]?i[s](n.duration,n.easing,r):i.queue(function(o){e(this)[t](),r&&r.call(i[0]),o()})}}),e.widget;var d=!1;e(document).mouseup(function(){d=!1}),e.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(o){return!0===e.data(o.target,t.widgetName+".preventClickEvent")?(e.removeData(o.target,t.widgetName+".preventClickEvent"),o.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!d){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var o=this,i=1===t.which,n="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return i&&!n&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){o.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return o._mouseMove(e)},this._mouseUpDelegate=function(e){return o._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),d=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),d=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function t(e,t,o){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?o/100:1)]}function o(t,o){return parseInt(e.css(t,o),10)||0}function i(t){var o=t[0];return 9===o.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(o)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:o.preventDefault?{width:0,height:0,offset:{top:o.pageY,left:o.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var n,r,a=Math.max,s=Math.abs,l=Math.round,c=/left|center|right/,u=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,h=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==n)return n;var t,o,i=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),r=i.children()[0];return e("body").append(i),t=r.offsetWidth,i.css("overflow","scroll"),o=r.offsetWidth,t===o&&(o=i[0].clientWidth),i.remove(),n=t-o},getScrollInfo:function(t){var o=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),i=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),n="scroll"===o||"auto"===o&&t.width<t.element[0].scrollWidth,r="scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight;
return{width:r?e.position.scrollbarWidth():0,height:n?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var o=e(t||window),i=e.isWindow(o[0]),n=!!o[0]&&9===o[0].nodeType;return{element:o,isWindow:i,isDocument:n,offset:o.offset()||{left:0,top:0},scrollLeft:o.scrollLeft(),scrollTop:o.scrollTop(),width:i||n?o.width():o.outerWidth(),height:i||n?o.height():o.outerHeight()}}},e.fn.position=function(n){if(!n||!n.of)return f.apply(this,arguments);n=e.extend({},n);var p,m,g,v,b,y,C=e(n.of),w=e.position.getWithinInfo(n.within),x=e.position.getScrollInfo(w),_=(n.collision||"flip").split(" "),S={};return y=i(C),C[0].preventDefault&&(n.at="left top"),m=y.width,g=y.height,v=y.offset,b=e.extend({},v),e.each(["my","at"],function(){var e,t,o=(n[this]||"").split(" ");1===o.length&&(o=c.test(o[0])?o.concat(["center"]):u.test(o[0])?["center"].concat(o):["center","center"]),o[0]=c.test(o[0])?o[0]:"center",o[1]=u.test(o[1])?o[1]:"center",e=d.exec(o[0]),t=d.exec(o[1]),S[this]=[e?e[0]:0,t?t[0]:0],n[this]=[h.exec(o[0])[0],h.exec(o[1])[0]]}),1===_.length&&(_[1]=_[0]),"right"===n.at[0]?b.left+=m:"center"===n.at[0]&&(b.left+=m/2),"bottom"===n.at[1]?b.top+=g:"center"===n.at[1]&&(b.top+=g/2),p=t(S.at,m,g),b.left+=p[0],b.top+=p[1],this.each(function(){var i,c,u=e(this),d=u.outerWidth(),h=u.outerHeight(),f=o(this,"marginLeft"),y=o(this,"marginTop"),k=d+f+o(this,"marginRight")+x.width,T=h+y+o(this,"marginBottom")+x.height,F=e.extend({},b),E=t(S.my,u.outerWidth(),u.outerHeight());"right"===n.my[0]?F.left-=d:"center"===n.my[0]&&(F.left-=d/2),"bottom"===n.my[1]?F.top-=h:"center"===n.my[1]&&(F.top-=h/2),F.left+=E[0],F.top+=E[1],r||(F.left=l(F.left),F.top=l(F.top)),i={marginLeft:f,marginTop:y},e.each(["left","top"],function(t,o){e.ui.position[_[t]]&&e.ui.position[_[t]][o](F,{targetWidth:m,targetHeight:g,elemWidth:d,elemHeight:h,collisionPosition:i,collisionWidth:k,collisionHeight:T,offset:[p[0]+E[0],p[1]+E[1]],my:n.my,at:n.at,within:w,elem:u})}),n.using&&(c=function(e){var t=v.left-F.left,o=t+m-d,i=v.top-F.top,r=i+g-h,l={target:{element:C,left:v.left,top:v.top,width:m,height:g},element:{element:u,left:F.left,top:F.top,width:d,height:h},horizontal:0>o?"left":t>0?"right":"center",vertical:0>r?"top":i>0?"bottom":"middle"};d>m&&m>s(t+o)&&(l.horizontal="center"),h>g&&g>s(i+r)&&(l.vertical="middle"),l.important=a(s(t),s(o))>a(s(i),s(r))?"horizontal":"vertical",n.using.call(this,e,l)}),u.offset(e.extend(F,{using:c}))})},e.ui.position={fit:{left:function(e,t){var o,i=t.within,n=i.isWindow?i.scrollLeft:i.offset.left,r=i.width,s=e.left-t.collisionPosition.marginLeft,l=n-s,c=s+t.collisionWidth-r-n;t.collisionWidth>r?l>0&&0>=c?(o=e.left+l+t.collisionWidth-r-n,e.left+=l-o):e.left=c>0&&0>=l?n:l>c?n+r-t.collisionWidth:n:l>0?e.left+=l:c>0?e.left-=c:e.left=a(e.left-s,e.left)},top:function(e,t){var o,i=t.within,n=i.isWindow?i.scrollTop:i.offset.top,r=t.within.height,s=e.top-t.collisionPosition.marginTop,l=n-s,c=s+t.collisionHeight-r-n;t.collisionHeight>r?l>0&&0>=c?(o=e.top+l+t.collisionHeight-r-n,e.top+=l-o):e.top=c>0&&0>=l?n:l>c?n+r-t.collisionHeight:n:l>0?e.top+=l:c>0?e.top-=c:e.top=a(e.top-s,e.top)}},flip:{left:function(e,t){var o,i,n=t.within,r=n.offset.left+n.scrollLeft,a=n.width,l=n.isWindow?n.scrollLeft:n.offset.left,c=e.left-t.collisionPosition.marginLeft,u=c-l,d=c+t.collisionWidth-a-l,h="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(o=e.left+h+p+f+t.collisionWidth-a-r,(0>o||s(u)>o)&&(e.left+=h+p+f)):d>0&&(i=e.left-t.collisionPosition.marginLeft+h+p+f-l,(i>0||d>s(i))&&(e.left+=h+p+f))},top:function(e,t){var o,i,n=t.within,r=n.offset.top+n.scrollTop,a=n.height,l=n.isWindow?n.scrollTop:n.offset.top,c=e.top-t.collisionPosition.marginTop,u=c-l,d=c+t.collisionHeight-a-l,h="top"===t.my[1],p=h?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>u?(i=e.top+p+f+m+t.collisionHeight-a-r,(0>i||s(u)>i)&&(e.top+=p+f+m)):d>0&&(o=e.top-t.collisionPosition.marginTop+p+f+m-l,(o>0||d>s(o))&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,o,i,n,a,s=document.getElementsByTagName("body")[0],l=document.createElement("div");t=document.createElement(s?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},s&&e.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"});for(a in i)t.style[a]=i[a];t.appendChild(l),o=s||document.documentElement,o.insertBefore(t,o.firstChild),l.style.cssText="position: absolute; left: 10.7432222px;",n=e(l).offset().left,r=n>10&&11>n,t.innerHTML="",o.removeChild(t)}()}(),e.ui.position,e.widget("ui.draggable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(t){var o=this.options;return this._blurActiveElement(t),this.helper||o.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(this._blockFrames(o.iframeFix===!0?"iframe":o.iframeFix),!0):!1)},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var o=this.document[0];if(this.handleElement.is(t.target))try{o.activeElement&&"body"!==o.activeElement.nodeName.toLowerCase()&&e(o.activeElement).blur()}catch(i){}},_mouseStart:function(t){var o=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,o){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!o){var i=this._uiHash();if(this._trigger("drag",t,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var o=this,i=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(i=e.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){o._trigger("stop",t)!==!1&&o._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var o=this.options,i=e.isFunction(o.helper),n=i?e(o.helper.apply(this.element[0],[t])):"clone"===o.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===o.appendTo?this.element[0].parentNode:o.appendTo),i&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),o=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==o&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,o,i,n=this.options,r=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===n.containment?void(this.containment=[0,0,e(r).width()-this.helperProportions.width-this.margins.left,(e(r).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):n.containment.constructor===Array?void(this.containment=n.containment):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),o=e(n.containment),i=o[0],void(i&&(t=/(scroll|auto)/.test(o.css("overflow")),this.containment=[(parseInt(o.css("borderLeftWidth"),10)||0)+(parseInt(o.css("paddingLeft"),10)||0),(parseInt(o.css("borderTopWidth"),10)||0)+(parseInt(o.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(o.css("borderRightWidth"),10)||0)-(parseInt(o.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(o.css("borderBottomWidth"),10)||0)-(parseInt(o.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=o))):void(this.containment=null)},_convertPositionTo:function(e,t){t||(t=this.position);var o="absolute"===e?1:-1,i=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*o+this.offset.parent.top*o-("fixed"===this.cssPosition?-this.offset.scroll.top:i?0:this.offset.scroll.top)*o,left:t.left+this.offset.relative.left*o+this.offset.parent.left*o-("fixed"===this.cssPosition?-this.offset.scroll.left:i?0:this.offset.scroll.left)*o}},_generatePosition:function(e,t){var o,i,n,r,a=this.options,s=this._isRootNode(this.scrollParent[0]),l=e.pageX,c=e.pageY;return s&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(i=this.relativeContainer.offset(),o=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):o=this.containment,e.pageX-this.offset.click.left<o[0]&&(l=o[0]+this.offset.click.left),e.pageY-this.offset.click.top<o[1]&&(c=o[1]+this.offset.click.top),e.pageX-this.offset.click.left>o[2]&&(l=o[2]+this.offset.click.left),e.pageY-this.offset.click.top>o[3]&&(c=o[3]+this.offset.click.top)),a.grid&&(n=a.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,c=o?n-this.offset.click.top>=o[1]||n-this.offset.click.top>o[3]?n:n-this.offset.click.top>=o[1]?n-a.grid[1]:n+a.grid[1]:n,r=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=o?r-this.offset.click.left>=o[0]||r-this.offset.click.left>o[2]?r:r-this.offset.click.left>=o[0]?r-a.grid[0]:r+a.grid[0]:r),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,o,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[o,i,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,o,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,o,i){var n=e.extend({},o,{item:i.element});i.sortables=[],e(i.options.connectToSortable).each(function(){var o=e(this).sortable("instance");o&&!o.options.disabled&&(i.sortables.push(o),o.refreshPositions(),o._trigger("activate",t,n))})},stop:function(t,o,i){var n=e.extend({},o,{item:i.element});i.cancelHelperRemoval=!1,e.each(i.sortables,function(){var e=this;e.isOver?(e.isOver=0,i.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,n))})},drag:function(t,o,i){e.each(i.sortables,function(){var n=!1,r=this;r.positionAbs=i.positionAbs,r.helperProportions=i.helperProportions,r.offset.click=i.offset.click,r._intersectsWith(r.containerCache)&&(n=!0,e.each(i.sortables,function(){return this.positionAbs=i.positionAbs,this.helperProportions=i.helperProportions,this.offset.click=i.offset.click,this!==r&&this._intersectsWith(this.containerCache)&&e.contains(r.element[0],this.element[0])&&(n=!1),n})),n?(r.isOver||(r.isOver=1,i._parent=o.helper.parent(),r.currentItem=o.helper.appendTo(r.element).data("ui-sortable-item",!0),r.options._helper=r.options.helper,r.options.helper=function(){return o.helper[0]},t.target=r.currentItem[0],r._mouseCapture(t,!0),r._mouseStart(t,!0,!0),r.offset.click.top=i.offset.click.top,r.offset.click.left=i.offset.click.left,r.offset.parent.left-=i.offset.parent.left-r.offset.parent.left,r.offset.parent.top-=i.offset.parent.top-r.offset.parent.top,i._trigger("toSortable",t),i.dropped=r.element,e.each(i.sortables,function(){this.refreshPositions()}),i.currentItem=i.element,r.fromOutside=i),r.currentItem&&(r._mouseDrag(t),o.position=r.position)):r.isOver&&(r.isOver=0,r.cancelHelperRemoval=!0,r.options._revert=r.options.revert,r.options.revert=!1,r._trigger("out",t,r._uiHash(r)),r._mouseStop(t,!0),r.options.revert=r.options._revert,r.options.helper=r.options._helper,r.placeholder&&r.placeholder.remove(),o.helper.appendTo(i._parent),i._refreshOffsets(t),o.position=i._generatePosition(t,!0),i._trigger("fromSortable",t),i.dropped=!1,e.each(i.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,o,i){var n=e("body"),r=i.options;n.css("cursor")&&(r._cursor=n.css("cursor")),n.css("cursor",r.cursor)},stop:function(t,o,i){var n=i.options;n._cursor&&e("body").css("cursor",n._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,o,i){var n=e(o.helper),r=i.options;n.css("opacity")&&(r._opacity=n.css("opacity")),n.css("opacity",r.opacity)},stop:function(t,o,i){var n=i.options;n._opacity&&e(o.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,o){o.scrollParentNotHidden||(o.scrollParentNotHidden=o.helper.scrollParent(!1)),o.scrollParentNotHidden[0]!==o.document[0]&&"HTML"!==o.scrollParentNotHidden[0].tagName&&(o.overflowOffset=o.scrollParentNotHidden.offset())},drag:function(t,o,i){var n=i.options,r=!1,a=i.scrollParentNotHidden[0],s=i.document[0];a!==s&&"HTML"!==a.tagName?(n.axis&&"x"===n.axis||(i.overflowOffset.top+a.offsetHeight-t.pageY<n.scrollSensitivity?a.scrollTop=r=a.scrollTop+n.scrollSpeed:t.pageY-i.overflowOffset.top<n.scrollSensitivity&&(a.scrollTop=r=a.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(i.overflowOffset.left+a.offsetWidth-t.pageX<n.scrollSensitivity?a.scrollLeft=r=a.scrollLeft+n.scrollSpeed:t.pageX-i.overflowOffset.left<n.scrollSensitivity&&(a.scrollLeft=r=a.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-e(s).scrollTop()<n.scrollSensitivity?r=e(s).scrollTop(e(s).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(s).scrollTop())<n.scrollSensitivity&&(r=e(s).scrollTop(e(s).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-e(s).scrollLeft()<n.scrollSensitivity?r=e(s).scrollLeft(e(s).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(s).scrollLeft())<n.scrollSensitivity&&(r=e(s).scrollLeft(e(s).scrollLeft()+n.scrollSpeed)))),r!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,o,i){var n=i.options;i.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var t=e(this),o=t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:o.top,left:o.left})})},drag:function(t,o,i){var n,r,a,s,l,c,u,d,h,p,f=i.options,m=f.snapTolerance,g=o.offset.left,v=g+i.helperProportions.width,b=o.offset.top,y=b+i.helperProportions.height;for(h=i.snapElements.length-1;h>=0;h--)l=i.snapElements[h].left-i.margins.left,c=l+i.snapElements[h].width,u=i.snapElements[h].top-i.margins.top,d=u+i.snapElements[h].height,l-m>v||g>c+m||u-m>y||b>d+m||!e.contains(i.snapElements[h].item.ownerDocument,i.snapElements[h].item)?(i.snapElements[h].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[h].item})),i.snapElements[h].snapping=!1):("inner"!==f.snapMode&&(n=m>=Math.abs(u-y),r=m>=Math.abs(d-b),a=m>=Math.abs(l-v),s=m>=Math.abs(c-g),n&&(o.position.top=i._convertPositionTo("relative",{top:u-i.helperProportions.height,left:0}).top),r&&(o.position.top=i._convertPositionTo("relative",{top:d,left:0}).top),a&&(o.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left),s&&(o.position.left=i._convertPositionTo("relative",{top:0,left:c}).left)),p=n||r||a||s,"outer"!==f.snapMode&&(n=m>=Math.abs(u-b),r=m>=Math.abs(d-y),a=m>=Math.abs(l-g),s=m>=Math.abs(c-v),n&&(o.position.top=i._convertPositionTo("relative",{top:u,left:0}).top),r&&(o.position.top=i._convertPositionTo("relative",{top:d-i.helperProportions.height,left:0}).top),a&&(o.position.left=i._convertPositionTo("relative",{top:0,left:l}).left),s&&(o.position.left=i._convertPositionTo("relative",{top:0,left:c-i.helperProportions.width}).left)),!i.snapElements[h].snapping&&(n||r||a||s||p)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[h].item})),i.snapElements[h].snapping=n||r||a||s||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,o,i){var n,r=i.options,a=e.makeArray(e(r.stack)).sort(function(t,o){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(o).css("zIndex"),10)||0)});a.length&&(n=parseInt(e(a[0]).css("zIndex"),10)||0,e(a).each(function(t){e(this).css("zIndex",n+t)}),this.css("zIndex",n+a.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,o,i){var n=e(o.helper),r=i.options;n.css("zIndex")&&(r._zIndex=n.css("zIndex")),n.css("zIndex",r.zIndex)},stop:function(t,o,i){var n=i.options;n._zIndex&&e(o.helper).css("zIndex",n._zIndex)}}),e.ui.draggable,e.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,o=this.options,i=o.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(i)?i:function(e){return e.is(i)},this.proportions=function(){return arguments.length?void(t=arguments[0]):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(o.scope),o.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,o){if("accept"===t)this.accept=e.isFunction(o)?o:function(e){return e.is(o)};else if("scope"===t){var i=e.ui.ddmanager.droppables[this.options.scope];this._splice(i),this._addToManager(o)}this._super(t,o)},_activate:function(t){var o=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),o&&this._trigger("activate",t,this.ui(o))},_deactivate:function(t){var o=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),o&&this._trigger("deactivate",t,this.ui(o))},_over:function(t){var o=e.ui.ddmanager.current;o&&(o.currentItem||o.element)[0]!==this.element[0]&&this.accept.call(this.element[0],o.currentItem||o.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(o)))},_out:function(t){var o=e.ui.ddmanager.current;o&&(o.currentItem||o.element)[0]!==this.element[0]&&this.accept.call(this.element[0],o.currentItem||o.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(o)))},_drop:function(t,o){var i=o||e.ui.ddmanager.current,n=!1;return i&&(i.currentItem||i.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var o=e(this).droppable("instance");return o.options.greedy&&!o.options.disabled&&o.options.scope===i.options.scope&&o.accept.call(o.element[0],i.currentItem||i.element)&&e.ui.intersect(i,e.extend(o,{offset:o.element.offset()}),o.options.tolerance,t)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],i.currentItem||i.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(i)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,o){return e>=t&&t+o>e}return function(t,o,i,n){if(!o.offset)return!1;var r=(t.positionAbs||t.position.absolute).left+t.margins.left,a=(t.positionAbs||t.position.absolute).top+t.margins.top,s=r+t.helperProportions.width,l=a+t.helperProportions.height,c=o.offset.left,u=o.offset.top,d=c+o.proportions().width,h=u+o.proportions().height;switch(i){case"fit":return r>=c&&d>=s&&a>=u&&h>=l;case"intersect":return r+t.helperProportions.width/2>c&&d>s-t.helperProportions.width/2&&a+t.helperProportions.height/2>u&&h>l-t.helperProportions.height/2;case"pointer":return e(n.pageY,u,o.proportions().height)&&e(n.pageX,c,o.proportions().width);case"touch":return(a>=u&&h>=a||l>=u&&h>=l||u>a&&l>h)&&(r>=c&&d>=r||s>=c&&d>=s||c>r&&s>d);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,o){var i,n,r=e.ui.ddmanager.droppables[t.options.scope]||[],a=o?o.type:null,s=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(i=0;r.length>i;i++)if(!(r[i].options.disabled||t&&!r[i].accept.call(r[i].element[0],t.currentItem||t.element))){for(n=0;s.length>n;n++)if(s[n]===r[i].element[0]){r[i].proportions().height=0;continue e}r[i].visible="none"!==r[i].element.css("display"),r[i].visible&&("mousedown"===a&&r[i]._activate.call(r[i],o),r[i].offset=r[i].element.offset(),r[i].proportions({width:r[i].element[0].offsetWidth,height:r[i].element[0].offsetHeight}))}},drop:function(t,o){var i=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,o)&&(i=this._drop.call(this,o)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,o)))}),i},dragStart:function(t,o){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,o)})},drag:function(t,o){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,o),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var i,n,r,a=e.ui.intersect(t,this,this.options.tolerance,o),s=!a&&this.isover?"isout":a&&!this.isover?"isover":null;s&&(this.options.greedy&&(n=this.options.scope,r=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===n}),r.length&&(i=e(r[0]).droppable("instance"),i.greedyChild="isover"===s)),i&&"isover"===s&&(i.isover=!1,i.isout=!0,i._out.call(i,o)),this[s]=!0,this["isout"===s?"isover":"isout"]=!1,this["isover"===s?"_over":"_out"].call(this,o),i&&"isout"===s&&(i.isout=!1,i.isover=!0,i._over.call(i,o)))}})},dragStop:function(t,o){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,o)}},e.ui.droppable,e.widget("ui.resizable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,o){if("hidden"===e(t).css("overflow"))return!1;var i=o&&"left"===o?"scrollLeft":"scrollTop",n=!1;return t[i]>0?!0:(t[i]=1,n=t[i]>0,t[i]=0,n)},_create:function(){var t,o,i,n,r,a=this,s=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!s.aspectRatio,aspectRatio:s.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:s.helper||s.ghost||s.animate?s.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=s.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=e(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},o=0;t.length>o;o++)i=e.trim(t[o]),r="ui-resizable-"+i,n=e("<div class='ui-resizable-handle "+r+"'></div>"),n.css({zIndex:s.zIndex}),"se"===i&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[i]=".ui-resizable-"+i,this.element.append(n);this._renderAxis=function(t){var o,i,n,r;t=t||this.element;
for(o in this.handles)this.handles[o].constructor===String?this.handles[o]=this.element.children(this.handles[o]).first().show():(this.handles[o].jquery||this.handles[o].nodeType)&&(this.handles[o]=e(this.handles[o]),this._on(this.handles[o],{mousedown:a._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(i=e(this.handles[o],this.element),r=/sw|ne|nw|se|n|s/.test(o)?i.outerHeight():i.outerWidth(),n=["padding",/ne|nw|n/.test(o)?"Top":/se|sw|s/.test(o)?"Bottom":/^e$/.test(o)?"Right":"Left"].join(""),t.css(n,r),this._proportionallyResize()),this._handles=this._handles.add(this.handles[o])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.mouseover(function(){a.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=n&&n[1]?n[1]:"se")}),s.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){s.disabled||(e(this).removeClass("ui-resizable-autohide"),a._handles.show())}).mouseleave(function(){s.disabled||a.resizing||(e(this).addClass("ui-resizable-autohide"),a._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,o=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(o(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),o(this.originalElement),this},_mouseCapture:function(t){var o,i,n=!1;for(o in this.handles)i=e(this.handles[o])[0],(i===t.target||e.contains(i,t.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var o,i,n,r=this.options,a=this.element;return this.resizing=!0,this._renderProxy(),o=this._num(this.helper.css("left")),i=this._num(this.helper.css("top")),r.containment&&(o+=e(r.containment).scrollLeft()||0,i+=e(r.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:o,top:i},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalPosition={left:o,top:i},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof r.aspectRatio?r.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===n?this.axis+"-resize":n),a.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var o,i,n=this.originalMousePosition,r=this.axis,a=t.pageX-n.left||0,s=t.pageY-n.top||0,l=this._change[r];return this._updatePrevProperties(),l?(o=l.apply(this,[t,a,s]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(o=this._updateRatio(o,t)),o=this._respectSize(o,t),this._updateCache(o),this._propagate("resize",t),i=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(i)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(t){this.resizing=!1;var o,i,n,r,a,s,l,c=this.options,u=this;return this._helper&&(o=this._proportionallyResizeElements,i=o.length&&/textarea/i.test(o[0].nodeName),n=i&&this._hasScroll(o[0],"left")?0:u.sizeDiff.height,r=i?0:u.sizeDiff.width,a={width:u.helper.width()-r,height:u.helper.height()-n},s=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,l=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,c.animate||this.element.css(e.extend(a,{top:l,left:s})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!c.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,o,i,n,r,a=this.options;r={minWidth:this._isNumber(a.minWidth)?a.minWidth:0,maxWidth:this._isNumber(a.maxWidth)?a.maxWidth:1/0,minHeight:this._isNumber(a.minHeight)?a.minHeight:0,maxHeight:this._isNumber(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||e)&&(t=r.minHeight*this.aspectRatio,i=r.minWidth/this.aspectRatio,o=r.maxHeight*this.aspectRatio,n=r.maxWidth/this.aspectRatio,t>r.minWidth&&(r.minWidth=t),i>r.minHeight&&(r.minHeight=i),r.maxWidth>o&&(r.maxWidth=o),r.maxHeight>n&&(r.maxHeight=n)),this._vBoundaries=r},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,o=this.size,i=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===i&&(e.left=t.left+(o.width-e.width),e.top=null),"nw"===i&&(e.top=t.top+(o.height-e.height),e.left=t.left+(o.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,o=this.axis,i=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,n=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,r=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,a=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,s=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,c=/sw|nw|w/.test(o),u=/nw|ne|n/.test(o);return r&&(e.width=t.minWidth),a&&(e.height=t.minHeight),i&&(e.width=t.maxWidth),n&&(e.height=t.maxHeight),r&&c&&(e.left=s-t.minWidth),i&&c&&(e.left=s-t.maxWidth),a&&u&&(e.top=l-t.minHeight),n&&u&&(e.top=l-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,o=[],i=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],n=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];4>t;t++)o[t]=parseInt(i[t],10)||0,o[t]+=parseInt(n[t],10)||0;return{height:o[0]+o[2],width:o[1]+o[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,o=this.helper||this.element;this._proportionallyResizeElements.length>t;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:o.height()-this.outerDimensions.height||0,width:o.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,o=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++o.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var o=this.originalSize,i=this.originalPosition;return{left:i.left+t,width:o.width-t}},n:function(e,t,o){var i=this.originalSize,n=this.originalPosition;return{top:n.top+o,height:i.height-o}},s:function(e,t,o){return{height:this.originalSize.height+o}},se:function(t,o,i){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,o,i]))},sw:function(t,o,i){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,o,i]))},ne:function(t,o,i){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,o,i]))},nw:function(t,o,i){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,o,i]))}},_propagate:function(t,o){e.ui.plugin.call(this,t,[o,this.ui()]),"resize"!==t&&this._trigger(t,o,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var o=e(this).resizable("instance"),i=o.options,n=o._proportionallyResizeElements,r=n.length&&/textarea/i.test(n[0].nodeName),a=r&&o._hasScroll(n[0],"left")?0:o.sizeDiff.height,s=r?0:o.sizeDiff.width,l={width:o.size.width-s,height:o.size.height-a},c=parseInt(o.element.css("left"),10)+(o.position.left-o.originalPosition.left)||null,u=parseInt(o.element.css("top"),10)+(o.position.top-o.originalPosition.top)||null;o.element.animate(e.extend(l,u&&c?{top:u,left:c}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var i={width:parseInt(o.element.css("width"),10),height:parseInt(o.element.css("height"),10),top:parseInt(o.element.css("top"),10),left:parseInt(o.element.css("left"),10)};n&&n.length&&e(n[0]).css({width:i.width,height:i.height}),o._updateCache(i),o._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,o,i,n,r,a,s,l=e(this).resizable("instance"),c=l.options,u=l.element,d=c.containment,h=d instanceof e?d.get(0):/parent/.test(d)?u.parent().get(0):d;h&&(l.containerElement=e(h),/document/.test(d)||d===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(h),o=[],e(["Top","Right","Left","Bottom"]).each(function(e,i){o[e]=l._num(t.css("padding"+i))}),l.containerOffset=t.offset(),l.containerPosition=t.position(),l.containerSize={height:t.innerHeight()-o[3],width:t.innerWidth()-o[1]},i=l.containerOffset,n=l.containerSize.height,r=l.containerSize.width,a=l._hasScroll(h,"left")?h.scrollWidth:r,s=l._hasScroll(h)?h.scrollHeight:n,l.parentData={element:h,left:i.left,top:i.top,width:a,height:s}))},resize:function(t){var o,i,n,r,a=e(this).resizable("instance"),s=a.options,l=a.containerOffset,c=a.position,u=a._aspectRatio||t.shiftKey,d={top:0,left:0},h=a.containerElement,p=!0;h[0]!==document&&/static/.test(h.css("position"))&&(d=l),c.left<(a._helper?l.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-l.left:a.position.left-d.left),u&&(a.size.height=a.size.width/a.aspectRatio,p=!1),a.position.left=s.helper?l.left:0),c.top<(a._helper?l.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-l.top:a.position.top),u&&(a.size.width=a.size.height*a.aspectRatio,p=!1),a.position.top=a._helper?l.top:0),n=a.containerElement.get(0)===a.element.parent().get(0),r=/relative|absolute/.test(a.containerElement.css("position")),n&&r?(a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top):(a.offset.left=a.element.offset().left,a.offset.top=a.element.offset().top),o=Math.abs(a.sizeDiff.width+(a._helper?a.offset.left-d.left:a.offset.left-l.left)),i=Math.abs(a.sizeDiff.height+(a._helper?a.offset.top-d.top:a.offset.top-l.top)),o+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-o,u&&(a.size.height=a.size.width/a.aspectRatio,p=!1)),i+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-i,u&&(a.size.width=a.size.height*a.aspectRatio,p=!1)),p||(a.position.left=a.prevPosition.left,a.position.top=a.prevPosition.top,a.size.width=a.prevSize.width,a.size.height=a.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),o=t.options,i=t.containerOffset,n=t.containerPosition,r=t.containerElement,a=e(t.helper),s=a.offset(),l=a.outerWidth()-t.sizeDiff.width,c=a.outerHeight()-t.sizeDiff.height;t._helper&&!o.animate&&/relative/.test(r.css("position"))&&e(this).css({left:s.left-n.left-i.left,width:l,height:c}),t._helper&&!o.animate&&/static/.test(r.css("position"))&&e(this).css({left:s.left-n.left-i.left,width:l,height:c})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),o=t.options;e(o.alsoResize).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})},resize:function(t,o){var i=e(this).resizable("instance"),n=i.options,r=i.originalSize,a=i.originalPosition,s={height:i.size.height-r.height||0,width:i.size.width-r.width||0,top:i.position.top-a.top||0,left:i.position.left-a.left||0};e(n.alsoResize).each(function(){var t=e(this),i=e(this).data("ui-resizable-alsoresize"),n={},r=t.parents(o.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(r,function(e,t){var o=(i[t]||0)+(s[t]||0);o&&o>=0&&(n[t]=o||null)}),t.css(n)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),o=t.options,i=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof o.ghost?o.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,o=e(this).resizable("instance"),i=o.options,n=o.size,r=o.originalSize,a=o.originalPosition,s=o.axis,l="number"==typeof i.grid?[i.grid,i.grid]:i.grid,c=l[0]||1,u=l[1]||1,d=Math.round((n.width-r.width)/c)*c,h=Math.round((n.height-r.height)/u)*u,p=r.width+d,f=r.height+h,m=i.maxWidth&&p>i.maxWidth,g=i.maxHeight&&f>i.maxHeight,v=i.minWidth&&i.minWidth>p,b=i.minHeight&&i.minHeight>f;i.grid=l,v&&(p+=c),b&&(f+=u),m&&(p-=c),g&&(f-=u),/^(se|s|e)$/.test(s)?(o.size.width=p,o.size.height=f):/^(ne)$/.test(s)?(o.size.width=p,o.size.height=f,o.position.top=a.top-h):/^(sw)$/.test(s)?(o.size.width=p,o.size.height=f,o.position.left=a.left-d):((0>=f-u||0>=p-c)&&(t=o._getPaddingPlusBorderDimensions(this)),f-u>0?(o.size.height=f,o.position.top=a.top-h):(f=u-t.height,o.size.height=f,o.position.top=a.top+r.height-f),p-c>0?(o.size.width=p,o.position.left=a.left-d):(p=c-t.width,o.size.width=p,o.position.left=a.left+r.width-p))}}),e.ui.resizable,e.widget("ui.selectable",e.ui.mouse,{version:"1.11.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,o=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(o.options.filter,o.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),o=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:o.left,top:o.top,right:o.left+t.outerWidth(),bottom:o.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var o=this,i=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(i.filter,this.element[0]),this._trigger("start",t),e(i.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),i.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var i=e.data(this,"selectable-item");i.startselected=!0,t.metaKey||t.ctrlKey||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,o._trigger("unselecting",t,{unselecting:i.element}))}),e(t.target).parents().addBack().each(function(){var i,n=e.data(this,"selectable-item");return n?(i=!t.metaKey&&!t.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(i?"ui-unselecting":"ui-selected").addClass(i?"ui-selecting":"ui-unselecting"),n.unselecting=!i,n.selecting=i,n.selected=i,i?o._trigger("selecting",t,{selecting:n.element}):o._trigger("unselecting",t,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var o,i=this,n=this.options,r=this.opos[0],a=this.opos[1],s=t.pageX,l=t.pageY;return r>s&&(o=s,s=r,r=o),a>l&&(o=l,l=a,a=o),this.helper.css({left:r,top:a,width:s-r,height:l-a}),this.selectees.each(function(){var o=e.data(this,"selectable-item"),c=!1;o&&o.element!==i.element[0]&&("touch"===n.tolerance?c=!(o.left>s||r>o.right||o.top>l||a>o.bottom):"fit"===n.tolerance&&(c=o.left>r&&s>o.right&&o.top>a&&l>o.bottom),c?(o.selected&&(o.$element.removeClass("ui-selected"),o.selected=!1),o.unselecting&&(o.$element.removeClass("ui-unselecting"),o.unselecting=!1),o.selecting||(o.$element.addClass("ui-selecting"),o.selecting=!0,i._trigger("selecting",t,{selecting:o.element}))):(o.selecting&&((t.metaKey||t.ctrlKey)&&o.startselected?(o.$element.removeClass("ui-selecting"),o.selecting=!1,o.$element.addClass("ui-selected"),o.selected=!0):(o.$element.removeClass("ui-selecting"),o.selecting=!1,o.startselected&&(o.$element.addClass("ui-unselecting"),o.unselecting=!0),i._trigger("unselecting",t,{unselecting:o.element}))),o.selected&&(t.metaKey||t.ctrlKey||o.startselected||(o.$element.removeClass("ui-selected"),o.selected=!1,o.$element.addClass("ui-unselecting"),o.unselecting=!0,i._trigger("unselecting",t,{unselecting:o.element})))))}),!1}},_mouseStop:function(t){var o=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var i=e.data(this,"selectable-item");i.$element.removeClass("ui-unselecting"),i.unselecting=!1,i.startselected=!1,o._trigger("unselected",t,{unselected:i.element})}),e(".ui-selecting",this.element[0]).each(function(){var i=e.data(this,"selectable-item");i.$element.removeClass("ui-selecting").addClass("ui-selected"),i.selecting=!1,i.selected=!0,i.startselected=!0,o._trigger("selected",t,{selected:i.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),e.widget("ui.sortable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,o){return e>=t&&t+o>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,o){var i=null,n=!1,r=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,r.widgetName+"-item")===r?(i=e(this),!1):void 0}),e.data(t.target,r.widgetName+"-item")===r&&(i=e(t.target)),i&&(!this.options.handle||o||(e(this.options.handle,i).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n))?(this.currentItem=i,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(t,o,i){var n,r,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(r=this.document.find("body"),this.storedCursor=r.css("cursor"),r.css("cursor",a.cursor),this.storedStylesheet=e("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(r)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var o,i,n,r,a=this.options,s=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop+a.scrollSpeed:t.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft+a.scrollSpeed:t.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(t.pageY-this.document.scrollTop()<a.scrollSensitivity?s=this.document.scrollTop(this.document.scrollTop()-a.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<a.scrollSensitivity&&(s=this.document.scrollTop(this.document.scrollTop()+a.scrollSpeed)),t.pageX-this.document.scrollLeft()<a.scrollSensitivity?s=this.document.scrollLeft(this.document.scrollLeft()-a.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<a.scrollSensitivity&&(s=this.document.scrollLeft(this.document.scrollLeft()+a.scrollSpeed))),s!==!1&&e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),o=this.items.length-1;o>=0;o--)if(i=this.items[o],n=i.item[0],r=this._intersectsWithPointer(i),r&&i.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===r?"next":"prev"]()[0]!==n&&!e.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],n):!0)){if(this.direction=1===r?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(t,i),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,o){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var i=this,n=this.placeholder.offset(),r=this.options.axis,a={};r&&"x"!==r||(a.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),r&&"y"!==r||(a.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){i._clear(t)})}else this._clear(t,o);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var o=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e(o).each(function(){var o=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);o&&i.push((t.key||o[1]+"[]")+"="+(t.key&&t.expression?o[1]:o[2]))}),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(t){var o=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},o.each(function(){i.push(e(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(e){var t=this.positionAbs.left,o=t+this.helperProportions.width,i=this.positionAbs.top,n=i+this.helperProportions.height,r=e.left,a=r+e.width,s=e.top,l=s+e.height,c=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||i+c>s&&l>i+c,h="y"===this.options.axis||t+u>r&&a>t+u,p=d&&h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:t+this.helperProportions.width/2>r&&a>o-this.helperProportions.width/2&&i+this.helperProportions.height/2>s&&l>n-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),o="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),i=t&&o,n=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return i?this.floating?r&&"right"===r||"down"===n?2:1:n&&("down"===n?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),o=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),i=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&o||"left"===n&&!o:i&&("down"===i&&t||"up"===i&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function o(){s.push(this)}var i,n,r,a,s=[],l=[],c=this._connectWith();if(c&&t)for(i=c.length-1;i>=0;i--)for(r=e(c[i],this.document[0]),n=r.length-1;n>=0;n--)a=e.data(r[n],this.widgetFullName),a&&a!==this&&!a.options.disabled&&l.push([e.isFunction(a.options.items)?a.options.items.call(a.element):e(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a]);for(l.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=l.length-1;i>=0;i--)l[i][0].each(o);return e(s)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var o=0;t.length>o;o++)if(t[o]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var o,i,n,r,a,s,l,c,u=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(o=h.length-1;o>=0;o--)for(n=e(h[o],this.document[0]),i=n.length-1;i>=0;i--)r=e.data(n[i],this.widgetFullName),r&&r!==this&&!r.options.disabled&&(d.push([e.isFunction(r.options.items)?r.options.items.call(r.element[0],t,{item:this.currentItem}):e(r.options.items,r.element),r]),this.containers.push(r));for(o=d.length-1;o>=0;o--)for(a=d[o][1],s=d[o][0],i=0,c=s.length;c>i;i++)l=e(s[i]),l.data(this.widgetName+"-item",a),u.push({item:l,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var o,i,n,r;for(o=this.items.length-1;o>=0;o--)i=this.items[o],i.instance!==this.currentContainer&&this.currentContainer&&i.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?e(this.options.toleranceElement,i.item):i.item,t||(i.width=n.outerWidth(),i.height=n.outerHeight()),r=n.offset(),i.left=r.left,i.top=r.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(o=this.containers.length-1;o>=0;o--)r=this.containers[o].element.offset(),this.containers[o].containerCache.left=r.left,this.containers[o].containerCache.top=r.top,this.containers[o].containerCache.width=this.containers[o].element.outerWidth(),this.containers[o].containerCache.height=this.containers[o].element.outerHeight();
return this},_createPlaceholder:function(t){t=t||this;var o,i=t.options;i.placeholder&&i.placeholder.constructor!==String||(o=i.placeholder,i.placeholder={element:function(){var i=t.currentItem[0].nodeName.toLowerCase(),n=e("<"+i+">",t.document[0]).addClass(o||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===i?t._createTrPlaceholder(t.currentItem.find("tr").eq(0),e("<tr>",t.document[0]).appendTo(n)):"tr"===i?t._createTrPlaceholder(t.currentItem,n):"img"===i&&n.attr("src",t.currentItem.attr("src")),o||n.css("visibility","hidden"),n},update:function(e,n){(!o||i.forcePlaceholderSize)&&(n.height()||n.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(i.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),i.placeholder.update(t,t.placeholder)},_createTrPlaceholder:function(t,o){var i=this;t.children().each(function(){e("<td>&#160;</td>",i.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(o)})},_contactContainers:function(t){var o,i,n,r,a,s,l,c,u,d,h=null,p=null;for(o=this.containers.length-1;o>=0;o--)if(!e.contains(this.currentItem[0],this.containers[o].element[0]))if(this._intersectsWith(this.containers[o].containerCache)){if(h&&e.contains(this.containers[o].element[0],h.element[0]))continue;h=this.containers[o],p=o}else this.containers[o].containerCache.over&&(this.containers[o]._trigger("out",t,this._uiHash(this)),this.containers[o].containerCache.over=0);if(h)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,r=null,u=h.floating||this._isFloating(this.currentItem),a=u?"left":"top",s=u?"width":"height",d=u?"clientX":"clientY",i=this.items.length-1;i>=0;i--)e.contains(this.containers[p].element[0],this.items[i].item[0])&&this.items[i].item[0]!==this.currentItem[0]&&(l=this.items[i].item.offset()[a],c=!1,t[d]-l>this.items[i][s]/2&&(c=!0),n>Math.abs(t[d]-l)&&(n=Math.abs(t[d]-l),r=this.items[i],this.direction=c?"up":"down"));if(!r&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return void(this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1));r?this._rearrange(t,r,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var o=this.options,i=e.isFunction(o.helper)?e(o.helper.apply(this.element[0],[t,this.currentItem])):"clone"===o.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||e("parent"!==o.appendTo?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!i[0].style.width||o.forceHelperSize)&&i.width(this.currentItem.width()),(!i[0].style.height||o.forceHelperSize)&&i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,o,i,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=e(n.containment)[0],o=e(n.containment).offset(),i="hidden"!==e(t).css("overflow"),this.containment=[o.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,o.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,o.left+(i?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,o.top+(i?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,o){o||(o=this.position);var i="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(n[0].tagName);return{top:o.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:n.scrollTop())*i,left:o.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:n.scrollLeft())*i}},_generatePosition:function(t){var o,i,n=this.options,r=t.pageX,a=t.pageY,s="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(s[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),n.grid&&(o=this.originalPageY+Math.round((a-this.originalPageY)/n.grid[1])*n.grid[1],a=this.containment?o-this.offset.click.top>=this.containment[1]&&o-this.offset.click.top<=this.containment[3]?o:o-this.offset.click.top>=this.containment[1]?o-n.grid[1]:o+n.grid[1]:o,i=this.originalPageX+Math.round((r-this.originalPageX)/n.grid[0])*n.grid[0],r=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-n.grid[0]:i+n.grid[0]:i)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:s.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:s.scrollLeft())}},_rearrange:function(e,t,o,i){o?o[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!i)})},_clear:function(e,t){function o(e,t,o){return function(i){o._trigger(e,i,t._uiHash(t))}}this.reverting=!1;var i,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)("auto"===this._storedCSS[i]||"static"===this._storedCSS[i])&&(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(n.push(function(e){this._trigger("remove",e,this._uiHash())}),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)t||n.push(o("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(n.push(o("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(i=0;n.length>i;i++)n[i].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var o=t||this;return{helper:o.helper,placeholder:o.placeholder||e([]),position:o.position,originalPosition:o.originalPosition,offset:o.positionAbs,item:o.currentItem,sender:t?t.element:null}}}),e.widget("ui.accordion",{version:"1.11.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),0>t.active&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?void this._activate(t):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),void("disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t))))},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var o=e.ui.keyCode,i=this.headers.length,n=this.headers.index(t.target),r=!1;switch(t.keyCode){case o.RIGHT:case o.DOWN:r=this.headers[(n+1)%i];break;case o.LEFT:case o.UP:r=this.headers[(n-1+i)%i];break;case o.SPACE:case o.ENTER:this._eventHandler(t);break;case o.HOME:r=this.headers[0];break;case o.END:r=this.headers[i-1]}r&&(e(t.target).attr("tabIndex",-1),e(r).attr("tabIndex",0),r.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))},_refresh:function(){var t,o=this.options,i=o.heightStyle,n=this.element.parent();this.active=this._findActive(o.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var t=e(this),o=t.uniqueId().attr("id"),i=t.next(),n=i.uniqueId().attr("id");t.attr("aria-controls",n),i.attr("aria-labelledby",o)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(o.event),"fill"===i?(t=n.height(),this.element.siblings(":visible").each(function(){var o=e(this),i=o.css("position");"absolute"!==i&&"fixed"!==i&&(t-=o.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===i&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var o=this._findActive(t)[0];o!==this.active[0]&&(o=o||this.active[0],this._eventHandler({target:o,currentTarget:o,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var o={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){o[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,o),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var o=this.options,i=this.active,n=e(t.currentTarget),r=n[0]===i[0],a=r&&o.collapsible,s=a?e():n.next(),l=i.next(),c={oldHeader:i,oldPanel:l,newHeader:a?e():n,newPanel:s};t.preventDefault(),r&&!o.collapsible||this._trigger("beforeActivate",t,c)===!1||(o.active=a?!1:this.headers.index(n),this.active=r?e():n,this._toggle(c),i.removeClass("ui-accordion-header-active ui-state-active"),o.icons&&i.children(".ui-accordion-header-icon").removeClass(o.icons.activeHeader).addClass(o.icons.header),r||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),o.icons&&n.children(".ui-accordion-header-icon").removeClass(o.icons.header).addClass(o.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var o=t.newPanel,i=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=o,this.prevHide=i,this.options.animate?this._animate(o,i,t):(i.hide(),o.show(),this._toggleComplete(t)),i.attr({"aria-hidden":"true"}),i.prev().attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&i.length?i.prev().attr({tabIndex:-1,"aria-expanded":"false"}):o.length&&this.headers.filter(function(){return 0===parseInt(e(this).attr("tabIndex"),10)}).attr("tabIndex",-1),o.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(e,t,o){var i,n,r,a=this,s=0,l=e.css("box-sizing"),c=e.length&&(!t.length||e.index()<t.index()),u=this.options.animate||{},d=c&&u.down||u,h=function(){a._toggleComplete(o)};return"number"==typeof d&&(r=d),"string"==typeof d&&(n=d),n=n||d.easing||u.easing,r=r||d.duration||u.duration,t.length?e.length?(i=e.show().outerHeight(),t.animate(this.hideProps,{duration:r,easing:n,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(this.showProps,{duration:r,easing:n,complete:h,step:function(e,o){o.now=Math.round(e),"height"!==o.prop?"content-box"===l&&(s+=o.now):"content"!==a.options.heightStyle&&(o.now=Math.round(i-t.outerHeight()-s),s=0)}})):t.animate(this.hideProps,r,n,h):e.animate(this.showProps,r,n,h)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(t){var o=e(t.target);!this.mouseHandled&&o.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),o.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){if(!this.previousFilter){var o=e(t.currentTarget);o.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,o)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var o=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,o)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){var o,i,n,r,a=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:a=!1,i=this.previousFilter||"",n=String.fromCharCode(t.keyCode),r=!1,clearTimeout(this.filterTimer),n===i?r=!0:n=i+n,o=this._filterMenuItems(n),o=r&&-1!==o.index(this.active.next())?this.active.nextAll(".ui-menu-item"):o,o.length||(n=String.fromCharCode(t.keyCode),o=this._filterMenuItems(n)),o.length?(this.focus(t,o),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}a&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t,o,i=this,n=this.options.icons.submenu,r=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),o=t.parent(),i=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);o.attr("aria-haspopup","true").prepend(i),t.attr("aria-labelledby",o.attr("id"))}),t=r.add(this.element),o=t.find(this.options.items),o.not(".ui-menu-item").each(function(){var t=e(this);i._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),o.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),o.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var o,i;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),i=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",i.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),o=t.children(".ui-menu"),o.length&&e&&/^mouse/.test(e.type)&&this._startOpening(o),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var o,i,n,r,a,s;this._hasScroll()&&(o=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-o-i,r=this.activeMenu.scrollTop(),a=this.activeMenu.height(),s=t.outerHeight(),0>n?this.activeMenu.scrollTop(r+n):n+s>a&&this.activeMenu.scrollTop(r+n-a+s))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var o=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(o)},collapseAll:function(t,o){clearTimeout(this.timer),this.timer=this._delay(function(){var i=o?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));i.length||(i=this.element),this._close(i),this.blur(t),this.activeMenu=i},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,o){var i;this.active&&(i="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),i&&i.length&&this.active||(i=this.activeMenu.find(this.options.items)[t]()),this.focus(o,i)},nextPage:function(t){var o,i,n;return this.active?void(this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return o=e(this),0>o.offset().top-i-n}),this.focus(t,o)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var o,i,n;return this.active?void(this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return o=e(this),o.offset().top-i+n>0}),this.focus(t,o)):this.focus(t,this.activeMenu.find(this.options.items).first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var o={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,o)},_filterMenuItems:function(t){var o=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),i=RegExp("^"+o,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return i.test(e.trim(e(this).text()))})}}),e.widget("ui.autocomplete",{version:"1.11.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,o,i,n=this.element[0].nodeName.toLowerCase(),r="textarea"===n,a="input"===n;this.isMultiLine=r?!0:a?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[r||a?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return t=!0,i=!0,void(o=!0);t=!1,i=!1,o=!1;var r=e.ui.keyCode;switch(n.keyCode){case r.PAGE_UP:t=!0,this._move("previousPage",n);break;case r.PAGE_DOWN:t=!0,this._move("nextPage",n);break;case r.UP:t=!0,this._keyEvent("previous",n);break;case r.DOWN:t=!0,this._keyEvent("next",n);break;case r.ENTER:this.menu.active&&(t=!0,n.preventDefault(),this.menu.select(n));break;case r.TAB:this.menu.active&&this.menu.select(n);break;case r.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:o=!0,this._searchTimeout(n)}},keypress:function(i){if(t)return t=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&i.preventDefault());if(!o){var n=e.ui.keyCode;switch(i.keyCode){case n.PAGE_UP:this._move("previousPage",i);break;case n.PAGE_DOWN:this._move("nextPage",i);break;case n.UP:this._keyEvent("previous",i);break;case n.DOWN:this._keyEvent("next",i)}}},input:function(e){return i?(i=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var o=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(i){i.target===t.element[0]||i.target===o||e.contains(o,i.target)||t.close()})})},menufocus:function(t,o){var i,n;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)})):(n=o.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:n})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(n.value),i=o.item.attr("aria-label")||n.value,void(i&&e.trim(i).length&&(this.liveRegion.children().hide(),e("<div>").text(i).appendTo(this.liveRegion))))
},menuselect:function(e,t){var o=t.item.data("ui-autocomplete-item"),i=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i,this.selectedItem=o})),!1!==this._trigger("select",e,{item:o})&&this._value(o.value),this.term=this._value(),this.close(e),this.selectedItem=o}}),this.liveRegion=e("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,o,i=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(o,i){i(e.ui.autocomplete.filter(t,o.term))}):"string"==typeof this.options.source?(o=this.options.source,this.source=function(t,n){i.xhr&&i.xhr.abort(),i.xhr=e.ajax({url:o,data:t,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),o=this.menu.element.is(":visible"),i=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;(!t||t&&!o&&!i)&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var o=this.menu.element.empty();this._renderMenu(o,t),this.isNewMenu=!0,this.menu.refresh(),o.show(),this._resizeMenu(),o.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,o){var i=this;e.each(o,function(e,o){i._renderItemData(t,o)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,o){return e("<li>").text(o.label).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,o){var i=RegExp(e.ui.autocomplete.escapeRegex(o),"i");return e.grep(t,function(e){return i.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var o;this._superApply(arguments),this.options.disabled||this.cancelSearch||(o=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(o).appendTo(this.liveRegion))}}),e.ui.autocomplete;var h,p="ui-button ui-widget ui-state-default ui-corner-all",f="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",m=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},g=function(t){var o=t.name,i=t.form,n=e([]);return o&&(o=o.replace(/'/g,"\\'"),n=i?e(i).find("[name='"+o+"'][type=radio]"):e("[name='"+o+"'][type=radio]",t.ownerDocument).filter(function(){return!this.form})),n};e.widget("ui.button",{version:"1.11.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,m),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,o=this.options,i="checkbox"===this.type||"radio"===this.type,n=i?"":"ui-state-active";null===o.label&&(o.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(p).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){o.disabled||this===h&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){o.disabled||e(this).removeClass(n)}).bind("click"+this.eventNamespace,function(e){o.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),i&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return o.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(o.disabled)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var i=t.element[0];g(i).not(i).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return o.disabled?!1:(e(this).addClass("ui-state-active"),h=this,void t.document.one("mouseup",function(){h=null}))}).bind("mouseup"+this.eventNamespace,function(){return o.disabled?!1:void e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){return o.disabled?!1:void((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",o.disabled),this._resetButton()},_determineButtonType:function(){var e,t,o;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),o=this.element.is(":checked"),o&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",o)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(p+" ui-state-active "+f).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),void(t&&this.buttonElement.removeClass("checkbox"===this.type||"radio"===this.type?"ui-state-focus":"ui-state-focus ui-state-active"))):void this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?g(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var t=this.buttonElement.removeClass(f),o=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),i=this.options.icons,n=i.primary&&i.secondary,r=[];i.primary||i.secondary?(this.options.text&&r.push("ui-button-text-icon"+(n?"s":i.primary?"-primary":"-secondary")),i.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+i.primary+"'></span>"),i.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+i.secondary+"'></span>"),this.options.text||(r.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(o)))):r.push("ui-button-text-only"),t.addClass(r.join(" "))}}),e.widget("ui.buttonset",{version:"1.11.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction"),o=this.element.find(this.options.items),i=o.filter(":ui-button");o.not(":ui-button").button(),i.button("refresh"),this.buttons=o.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),e.ui.button,e.extend(e.ui,{datepicker:{version:"1.11.4"}});var v;e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return s(this._defaults,e||{}),this},_attachDatepicker:function(t,o){var i,n,r;i=t.nodeName.toLowerCase(),n="div"===i||"span"===i,t.id||(this.uuid+=1,t.id="dp"+this.uuid),r=this._newInst(e(t),n),r.settings=e.extend({},o||{}),"input"===i?this._connectDatepicker(t,r):n&&this._inlineDatepicker(t,r)},_newInst:function(t,o){var i=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:i,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:o,dpDiv:o?r(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,o){var i=e(t);o.append=e([]),o.trigger=e([]),i.hasClass(this.markerClassName)||(this._attachments(i,o),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(o),e.data(t,"datepicker",o),o.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,o){var i,n,r,a=this._get(o,"appendText"),s=this._get(o,"isRTL");o.append&&o.append.remove(),a&&(o.append=e("<span class='"+this._appendClass+"'>"+a+"</span>"),t[s?"before":"after"](o.append)),t.unbind("focus",this._showDatepicker),o.trigger&&o.trigger.remove(),i=this._get(o,"showOn"),("focus"===i||"both"===i)&&t.focus(this._showDatepicker),("button"===i||"both"===i)&&(n=this._get(o,"buttonText"),r=this._get(o,"buttonImage"),o.trigger=e(this._get(o,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:r,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(r?e("<img/>").attr({src:r,alt:n,title:n}):n)),t[s?"before":"after"](o.trigger),o.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,o,i,n,r=new Date(2009,11,20),a=this._get(e,"dateFormat");a.match(/[DM]/)&&(t=function(e){for(o=0,i=0,n=0;e.length>n;n++)e[n].length>o&&(o=e[n].length,i=n);return i},r.setMonth(t(this._get(e,a.match(/MM/)?"monthNames":"monthNamesShort"))),r.setDate(t(this._get(e,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-r.getDay())),e.input.attr("size",this._formatDate(e,r).length)}},_inlineDatepicker:function(t,o){var i=e(t);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(o.dpDiv),e.data(t,"datepicker",o),this._setDate(o,this._getDefaultDate(o),!0),this._updateDatepicker(o),this._updateAlternate(o),o.settings.disabled&&this._disableDatepicker(t),o.dpDiv.css("display","block"))},_dialogDatepicker:function(t,o,i,n,r){var a,l,c,u,d,h=this._dialogInst;return h||(this.uuid+=1,a="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+a+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),h=this._dialogInst=this._newInst(this._dialogInput,!1),h.settings={},e.data(this._dialogInput[0],"datepicker",h)),s(h.settings,n||{}),o=o&&o.constructor===Date?this._formatDate(h,o):o,this._dialogInput.val(o),this._pos=r?r.length?r:[r.pageX,r.pageY]:null,this._pos||(l=document.documentElement.clientWidth,c=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+u,c/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),h.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",h),this},_destroyDatepicker:function(t){var o,i=e(t),n=e.data(t,"datepicker");i.hasClass(this.markerClassName)&&(o=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===o?(n.append.remove(),n.trigger.remove(),i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===o||"span"===o)&&i.removeClass(this.markerClassName).empty(),v===n&&(v=null))},_enableDatepicker:function(t){var o,i,n=e(t),r=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(o=t.nodeName.toLowerCase(),"input"===o?(t.disabled=!1,r.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===o||"span"===o)&&(i=n.children("."+this._inlineClass),i.children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var o,i,n=e(t),r=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(o=t.nodeName.toLowerCase(),"input"===o?(t.disabled=!0,r.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===o||"span"===o)&&(i=n.children("."+this._inlineClass),i.children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(o){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,o,i){var n,r,a,l,c=this._getInst(t);return 2===arguments.length&&"string"==typeof o?"defaults"===o?e.extend({},e.datepicker._defaults):c?"all"===o?e.extend({},c.settings):this._get(c,o):null:(n=o||{},"string"==typeof o&&(n={},n[o]=i),void(c&&(this._curInst===c&&this._hideDatepicker(),r=this._getDateDatepicker(t,!0),a=this._getMinMaxDate(c,"min"),l=this._getMinMaxDate(c,"max"),s(c.settings,n),null!==a&&void 0!==n.dateFormat&&void 0===n.minDate&&(c.settings.minDate=this._formatDate(c,a)),null!==l&&void 0!==n.dateFormat&&void 0===n.maxDate&&(c.settings.maxDate=this._formatDate(c,l)),"disabled"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),c),this._autoSize(c),this._setDate(c,r),this._updateAlternate(c),this._updateDatepicker(c))))},_changeDatepicker:function(e,t,o){this._optionDatepicker(e,t,o)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var o=this._getInst(e);o&&(this._setDate(o,t),this._updateDatepicker(o),this._updateAlternate(o))},_getDateDatepicker:function(e,t){var o=this._getInst(e);return o&&!o.inline&&this._setDateFromField(o,t),o?this._getDate(o):null},_doKeyDown:function(t){var o,i,n,r=e.datepicker._getInst(t.target),a=!0,s=r.dpDiv.is(".ui-datepicker-rtl");if(r._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),a=!1;break;case 13:return n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",r.dpDiv),n[0]&&e.datepicker._selectDay(t.target,r.selectedMonth,r.selectedYear,n[0]),o=e.datepicker._get(r,"onSelect"),o?(i=e.datepicker._formatDate(r),o.apply(r.input?r.input[0]:null,[i,r])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(r,"stepBigMonths"):-e.datepicker._get(r,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(r,"stepBigMonths"):+e.datepicker._get(r,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),a=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),a=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,s?1:-1,"D"),a=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(r,"stepBigMonths"):-e.datepicker._get(r,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),a=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,s?-1:1,"D"),a=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(r,"stepBigMonths"):+e.datepicker._get(r,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),a=t.ctrlKey||t.metaKey;break;default:a=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):a=!1;a&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var o,i,n=e.datepicker._getInst(t.target);return e.datepicker._get(n,"constrainInput")?(o=e.datepicker._possibleChars(e.datepicker._get(n,"dateFormat")),i=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">i||!o||o.indexOf(i)>-1):void 0},_doKeyUp:function(t){var o,i=e.datepicker._getInst(t.target);if(i.input.val()!==i.lastVal)try{o=e.datepicker.parseDate(e.datepicker._get(i,"dateFormat"),i.input?i.input.val():null,e.datepicker._getFormatConfig(i)),o&&(e.datepicker._setDateFromField(i),e.datepicker._updateAlternate(i),e.datepicker._updateDatepicker(i))}catch(n){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var o,n,r,a,l,c,u;o=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==o&&(e.datepicker._curInst.dpDiv.stop(!0,!0),o&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),n=e.datepicker._get(o,"beforeShow"),r=n?n.apply(t,[t,o]):{},r!==!1&&(s(o.settings,r),o.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(o),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),a=!1,e(t).parents().each(function(){return a|="fixed"===e(this).css("position"),!a}),l={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,o.dpDiv.empty(),o.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(o),l=e.datepicker._checkOffset(o,l,a),o.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":a?"fixed":"absolute",display:"none",left:l.left+"px",top:l.top+"px"}),o.inline||(c=e.datepicker._get(o,"showAnim"),u=e.datepicker._get(o,"duration"),o.dpDiv.css("z-index",i(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[c]?o.dpDiv.show(c,e.datepicker._get(o,"showOptions"),u):o.dpDiv[c||"show"](c?u:null),e.datepicker._shouldFocusInput(o)&&o.input.focus(),e.datepicker._curInst=o))}},_updateDatepicker:function(t){this.maxRows=4,v=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var o,i=this._getNumberOfMonths(t),n=i[1],r=17,s=t.dpDiv.find("."+this._dayOverClass+" a");s.length>0&&a.apply(s.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",r*n+"em"),t.dpDiv[(1!==i[0]||1!==i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(o=t.yearshtml,setTimeout(function(){o===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),o=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,o,i){var n=t.dpDiv.outerWidth(),r=t.dpDiv.outerHeight(),a=t.input?t.input.outerWidth():0,s=t.input?t.input.outerHeight():0,l=document.documentElement.clientWidth+(i?0:e(document).scrollLeft()),c=document.documentElement.clientHeight+(i?0:e(document).scrollTop());return o.left-=this._get(t,"isRTL")?n-a:0,o.left-=i&&o.left===t.input.offset().left?e(document).scrollLeft():0,o.top-=i&&o.top===t.input.offset().top+s?e(document).scrollTop():0,o.left-=Math.min(o.left,o.left+n>l&&l>n?Math.abs(o.left+n-l):0),o.top-=Math.min(o.top,o.top+r>c&&c>r?Math.abs(r+s):0),o},_findPos:function(t){for(var o,i=this._getInst(t),n=this._get(i,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return o=e(t).offset(),[o.left,o.top]},_hideDatepicker:function(t){var o,i,n,r,a=this._curInst;!a||t&&a!==e.data(t,"datepicker")||this._datepickerShowing&&(o=this._get(a,"showAnim"),i=this._get(a,"duration"),n=function(){e.datepicker._tidyDialog(a)},e.effects&&(e.effects.effect[o]||e.effects[o])?a.dpDiv.hide(o,e.datepicker._get(a,"showOptions"),i,n):a.dpDiv["slideDown"===o?"slideUp":"fadeIn"===o?"fadeOut":"hide"](o?i:null,n),o||n(),this._datepickerShowing=!1,r=this._get(a,"onClose"),r&&r.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var o=e(t.target),i=e.datepicker._getInst(o[0]);(o[0].id!==e.datepicker._mainDivId&&0===o.parents("#"+e.datepicker._mainDivId).length&&!o.hasClass(e.datepicker.markerClassName)&&!o.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||o.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==i)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,o,i){var n=e(t),r=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(r,o+("M"===i?this._get(r,"showCurrentAtPos"):0),i),this._updateDatepicker(r))},_gotoToday:function(t){var o,i=e(t),n=this._getInst(i[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(o=new Date,n.selectedDay=o.getDate(),n.drawMonth=n.selectedMonth=o.getMonth(),n.drawYear=n.selectedYear=o.getFullYear()),this._notifyChange(n),this._adjustDate(i)},_selectMonthYear:function(t,o,i){var n=e(t),r=this._getInst(n[0]);r["selected"+("M"===i?"Month":"Year")]=r["draw"+("M"===i?"Month":"Year")]=parseInt(o.options[o.selectedIndex].value,10),this._notifyChange(r),this._adjustDate(n)},_selectDay:function(t,o,i,n){var r,a=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])||(r=this._getInst(a[0]),r.selectedDay=r.currentDay=e("a",n).html(),r.selectedMonth=r.currentMonth=o,r.selectedYear=r.currentYear=i,this._selectDate(t,this._formatDate(r,r.currentDay,r.currentMonth,r.currentYear)))},_clearDate:function(t){var o=e(t);this._selectDate(o,"")},_selectDate:function(t,o){var i,n=e(t),r=this._getInst(n[0]);o=null!=o?o:this._formatDate(r),r.input&&r.input.val(o),this._updateAlternate(r),i=this._get(r,"onSelect"),i?i.apply(r.input?r.input[0]:null,[o,r]):r.input&&r.input.trigger("change"),r.inline?this._updateDatepicker(r):(this._hideDatepicker(),this._lastInput=r.input[0],"object"!=typeof r.input[0]&&r.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var o,i,n,r=this._get(t,"altField");r&&(o=this._get(t,"altFormat")||this._get(t,"dateFormat"),i=this._getDate(t),n=this.formatDate(o,i,this._getFormatConfig(t)),e(r).each(function(){e(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,o=new Date(e.getTime());return o.setDate(o.getDate()+4-(o.getDay()||7)),t=o.getTime(),o.setMonth(0),o.setDate(1),Math.floor(Math.round((t-o)/864e5)/7)+1},parseDate:function(t,o,i){if(null==t||null==o)throw"Invalid arguments";if(o="object"==typeof o?""+o:o+"",""===o)return null;var n,r,a,s,l=0,c=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),d=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,h=(i?i.dayNames:null)||this._defaults.dayNames,p=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,f=(i?i.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,b=-1,y=!1,C=function(e){var o=t.length>n+1&&t.charAt(n+1)===e;return o&&n++,o},w=function(e){var t=C(e),i="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n="y"===e?i:1,r=RegExp("^\\d{"+n+","+i+"}"),a=o.substring(l).match(r);if(!a)throw"Missing number at position "+l;return l+=a[0].length,parseInt(a[0],10)},x=function(t,i,n){var r=-1,a=e.map(C(t)?n:i,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(a,function(e,t){var i=t[1];return o.substr(l,i.length).toLowerCase()===i.toLowerCase()?(r=t[0],l+=i.length,!1):void 0}),-1!==r)return r+1;throw"Unknown name at position "+l},_=function(){if(o.charAt(l)!==t.charAt(n))throw"Unexpected literal at position "+l;l++};for(n=0;t.length>n;n++)if(y)"'"!==t.charAt(n)||C("'")?_():y=!1;else switch(t.charAt(n)){case"d":v=w("d");break;case"D":x("D",d,h);break;case"o":b=w("o");break;case"m":g=w("m");break;case"M":g=x("M",p,f);break;case"y":m=w("y");break;case"@":s=new Date(w("@")),m=s.getFullYear(),g=s.getMonth()+1,v=s.getDate();break;case"!":s=new Date((w("!")-this._ticksTo1970)/1e4),m=s.getFullYear(),g=s.getMonth()+1,v=s.getDate();break;case"'":C("'")?_():y=!0;break;default:_()}if(o.length>l&&(a=o.substr(l),!/^\s+/.test(a)))throw"Extra/unparsed characters found in date: "+a;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=m?0:-100)),b>-1)for(g=1,v=b;r=this._getDaysInMonth(m,g-1),!(r>=v);)g++,v-=r;if(s=this._daylightSavingAdjust(new Date(m,g-1,v)),s.getFullYear()!==m||s.getMonth()+1!==g||s.getDate()!==v)throw"Invalid date";return s},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,o){if(!t)return"";var i,n=(o?o.dayNamesShort:null)||this._defaults.dayNamesShort,r=(o?o.dayNames:null)||this._defaults.dayNames,a=(o?o.monthNamesShort:null)||this._defaults.monthNamesShort,s=(o?o.monthNames:null)||this._defaults.monthNames,l=function(t){var o=e.length>i+1&&e.charAt(i+1)===t;return o&&i++,o},c=function(e,t,o){var i=""+t;if(l(e))for(;o>i.length;)i="0"+i;return i},u=function(e,t,o,i){return l(e)?i[t]:o[t]},d="",h=!1;if(t)for(i=0;e.length>i;i++)if(h)"'"!==e.charAt(i)||l("'")?d+=e.charAt(i):h=!1;else switch(e.charAt(i)){case"d":d+=c("d",t.getDate(),2);break;case"D":d+=u("D",t.getDay(),n,r);break;case"o":d+=c("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=c("m",t.getMonth()+1,2);break;case"M":d+=u("M",t.getMonth(),a,s);break;case"y":d+=l("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":l("'")?d+="'":h=!0;break;default:d+=e.charAt(i)}return d},_possibleChars:function(e){var t,o="",i=!1,n=function(o){var i=e.length>t+1&&e.charAt(t+1)===o;return i&&t++,i};for(t=0;e.length>t;t++)if(i)"'"!==e.charAt(t)||n("'")?o+=e.charAt(t):i=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":o+="0123456789";break;case"D":case"M":return null;case"'":n("'")?o+="'":i=!0;break;default:o+=e.charAt(t)}return o},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var o=this._get(e,"dateFormat"),i=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),r=n,a=this._getFormatConfig(e);
try{r=this.parseDate(o,i,a)||n}catch(s){i=t?"":i}e.selectedDay=r.getDate(),e.drawMonth=e.selectedMonth=r.getMonth(),e.drawYear=e.selectedYear=r.getFullYear(),e.currentDay=i?r.getDate():0,e.currentMonth=i?r.getMonth():0,e.currentYear=i?r.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,o,i){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},r=function(o){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),o,e.datepicker._getFormatConfig(t))}catch(i){}for(var n=(o.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,r=n.getFullYear(),a=n.getMonth(),s=n.getDate(),l=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,c=l.exec(o);c;){switch(c[2]||"d"){case"d":case"D":s+=parseInt(c[1],10);break;case"w":case"W":s+=7*parseInt(c[1],10);break;case"m":case"M":a+=parseInt(c[1],10),s=Math.min(s,e.datepicker._getDaysInMonth(r,a));break;case"y":case"Y":r+=parseInt(c[1],10),s=Math.min(s,e.datepicker._getDaysInMonth(r,a))}c=l.exec(o)}return new Date(r,a,s)},a=null==o||""===o?i:"string"==typeof o?r(o):"number"==typeof o?isNaN(o)?i:n(o):new Date(o.getTime());return a=a&&"Invalid Date"==""+a?i:a,a&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,o){var i=!t,n=e.selectedMonth,r=e.selectedYear,a=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=a.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=a.getMonth(),e.drawYear=e.selectedYear=e.currentYear=a.getFullYear(),n===e.selectedMonth&&r===e.selectedYear||o||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(i?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var o=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(i,-o,"M")},next:function(){e.datepicker._adjustDate(i,+o,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(i)},selectDay:function(){return e.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(i,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,o,i,n,r,a,s,l,c,u,d,h,p,f,m,g,v,b,y,C,w,x,_,S,k,T,F,E,D,P,A,I,M,R,N,L,O,z,H,B=new Date,U=this._daylightSavingAdjust(new Date(B.getFullYear(),B.getMonth(),B.getDate())),j=this._get(e,"isRTL"),V=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),G=this._get(e,"navigationAsDateFormat"),$=this._getNumberOfMonths(e),Y=this._get(e,"showCurrentAtPos"),K=this._get(e,"stepMonths"),q=1!==$[0]||1!==$[1],X=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),J=this._getMinMaxDate(e,"min"),Z=this._getMinMaxDate(e,"max"),Q=e.drawMonth-Y,et=e.drawYear;if(0>Q&&(Q+=12,et--),Z)for(t=this._daylightSavingAdjust(new Date(Z.getFullYear(),Z.getMonth()-$[0]*$[1]+1,Z.getDate())),t=J&&J>t?J:t;this._daylightSavingAdjust(new Date(et,Q,1))>t;)Q--,0>Q&&(Q=11,et--);for(e.drawMonth=Q,e.drawYear=et,o=this._get(e,"prevText"),o=G?this.formatDate(o,this._daylightSavingAdjust(new Date(et,Q-K,1)),this._getFormatConfig(e)):o,i=this._canAdjustMonth(e,-1,et,Q)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(j?"e":"w")+"'>"+o+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(j?"e":"w")+"'>"+o+"</span></a>",n=this._get(e,"nextText"),n=G?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Q+K,1)),this._getFormatConfig(e)):n,r=this._canAdjustMonth(e,1,et,Q)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(j?"w":"e")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(j?"w":"e")+"'>"+n+"</span></a>",a=this._get(e,"currentText"),s=this._get(e,"gotoCurrent")&&e.currentDay?X:U,a=G?this.formatDate(a,s,this._getFormatConfig(e)):a,l=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",c=V?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(j?l:"")+(this._isInRange(e,s)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(j?"":l)+"</div>":"",u=parseInt(this._get(e,"firstDay"),10),u=isNaN(u)?0:u,d=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),b=this._get(e,"selectOtherMonths"),y=this._getDefaultDate(e),C="",x=0;$[0]>x;x++){for(_="",this.maxRows=4,S=0;$[1]>S;S++){if(k=this._daylightSavingAdjust(new Date(et,Q,e.selectedDay)),T=" ui-corner-all",F="",q){if(F+="<div class='ui-datepicker-group",$[1]>1)switch(S){case 0:F+=" ui-datepicker-group-first",T=" ui-corner-"+(j?"right":"left");break;case $[1]-1:F+=" ui-datepicker-group-last",T=" ui-corner-"+(j?"left":"right");break;default:F+=" ui-datepicker-group-middle",T=""}F+="'>"}for(F+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+T+"'>"+(/all|left/.test(T)&&0===x?j?r:i:"")+(/all|right/.test(T)&&0===x?j?i:r:"")+this._generateMonthYearHeader(e,Q,et,J,Z,x>0||S>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",E=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",w=0;7>w;w++)D=(w+u)%7,E+="<th scope='col'"+((w+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+h[D]+"'>"+p[D]+"</span></th>";for(F+=E+"</tr></thead><tbody>",P=this._getDaysInMonth(et,Q),et===e.selectedYear&&Q===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,P)),A=(this._getFirstDayOfMonth(et,Q)-u+7)%7,I=Math.ceil((A+P)/7),M=q&&this.maxRows>I?this.maxRows:I,this.maxRows=M,R=this._daylightSavingAdjust(new Date(et,Q,1-A)),N=0;M>N;N++){for(F+="<tr>",L=d?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(R)+"</td>":"",w=0;7>w;w++)O=g?g.apply(e.input?e.input[0]:null,[R]):[!0,""],z=R.getMonth()!==Q,H=z&&!b||!O[0]||J&&J>R||Z&&R>Z,L+="<td class='"+((w+u+6)%7>=5?" ui-datepicker-week-end":"")+(z?" ui-datepicker-other-month":"")+(R.getTime()===k.getTime()&&Q===e.selectedMonth&&e._keyEvent||y.getTime()===R.getTime()&&y.getTime()===k.getTime()?" "+this._dayOverClass:"")+(H?" "+this._unselectableClass+" ui-state-disabled":"")+(z&&!v?"":" "+O[1]+(R.getTime()===X.getTime()?" "+this._currentClass:"")+(R.getTime()===U.getTime()?" ui-datepicker-today":""))+"'"+(z&&!v||!O[2]?"":" title='"+O[2].replace(/'/g,"&#39;")+"'")+(H?"":" data-handler='selectDay' data-event='click' data-month='"+R.getMonth()+"' data-year='"+R.getFullYear()+"'")+">"+(z&&!v?"&#xa0;":H?"<span class='ui-state-default'>"+R.getDate()+"</span>":"<a class='ui-state-default"+(R.getTime()===U.getTime()?" ui-state-highlight":"")+(R.getTime()===X.getTime()?" ui-state-active":"")+(z?" ui-priority-secondary":"")+"' href='#'>"+R.getDate()+"</a>")+"</td>",R.setDate(R.getDate()+1),R=this._daylightSavingAdjust(R);F+=L+"</tr>"}Q++,Q>11&&(Q=0,et++),F+="</tbody></table>"+(q?"</div>"+($[0]>0&&S===$[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),_+=F}C+=_}return C+=c,e._keyEvent=!1,C},_generateMonthYearHeader:function(e,t,o,i,n,r,a,s){var l,c,u,d,h,p,f,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),b=this._get(e,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",C="";if(r||!g)C+="<span class='ui-datepicker-month'>"+a[t]+"</span>";else{for(l=i&&i.getFullYear()===o,c=n&&n.getFullYear()===o,C+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;12>u;u++)(!l||u>=i.getMonth())&&(!c||n.getMonth()>=u)&&(C+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+s[u]+"</option>");C+="</select>"}if(b||(y+=C+(!r&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",r||!v)y+="<span class='ui-datepicker-year'>"+o+"</span>";else{for(d=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?o+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t},f=p(d[0]),m=Math.max(f,p(d[1]||"")),f=i?Math.max(f,i.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===o?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",y+=e.yearshtml,e.yearshtml=null}return y+=this._get(e,"yearSuffix"),b&&(y+=(!r&&g&&v?"":"&#xa0;")+C),y+="</div>"},_adjustInstDate:function(e,t,o){var i=e.drawYear+("Y"===o?t:0),n=e.drawMonth+("M"===o?t:0),r=Math.min(e.selectedDay,this._getDaysInMonth(i,n))+("D"===o?t:0),a=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(i,n,r)));e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),("M"===o||"Y"===o)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var o=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max"),n=o&&o>t?o:t;return i&&n>i?i:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,o,i){var n=this._getNumberOfMonths(e),r=this._daylightSavingAdjust(new Date(o,i+(0>t?t:n[0]*n[1]),1));return 0>t&&r.setDate(this._getDaysInMonth(r.getFullYear(),r.getMonth())),this._isInRange(e,r)},_isInRange:function(e,t){var o,i,n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),a=null,s=null,l=this._get(e,"yearRange");return l&&(o=l.split(":"),i=(new Date).getFullYear(),a=parseInt(o[0],10),s=parseInt(o[1],10),o[0].match(/[+\-].*/)&&(a+=i),o[1].match(/[+\-].*/)&&(s+=i)),(!n||t.getTime()>=n.getTime())&&(!r||t.getTime()<=r.getTime())&&(!a||t.getFullYear()>=a)&&(!s||s>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,o,i){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(i,o,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var o=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(o)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(o)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(o))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.4",e.datepicker,e.widget("ui.dialog",{version:"1.11.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var o=e(this).css(t).offset().top;0>o&&e(this).css("top",t.top-o)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var o,i=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{o=this.document[0].activeElement,o&&"body"!==o.nodeName.toLowerCase()&&e(o).blur()}catch(n){}this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,o){var i=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+e(this).css("z-index")}).get(),r=Math.max.apply(null,n);return r>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",r+1),i=!0),i&&!o&&this._trigger("focus",t),i},open:function(){var t=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function o(){var t=this.document[0].activeElement,o=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);o||this._focusTabbable()}t.preventDefault(),o.call(this),this._delay(o)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var o=this.uiDialog.find(":tabbable"),i=o.filter(":first"),n=o.filter(":last");t.target!==n[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==i[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){n.focus()}),t.preventDefault()):(this._delay(function(){i.focus()}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,o=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(o)||e.isArray(o)&&!o.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(e.each(o,function(o,i){var n,r;i=e.isFunction(i)?{click:i,text:o}:i,i=e.extend({type:"button"},i),n=i.click,i.click=function(){n.apply(t.element[0],arguments)},r={icons:i.icons,text:i.showText},delete i.icons,delete i.showText,e("<button></button>",i).button(r).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var o=this,i=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(i,n){e(this).addClass("ui-dialog-dragging"),o._blockFrames(),o._trigger("dragStart",i,t(n))},drag:function(e,i){o._trigger("drag",e,t(i))},stop:function(n,r){var a=r.offset.left-o.document.scrollLeft(),s=r.offset.top-o.document.scrollTop();i.position={my:"left top",at:"left"+(a>=0?"+":"")+a+" top"+(s>=0?"+":"")+s,of:o.window},e(this).removeClass("ui-dialog-dragging"),o._unblockFrames(),o._trigger("dragStop",n,t(r))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var o=this,i=this.options,n=i.resizable,r=this.uiDialog.css("position"),a="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:i.maxWidth,maxHeight:i.maxHeight,minWidth:i.minWidth,minHeight:this._minHeight(),handles:a,start:function(i,n){e(this).addClass("ui-dialog-resizing"),o._blockFrames(),o._trigger("resizeStart",i,t(n))},resize:function(e,i){o._trigger("resize",e,t(i))},stop:function(n,r){var a=o.uiDialog.offset(),s=a.left-o.document.scrollLeft(),l=a.top-o.document.scrollTop();i.height=o.uiDialog.height(),i.width=o.uiDialog.width(),i.position={my:"left top",at:"left"+(s>=0?"+":"")+s+" top"+(l>=0?"+":"")+l,of:o.window},e(this).removeClass("ui-dialog-resizing"),o._unblockFrames(),o._trigger("resizeStop",n,t(r))}}).css("position",r)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),o=e.inArray(this,t);-1!==o&&t.splice(o,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var o=this,i=!1,n={};e.each(t,function(e,t){o._setOption(e,t),e in o.sizeRelatedOptions&&(i=!0),e in o.resizableRelatedOptions&&(n[e]=t)}),i&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",n)},_setOption:function(e,t){var o,i,n=this.uiDialog;"dialogClass"===e&&n.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(o=n.is(":data(ui-draggable)"),o&&!t&&n.draggable("destroy"),!o&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(i=n.is(":data(ui-resizable)"),i&&!t&&n.resizable("destroy"),i&&"string"==typeof t&&n.resizable("option","handles",t),i||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,o,i=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),i.minWidth>i.width&&(i.width=i.minWidth),e=this.uiDialog.css({height:"auto",width:i.width}).outerHeight(),t=Math.max(0,i.minHeight-e),o="number"==typeof i.maxHeight?Math.max(0,i.maxHeight-e):"none","auto"===i.height?this.element.css({minHeight:t,maxHeight:o,height:"auto"}):this.element.height(Math.max(0,i.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),e.widget("ui.progressbar",{version:"1.11.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),void this._refreshValue())},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,o=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(o.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),e.widget("ui.selectmenu",{version:"1.11.4",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var t=this;this.label=e("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=e("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),e("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=e("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){t.menuItems||t._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var t=this;this.menu=e("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=e("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(e,o){e.preventDefault(),t._setSelection(),t._select(o.item.data("ui-selectmenu-item"),e)},focus:function(e,o){var i=o.item.data("ui-selectmenu-item");null!=t.focusIndex&&i.index!==t.focusIndex&&(t._trigger("focus",e,{item:i}),t.isOpen||t._select(i,e)),t.focusIndex=i.index,t.button.attr("aria-activedescendant",t.menuItems.eq(i.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var e,t=this.element.find("option");t.length&&(this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(t,o){var i=this,n="";e.each(o,function(o,r){r.optgroup!==n&&(e("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(r.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:r.optgroup}).appendTo(t),n=r.optgroup),i._renderItemData(t,r)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(t,o){var i=e("<li>");return o.disabled&&i.addClass("ui-state-disabled"),this._setText(i,o.label),i.appendTo(t)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var o,i,n=".ui-menu-item";this.isOpen?o=this.menuItems.eq(this.focusIndex):(o=this.menuItems.eq(this.element[0].selectedIndex),n+=":not(.ui-state-disabled)"),i="first"===e||"last"===e?o["first"===e?"prevAll":"nextAll"](n).eq(-1):o[e+"All"](n).eq(0),i.length&&this.menuInstance.focus(t,i)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;this.range&&(window.getSelection?(e=window.getSelection(),e.removeAllRanges(),e.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(t))}},_buttonEvents:{mousedown:function(){var e;window.getSelection?(e=window.getSelection(),e.rangeCount&&(this.range=e.getRangeAt(0))):this.range=document.selection.createRange()},click:function(e){this._setSelection(),this._toggle(e)},keydown:function(t){var o=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),o=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move("prev",t);
break;case e.ui.keyCode.RIGHT:this._move("next",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move("first",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),o=!1}o&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var o=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==o&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){"icons"===e&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"disabled"===e&&(this.menuInstance.option("disabled",t),this.button.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===e&&this._resizeButton()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;e||(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(t){var o=[];t.each(function(t,i){var n=e(i),r=n.parent("optgroup");o.push({element:n,index:t,value:n.val(),label:n.text(),optgroup:r.attr("label")||"",disabled:r.prop("disabled")||n.prop("disabled")})}),this.items=o},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),e.widget("ui.slider",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,o,i=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),r="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",a=[];for(o=i.values&&i.values.length||1,n.length>o&&(n.slice(o).remove(),n=n.slice(0,o)),t=n.length;o>t;t++)a.push(r);this.handles=n.add(e(a.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,o="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),o="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(o+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var o,i,n,r,a,s,l,c,u=this,d=this.options;return d.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),o={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(o),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var o=Math.abs(i-u.values(t));(n>o||n===o&&(t===u._lastChangedValue||u.values(t)===d.min))&&(n=o,r=e(this),a=t)}),s=this._start(t,a),s===!1?!1:(this._mouseSliding=!0,this._handleIndex=a,r.addClass("ui-state-active").focus(),l=r.offset(),c=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=c?{left:0,top:0}:{left:t.pageX-l.left-r.width()/2,top:t.pageY-l.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,a,i),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},o=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,o),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,o,i,n,r;return"horizontal"===this.orientation?(t=this.elementSize.width,o=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,o=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),i=o/t,i>1&&(i=1),0>i&&(i=0),"vertical"===this.orientation&&(i=1-i),n=this._valueMax()-this._valueMin(),r=this._valueMin()+i*n,this._trimAlignValue(r)},_start:function(e,t){var o={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(o.value=this.values(t),o.values=this.values()),this._trigger("start",e,o)},_slide:function(e,t,o){var i,n,r;this.options.values&&this.options.values.length?(i=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&o>i||1===t&&i>o)&&(o=i),o!==this.values(t)&&(n=this.values(),n[t]=o,r=this._trigger("slide",e,{handle:this.handles[t],value:o,values:n}),i=this.values(t?0:1),r!==!1&&this.values(t,o))):o!==this.value()&&(r=this._trigger("slide",e,{handle:this.handles[t],value:o}),r!==!1&&this.value(o))},_stop:function(e,t){var o={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(o.value=this.values(t),o.values=this.values()),this._trigger("stop",e,o)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var o={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(o.value=this.values(t),o.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,o)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,o){var i,n,r;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(o),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(i=this.options.values,n=arguments[0],r=0;i.length>r;r+=1)i[r]=this._trimAlignValue(n[r]),this._change(null,r);this._refreshValue()},_setOption:function(t,o){var i,n=0;switch("range"===t&&this.options.range===!0&&("min"===o?(this.options.value=this._values(0),this.options.values=null):"max"===o&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(n=this.options.values.length),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!o),this._super(t,o),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===o?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;n>i;i+=1)this._change(null,i);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,o,i;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(o=this.options.values.slice(),i=0;o.length>i;i+=1)o[i]=this._trimAlignValue(o[i]);return o}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,o=(e-this._valueMin())%t,i=e-o;return 2*Math.abs(o)>=t&&(i+=o>0?t:-t),parseFloat(i.toFixed(5))},_calculateNewMax:function(){var e=this.options.max,t=this._valueMin(),o=this.options.step,i=Math.floor(+(e-t).toFixed(this._precision())/o)*o;e=i+t,this.max=parseFloat(e.toFixed(this._precision()))},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,o=t.indexOf(".");return-1===o?0:t.length-o-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var t,o,i,n,r,a=this.options.range,s=this.options,l=this,c=this._animateOff?!1:s.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(i){o=100*((l.values(i)-l._valueMin())/(l._valueMax()-l._valueMin())),u["horizontal"===l.orientation?"left":"bottom"]=o+"%",e(this).stop(1,1)[c?"animate":"css"](u,s.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===i&&l.range.stop(1,1)[c?"animate":"css"]({left:o+"%"},s.animate),1===i&&l.range[c?"animate":"css"]({width:o-t+"%"},{queue:!1,duration:s.animate})):(0===i&&l.range.stop(1,1)[c?"animate":"css"]({bottom:o+"%"},s.animate),1===i&&l.range[c?"animate":"css"]({height:o-t+"%"},{queue:!1,duration:s.animate}))),t=o}):(i=this.value(),n=this._valueMin(),r=this._valueMax(),o=r!==n?100*((i-n)/(r-n)):0,u["horizontal"===this.orientation?"left":"bottom"]=o+"%",this.handle.stop(1,1)[c?"animate":"css"](u,s.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:o+"%"},s.animate),"max"===a&&"horizontal"===this.orientation&&this.range[c?"animate":"css"]({width:100-o+"%"},{queue:!1,duration:s.animate}),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:o+"%"},s.animate),"max"===a&&"vertical"===this.orientation&&this.range[c?"animate":"css"]({height:100-o+"%"},{queue:!1,duration:s.animate}))},_handleEvents:{keydown:function(t){var o,i,n,r,a=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),o=this._start(t,a),o===!1))return}switch(r=this.options.step,i=n=this.options.values&&this.options.values.length?this.values(a):this.value(),t.keyCode){case e.ui.keyCode.HOME:n=this._valueMin();break;case e.ui.keyCode.END:n=this._valueMax();break;case e.ui.keyCode.PAGE_UP:n=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(i===this._valueMax())return;n=this._trimAlignValue(i+r);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i===this._valueMin())return;n=this._trimAlignValue(i-r)}this._slide(t,a,n)},keyup:function(t){var o=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,o),this._change(t,o),e(t.target).removeClass("ui-state-active"))}}}),e.widget("ui.spinner",{version:"1.11.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},o=this.element;return e.each(["min","max","step"],function(e,i){var n=o.attr(i);void 0!==n&&n.length&&(t[i]=n)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",e)))},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function o(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i}))}var i;i=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),o.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,o.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:void this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var o=this.options,i=e.ui.keyCode;switch(t.keyCode){case i.UP:return this._repeat(null,1,t),!0;case i.DOWN:return this._repeat(null,-1,t),!0;case i.PAGE_UP:return this._repeat(null,o.page,t),!0;case i.PAGE_DOWN:return this._repeat(null,-o.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,o){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,o)},e),this._spin(t*this.options.step,o)},_spin:function(e,t){var o=this.value()||0;this.counter||(this.counter=1),o=this._adjustValue(o+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:o})===!1||(this._value(o),this.counter++)},_increment:function(t){var o=this.options.incremental;return o?e.isFunction(o)?o(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,o=t.indexOf(".");return-1===o?0:t.length-o-1},_adjustValue:function(e){var t,o,i=this.options;return t=null!==i.min?i.min:0,o=e-t,o=Math.round(o/i.step)*i.step,e=t+o,e=parseFloat(e.toFixed(this._precision())),null!==i.max&&e>i.max?i.max:null!==i.min&&i.min>e?i.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var o=this._parse(this.element.val());return this.options[e]=t,void this.element.val(this._format(o))}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable"))},_setOptions:l(function(e){this._super(e)}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null===e?!1:e===this._adjustValue(e)},_value:function(e,t){var o;""!==e&&(o=this._parse(e),null!==o&&(t||(o=this._adjustValue(o)),e=this._format(o))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:l(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:l(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:l(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:l(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?void l(this._value).call(this,e):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),e.widget("ui.tabs",{version:"1.11.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var e=/#.*$/;return function(t){var o,i;t=t.cloneNode(!1),o=t.href.replace(e,""),i=location.href.replace(e,"");try{o=decodeURIComponent(o)}catch(n){}try{i=decodeURIComponent(i)}catch(n){}return t.hash.length>1&&o===i}}(),_create:function(){var t=this,o=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",o.collapsible),this._processTabs(),o.active=this._initialActive(),e.isArray(o.disabled)&&(o.disabled=e.unique(o.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(o.active):e(),this._refresh(),this.active.length&&this.load(o.active)},_initialActive:function(){var t=this.options.active,o=this.options.collapsible,i=location.hash.substring(1);return null===t&&(i&&this.tabs.each(function(o,n){return e(n).attr("aria-controls")===i?(t=o,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=o?!1:0)),!o&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var o=e(this.document[0].activeElement).closest("li"),i=this.tabs.index(o),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:i++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:n=!1,i--;break;case e.ui.keyCode.END:i=this.anchors.length-1;break;case e.ui.keyCode.HOME:i=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i);case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i===this.options.active?!1:i);default:return}t.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,n),t.ctrlKey||t.metaKey||(o.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,o){function i(){return t>n&&(t=0),0>t&&(t=n),t}for(var n=this.tabs.length-1;-1!==e.inArray(i(),this.options.disabled);)t=o?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,o=this.tablist.children(":has(a[href])");t.disabled=e.map(o.filter(".ui-state-disabled"),function(e){return o.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this,o=this.tabs,i=this.anchors,n=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(o,i){var n,r,a,s=e(i).uniqueId().attr("id"),l=e(i).closest("li"),c=l.attr("aria-controls");t._isLocal(i)?(n=i.hash,a=n.substring(1),r=t.element.find(t._sanitizeSelector(n))):(a=l.attr("aria-controls")||e({}).uniqueId()[0].id,n="#"+a,r=t.element.find(n),r.length||(r=t._createPanel(a),r.insertAfter(t.panels[o-1]||t.tablist)),r.attr("aria-live","polite")),r.length&&(t.panels=t.panels.add(r)),c&&l.data("ui-tabs-aria-controls",c),l.attr({"aria-controls":a,"aria-labelledby":s}),r.attr("aria-labelledby",s)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),o&&(this._off(o.not(this.tabs)),this._off(i.not(this.anchors)),this._off(n.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var o,i=0;o=this.tabs[i];i++)t===!0||-1!==e.inArray(i,t)?e(o).addClass("ui-state-disabled").attr("aria-disabled","true"):e(o).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var o={};t&&e.each(t.split(" "),function(e,t){o[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,o),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var o,i=this.element.parent();"fill"===t?(o=i.height(),o-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),i=t.css("position");"absolute"!==i&&"fixed"!==i&&(o-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){o-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,o-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(o=0,this.panels.each(function(){o=Math.max(o,e(this).height("").height())}).height(o))},_eventHandler:function(t){var o=this.options,i=this.active,n=e(t.currentTarget),r=n.closest("li"),a=r[0]===i[0],s=a&&o.collapsible,l=s?e():this._getPanelForTab(r),c=i.length?this._getPanelForTab(i):e(),u={oldTab:i,oldPanel:c,newTab:s?e():r,newPanel:l};t.preventDefault(),r.hasClass("ui-state-disabled")||r.hasClass("ui-tabs-loading")||this.running||a&&!o.collapsible||this._trigger("beforeActivate",t,u)===!1||(o.active=s?!1:this.tabs.index(r),this.active=a?e():r,this.xhr&&this.xhr.abort(),c.length||l.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(r),t),this._toggle(t,u))},_toggle:function(t,o){function i(){r.running=!1,r._trigger("activate",t,o)}function n(){o.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),a.length&&r.options.show?r._show(a,r.options.show,i):(a.show(),i())}var r=this,a=o.newPanel,s=o.oldPanel;this.running=!0,s.length&&this.options.hide?this._hide(s,this.options.hide,function(){o.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(o.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),s.hide(),n()),s.attr("aria-hidden","true"),o.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),a.length&&s.length?o.oldTab.attr("tabIndex",-1):a.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),a.attr("aria-hidden","false"),o.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var o,i=this._findActive(t);i[0]!==this.active[0]&&(i.length||(i=this.active),o=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:o,currentTarget:o,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),o=t.data("ui-tabs-aria-controls");o?t.attr("aria-controls",o).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var o=this.options.disabled;o!==!1&&(void 0===t?o=!1:(t=this._getIndex(t),o=e.isArray(o)?e.map(o,function(e){return e!==t?e:null}):e.map(this.tabs,function(e,o){return o!==t?o:null})),this._setupDisabled(o))},disable:function(t){var o=this.options.disabled;if(o!==!0){if(void 0===t)o=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,o))return;o=e.isArray(o)?e.merge([t],o).sort():[t]}this._setupDisabled(o)}},load:function(t,o){t=this._getIndex(t);var i=this,n=this.tabs.eq(t),r=n.find(".ui-tabs-anchor"),a=this._getPanelForTab(n),s={tab:n,panel:a},l=function(e,t){"abort"===t&&i.panels.stop(!1,!0),n.removeClass("ui-tabs-loading"),a.removeAttr("aria-busy"),e===i.xhr&&delete i.xhr};this._isLocal(r[0])||(this.xhr=e.ajax(this._ajaxSettings(r,o,s)),this.xhr&&"canceled"!==this.xhr.statusText&&(n.addClass("ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.done(function(e,t,n){setTimeout(function(){a.html(e),i._trigger("load",o,s),l(n,t)},1)}).fail(function(e,t){setTimeout(function(){l(e,t)},1)})))},_ajaxSettings:function(t,o,i){var n=this;return{url:t.attr("href"),beforeSend:function(t,r){return n._trigger("beforeLoad",o,e.extend({jqXHR:t,ajaxSettings:r},i))}}},_getPanelForTab:function(t){var o=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+o))}}),e.widget("ui.tooltip",{version:"1.11.4",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(t,o){var i=(t.attr("aria-describedby")||"").split(/\s+/);i.push(o),t.data("ui-tooltip-id",o).attr("aria-describedby",e.trim(i.join(" ")))},_removeDescribedBy:function(t){var o=t.data("ui-tooltip-id"),i=(t.attr("aria-describedby")||"").split(/\s+/),n=e.inArray(o,i);
-1!==n&&i.splice(n,1),t.removeData("ui-tooltip-id"),i=e.trim(i.join(" ")),i?t.attr("aria-describedby",i):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=e("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(t,o){var i=this;return"disabled"===t?(this[o?"_disable":"_enable"](),void(this.options[t]=o)):(this._super(t,o),void("content"===t&&e.each(this.tooltips,function(e,t){i._updateContent(t.element)})))},_disable:function(){var t=this;e.each(this.tooltips,function(o,i){var n=e.Event("blur");n.target=n.currentTarget=i.element[0],t.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var o=this,i=e(t?t.target:this.element).closest(this.options.items);i.length&&!i.data("ui-tooltip-id")&&(i.attr("title")&&i.data("ui-tooltip-title",i.attr("title")),i.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&i.parents().each(function(){var t,i=e(this);i.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,o.close(t,!0)),i.attr("title")&&(i.uniqueId(),o.parents[this.id]={element:this,title:i.attr("title")},i.attr("title",""))}),this._registerCloseHandlers(t,i),this._updateContent(i,t))},_updateContent:function(e,t){var o,i=this.options.content,n=this,r=t?t.type:null;return"string"==typeof i?this._open(t,e,i):(o=i.call(e[0],function(o){n._delay(function(){e.data("ui-tooltip-open")&&(t&&(t.type=r),this._open(t,e,o))})}),void(o&&this._open(t,e,o)))},_open:function(t,o,i){function n(e){c.of=e,a.is(":hidden")||a.position(c)}var r,a,s,l,c=e.extend({},this.options.position);if(i){if(r=this._find(o))return void r.tooltip.find(".ui-tooltip-content").html(i);o.is("[title]")&&(t&&"mouseover"===t.type?o.attr("title",""):o.removeAttr("title")),r=this._tooltip(o),a=r.tooltip,this._addDescribedBy(o,a.attr("id")),a.find(".ui-tooltip-content").html(i),this.liveRegion.children().hide(),i.clone?(l=i.clone(),l.removeAttr("id").find("[id]").removeAttr("id")):l=i,e("<div>").html(l).appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:n}),n(t)):a.position(e.extend({of:o},this.options.position)),a.hide(),this._show(a,this.options.show),this.options.show&&this.options.show.delay&&(s=this.delayedShow=setInterval(function(){a.is(":visible")&&(n(c.of),clearInterval(s))},e.fx.interval)),this._trigger("open",t,{tooltip:a})}},_registerCloseHandlers:function(t,o){var i={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var i=e.Event(t);i.currentTarget=o[0],this.close(i,!0)}}};o[0]!==this.element[0]&&(i.remove=function(){this._removeTooltip(this._find(o).tooltip)}),t&&"mouseover"!==t.type||(i.mouseleave="close"),t&&"focusin"!==t.type||(i.focusout="close"),this._on(!0,o,i)},close:function(t){var o,i=this,n=e(t?t.currentTarget:this.element),r=this._find(n);return r?(o=r.tooltip,void(r.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),r.hiding=!0,o.stop(!0),this._hide(o,this.options.hide,function(){i._removeTooltip(e(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,o){e(o.element).attr("title",o.title),delete i.parents[t]}),r.closing=!0,this._trigger("close",t,{tooltip:o}),r.hiding||(r.closing=!1)))):void n.removeData("ui-tooltip-open")},_tooltip:function(t){var o=e("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),i=o.uniqueId().attr("id");return e("<div>").addClass("ui-tooltip-content").appendTo(o),o.appendTo(this.document[0].body),this.tooltips[i]={element:t,tooltip:o}},_find:function(e){var t=e.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(o,i){var n=e.Event("blur"),r=i.element;n.target=n.currentTarget=r[0],t.close(n,!0),e("#"+o).remove(),r.data("ui-tooltip-title")&&(r.attr("title")||r.attr("title",r.data("ui-tooltip-title")),r.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}})});
//# sourceMappingURL=ethercalc.js.map